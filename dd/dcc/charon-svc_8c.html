<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: charon-svc.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('dd/dcc/charon-svc_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">charon-svc.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="../../dd/d08/library_8h_source.html">library.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../dc/d63/hydra_8h_source.html">hydra.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d0/d51/daemon_8h_source.html">daemon.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d3/dda/backtrace_8h_source.html">utils/backtrace.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../db/dd5/thread_8h_source.html">threading/thread.h</a>&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for charon-svc.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/d8b/charon-svc_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="../../dd/dcc/charon-svc_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5ecc06b4fbeedd8edd0692663fb76489"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a>&#160;&#160;&#160;&quot;charon-svc&quot;</td></tr>
<tr class="separator:a5ecc06b4fbeedd8edd0692663fb76489"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6217be2302f6c5c7c2da0453cb2e3bb8"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a6217be2302f6c5c7c2da0453cb2e3bb8">service_handler</a> (<a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> dwControl, <a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> dwEventType, LPVOID lpEventData, LPVOID lpContext)</td></tr>
<tr class="separator:a6217be2302f6c5c7c2da0453cb2e3bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64392cdba8d456f637372c0e77c287da"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a64392cdba8d456f637372c0e77c287da">dbg_stderr</a> (<a class="el" href="../../de/db7/group__debug.html#ga7e9915df78adc12ef31cc2a7b2b1e2ff">debug_t</a> <a class="el" href="../../d4/d58/tls__crypto_8c.html#a28f6c53e49dfa08e24017d893fc83524">group</a>, <a class="el" href="../../de/db7/group__debug.html#gaeecff33c3c69c66a1c0c8b271636fffc">level_t</a> level, char *fmt,...)</td></tr>
<tr class="separator:a64392cdba8d456f637372c0e77c287da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a571433b70a39494d589b7d96ed5a9f1f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a571433b70a39494d589b7d96ed5a9f1f">print_version</a> ()</td></tr>
<tr class="separator:a571433b70a39494d589b7d96ed5a9f1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd508211ca3da266bf892f9ca7702894"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a> (<a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> state)</td></tr>
<tr class="separator:abd508211ca3da266bf892f9ca7702894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34411d94cdfd4af99b1928df8b0bd303"><td class="memItemLeft" align="right" valign="top">static BOOL WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a34411d94cdfd4af99b1928df8b0bd303">console_handler</a> (<a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> dwCtrlType)</td></tr>
<tr class="separator:a34411d94cdfd4af99b1928df8b0bd303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf34d40d8df8587725c4a1cbbd807141"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#adf34d40d8df8587725c4a1cbbd807141">console_wait</a> ()</td></tr>
<tr class="separator:adf34d40d8df8587725c4a1cbbd807141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a132ea4cdd62910216c8ea9605a224108"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a132ea4cdd62910216c8ea9605a224108">service_wait</a> ()</td></tr>
<tr class="separator:a132ea4cdd62910216c8ea9605a224108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a57519866b925dd058567c145b8ae45"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a2a57519866b925dd058567c145b8ae45">init_and_run</a> (<a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> dwArgc, LPTSTR *lpszArgv, int(*wait)())</td></tr>
<tr class="separator:a2a57519866b925dd058567c145b8ae45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbee77e5d66102b8a8b52c080af297b0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#abbee77e5d66102b8a8b52c080af297b0">console_main</a> (<a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> dwArgc, LPTSTR *lpszArgv)</td></tr>
<tr class="separator:abbee77e5d66102b8a8b52c080af297b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74aefad2298154b67858e0a1dfd00875"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a74aefad2298154b67858e0a1dfd00875">switch_workingdir</a> ()</td></tr>
<tr class="separator:a74aefad2298154b67858e0a1dfd00875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2187fa70ac95082f38e9cf770aa45af2"><td class="memItemLeft" align="right" valign="top">static void WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a2187fa70ac95082f38e9cf770aa45af2">service_main</a> (<a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> dwArgc, LPTSTR *lpszArgv)</td></tr>
<tr class="separator:a2187fa70ac95082f38e9cf770aa45af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int <a class="el" href="../../d1/d2c/swanctl_2command_8c.html#ad1447518f4372828b8435ae82e48499e">argc</a>, char *<a class="el" href="../../d1/d2c/swanctl_2command_8c.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4da53ff46b740844b3dfb4025f6bbd09"><td class="memItemLeft" align="right" valign="top">static SERVICE_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></td></tr>
<tr class="separator:a4da53ff46b740844b3dfb4025f6bbd09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69b316dd1ee0a26f8eac6c68aac72af3"><td class="memItemLeft" align="right" valign="top">static SERVICE_STATUS_HANDLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a69b316dd1ee0a26f8eac6c68aac72af3">handle</a></td></tr>
<tr class="separator:a69b316dd1ee0a26f8eac6c68aac72af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a565d71e8ad36560cb72c7f6edd56ba63"><td class="memItemLeft" align="right" valign="top">static HANDLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a></td></tr>
<tr class="separator:a565d71e8ad36560cb72c7f6edd56ba63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb0355be5249325bec1a2aace2aae076"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/dcc/charon-svc_8c.html#abb0355be5249325bec1a2aace2aae076">dbg</a> )(<a class="el" href="../../de/db7/group__debug.html#ga7e9915df78adc12ef31cc2a7b2b1e2ff">debug_t</a> <a class="el" href="../../d4/d58/tls__crypto_8c.html#a28f6c53e49dfa08e24017d893fc83524">group</a>, <a class="el" href="../../de/db7/group__debug.html#gaeecff33c3c69c66a1c0c8b271636fffc">level_t</a> level, char *fmt,...)</td></tr>
<tr class="separator:abb0355be5249325bec1a2aace2aae076"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a5ecc06b4fbeedd8edd0692663fb76489"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SERVICE_NAME&#160;&#160;&#160;&quot;charon-svc&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The name of our service, both internal and external </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00026">26</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00195">init_and_run()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00307">main()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00074">print_version()</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">service_main()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a34411d94cdfd4af99b1928df8b0bd303"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static BOOL WINAPI console_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwCtrlType</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Control handler for console </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00114">114</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00293">bus_t::alert</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00088">ALERT_SHUTDOWN_SIGNAL</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00260">daemon_t::bus</a>, <a class="el" href="../../dc/d21/daemon_8c_source.html#l00089">charon</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00036">DBG_DMN</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00041">event</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00248">console_main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;{</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">switch</span> (dwCtrlType)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">case</span> CTRL_C_EVENT:</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">case</span> CTRL_BREAK_EVENT:</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">case</span> CTRL_CLOSE_EVENT:</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a>, <span class="stringliteral">&quot;application is stopping, cleaning up&quot;</span>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwCurrentState == SERVICE_RUNNING)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">bus</a>-&gt;<a class="code" href="../../dc/db8/structbus__t.html#acc074b8b448c2eef34abd4cba834dbe2">alert</a>(<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">bus</a>, <a class="code" href="../../de/d50/group__bus.html#ggaa0071ff5a3cf0fb030265e91a37fe7c4a3343881b230a8b6bf787735e64026f20">ALERT_SHUTDOWN_SIGNAL</a>,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                   dwCtrlType);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="comment">/* signal main thread to clean up */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            SetEvent(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00036">debug.h:36</a></div></div>
<div class="ttc" id="structdaemon__t_html_ae221a60416ecd62483aa97ea139025c3"><div class="ttname"><a href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">daemon_t::bus</a></div><div class="ttdeci">bus_t * bus</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00260">daemon.h:260</a></div></div>
<div class="ttc" id="group__libcharon_html_ga3f85ddc91855d7d74beeb2f21fb74dbb"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a></div><div class="ttdeci">daemon_t * charon</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00089">daemon.c:89</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="structbus__t_html_acc074b8b448c2eef34abd4cba834dbe2"><div class="ttname"><a href="../../dc/db8/structbus__t.html#acc074b8b448c2eef34abd4cba834dbe2">bus_t::alert</a></div><div class="ttdeci">void(* alert)(bus_t *this, alert_t alert,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00293">bus.h:293</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a565d71e8ad36560cb72c7f6edd56ba63"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a></div><div class="ttdeci">static HANDLE event</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00041">charon-svc.c:41</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__bus_html_ggaa0071ff5a3cf0fb030265e91a37fe7c4a3343881b230a8b6bf787735e64026f20"><div class="ttname"><a href="../../de/d50/group__bus.html#ggaa0071ff5a3cf0fb030265e91a37fe7c4a3343881b230a8b6bf787735e64026f20">ALERT_SHUTDOWN_SIGNAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00088">bus.h:88</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a34411d94cdfd4af99b1928df8b0bd303_icgraph.svg" width="379" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="abbee77e5d66102b8a8b52c080af297b0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void console_main </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwArgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPTSTR *&#160;</td>
          <td class="paramname"><em>lpszArgv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Main routine when running from console </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00248">248</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00114">console_handler()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00164">console_wait()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00195">init_and_run()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00307">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;{</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwWin32ExitCode = 1;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> (SetConsoleCtrlHandler(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a34411d94cdfd4af99b1928df8b0bd303">console_handler</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>))</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="../../dd/dcc/charon-svc_8c.html#a2a57519866b925dd058567c145b8ae45">init_and_run</a>(dwArgc, lpszArgv, <a class="code" href="../../dd/dcc/charon-svc_8c.html#adf34d40d8df8587725c4a1cbbd807141">console_wait</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        SetConsoleCtrlHandler(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a34411d94cdfd4af99b1928df8b0bd303">console_handler</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="charon-svc_8c_html_adf34d40d8df8587725c4a1cbbd807141"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#adf34d40d8df8587725c4a1cbbd807141">console_wait</a></div><div class="ttdeci">static int console_wait()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00164">charon-svc.c:164</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a34411d94cdfd4af99b1928df8b0bd303"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a34411d94cdfd4af99b1928df8b0bd303">console_handler</a></div><div class="ttdeci">static BOOL WINAPI console_handler(DWORD dwCtrlType)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00114">charon-svc.c:114</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a2a57519866b925dd058567c145b8ae45"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a2a57519866b925dd058567c145b8ae45">init_and_run</a></div><div class="ttdeci">static void init_and_run(DWORD dwArgc, LPTSTR *lpszArgv, int(*wait)())</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00195">charon-svc.c:195</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_abbee77e5d66102b8a8b52c080af297b0_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_abbee77e5d66102b8a8b52c080af297b0_icgraph.svg" width="214" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="adf34d40d8df8587725c4a1cbbd807141"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int console_wait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wait for console program shutdown </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00164">164</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00041">event</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00094">update_status()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00248">console_main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_RUNNING);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span> (WaitForSingleObjectEx(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>, INFINITE, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) != WAIT_OBJECT_0)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="ttc" id="charon-svc_8c_html_a565d71e8ad36560cb72c7f6edd56ba63"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a></div><div class="ttdeci">static HANDLE event</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00041">charon-svc.c:41</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="charon-svc_8c_html_abd508211ca3da266bf892f9ca7702894"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a></div><div class="ttdeci">static void update_status(DWORD state)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00094">charon-svc.c:94</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_adf34d40d8df8587725c4a1cbbd807141_cgraph.svg" width="262" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_adf34d40d8df8587725c4a1cbbd807141_icgraph.svg" width="360" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a64392cdba8d456f637372c0e77c287da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void dbg_stderr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db7/group__debug.html#ga7e9915df78adc12ef31cc2a7b2b1e2ff">debug_t</a>&#160;</td>
          <td class="paramname"><em>group</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/db7/group__debug.html#gaeecff33c3c69c66a1c0c8b271636fffc">level_t</a>&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Logging hook for library logs, using stderr output </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00057">57</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../de/db7/group__debug.html#gaa9240ce5b05790fad6a3ee6304614ad4">debug_names</a>, <a class="el" href="../../d9/d12/printf__hook__builtin_8h_source.html#l00071">fprintf</a>, and <a class="el" href="../../d9/d12/printf__hook__builtin_8h_source.html#l00077">vfprintf</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00307">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    va_list args;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span> (level &lt;= 1)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        va_start(args, fmt);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaab6e63106cf29e5160e5c2d63db86d27">fprintf</a>(stderr, <span class="stringliteral">&quot;00[%N] &quot;</span>, <a class="code" href="../../de/db7/group__debug.html#gaa9240ce5b05790fad6a3ee6304614ad4">debug_names</a>, <a class="code" href="../../d6/d1a/dh__speed_8c.html#a28f6c53e49dfa08e24017d893fc83524">group</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#ga8fdc4bb69d2ce8fe042b88eae7160e6e">vfprintf</a>(stderr, fmt, args);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaab6e63106cf29e5160e5c2d63db86d27">fprintf</a>(stderr, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        va_end(args);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="ttc" id="dh__speed_8c_html_a28f6c53e49dfa08e24017d893fc83524"><div class="ttname"><a href="../../d6/d1a/dh__speed_8c.html#a28f6c53e49dfa08e24017d893fc83524">group</a></div><div class="ttdeci">diffie_hellman_group_t group</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d1a/dh__speed_8c_source.html#l00031">dh_speed.c:31</a></div></div>
<div class="ttc" id="group__debug_html_gaa9240ce5b05790fad6a3ee6304614ad4"><div class="ttname"><a href="../../de/db7/group__debug.html#gaa9240ce5b05790fad6a3ee6304614ad4">debug_names</a></div><div class="ttdeci">enum_name_t * debug_names</div></div>
<div class="ttc" id="group__printf__hook__builtin_html_ga8fdc4bb69d2ce8fe042b88eae7160e6e"><div class="ttname"><a href="../../d1/dc8/group__printf__hook__builtin.html#ga8fdc4bb69d2ce8fe042b88eae7160e6e">vfprintf</a></div><div class="ttdeci">#define vfprintf</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/printf__hook__builtin_8h_source.html#l00077">printf_hook_builtin.h:77</a></div></div>
<div class="ttc" id="group__printf__hook__builtin_html_gaab6e63106cf29e5160e5c2d63db86d27"><div class="ttname"><a href="../../d1/dc8/group__printf__hook__builtin.html#gaab6e63106cf29e5160e5c2d63db86d27">fprintf</a></div><div class="ttdeci">#define fprintf</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/printf__hook__builtin_8h_source.html#l00071">printf_hook_builtin.h:71</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a64392cdba8d456f637372c0e77c287da_icgraph.svg" width="192" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2a57519866b925dd058567c145b8ae45"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void init_and_run </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwArgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPTSTR *&#160;</td>
          <td class="paramname"><em>lpszArgv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)()&#160;</td>
          <td class="paramname"><em>wait</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize and run charon using a wait function </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00195">195</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../dc/d21/daemon_8c_source.html#l00089">charon</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00072">DBG_MAX</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00041">event</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00295">daemon_t::initialize</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00096">LEVEL_CTRL</a>, <a class="el" href="../../d9/df7/charon_8c_source.html#l00065">levels</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../dc/d21/daemon_8c_source.html#l00689">libcharon_deinit()</a>, <a class="el" href="../../dc/d21/daemon_8c_source.html#l00707">libcharon_init()</a>, <a class="el" href="../../de/d6a/hydra_8c_source.html#l00051">libhydra_deinit()</a>, <a class="el" href="../../de/d6a/hydra_8c_source.html#l00068">libhydra_init()</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00105">library_deinit()</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00247">library_init()</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00310">daemon_t::load_loggers</a>, <a class="el" href="../../dd/dd5/aes-test_8c_source.html#l00027">PLUGINS</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00210">library_t::plugins</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00074">print_version()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00026">SERVICE_NAME</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00300">daemon_t::start</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, <a class="el" href="../../de/db6/plugin__loader_8h_source.html#l00147">plugin_loader_t::status</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00094">update_status()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00248">console_main()</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">service_main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="../../de/db7/group__debug.html#gaeecff33c3c69c66a1c0c8b271636fffc">level_t</a> <a class="code" href="../../d9/df7/charon_8c.html#a0361fd965a21cf311c8ca14d7f2c5eed">levels</a>[<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffab5e664b434229e382102b0453cd22b77">DBG_MAX</a>];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffab5e664b434229e382102b0453cd22b77">DBG_MAX</a>; i++)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        levels[i] = <a class="code" href="../../de/db7/group__debug.html#ggaeecff33c3c69c66a1c0c8b271636fffcaabfc027e43578e276889312964799a9e">LEVEL_CTRL</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_START_PENDING);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keyword">event</span> = CreateEvent(NULL, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, NULL);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_START_PENDING);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d3/d99/group__library.html#ga18cf1ca25ca811f74ba75c1de79cee4f">library_init</a>(NULL, <a class="code" href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a>))</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_START_PENDING);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d9d/group__libhydra.html#gabbb2a2a7ac53c6b841c725f22d7fde60">libhydra_init</a>())</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_START_PENDING);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d0/db7/group__libcharon.html#ga01f4487f0a3d473dfac06abc66741574">libcharon_init</a>())</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    <a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#a6e834d3b196d3dd3f5e2d5deddb53081">load_loggers</a>(<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>, levels, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                    <a class="code" href="../../dd/dcc/charon-svc_8c.html#a571433b70a39494d589b7d96ed5a9f1f">print_version</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_START_PENDING);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#a5e1e2b22607bb8d4d00c56b5666aea16">initialize</a>(<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>, <a class="code" href="../../dd/dd5/aes-test_8c.html#ac3010801f7a878e7da79056b2ce38f5c">PLUGINS</a>))</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                        <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_START_PENDING);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                        <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a667e50725c90633aba03b0ea1a55ded5">plugins</a>-&gt;<a class="code" href="../../dd/d7c/structplugin__loader__t.html#aa6326bf53d48c6e08494a4780a4adbe9">status</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a667e50725c90633aba03b0ea1a55ded5">plugins</a>, <a class="code" href="../../de/db7/group__debug.html#ggaeecff33c3c69c66a1c0c8b271636fffcaabfc027e43578e276889312964799a9e">LEVEL_CTRL</a>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                        <a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#a8b2dffbfd6402be95f4c22241af049f7">start</a>(<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                        <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwWin32ExitCode = wait();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_STOP_PENDING);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    <a class="code" href="../../d0/db7/group__libcharon.html#ga3cb8c2e066a22e30b3814bfd915e689f">libcharon_deinit</a>();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_STOP_PENDING);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <a class="code" href="../../d6/d9d/group__libhydra.html#ga9fb1c0e7b73ef5cc7f5e3ee5b714f70e">libhydra_deinit</a>();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_STOP_PENDING);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <a class="code" href="../../d3/d99/group__library.html#gab33af64193c983bf43d09c198c4a45ab">library_deinit</a>();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_STOP_PENDING);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        CloseHandle(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_STOPPED);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__debug_html_ggaeecff33c3c69c66a1c0c8b271636fffcaabfc027e43578e276889312964799a9e"><div class="ttname"><a href="../../de/db7/group__debug.html#ggaeecff33c3c69c66a1c0c8b271636fffcaabfc027e43578e276889312964799a9e">LEVEL_CTRL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00096">debug.h:96</a></div></div>
<div class="ttc" id="charon_8c_html_a0361fd965a21cf311c8ca14d7f2c5eed"><div class="ttname"><a href="../../d9/df7/charon_8c.html#a0361fd965a21cf311c8ca14d7f2c5eed">levels</a></div><div class="ttdeci">static level_t levels[DBG_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/charon_8c_source.html#l00065">charon.c:65</a></div></div>
<div class="ttc" id="group__libcharon_html_ga3cb8c2e066a22e30b3814bfd915e689f"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga3cb8c2e066a22e30b3814bfd915e689f">libcharon_deinit</a></div><div class="ttdeci">void libcharon_deinit()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00689">daemon.c:689</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="group__libhydra_html_ga9fb1c0e7b73ef5cc7f5e3ee5b714f70e"><div class="ttname"><a href="../../d6/d9d/group__libhydra.html#ga9fb1c0e7b73ef5cc7f5e3ee5b714f70e">libhydra_deinit</a></div><div class="ttdeci">void libhydra_deinit()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6a/hydra_8c_source.html#l00051">hydra.c:51</a></div></div>
<div class="ttc" id="group__debug_html_gaeecff33c3c69c66a1c0c8b271636fffc"><div class="ttname"><a href="../../de/db7/group__debug.html#gaeecff33c3c69c66a1c0c8b271636fffc">level_t</a></div><div class="ttdeci">level_t</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00090">debug.h:90</a></div></div>
<div class="ttc" id="group__libhydra_html_gabbb2a2a7ac53c6b841c725f22d7fde60"><div class="ttname"><a href="../../d6/d9d/group__libhydra.html#gabbb2a2a7ac53c6b841c725f22d7fde60">libhydra_init</a></div><div class="ttdeci">bool libhydra_init()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6a/hydra_8c_source.html#l00068">hydra.c:68</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffab5e664b434229e382102b0453cd22b77"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffab5e664b434229e382102b0453cd22b77">DBG_MAX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00072">debug.h:72</a></div></div>
<div class="ttc" id="group__libcharon_html_ga3f85ddc91855d7d74beeb2f21fb74dbb"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a></div><div class="ttdeci">daemon_t * charon</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00089">daemon.c:89</a></div></div>
<div class="ttc" id="group__libcharon_html_ga01f4487f0a3d473dfac06abc66741574"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga01f4487f0a3d473dfac06abc66741574">libcharon_init</a></div><div class="ttdeci">bool libcharon_init()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00707">daemon.c:707</a></div></div>
<div class="ttc" id="structplugin__loader__t_html_aa6326bf53d48c6e08494a4780a4adbe9"><div class="ttname"><a href="../../dd/d7c/structplugin__loader__t.html#aa6326bf53d48c6e08494a4780a4adbe9">plugin_loader_t::status</a></div><div class="ttdeci">void(* status)(plugin_loader_t *this, level_t level)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/db6/plugin__loader_8h_source.html#l00147">plugin_loader.h:147</a></div></div>
<div class="ttc" id="structdaemon__t_html_a8b2dffbfd6402be95f4c22241af049f7"><div class="ttname"><a href="../../d0/def/structdaemon__t.html#a8b2dffbfd6402be95f4c22241af049f7">daemon_t::start</a></div><div class="ttdeci">void(* start)(daemon_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00300">daemon.h:300</a></div></div>
<div class="ttc" id="group__library_html_gab33af64193c983bf43d09c198c4a45ab"><div class="ttname"><a href="../../d3/d99/group__library.html#gab33af64193c983bf43d09c198c4a45ab">library_deinit</a></div><div class="ttdeci">void library_deinit()</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00105">library.c:105</a></div></div>
<div class="ttc" id="aes-test_8c_html_ac3010801f7a878e7da79056b2ce38f5c"><div class="ttname"><a href="../../dd/dd5/aes-test_8c.html#ac3010801f7a878e7da79056b2ce38f5c">PLUGINS</a></div><div class="ttdeci">#define PLUGINS</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/aes-test_8c_source.html#l00027">aes-test.c:27</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a565d71e8ad36560cb72c7f6edd56ba63"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a></div><div class="ttdeci">static HANDLE event</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00041">charon-svc.c:41</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__library_html_ga18cf1ca25ca811f74ba75c1de79cee4f"><div class="ttname"><a href="../../d3/d99/group__library.html#ga18cf1ca25ca811f74ba75c1de79cee4f">library_init</a></div><div class="ttdeci">bool library_init(char *settings, const char *namespace)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00247">library.c:247</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a5ecc06b4fbeedd8edd0692663fb76489"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a></div><div class="ttdeci">#define SERVICE_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00026">charon-svc.c:26</a></div></div>
<div class="ttc" id="structdaemon__t_html_a5e1e2b22607bb8d4d00c56b5666aea16"><div class="ttname"><a href="../../d0/def/structdaemon__t.html#a5e1e2b22607bb8d4d00c56b5666aea16">daemon_t::initialize</a></div><div class="ttdeci">bool(* initialize)(daemon_t *this, char *plugins)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00295">daemon.h:295</a></div></div>
<div class="ttc" id="charon-svc_8c_html_abd508211ca3da266bf892f9ca7702894"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a></div><div class="ttdeci">static void update_status(DWORD state)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00094">charon-svc.c:94</a></div></div>
<div class="ttc" id="structlibrary__t_html_a667e50725c90633aba03b0ea1a55ded5"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a667e50725c90633aba03b0ea1a55ded5">library_t::plugins</a></div><div class="ttdeci">plugin_loader_t * plugins</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00210">library.h:210</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a571433b70a39494d589b7d96ed5a9f1f"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a571433b70a39494d589b7d96ed5a9f1f">print_version</a></div><div class="ttdeci">static void print_version()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00074">charon-svc.c:74</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="structdaemon__t_html_a6e834d3b196d3dd3f5e2d5deddb53081"><div class="ttname"><a href="../../d0/def/structdaemon__t.html#a6e834d3b196d3dd3f5e2d5deddb53081">daemon_t::load_loggers</a></div><div class="ttdeci">void(* load_loggers)(daemon_t *this, level_t levels[DBG_MAX], bool to_stderr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00310">daemon.h:310</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a2a57519866b925dd058567c145b8ae45_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a2a57519866b925dd058567c145b8ae45_icgraph.svg" width="355" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Main function, starts the service </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00307">307</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00248">console_main()</a>, <a class="el" href="../../d1/d72/debug_8c_source.html#l00111">dbg</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00057">dbg_stderr()</a>, <a class="el" href="../../de/d94/kernel__wfp__compat_8c_source.html#l00175">DWORD</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">service_main()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00026">SERVICE_NAME</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00020">services</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    SERVICE_TABLE_ENTRY <a class="code" href="../../dd/d49/test__stream_8c.html#af267cf96b92d94ac912d72b2fafe05c3">services</a>[] = {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            .lpServiceName = <a class="code" href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a>,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            .lpServiceProc = <a class="code" href="../../dd/dcc/charon-svc_8c.html#a2187fa70ac95082f38e9cf770aa45af2">service_main</a>,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        },</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        { NULL, NULL },</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    };</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> err;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#abb0355be5249325bec1a2aace2aae076">dbg</a> = <a class="code" href="../../dd/dcc/charon-svc_8c.html#a64392cdba8d456f637372c0e77c287da">dbg_stderr</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (!StartServiceCtrlDispatcher(services))</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        err = GetLastError();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">if</span> (err == ERROR_FAILED_SERVICE_CONTROLLER_CONNECT)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <a class="code" href="../../dd/dcc/charon-svc_8c.html#abbee77e5d66102b8a8b52c080af297b0">console_main</a>(<a class="code" href="../../da/d7c/pki_2command_8c.html#ad1447518f4372828b8435ae82e48499e">argc</a>, <a class="code" href="../../da/d7c/pki_2command_8c.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwWin32ExitCode;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="ttc" id="charon-svc_8c_html_abb0355be5249325bec1a2aace2aae076"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#abb0355be5249325bec1a2aace2aae076">dbg</a></div><div class="ttdeci">void(* dbg)(debug_t group, level_t level, char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d72/debug_8c_source.html#l00111">debug.c:111</a></div></div>
<div class="ttc" id="test__stream_8c_html_af267cf96b92d94ac912d72b2fafe05c3"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#af267cf96b92d94ac912d72b2fafe05c3">services</a></div><div class="ttdeci">static char * services[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00020">test_stream.c:20</a></div></div>
<div class="ttc" id="kernel__wfp__compat_8c_html_a213ee437ad57ecbe6e98b7aaf16920a7"><div class="ttname"><a href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a></div><div class="ttdeci">DWORD</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d94/kernel__wfp__compat_8c_source.html#l00175">kernel_wfp_compat.c:175</a></div></div>
<div class="ttc" id="pki_2command_8c_html_af2efa898e9eed6fe6715279cb1ec35b0"><div class="ttname"><a href="../../da/d7c/pki_2command_8c.html#af2efa898e9eed6fe6715279cb1ec35b0">argv</a></div><div class="ttdeci">static char ** argv</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7c/pki_2command_8c_source.html#l00051">pki/command.c:51</a></div></div>
<div class="ttc" id="charon-svc_8c_html_abbee77e5d66102b8a8b52c080af297b0"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#abbee77e5d66102b8a8b52c080af297b0">console_main</a></div><div class="ttdeci">static void console_main(DWORD dwArgc, LPTSTR *lpszArgv)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00248">charon-svc.c:248</a></div></div>
<div class="ttc" id="pki_2command_8c_html_ad1447518f4372828b8435ae82e48499e"><div class="ttname"><a href="../../da/d7c/pki_2command_8c.html#ad1447518f4372828b8435ae82e48499e">argc</a></div><div class="ttdeci">static int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7c/pki_2command_8c_source.html#l00049">pki/command.c:49</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a5ecc06b4fbeedd8edd0692663fb76489"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a></div><div class="ttdeci">#define SERVICE_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00026">charon-svc.c:26</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a2187fa70ac95082f38e9cf770aa45af2"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a2187fa70ac95082f38e9cf770aa45af2">service_main</a></div><div class="ttdeci">static void WINAPI service_main(DWORD dwArgc, LPTSTR *lpszArgv)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00288">charon-svc.c:288</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a64392cdba8d456f637372c0e77c287da"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a64392cdba8d456f637372c0e77c287da">dbg_stderr</a></div><div class="ttdeci">static void dbg_stderr(debug_t group, level_t level, char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00057">charon-svc.c:57</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a0ddf1224851353fc92bfbff6f499fa97_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a571433b70a39494d589b7d96ed5a9f1f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void print_version </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Log strongSwan/Windows version during startup </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00074">74</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00036">DBG_DMN</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00026">SERVICE_NAME</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00195">init_and_run()</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    OSVERSIONINFOEX osvie;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(&amp;osvie, 0, <span class="keyword">sizeof</span>(osvie));</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    osvie.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(osvie);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (GetVersionEx((LPOSVERSIONINFO)&amp;osvie))</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a>, <span class="stringliteral">&quot;Starting IKE service %s (strongSwan %s, &quot;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;             <span class="stringliteral">&quot;Windows %s %d.%d.%d (SP %d.%d)&quot;</span>, <a class="code" href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a>, VERSION,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;             osvie.wProductType == VER_NT_WORKSTATION ? <span class="stringliteral">&quot;Client&quot;</span> : <span class="stringliteral">&quot;Server&quot;</span>,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;             osvie.dwMajorVersion, osvie.dwMinorVersion, osvie.dwBuildNumber,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;             osvie.wServicePackMajor, osvie.wServicePackMinor);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00036">debug.h:36</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a5ecc06b4fbeedd8edd0692663fb76489"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a></div><div class="ttdeci">#define SERVICE_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00026">charon-svc.c:26</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a571433b70a39494d589b7d96ed5a9f1f_icgraph.svg" width="499" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6217be2302f6c5c7c2da0453cb2e3bb8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a> WINAPI service_handler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwControl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwEventType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPVOID&#160;</td>
          <td class="paramname"><em>lpEventData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPVOID&#160;</td>
          <td class="paramname"><em>lpContext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Forward declaration</p>
<p>Service handler function </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00138">138</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00293">bus_t::alert</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00088">ALERT_SHUTDOWN_SIGNAL</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00260">daemon_t::bus</a>, <a class="el" href="../../dc/d21/daemon_8c_source.html#l00089">charon</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00036">DBG_DMN</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00041">event</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">service_main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">switch</span> (dwControl)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">case</span> SERVICE_CONTROL_STOP:</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">case</span> SERVICE_CONTROL_SHUTDOWN:</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a>, <span class="stringliteral">&quot;service is stopping, cleaning up&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwCurrentState == SERVICE_RUNNING)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                <a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">bus</a>-&gt;<a class="code" href="../../dc/db8/structbus__t.html#acc074b8b448c2eef34abd4cba834dbe2">alert</a>(<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">bus</a>, <a class="code" href="../../de/d50/group__bus.html#ggaa0071ff5a3cf0fb030265e91a37fe7c4a3343881b230a8b6bf787735e64026f20">ALERT_SHUTDOWN_SIGNAL</a>,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                   dwControl);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="comment">/* signal main thread to clean up */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            SetEvent(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">return</span> NO_ERROR;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">case</span> SERVICE_CONTROL_INTERROGATE:</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">return</span> NO_ERROR;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">return</span> ERROR_CALL_NOT_IMPLEMENTED;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00036">debug.h:36</a></div></div>
<div class="ttc" id="structdaemon__t_html_ae221a60416ecd62483aa97ea139025c3"><div class="ttname"><a href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">daemon_t::bus</a></div><div class="ttdeci">bus_t * bus</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00260">daemon.h:260</a></div></div>
<div class="ttc" id="group__libcharon_html_ga3f85ddc91855d7d74beeb2f21fb74dbb"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a></div><div class="ttdeci">daemon_t * charon</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00089">daemon.c:89</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="structbus__t_html_acc074b8b448c2eef34abd4cba834dbe2"><div class="ttname"><a href="../../dc/db8/structbus__t.html#acc074b8b448c2eef34abd4cba834dbe2">bus_t::alert</a></div><div class="ttdeci">void(* alert)(bus_t *this, alert_t alert,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00293">bus.h:293</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a565d71e8ad36560cb72c7f6edd56ba63"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a></div><div class="ttdeci">static HANDLE event</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00041">charon-svc.c:41</a></div></div>
<div class="ttc" id="group__bus_html_ggaa0071ff5a3cf0fb030265e91a37fe7c4a3343881b230a8b6bf787735e64026f20"><div class="ttname"><a href="../../de/d50/group__bus.html#ggaa0071ff5a3cf0fb030265e91a37fe7c4a3343881b230a8b6bf787735e64026f20">ALERT_SHUTDOWN_SIGNAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00088">bus.h:88</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a6217be2302f6c5c7c2da0453cb2e3bb8_icgraph.svg" width="371" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2187fa70ac95082f38e9cf770aa45af2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void WINAPI service_main </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a>&#160;</td>
          <td class="paramname"><em>dwArgc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPTSTR *&#160;</td>
          <td class="paramname"><em>lpszArgv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Service main routine when running as service </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">288</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00036">handle</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00195">init_and_run()</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00138">service_handler()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00026">SERVICE_NAME</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00178">service_wait()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00262">switch_workingdir()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00307">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(&amp;<a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>));</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwServiceType = SERVICE_WIN32_OWN_PROCESS;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwWin32ExitCode = 1;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#a69b316dd1ee0a26f8eac6c68aac72af3">handle</a> = RegisterServiceCtrlHandlerEx(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a>, <a class="code" href="../../dd/dcc/charon-svc_8c.html#a6217be2302f6c5c7c2da0453cb2e3bb8">service_handler</a>, NULL);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a69b316dd1ee0a26f8eac6c68aac72af3">handle</a>)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a74aefad2298154b67858e0a1dfd00875">switch_workingdir</a>())</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <a class="code" href="../../dd/dcc/charon-svc_8c.html#a2a57519866b925dd058567c145b8ae45">init_and_run</a>(dwArgc, lpszArgv, <a class="code" href="../../dd/dcc/charon-svc_8c.html#a132ea4cdd62910216c8ea9605a224108">service_wait</a>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="ttc" id="charon-svc_8c_html_a69b316dd1ee0a26f8eac6c68aac72af3"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a69b316dd1ee0a26f8eac6c68aac72af3">handle</a></div><div class="ttdeci">static SERVICE_STATUS_HANDLE handle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00036">charon-svc.c:36</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a74aefad2298154b67858e0a1dfd00875"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a74aefad2298154b67858e0a1dfd00875">switch_workingdir</a></div><div class="ttdeci">static bool switch_workingdir()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00262">charon-svc.c:262</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a6217be2302f6c5c7c2da0453cb2e3bb8"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a6217be2302f6c5c7c2da0453cb2e3bb8">service_handler</a></div><div class="ttdeci">static DWORD WINAPI service_handler(DWORD dwControl, DWORD dwEventType, LPVOID lpEventData, LPVOID lpContext)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00138">charon-svc.c:138</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a2a57519866b925dd058567c145b8ae45"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a2a57519866b925dd058567c145b8ae45">init_and_run</a></div><div class="ttdeci">static void init_and_run(DWORD dwArgc, LPTSTR *lpszArgv, int(*wait)())</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00195">charon-svc.c:195</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a132ea4cdd62910216c8ea9605a224108"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a132ea4cdd62910216c8ea9605a224108">service_wait</a></div><div class="ttdeci">static int service_wait()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00178">charon-svc.c:178</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a5ecc06b4fbeedd8edd0692663fb76489"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a5ecc06b4fbeedd8edd0692663fb76489">SERVICE_NAME</a></div><div class="ttdeci">#define SERVICE_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00026">charon-svc.c:26</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a2187fa70ac95082f38e9cf770aa45af2_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a2187fa70ac95082f38e9cf770aa45af2_icgraph.svg" width="208" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a132ea4cdd62910216c8ea9605a224108"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int service_wait </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wait for service shutdown </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00178">178</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00041">event</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00094">update_status()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">service_main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">/* service is initialized, we now accept control requests */</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwControlsAccepted = SERVICE_ACCEPT_STOP | SERVICE_ACCEPT_SHUTDOWN;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a>(SERVICE_RUNNING);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwControlsAccepted = 0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (WaitForSingleObjectEx(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>, INFINITE, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) != WAIT_OBJECT_0)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
<div class="ttc" id="charon-svc_8c_html_a565d71e8ad36560cb72c7f6edd56ba63"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a></div><div class="ttdeci">static HANDLE event</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00041">charon-svc.c:41</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="charon-svc_8c_html_abd508211ca3da266bf892f9ca7702894"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#abd508211ca3da266bf892f9ca7702894">update_status</a></div><div class="ttdeci">static void update_status(DWORD state)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00094">charon-svc.c:94</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a132ea4cdd62910216c8ea9605a224108_cgraph.svg" width="259" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a132ea4cdd62910216c8ea9605a224108_icgraph.svg" width="352" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a74aefad2298154b67858e0a1dfd00875"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> switch_workingdir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Switch the working directory to the executable directory </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00262">262</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, and <a class="el" href="../../d9/dbe/test__utils_8c_source.html#l00593">path</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">service_main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;{</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    CHAR <a class="code" href="../../d9/dbe/test__utils_8c.html#a44196e6a5696d10442c29e639437196e">path</a>[MAX_PATH], *pos;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    HMODULE module;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    module = GetModuleHandle(NULL);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (!module)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (!GetModuleFileName(module, path, <span class="keyword">sizeof</span>(path)))</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    pos = strrchr(path, <span class="charliteral">&#39;\\&#39;</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">if</span> (!pos)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    *pos = 0;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">return</span> SetCurrentDirectory(path);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="ttc" id="test__utils_8c_html_a44196e6a5696d10442c29e639437196e"><div class="ttname"><a href="../../d9/dbe/test__utils_8c.html#a44196e6a5696d10442c29e639437196e">path</a></div><div class="ttdeci">char * path</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbe/test__utils_8c_source.html#l00593">test_utils.c:593</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_a74aefad2298154b67858e0a1dfd00875_icgraph.svg" width="384" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="abd508211ca3da266bf892f9ca7702894"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void update_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d94/kernel__wfp__compat_8c.html#a213ee437ad57ecbe6e98b7aaf16920a7">DWORD</a>&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update service state to SCM, increase check point if state didn't change </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00094">94</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>References <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00036">handle</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00164">console_wait()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00195">init_and_run()</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00178">service_wait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (state == <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwCurrentState)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwCheckPoint++;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwCheckPoint = 0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>.dwCurrentState = state;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a69b316dd1ee0a26f8eac6c68aac72af3">handle</a>)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        SetServiceStatus(<a class="code" href="../../dd/dcc/charon-svc_8c.html#a69b316dd1ee0a26f8eac6c68aac72af3">handle</a>, &amp;<a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="ttc" id="charon-svc_8c_html_a69b316dd1ee0a26f8eac6c68aac72af3"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a69b316dd1ee0a26f8eac6c68aac72af3">handle</a></div><div class="ttdeci">static SERVICE_STATUS_HANDLE handle</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00036">charon-svc.c:36</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dd/dcc/charon-svc_8c_abd508211ca3da266bf892f9ca7702894_icgraph.svg" width="512" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="abb0355be5249325bec1a2aace2aae076"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* dbg)(<a class="el" href="../../de/db7/group__debug.html#ga7e9915df78adc12ef31cc2a7b2b1e2ff">debug_t</a> <a class="el" href="../../d4/d58/tls__crypto_8c.html#a28f6c53e49dfa08e24017d893fc83524">group</a>, <a class="el" href="../../de/db7/group__debug.html#gaeecff33c3c69c66a1c0c8b271636fffc">level_t</a> level, char *fmt,...)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>hook in library for debugging messages</p>
<p>The registered debug hook. </p>

<p>Definition at line <a class="el" href="../../d1/d72/debug_8c_source.html#l00111">111</a> of file <a class="el" href="../../d1/d72/debug_8c_source.html">debug.c</a>.</p>

<p>Referenced by <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00307">main()</a>.</p>

</div>
</div>
<a class="anchor" id="a565d71e8ad36560cb72c7f6edd56ba63"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE event</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wait event for main thread </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00041">41</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d3b/vici__dispatcher_8c_source.html#l00376">CALLBACK()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00114">console_handler()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00164">console_wait()</a>, <a class="el" href="../../dc/dfc/libvici_8c_source.html#l00143">handle_event()</a>, <a class="el" href="../../d9/dad/ipsec__event__relay_8c_source.html#l00108">handle_events()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00195">init_and_run()</a>, <a class="el" href="../../d9/dad/ipsec__event__relay_8c_source.html#l00137">METHOD()</a>, <a class="el" href="../../d7/d73/pts__ima__bios__list_8c_source.html#l00192">pts_ima_bios_list_create()</a>, <a class="el" href="../../d0/d3b/vici__dispatcher_8c_source.html#l00148">register_event()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01764">register_events()</a>, <a class="el" href="../../dd/d6c/scheduler_8c_source.html#l00132">remove_event()</a>, <a class="el" href="../../dd/d6c/scheduler_8c_source.html#l00180">schedule()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00138">service_handler()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00178">service_wait()</a>, <a class="el" href="../../d0/d3b/vici__dispatcher_8c_source.html#l00185">unregister_event()</a>, <a class="el" href="../../dc/dfc/libvici_8c_source.html#l00277">vici_disconnect()</a>, and <a class="el" href="../../dc/dfc/libvici_8c_source.html#l00678">vici_register()</a>.</p>

</div>
</div>
<a class="anchor" id="a69b316dd1ee0a26f8eac6c68aac72af3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SERVICE_STATUS_HANDLE handle</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handle for service status </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00036">36</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l02486">add_bypass()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01285">add_tunnel_provider()</a>, <a class="el" href="../../d6/dc2/checksum__builder_8c_source.html#l00034">build_checksum()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l00256">cleanup_policies()</a>, <a class="el" href="../../d4/ddc/windows_2thread_8c_source.html#l00442">create_internal()</a>, <a class="el" href="../../d4/ddc/windows_2thread_8c_source.html#l00295">destroy()</a>, <a class="el" href="../../d1/d3f/windows_8c_source.html#l00081">dlsym_default()</a>, <a class="el" href="../../d1/d3f/windows_8c_source.html#l00112">dlsym_next()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l00296">entry_destroy()</a>, <a class="el" href="../../d7/dde/pkcs11__library_8c_source.html#l01030">initialize()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l00738">install_ipip_ale()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01000">install_sa()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01143">install_sas()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l00660">install_sp()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01782">install_trap()</a>, <a class="el" href="../../d4/dbf/integrity__checker_8c_source.html#l00255">integrity_checker_create()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l02628">kernel_wfp_ipsec_create()</a>, <a class="el" href="../../d7/d5a/ipsecdump_8c_source.html#l00347">list_contexts()</a>, <a class="el" href="../../d7/d5a/ipsecdump_8c_source.html#l00555">list_filters()</a>, <a class="el" href="../../de/d94/kernel__wfp__compat_8c_source.html#l00133">load_function()</a>, <a class="el" href="../../db/d66/plugin__loader_8c_source.html#l00354">load_plugin()</a>, <a class="el" href="../../d4/dbf/integrity__checker_8c_source.html#l00242">METHOD()</a>, <a class="el" href="../../d7/dde/pkcs11__library_8c_source.html#l01109">pkcs11_library_create()</a>, <a class="el" href="../../d3/d61/tnc__pdp_8c_source.html#l00624">pt_tls_receive_more()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01764">register_events()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">service_main()</a>, <a class="el" href="../../d4/ddc/windows_2thread_8c_source.html#l00478">thread_create()</a>, <a class="el" href="../../d6/d34/tnc__imc_8c_source.html#l00349">tnc_imc_create()</a>, <a class="el" href="../../d3/dbe/tnc__imv_8c_source.html#l00345">tnc_imv_create()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01852">uninstall_trap()</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00094">update_status()</a>.</p>

</div>
</div>
<a class="anchor" id="a4da53ff46b740844b3dfb4025f6bbd09"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SERVICE_STATUS status</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Current service status </p>

<p>Definition at line <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">31</a> of file <a class="el" href="../../dd/dcc/charon-svc_8c_source.html">charon-svc.c</a>.</p>

<p>Referenced by <a class="el" href="../../db/d67/imc__hcd_8c_source.html#l00182">add_default_pwd_enabled()</a>, <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l02063">add_policy_internal()</a>, <a class="el" href="../../db/d67/imc__hcd_8c_source.html#l00232">add_pstn_fax_enabled()</a>, <a class="el" href="../../db/d67/imc__hcd_8c_source.html#l00268">add_user_app_enabled()</a>, <a class="el" href="../../db/d67/imc__hcd_8c_source.html#l00286">add_user_app_persist_enabled()</a>, <a class="el" href="../../d7/d6a/pt__tls__server_8c_source.html#l00403">assess()</a>, <a class="el" href="../../d6/d2f/identification_8c_source.html#l00376">atodn()</a>, <a class="el" href="../../d6/d6a/tls__fragmentation_8c_source.html#l00379">build_application()</a>, <a class="el" href="../../d6/d6a/tls__fragmentation_8c_source.html#l00334">build_handshake()</a>, <a class="el" href="../../d6/d3e/tls__eap_8c_source.html#l00206">build_pkt()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00093">change_status()</a>, <a class="el" href="../../d9/da6/stroke__control_8c_source.html#l00106">charon_initiate()</a>, <a class="el" href="../../d9/da6/stroke__control_8c_source.html#l00304">charon_terminate()</a>, <a class="el" href="../../d3/d71/gmp__rsa__private__key_8c_source.html#l00528">check()</a>, <a class="el" href="../../d1/d05/credential__manager_8c_source.html#l00550">check_lifetime()</a>, <a class="el" href="../../d7/d9b/pt-tls-client_8c_source.html#l00053">client()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00114">console_handler()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00248">console_main()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02317">decrypt_and_extract()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02464">decrypt_payloads()</a>, <a class="el" href="../../de/d43/child__delete_8c_source.html#l00196">destroy_and_reestablish()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00200">disconnect()</a>, <a class="el" href="../../d7/d6a/pt__tls__server_8c_source.html#l00318">do_sasl()</a>, <a class="el" href="../../dc/db6/aikgen_8c_source.html#l00133">exit_aikgen()</a>, <a class="el" href="../../dd/d3d/scepclient_8c_source.html#l00264">exit_scepclient()</a>, <a class="el" href="../../df/de7/swid__inventory_8c_source.html#l00153">generate_tags()</a>, <a class="el" href="../../dd/deb/eap__mschapv2_8c_source.html#l00506">GenerateStuff()</a>, <a class="el" href="../../d5/d2c/generic__attr__bool_8c_source.html#l00190">generic_attr_bool_create()</a>, <a class="el" href="../../de/d43/mediation__manager_8c_source.html#l00113">get_peer_by_id()</a>, <a class="el" href="../../d9/d32/connect__manager_8c_source.html#l00619">get_triggered_pair()</a>, <a class="el" href="../../dd/d65/task__manager__v1_8c_source.html#l01203">handle_fragment()</a>, <a class="el" href="../../de/ddc/ietf__attr__op__status_8c_source.html#l00269">ietf_attr_op_status_create()</a>, <a class="el" href="../../df/dea/imc__attestation__process_8c_source.html#l00051">imc_attestation_process()</a>, <a class="el" href="../../d9/dff/imv__attestation__process_8c_source.html#l00042">imv_attestation_process()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00195">init_and_run()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00226">initiate_connection()</a>, <a class="el" href="../../d7/d58/quick__mode_8c_source.html#l00278">install()</a>, <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00830">install_policies_internal()</a>, <a class="el" href="../../d1/d8c/shunt__manager_8c_source.html#l00063">install_shunt_policy()</a>, <a class="el" href="../../d8/dca/keychain__creds_8c_source.html#l00065">load_certs()</a>, <a class="el" href="../../df/d4e/charon-nm_8c_source.html#l00154">main()</a>, <a class="el" href="../../d1/d1f/kernel__pfroute__net_8c_source.html#l01384">manage_route()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">manage_srcroute()</a>, <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00657">METHOD()</a>, <a class="el" href="../../dd/d65/task__manager__v1_8c_source.html#l01230">parse_message()</a>, <a class="el" href="../../df/d29/x509__ocsp__response_8c_source.html#l00591">parse_OCSPResponse()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02243">parse_payloads()</a>, <a class="el" href="../../dd/dcf/pem__builder_8c_source.html#l00180">pem_to_bin()</a>, <a class="el" href="../../d6/d6a/tls__fragmentation_8c_source.html#l00220">process_application()</a>, <a class="el" href="../../d1/dab/eap__aka__peer_8c_source.html#l00208">process_challenge()</a>, <a class="el" href="../../d6/d6a/tls__fragmentation_8c_source.html#l00144">process_handshake()</a>, <a class="el" href="../../dd/deb/eap__mschapv2_8c_source.html#l00858">process_peer_failure()</a>, <a class="el" href="../../dd/deb/eap__mschapv2_8c_source.html#l00773">process_peer_success()</a>, <a class="el" href="../../dd/d65/task__manager__v1_8c_source.html#l00962">process_request()</a>, <a class="el" href="../../dd/d65/task__manager__v1_8c_source.html#l01127">process_response()</a>, <a class="el" href="../../d9/d29/pb__tnc__batch_8c_source.html#l00322">process_tnc_msg()</a>, <a class="el" href="../../d7/d6a/pt__tls__server_8c_source.html#l00161">read_sasl()</a>, <a class="el" href="../../d5/db4/imv__hcd__agent_8c_source.html#l00173">receive_msg()</a>, <a class="el" href="../../d0/d09/receiver_8c_source.html#l00417">receive_packets()</a>, <a class="el" href="../../d0/d76/ha__cache_8c_source.html#l00199">rekey_children()</a>, <a class="el" href="../../dc/dfb/smp_8c_source.html#l00436">request_control_initiate()</a>, <a class="el" href="../../dc/dfb/smp_8c_source.html#l00370">request_control_terminate()</a>, <a class="el" href="../../d3/d86/padlock__rng_8c_source.html#l00054">rng()</a>, <a class="el" href="../../d8/d97/scep_8c_source.html#l00341">scep_http_request()</a>, <a class="el" href="../../de/d1f/seg__env_8c_source.html#l00255">seg_env_create_from_data()</a>, <a class="el" href="../../d2/d9f/pt__tls__client_8c_source.html#l00276">select_and_do_sasl()</a>, <a class="el" href="../../dc/d9a/child__create_8c_source.html#l00459">select_and_install()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00138">service_handler()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00288">service_main()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00178">service_wait()</a>, <a class="el" href="../../d9/d93/stroke_8c_source.html#l00246">show_status()</a>, <a class="el" href="../../d4/d9a/pubkey__authenticator_8c_source.html#l00257">sign_classic()</a>, <a class="el" href="../../d4/d9a/pubkey__authenticator_8c_source.html#l00203">sign_signature_auth()</a>, <a class="el" href="../../db/dd6/starter_8c_source.html#l00164">signal_handler()</a>, <a class="el" href="../../da/dee/test__fetch__http_8c_source.html#l00200">START_TEST()</a>, <a class="el" href="../../d2/df6/unbound__response_8c_source.html#l00118">unbound_response_create_frm_libub_response()</a>, <a class="el" href="../../da/d2a/unbound__rr_8c_source.html#l00110">unbound_rr_create_frm_ldns_rr()</a>, <a class="el" href="../../d1/d8c/shunt__manager_8c_source.html#l00200">uninstall_shunt_policy()</a>, <a class="el" href="../../d7/d68/ike__mobike_8c_source.html#l00254">update_children()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00094">update_status()</a>, <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00462">update_usebytes()</a>, <a class="el" href="../../da/d4e/xauth__eap_8c_source.html#l00111">verify_eap()</a>, and <a class="el" href="../../d6/d63/eap__radius__xauth_8c_source.html#l00123">verify_radius()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_2470fc0d77334fe553782314fc8c8767.html">charon-svc</a></li><li class="navelem"><a class="el" href="../../dd/dcc/charon-svc_8c.html">charon-svc.c</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:03:34 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
