<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: message.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d0/d6d/message_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">message.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../da/d66/string_8h_source.html">string.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="../../d2/d0d/message_8h_source.html">message.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="../../dd/d08/library_8h_source.html">library.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d5/dac/bio__writer_8h_source.html">bio/bio_writer.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../db/d63/array_8h_source.html">collections/array.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d0/d51/daemon_8h_source.html">daemon.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../de/da7/keymat__v1_8h_source.html">sa/ikev1/keymat_v1.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d8/df4/generator_8h_source.html">encoding/generator.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d1/df6/libcharon_2encoding_2parser_8h_source.html">encoding/parser.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../de/d06/encodings_8h_source.html">encoding/payloads/encodings.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d4/d8b/payload_8h_source.html">encoding/payloads/payload.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../dd/d54/hash__payload_8h_source.html">encoding/payloads/hash_payload.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d4/d26/encrypted__payload_8h_source.html">encoding/payloads/encrypted_payload.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d7/de8/encrypted__fragment__payload_8h_source.html">encoding/payloads/encrypted_fragment_payload.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d1/d97/unknown__payload_8h_source.html">encoding/payloads/unknown_payload.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d1/d7e/cp__payload_8h_source.html">encoding/payloads/cp_payload.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../df/d93/fragment__payload_8h_source.html">encoding/payloads/fragment_payload.h</a>&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for message.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d4/da8/message_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="../../d0/d6d/message_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dcd/structmessage__rule__t.html">message_rule_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/da5/structfragment__data__t.html">fragment_data_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d6f/structfragment__t.html">fragment_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3973eab87906a64f6c2f84dd30c87f47"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:a3973eab87906a64f6c2f84dd30c87f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cf903b5b85af33775169d09695b3fb4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a1cf903b5b85af33775169d09695b3fb4">MAX_DELETE_PAYLOADS</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:a1cf903b5b85af33775169d09695b3fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1bf82ba0751af9ecd6eb3586f0a01ae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ae1bf82ba0751af9ecd6eb3586f0a01ae">MAX_CERT_PAYLOADS</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:ae1bf82ba0751af9ecd6eb3586f0a01ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38b3c546e75469ac1ebe228f78b51b07"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:a38b3c546e75469ac1ebe228f78b51b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c9c82da02268e686d587f92e2c137e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ad4c9c82da02268e686d587f92e2c137e">MAX_CERTREQ_PAYLOADS</a>&#160;&#160;&#160;20</td></tr>
<tr class="separator:ad4c9c82da02268e686d587f92e2c137e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9afd2ed5ae2fa1018aabdbc5f516c9ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a9afd2ed5ae2fa1018aabdbc5f516c9ff">MAX_NAT_D_PAYLOADS</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a9afd2ed5ae2fa1018aabdbc5f516c9ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e3558ae64440370a8d1eca6f4447a9c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a3e3558ae64440370a8d1eca6f4447a9c">MAX_FRAGMENTS</a>&#160;&#160;&#160;255</td></tr>
<tr class="separator:a3e3558ae64440370a8d1eca6f4447a9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e5204ff05bf7fac32b7b74055b73065"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(fl, amount)</td></tr>
<tr class="separator:a7e5204ff05bf7fac32b7b74055b73065"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ac8bf60567ad10a781b254e7e574e44b6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ac8bf60567ad10a781b254e7e574e44b6">private_message_t</a></td></tr>
<tr class="separator:ac8bf60567ad10a781b254e7e574e44b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aaf699226234aa58a876efdf1e8b5d1e8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#aaf699226234aa58a876efdf1e8b5d1e8">fragment_destroy</a> (<a class="el" href="../../d3/d6f/structfragment__t.html">fragment_t</a> *this)</td></tr>
<tr class="separator:aaf699226234aa58a876efdf1e8b5d1e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c1298a30209676eb847c2c4406e0a22"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a7c1298a30209676eb847c2c4406e0a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef38b51cc48772f0530dabb1a53dbb52"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../df/dcd/structmessage__rule__t.html">message_rule_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#aef38b51cc48772f0530dabb1a53dbb52">get_message_rule</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:aef38b51cc48772f0530dabb1a53dbb52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2cf8cf2c2016e48b002c4acc5d51a51"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ac2cf8cf2c2016e48b002c4acc5d51a51">get_payload_rule</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>)</td></tr>
<tr class="separator:ac2cf8cf2c2016e48b002c4acc5d51a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac6a3c893ccf084181f910de9d06cb34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#aac6a3c893ccf084181f910de9d06cb34">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_ike_sa_id, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *ike_sa_id)</td></tr>
<tr class="separator:aac6a3c893ccf084181f910de9d06cb34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a102ed491cd3677f743791a84238aa58c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a102ed491cd3677f743791a84238aa58c">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_ike_sa_id, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a102ed491cd3677f743791a84238aa58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70e317774884c3f6897d203682d7edb6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a70e317774884c3f6897d203682d7edb6">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_message_id, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, u_int32_t message_id)</td></tr>
<tr class="separator:a70e317774884c3f6897d203682d7edb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86098549feb9c126898b35579f270935"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a86098549feb9c126898b35579f270935">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_message_id, u_int32_t, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a86098549feb9c126898b35579f270935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9010bc1b47cf91b52a934dc9afd072"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a6f9010bc1b47cf91b52a934dc9afd072">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_initiator_spi, u_int64_t, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a6f9010bc1b47cf91b52a934dc9afd072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33053520e0324e872e0df97ce5da2cf1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a33053520e0324e872e0df97ce5da2cf1">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_responder_spi, u_int64_t, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a33053520e0324e872e0df97ce5da2cf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e7a312e8b4d34a0b59c01d3340d3de4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a9e7a312e8b4d34a0b59c01d3340d3de4">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_major_version, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, u_int8_t major_version)</td></tr>
<tr class="separator:a9e7a312e8b4d34a0b59c01d3340d3de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37046c767986eca8dce22ab42e96ef4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ab37046c767986eca8dce22ab42e96ef4">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_major_version, u_int8_t, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:ab37046c767986eca8dce22ab42e96ef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f8b3e59fc845389d8fbfd7cf2aa47b0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a4f8b3e59fc845389d8fbfd7cf2aa47b0">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_minor_version, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, u_int8_t minor_version)</td></tr>
<tr class="separator:a4f8b3e59fc845389d8fbfd7cf2aa47b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a876229d434abd4096a628f03ded16211"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a876229d434abd4096a628f03ded16211">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_minor_version, u_int8_t, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a876229d434abd4096a628f03ded16211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91e09527bde32f25b2cbdd3b43ca7d15"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a91e09527bde32f25b2cbdd3b43ca7d15">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_exchange_type, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d3/d63/group__ike__header.html#ga7ac65c9d137f83d2cc8d0177749d3aab">exchange_type_t</a> exchange_type)</td></tr>
<tr class="separator:a91e09527bde32f25b2cbdd3b43ca7d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc8d79261b9c7f5c4b0470f8cbefd52"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a3bc8d79261b9c7f5c4b0470f8cbefd52">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_exchange_type, <a class="el" href="../../d3/d63/group__ike__header.html#ga7ac65c9d137f83d2cc8d0177749d3aab">exchange_type_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a3bc8d79261b9c7f5c4b0470f8cbefd52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94ce4cd8818b37fc8d616d10e0fa2da1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a94ce4cd8818b37fc8d616d10e0fa2da1">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_first_payload_type, <a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a94ce4cd8818b37fc8d616d10e0fa2da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af952654ad3cc3ac5a719680851f600fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#af952654ad3cc3ac5a719680851f600fa">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_request, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../dc/dfb/smp_8c.html#ae5ffd6d9c6e452364d061068e1c4affc">request</a>)</td></tr>
<tr class="separator:af952654ad3cc3ac5a719680851f600fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5423f94cb34d32d6eeb522f8ef3cbac5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a5423f94cb34d32d6eeb522f8ef3cbac5">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_request, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a5423f94cb34d32d6eeb522f8ef3cbac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9a20770de3aecc1423d56c460fcf0fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ae9a20770de3aecc1423d56c460fcf0fb">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_version_flag, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:ae9a20770de3aecc1423d56c460fcf0fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10474850d49cd9040781f8ee46bc94d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a10474850d49cd9040781f8ee46bc94d3">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_reserved_header_bit, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, u_int nr)</td></tr>
<tr class="separator:a10474850d49cd9040781f8ee46bc94d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a942681362ff8b4f8d7f3f8534bd9977f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a942681362ff8b4f8d7f3f8534bd9977f">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_reserved_header_bit, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, u_int nr)</td></tr>
<tr class="separator:a942681362ff8b4f8d7f3f8534bd9977f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5435e3dd3193276738a67e6889fb6c25"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a5435e3dd3193276738a67e6889fb6c25">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, is_encoded, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a5435e3dd3193276738a67e6889fb6c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57622794339721a03f04bac45a45d00e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a57622794339721a03f04bac45a45d00e">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, is_fragmented, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a57622794339721a03f04bac45a45d00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae715e0f710ef02749697edc09a8cdc3b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ae715e0f710ef02749697edc09a8cdc3b">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, add_payload, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload)</td></tr>
<tr class="separator:ae715e0f710ef02749697edc09a8cdc3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf7f4a028e2848f2acfe219f57958ecb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#aaf7f4a028e2848f2acfe219f57958ecb">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, add_notify, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> flush, <a class="el" href="../../da/d2c/group__notify__payload.html#gab6c94f52cd7f074f81f537e08b89bdca">notify_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>)</td></tr>
<tr class="separator:aaf7f4a028e2848f2acfe219f57958ecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c9e3ce3edd6f36dacf42da1118ad39"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a37c9e3ce3edd6f36dacf42da1118ad39">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_source, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>)</td></tr>
<tr class="separator:a37c9e3ce3edd6f36dacf42da1118ad39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc2e55167342d42d2a8dee573a71005a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#acc2e55167342d42d2a8dee573a71005a">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, set_destination, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>)</td></tr>
<tr class="separator:acc2e55167342d42d2a8dee573a71005a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468a70bd034bfc1c56de7d1ab37fdd95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a468a70bd034bfc1c56de7d1ab37fdd95">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_source, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a468a70bd034bfc1c56de7d1ab37fdd95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad316348afda8668c18293010c33dd4ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ad316348afda8668c18293010c33dd4ea">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_destination, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:ad316348afda8668c18293010c33dd4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858fb58760435d85a45bef5ed1ad4aa6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a858fb58760435d85a45bef5ed1ad4aa6">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, create_payload_enumerator, <a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a858fb58760435d85a45bef5ed1ad4aa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d748b3d0c9acde3edbf16a12a7671a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a4d748b3d0c9acde3edbf16a12a7671a2">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, remove_payload_at, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator)</td></tr>
<tr class="separator:a4d748b3d0c9acde3edbf16a12a7671a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af24ce060d08047a4c227ef966e101969"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#af24ce060d08047a4c227ef966e101969">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_payload, <a class="el" href="../../d7/d2f/structpayload__t.html">payload_t</a> *, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>)</td></tr>
<tr class="separator:af24ce060d08047a4c227ef966e101969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33fb580610bce177b1766f84ebc10003"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a33fb580610bce177b1766f84ebc10003">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_notify, <a class="el" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a> *, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../da/d2c/group__notify__payload.html#gab6c94f52cd7f074f81f537e08b89bdca">notify_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>)</td></tr>
<tr class="separator:a33fb580610bce177b1766f84ebc10003"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482b1abf3fc6a6bc6ef02bbe5c309067"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a482b1abf3fc6a6bc6ef02bbe5c309067">get_string</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, char *buf, int <a class="el" href="../../d1/d99/test__ntru_8c.html#a796dcf65654a6e155318d1a83bc78629">len</a>)</td></tr>
<tr class="separator:a482b1abf3fc6a6bc6ef02bbe5c309067"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fbc0af87af04a57177965925438dcfc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a3fbc0af87af04a57177965925438dcfc">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, disable_sort, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a3fbc0af87af04a57177965925438dcfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb66d9136fff56df15318f1eb49efe47"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#acb66d9136fff56df15318f1eb49efe47">order_payloads</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:acb66d9136fff56df15318f1eb49efe47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0fdacc9bc87781e1115f7081a7ca9b6"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ae0fdacc9bc87781e1115f7081a7ca9b6">wrap_payloads</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:ae0fdacc9bc87781e1115f7081a7ca9b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0154bbad362c82c985fe191c22961034"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/def/structike__header__t.html">ike_header_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a0154bbad362c82c985fe191c22961034">create_header</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a0154bbad362c82c985fe191c22961034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace0bd3f2f46246ad6c4f8dfcad5b6621"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ace0bd3f2f46246ad6c4f8dfcad5b6621">generate_message</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *keymat, <a class="el" href="../../d0/d70/structgenerator__t.html">generator_t</a> **out_generator, <a class="el" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> **encrypted)</td></tr>
<tr class="separator:ace0bd3f2f46246ad6c4f8dfcad5b6621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab502192691e076bfa0a75e1939a5d04b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ab502192691e076bfa0a75e1939a5d04b">finalize_message</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *keymat, <a class="el" href="../../d0/d70/structgenerator__t.html">generator_t</a> *generator, <a class="el" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encrypted)</td></tr>
<tr class="separator:ab502192691e076bfa0a75e1939a5d04b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c683a50cbb2bc3b6108ed19b82a5cab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a5c683a50cbb2bc3b6108ed19b82a5cab">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, <a class="el" href="../../dd/dce/x509__pkcs10_8c.html#a353d21bcb86800e9d2707bebc9fb4c9c">generate</a>, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *keymat, <a class="el" href="../../d7/d88/structpacket__t.html">packet_t</a> **packet)</td></tr>
<tr class="separator:a5c683a50cbb2bc3b6108ed19b82a5cab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6551c49d481314545330368807cdc222"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a6551c49d481314545330368807cdc222">clone_message</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a6551c49d481314545330368807cdc222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a563e9cfc9b0287af285158f9e2f2be"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a0a563e9cfc9b0287af285158f9e2f2be">create_fragment</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="el" href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a>, u_int16_t num, u_int16_t <a class="el" href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>)</td></tr>
<tr class="separator:a0a563e9cfc9b0287af285158f9e2f2be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a423da2b869370a56c247175103fe3390"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a423da2b869370a56c247175103fe3390">clear_fragments</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a423da2b869370a56c247175103fe3390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac43eddb961afe2dff86eac30d38cdac9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ac43eddb961afe2dff86eac30d38cdac9">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, fragment, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *keymat, size_t frag_len, <a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> **fragments)</td></tr>
<tr class="separator:ac43eddb961afe2dff86eac30d38cdac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5cb08c76286c1aed390b894d964c622"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ab5cb08c76286c1aed390b894d964c622">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_packet, <a class="el" href="../../d7/d88/structpacket__t.html">packet_t</a> *, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:ab5cb08c76286c1aed390b894d964c622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ad93ee69d7220ba513a91ce95134c83"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a8ad93ee69d7220ba513a91ce95134c83">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_packet_data, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a8ad93ee69d7220ba513a91ce95134c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a401f958b80c6184c2459837b0a73740b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a401f958b80c6184c2459837b0a73740b">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, get_fragments, <a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a401f958b80c6184c2459837b0a73740b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2536f0440a9a31154ea9cc73a05de33a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a2536f0440a9a31154ea9cc73a05de33a">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, parse_header, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a2536f0440a9a31154ea9cc73a05de33a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8944b8c52386a8cb9f1fa878b62acd1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ac8944b8c52386a8cb9f1fa878b62acd1">is_connectivity_check</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload)</td></tr>
<tr class="separator:ac8944b8c52386a8cb9f1fa878b62acd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44720d7d2b793ce08b703694683ec0a6"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a44720d7d2b793ce08b703694683ec0a6">parse_payloads</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a44720d7d2b793ce08b703694683ec0a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa96012927a0c20c32309bf02f89e7bd9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#aa96012927a0c20c32309bf02f89e7bd9">decrypt_and_extract</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *keymat, <a class="el" href="../../d7/d2f/structpayload__t.html">payload_t</a> *<a class="el" href="../../d4/d2b/leak__detective_8c.html#aa0e8a700cbc78af5e62cea0c5c01705e">previous</a>, <a class="el" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encryption)</td></tr>
<tr class="separator:aa96012927a0c20c32309bf02f89e7bd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28625ca2a5364f377a3dc4a73c559cf"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ab28625ca2a5364f377a3dc4a73c559cf">decrypt_fragment</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *keymat, <a class="el" href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a> *fragment)</td></tr>
<tr class="separator:ab28625ca2a5364f377a3dc4a73c559cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1857d0b7287aa1b7eec51df16f234cb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ac1857d0b7287aa1b7eec51df16f234cb">accept_unencrypted_mm</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>)</td></tr>
<tr class="separator:ac1857d0b7287aa1b7eec51df16f234cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a574b26ea7b254ebdfad14c73f6caf99d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a574b26ea7b254ebdfad14c73f6caf99d">decrypt_payloads</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *keymat)</td></tr>
<tr class="separator:a574b26ea7b254ebdfad14c73f6caf99d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48b41cdef3c57a4d00b378e7d9da1f8b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a48b41cdef3c57a4d00b378e7d9da1f8b">verify</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:a48b41cdef3c57a4d00b378e7d9da1f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d3da12f5f1d7965d8bd7c39a0ee10fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a0d3da12f5f1d7965d8bd7c39a0ee10fd">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, parse_body, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *keymat)</td></tr>
<tr class="separator:a0d3da12f5f1d7965d8bd7c39a0ee10fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d777e43d5027e42909f0a85d666712d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a6d777e43d5027e42909f0a85d666712d">add_fragment</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, u_int16_t num, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>)</td></tr>
<tr class="separator:a6d777e43d5027e42909f0a85d666712d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91d0859890919608d04024adcc7e1fe"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ac91d0859890919608d04024adcc7e1fe">merge_fragments</a> (<a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *last)</td></tr>
<tr class="separator:ac91d0859890919608d04024adcc7e1fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25aa04281d47a67d202211b65f200c49"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a25aa04281d47a67d202211b65f200c49">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, add_fragment_v1, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message)</td></tr>
<tr class="separator:a25aa04281d47a67d202211b65f200c49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa337d07c94358c3980c5fcc14ea766b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#aa337d07c94358c3980c5fcc14ea766b1">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, add_fragment_v2, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this, <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message)</td></tr>
<tr class="separator:aa337d07c94358c3980c5fcc14ea766b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae480795c305d11ad29dbece004b85786"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ae480795c305d11ad29dbece004b85786">METHOD</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a>, <a class="el" href="../../d4/ddc/windows_2thread_8c.html#a343cd07ea8770e572cfe3a7d39ea8401">destroy</a>, void, <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *this)</td></tr>
<tr class="separator:ae480795c305d11ad29dbece004b85786"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2c4a060592f02346b2dbf3d1df2e6e3c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d9a/group__message.html#ga2c4a060592f02346b2dbf3d1df2e6e3c">message_create_from_packet</a> (<a class="el" href="../../d7/d88/structpacket__t.html">packet_t</a> *packet)</td></tr>
<tr class="separator:ga2c4a060592f02346b2dbf3d1df2e6e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4bba880d7840360ecb8e4137526420b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d9a/group__message.html#gac4bba880d7840360ecb8e4137526420b">message_create</a> (int major, int minor)</td></tr>
<tr class="separator:gac4bba880d7840360ecb8e4137526420b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad469345a21ee03ddd0d65b76931f06d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d9a/group__message.html#gad469345a21ee03ddd0d65b76931f06d7">message_create_defrag</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *fragment)</td></tr>
<tr class="separator:gad469345a21ee03ddd0d65b76931f06d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:abc4bfd8aaaa377a07fe518c10a3bec62"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#abc4bfd8aaaa377a07fe518c10a3bec62">ike_sa_init_i_rules</a> []</td></tr>
<tr class="separator:abc4bfd8aaaa377a07fe518c10a3bec62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe511bd7dd3c87d3a9f726224733c8e9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#afe511bd7dd3c87d3a9f726224733c8e9">ike_sa_init_i_order</a> []</td></tr>
<tr class="separator:afe511bd7dd3c87d3a9f726224733c8e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a334ff924c1215d2282940536ec5f8b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a6a334ff924c1215d2282940536ec5f8b">ike_sa_init_r_rules</a> []</td></tr>
<tr class="separator:a6a334ff924c1215d2282940536ec5f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476a1e9804ef4b85f6c4f0f8b2014fed"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a476a1e9804ef4b85f6c4f0f8b2014fed">ike_sa_init_r_order</a> []</td></tr>
<tr class="separator:a476a1e9804ef4b85f6c4f0f8b2014fed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5e9f53d9e3629d93c9e261315d18735"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#ad5e9f53d9e3629d93c9e261315d18735">ike_auth_i_rules</a> []</td></tr>
<tr class="separator:ad5e9f53d9e3629d93c9e261315d18735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92513e460d7b086c961e6a19bc33768c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a92513e460d7b086c961e6a19bc33768c">ike_auth_i_order</a> []</td></tr>
<tr class="separator:a92513e460d7b086c961e6a19bc33768c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2964eae37b9d6fa4c537ea67f02a827c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a2964eae37b9d6fa4c537ea67f02a827c">ike_auth_r_rules</a> []</td></tr>
<tr class="separator:a2964eae37b9d6fa4c537ea67f02a827c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9638fc256bd159c93f01cd6288229efe"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a9638fc256bd159c93f01cd6288229efe">ike_auth_r_order</a> []</td></tr>
<tr class="separator:a9638fc256bd159c93f01cd6288229efe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bcaeabc0de01edffc5564810112c72e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a8bcaeabc0de01edffc5564810112c72e">informational_i_rules</a> []</td></tr>
<tr class="separator:a8bcaeabc0de01edffc5564810112c72e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f86c8440b70bccd00ad7b11a2af21a2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a8f86c8440b70bccd00ad7b11a2af21a2">informational_i_order</a> []</td></tr>
<tr class="separator:a8f86c8440b70bccd00ad7b11a2af21a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dc31af4b015b32fa174b4975f93baa2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a1dc31af4b015b32fa174b4975f93baa2">informational_r_rules</a> []</td></tr>
<tr class="separator:a1dc31af4b015b32fa174b4975f93baa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7aca85772df5de7297265313dc7ae68"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#af7aca85772df5de7297265313dc7ae68">informational_r_order</a> []</td></tr>
<tr class="separator:af7aca85772df5de7297265313dc7ae68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6edf5057079822ba83cc529d2413db4c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a6edf5057079822ba83cc529d2413db4c">create_child_sa_i_rules</a> []</td></tr>
<tr class="separator:a6edf5057079822ba83cc529d2413db4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefbbaec701dfc9491b58feb290276bc6"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#aefbbaec701dfc9491b58feb290276bc6">create_child_sa_i_order</a> []</td></tr>
<tr class="separator:aefbbaec701dfc9491b58feb290276bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a742f3c4cf7888cd9bde9e36be1d8c58e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a742f3c4cf7888cd9bde9e36be1d8c58e">create_child_sa_r_rules</a> []</td></tr>
<tr class="separator:a742f3c4cf7888cd9bde9e36be1d8c58e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b392ad6bda37ea9a6e18fb3d1329ea5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#a8b392ad6bda37ea9a6e18fb3d1329ea5">create_child_sa_r_order</a> []</td></tr>
<tr class="separator:a8b392ad6bda37ea9a6e18fb3d1329ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd569f38c38b78a84afb781f2041068d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../df/dcd/structmessage__rule__t.html">message_rule_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d6d/message_8c.html#abd569f38c38b78a84afb781f2041068d">message_rules</a> []</td></tr>
<tr class="separator:abd569f38c38b78a84afb781f2041068d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ae1bf82ba0751af9ecd6eb3586f0a01ae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_CERT_PAYLOADS&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max number of certificate payloads per IKEv2 message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00054">54</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad4c9c82da02268e686d587f92e2c137e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_CERTREQ_PAYLOADS&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max number of certificate request payloads per IKEv1 message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00064">64</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1cf903b5b85af33775169d09695b3fb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_DELETE_PAYLOADS&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max number of delete payloads per IKEv2 message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00049">49</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3e3558ae64440370a8d1eca6f4447a9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_FRAGMENTS&#160;&#160;&#160;255</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum number of fragments we will handle </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00948">948</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02835">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a9afd2ed5ae2fa1018aabdbc5f516c9ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_NAT_D_PAYLOADS&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max number of NAT-D payloads per IKEv1 message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00069">69</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3973eab87906a64f6c2f84dd30c87f47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_NOTIFY_PAYLOADS&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max number of notify payloads per IKEv2 message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00044">44</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a38b3c546e75469ac1ebe228f78b51b07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_VID_PAYLOADS&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max number of vendor ID payloads per IKEv2 message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00059">59</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7e5204ff05bf7fac32b7b74055b73065"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REDUCE_FRAG_LEN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fl, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">amount&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({ \</div>
<div class="line">    fl = <a class="code" href="../../da/dbd/group__align__i.html#gac39d9cef6a5e030ba8d9e11121054268">max</a>(1, (ssize_t)fl - (amount)); \</div>
<div class="line">})</div>
<div class="ttc" id="group__align__i_html_gac39d9cef6a5e030ba8d9e11121054268"><div class="ttname"><a href="../../da/dbd/group__align__i.html#gac39d9cef6a5e030ba8d9e11121054268">max</a></div><div class="ttdeci">#define max(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/ddf/align_8h_source.html#l00028">align.h:28</a></div></div>
</div><!-- fragment --><p>Reduce the fragment length but ensure it stays &gt; 0 </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01962">1962</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01966">METHOD()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ac8bf60567ad10a781b254e7e574e44b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> <a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00846">846</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac1857d0b7287aa1b7eec51df16f234cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> accept_unencrypted_mm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Do we accept unencrypted ID/HASH payloads in Main Mode, as seen from some SonicWall boxes? </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02447">2447</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../de/d60/settings_8h_source.html#l00176">settings_t::get_bool</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00067">ID_PROT</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00150">library_t::ns</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00088">PLV1_HASH</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00073">PLV1_ID</a>, and <a class="el" href="../../dd/d08/library_8h_source.html#l00240">library_t::settings</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02464">decrypt_payloads()</a>.</p>
<div class="fragment"><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;{</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="keywordflow">if</span> (this-&gt;exchange_type == <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba405ef06c878b2b71eec9e10f83bc4eb3">ID_PROT</a>)</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    {</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea72469ef358a9af1338913f3461c70329">PLV1_ID</a> || <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a>)</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        {</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>-&gt;<a class="code" href="../../db/d2f/structsettings__t.html#ad3f80b0c70cda358a9ed610ccac39aea">get_bool</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>,</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                                    <span class="stringliteral">&quot;%s.accept_unencrypted_mainmode_messages&quot;</span>,</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                                    <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">ns</a>);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        }</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    }</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00088">payload.h:88</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba405ef06c878b2b71eec9e10f83bc4eb3"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba405ef06c878b2b71eec9e10f83bc4eb3">ID_PROT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00067">ike_header.h:67</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea72469ef358a9af1338913f3461c70329"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea72469ef358a9af1338913f3461c70329">PLV1_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00073">payload.h:73</a></div></div>
<div class="ttc" id="structlibrary__t_html_aea9e6313fee01053f94cdc4a5a00e2bd"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">library_t::ns</a></div><div class="ttdeci">const char * ns</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00150">library.h:150</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="structsettings__t_html_ad3f80b0c70cda358a9ed610ccac39aea"><div class="ttname"><a href="../../db/d2f/structsettings__t.html#ad3f80b0c70cda358a9ed610ccac39aea">settings_t::get_bool</a></div><div class="ttdeci">bool(* get_bool)(settings_t *this, char *key, bool def,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d60/settings_8h_source.html#l00176">settings.h:176</a></div></div>
<div class="ttc" id="structlibrary__t_html_ad435178668da74384948b6a151d913f5"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">library_t::settings</a></div><div class="ttdeci">settings_t * settings</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00240">library.h:240</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ac1857d0b7287aa1b7eec51df16f234cb_icgraph.svg" width="480" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6d777e43d5027e42909f0a85d666712d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> add_fragment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Store the fragment data for the fragment with the given fragment number. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02706">2706</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../dc/dcc/array_8c_source.html#l00176">array_count()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00332">array_get()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00291">array_insert()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00251">chunk_clone</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00054">NEED_MORE</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00956">fragment_t::num</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00969">reset_defrag()</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02775">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;{</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <a class="code" href="../../d3/d6f/structfragment__t.html">fragment_t</a> *fragment;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordtype">int</span> i, insert_at = -1;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a>(this-&gt;fragments); i++)</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        <a class="code" href="../../d1/d0e/group__array.html#ga8f49cd8981e317a31801562481a983fe">array_get</a>(this-&gt;fragments, i, &amp;fragment);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        <span class="keywordflow">if</span> (fragment-&gt;<a class="code" href="../../d3/d6f/structfragment__t.html#ad7adccf49d5a6da30493b95ab16ffa10">num</a> == num)</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;            <span class="comment">/* ignore a duplicate fragment */</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;received duplicate fragment #%hu&quot;</span>, num);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750">NEED_MORE</a>;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        <span class="keywordflow">if</span> (fragment-&gt;<a class="code" href="../../d3/d6f/structfragment__t.html#ad7adccf49d5a6da30493b95ab16ffa10">num</a> &gt; num)</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            insert_at = i;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        }</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    }</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    this-&gt;frag-&gt;len += data.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    <span class="keywordflow">if</span> (this-&gt;frag-&gt;len &gt; this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#ae0c8436a9ada1e021b354603dd079645">frag</a>-&gt;<a class="code" href="../../d2/da5/structfragment__data__t.html#a15afa815a1f10e528f62b6e619a294a0">max_packet</a>)</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;fragmented IKE message is too large&quot;</span>);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(fragment,</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        .num = num,</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        .data = <a class="code" href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a>(data),</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    );</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <a class="code" href="../../d1/d0e/group__array.html#ga47238d69e35235b059ea47cdd82120e2">array_insert</a>(this-&gt;fragments, insert_at, fragment);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;}</div>
<div class="ttc" id="structprivate__message__t_html_ae0c8436a9ada1e021b354603dd079645"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#ae0c8436a9ada1e021b354603dd079645">private_message_t::frag</a></div><div class="ttdeci">fragment_data_t * frag</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00942">message.c:942</a></div></div>
<div class="ttc" id="group__array_html_ga37bb7fb1dde90d6fb84dac0027bb3606"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a></div><div class="ttdeci">int array_count(array_t *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00176">array.c:176</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="structfragment__t_html_ad7adccf49d5a6da30493b95ab16ffa10"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#ad7adccf49d5a6da30493b95ab16ffa10">fragment_t::num</a></div><div class="ttdeci">u_int8_t num</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00956">message.c:956</a></div></div>
<div class="ttc" id="message_8c_html_a7c1298a30209676eb847c2c4406e0a22"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a></div><div class="ttdeci">static void reset_defrag(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00969">message.c:969</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structfragment__data__t_html_a15afa815a1f10e528f62b6e619a294a0"><div class="ttname"><a href="../../d2/da5/structfragment__data__t.html#a15afa815a1f10e528f62b6e619a294a0">fragment_data_t::max_packet</a></div><div class="ttdeci">size_t max_packet</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00842">message.c:842</a></div></div>
<div class="ttc" id="group__array_html_ga47238d69e35235b059ea47cdd82120e2"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga47238d69e35235b059ea47cdd82120e2">array_insert</a></div><div class="ttdeci">void array_insert(array_t *array, int idx, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00291">array.c:291</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="group__chunk_html_gac7a055a5fa92106988cddbc641899871"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a></div><div class="ttdeci">#define chunk_clone(chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00251">chunk.h:251</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750">NEED_MORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00054">status.h:54</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structfragment__t_html"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html">fragment_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00953">message.c:953</a></div></div>
<div class="ttc" id="group__array_html_ga8f49cd8981e317a31801562481a983fe"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga8f49cd8981e317a31801562481a983fe">array_get</a></div><div class="ttdeci">bool array_get(array_t *array, int idx, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00332">array.c:332</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a6d777e43d5027e42909f0a85d666712d_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a6d777e43d5027e42909f0a85d666712d_icgraph.svg" width="240" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a423da2b869370a56c247175103fe3390"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void clear_fragments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destroy all fragments </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01953">1953</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../dc/dcc/array_8c_source.html#l00547">array_destroy_offset()</a>, and <a class="el" href="../../dc/d21/daemon_8c_source.html#l00452">destroy()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01966">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;{</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <a class="code" href="../../d1/d0e/group__array.html#ga9aacf785ead590ada5ca80138c34e909">array_destroy_offset</a>(this-&gt;fragments, offsetof(<a class="code" href="../../d7/d88/structpacket__t.html">packet_t</a>, <a class="code" href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a>));</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    this-&gt;fragments = NULL;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;}</div>
<div class="ttc" id="daemon_8c_html_a1e824dfeaa337e709772cb0c8e6c8dcc"><div class="ttname"><a href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a></div><div class="ttdeci">static void destroy(private_daemon_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00452">daemon.c:452</a></div></div>
<div class="ttc" id="structpacket__t_html"><div class="ttname"><a href="../../d7/d88/structpacket__t.html">packet_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d76/packet_8h_source.html#l00039">packet.h:39</a></div></div>
<div class="ttc" id="group__array_html_ga9aacf785ead590ada5ca80138c34e909"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga9aacf785ead590ada5ca80138c34e909">array_destroy_offset</a></div><div class="ttdeci">void array_destroy_offset(array_t *array, size_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00547">array.c:547</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a423da2b869370a56c247175103fe3390_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a423da2b869370a56c247175103fe3390_icgraph.svg" width="254" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6551c49d481314545330368807cdc222"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../df/d23/structmessage__t.html">message_t</a>* clone_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a (basic) clone of the given message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01872">1872</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../df/ded/host_8h_source.html#l00050">host_t::clone</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00643">dst</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00050">memcpy</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02998">message_create()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l00180">reserved</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00352">message_t::set_destination</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00126">message_t::set_exchange_type</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00110">message_t::set_ike_sa_id</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00080">message_t::set_message_id</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00147">message_t::set_request</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00332">message_t::set_source</a>, and <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00642">src</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01895">create_fragment()</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l03011">message_create_defrag()</a>.</p>
<div class="fragment"><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;{</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <a class="code" href="../../df/d23/structmessage__t.html">message_t</a> *message;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a>, *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    src = this-&gt;packet-&gt;get_source(this-&gt;packet);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    dst = this-&gt;packet-&gt;get_destination(this-&gt;packet);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    message = <a class="code" href="../../de/d9a/group__message.html#gac4bba880d7840360ecb8e4137526420b">message_create</a>(this-&gt;major_version, this-&gt;minor_version);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a600cd99860284938beb1156b0f70ec4a">set_ike_sa_id</a>(message, this-&gt;ike_sa_id);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a8ce10dc5c5401a3861d1ede2f81aee31">set_message_id</a>(message, this-&gt;message_id);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a1f5fe51c947151513fb23b0943117033">set_request</a>(message, this-&gt;is_request);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a0196eb7ec92f28c4b4535331bf53ab27">set_source</a>(message, src-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(src));</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#aedf28a9079936aa29d7ac6ef90ec2ba7">set_destination</a>(message, dst-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(dst));</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#aa6bded857efef5fda6b91e13c7a74885">set_exchange_type</a>(message, this-&gt;exchange_type);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(((<a class="code" href="../../d0/d17/structprivate__message__t.html">private_message_t</a>*)message)-&gt;<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>, this-&gt;<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>,</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;           <span class="keyword">sizeof</span>(this-&gt;<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>));</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="keywordflow">return</span> message;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;}</div>
<div class="ttc" id="structmessage__t_html_a600cd99860284938beb1156b0f70ec4a"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a600cd99860284938beb1156b0f70ec4a">message_t::set_ike_sa_id</a></div><div class="ttdeci">void(* set_ike_sa_id)(message_t *this, ike_sa_id_t *ike_sa_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00110">message.h:110</a></div></div>
<div class="ttc" id="structhost__t_html_aebe9cd9ffd665b04e223c5e8b6ce7114"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">host_t::clone</a></div><div class="ttdeci">host_t *(* clone)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00050">host.h:50</a></div></div>
<div class="ttc" id="structmessage__t_html_a8ce10dc5c5401a3861d1ede2f81aee31"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a8ce10dc5c5401a3861d1ede2f81aee31">message_t::set_message_id</a></div><div class="ttdeci">void(* set_message_id)(message_t *this, u_int32_t message_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00080">message.h:80</a></div></div>
<div class="ttc" id="structmessage__t_html_a1f5fe51c947151513fb23b0943117033"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a1f5fe51c947151513fb23b0943117033">message_t::set_request</a></div><div class="ttdeci">void(* set_request)(message_t *this, bool request)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00147">message.h:147</a></div></div>
<div class="ttc" id="structmessage__t_html_aedf28a9079936aa29d7ac6ef90ec2ba7"><div class="ttname"><a href="../../df/d23/structmessage__t.html#aedf28a9079936aa29d7ac6ef90ec2ba7">message_t::set_destination</a></div><div class="ttdeci">void(* set_destination)(message_t *this, host_t *host)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00352">message.h:352</a></div></div>
<div class="ttc" id="group__memory__i_html_gaed653b4838032a2c5ce8960421c8cfd7"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a></div><div class="ttdeci">#define memcpy(d, s, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00050">memory.h:50</a></div></div>
<div class="ttc" id="structprivate__message__t_html"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html">private_message_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00851">message.c:851</a></div></div>
<div class="ttc" id="structmessage__t_html_a0196eb7ec92f28c4b4535331bf53ab27"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a0196eb7ec92f28c4b4535331bf53ab27">message_t::set_source</a></div><div class="ttdeci">void(* set_source)(message_t *this, host_t *host)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00332">message.h:332</a></div></div>
<div class="ttc" id="pkcs11_8h_html_a54b44b284e7b978df176ebf111fd52ae"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a></div><div class="ttdeci">#define reserved</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l00180">pkcs11.h:180</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a2c489e7a93d1497f3690274e047e8aaf"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a></div><div class="ttdeci">struct sadb_address * dst</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00643">kernel_pfkey_ipsec.c:643</a></div></div>
<div class="ttc" id="structmessage__t_html_aa6bded857efef5fda6b91e13c7a74885"><div class="ttname"><a href="../../df/d23/structmessage__t.html#aa6bded857efef5fda6b91e13c7a74885">message_t::set_exchange_type</a></div><div class="ttdeci">void(* set_exchange_type)(message_t *this, exchange_type_t exchange_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00126">message.h:126</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
<div class="ttc" id="structmessage__t_html"><div class="ttname"><a href="../../df/d23/structmessage__t.html">message_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00045">message.h:45</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a680c29c0890886d7c4130a706b5a97a0"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a></div><div class="ttdeci">struct sadb_address * src</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00642">kernel_pfkey_ipsec.c:642</a></div></div>
<div class="ttc" id="group__message_html_gac4bba880d7840360ecb8e4137526420b"><div class="ttname"><a href="../../de/d9a/group__message.html#gac4bba880d7840360ecb8e4137526420b">message_create</a></div><div class="ttdeci">message_t * message_create(int major, int minor)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02998">message.c:2998</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a6551c49d481314545330368807cdc222_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a6551c49d481314545330368807cdc222_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0a563e9cfc9b0287af285158f9e2f2be"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../df/d23/structmessage__t.html">message_t</a>* create_fragment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a>&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a single fragment with the given data </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01895">1895</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d2/d0d/message_8h_source.html#l00187">message_t::add_payload</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00077">AGGRESSIVE</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00260">daemon_t::bus</a>, <a class="el" href="../../dc/d21/daemon_8c_source.html#l00089">charon</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01872">clone_message()</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d3/da3/encrypted__payload_8c_source.html#l01017">encrypted_fragment_payload_create_from_data()</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d1/d40/fragment__payload_8c_source.html#l00213">fragment_payload_create_from_data()</a>, <a class="el" href="../../d8/dd1/ike__sa_8h_source.html#l00471">ike_sa_t::get_peer_cfg</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00258">bus_t::get_sa</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00067">ID_PROT</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00035">IKEV1_MAJOR_VERSION</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00198">PLV2_ENCRYPTED</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00126">message_t::set_exchange_type</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00080">message_t::set_message_id</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00375">payload_t::set_next_type</a>, and <a class="el" href="../../d7/d2b/peer__cfg_8h_source.html#l00248">peer_cfg_t::use_aggressive</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01966">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;{</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *fragment, *payload;</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <a class="code" href="../../df/d23/structmessage__t.html">message_t</a> *message;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <a class="code" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *peer_cfg;</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <a class="code" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *ike_sa;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    message = <a class="code" href="../../d0/d6d/message_8c.html#a6551c49d481314545330368807cdc222">clone_message</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">if</span> (this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#gaf0d3ca24e19b97bea55bb93f1e531219">IKEV1_MAJOR_VERSION</a>)</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    {</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="comment">/* other implementations seem to just use 0 as message ID, so here we go */</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a8ce10dc5c5401a3861d1ede2f81aee31">set_message_id</a>(message, 0);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="comment">/* always use the initial message type for fragments, even for quick mode</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">         * or transaction messages. */</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        ike_sa = <a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">bus</a>-&gt;<a class="code" href="../../dc/db8/structbus__t.html#a4b526500303ea672e25429e8f8d7045f">get_sa</a>(<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">bus</a>);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        <span class="keywordflow">if</span> (ike_sa &amp;&amp; (peer_cfg = ike_sa-&gt;<a class="code" href="../../d9/d7d/structike__sa__t.html#a398b9be139b26cd84657c4ea71addd6d">get_peer_cfg</a>(ike_sa)) &amp;&amp;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            peer_cfg-&gt;<a class="code" href="../../d9/d16/structpeer__cfg__t.html#af195f25d4a4c448f91f852b0477b0271">use_aggressive</a>(peer_cfg))</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        {</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;            message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#aa6bded857efef5fda6b91e13c7a74885">set_exchange_type</a>(message, <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba128db069f37b5cd1b44901dff4db4ae0">AGGRESSIVE</a>);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        }</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;            message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#aa6bded857efef5fda6b91e13c7a74885">set_exchange_type</a>(message, <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba405ef06c878b2b71eec9e10f83bc4eb3">ID_PROT</a>);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        }</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        fragment = (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)<a class="code" href="../../da/d6d/group__fragment__payload.html#gaa5320303346f3226668e7252293c35c3">fragment_payload_create_from_data</a>(</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                                                    num, num == <a class="code" href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, data);</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    }</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    {</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        fragment = (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)<a class="code" href="../../d6/d9c/group__encrypted__fragment__payload.html#ga8ab14c4450abbbbe8f109d5d9c691b7a">encrypted_fragment_payload_create_from_data</a>(</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                                                    num, <a class="code" href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>, data);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <span class="keywordflow">if</span> (num == 1)</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        {</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;            <span class="comment">/* only in the first fragment is this set to the type of the first</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment">             * payload in the encrypted payload */</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;            fragment-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>(fragment, <a class="code" href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a>);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            <span class="comment">/* move unencrypted payloads to the first fragment */</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            enumerator = this-&gt;payloads-&gt;create_enumerator(this-&gt;payloads);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) != <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a>)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                    this-&gt;payloads-&gt;remove_at(this-&gt;payloads, enumerator);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                    message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#afc7ad3917c03857027462d67d09f12fa">add_payload</a>(message, payload);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                }</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        }</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    }</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#afc7ad3917c03857027462d67d09f12fa">add_payload</a>(message, (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)fragment);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="keywordflow">return</span> message;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;}</div>
<div class="ttc" id="fetch_8c_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">static int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d14/fetch_8c_source.html#l00022">fetch.c:22</a></div></div>
<div class="ttc" id="structmessage__t_html_afc7ad3917c03857027462d67d09f12fa"><div class="ttname"><a href="../../df/d23/structmessage__t.html#afc7ad3917c03857027462d67d09f12fa">message_t::add_payload</a></div><div class="ttdeci">void(* add_payload)(message_t *this, payload_t *payload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00187">message.h:187</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="structpeer__cfg__t_html_af195f25d4a4c448f91f852b0477b0271"><div class="ttname"><a href="../../d9/d16/structpeer__cfg__t.html#af195f25d4a4c448f91f852b0477b0271">peer_cfg_t::use_aggressive</a></div><div class="ttdeci">bool(* use_aggressive)(peer_cfg_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00248">peer_cfg.h:248</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba128db069f37b5cd1b44901dff4db4ae0"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba128db069f37b5cd1b44901dff4db4ae0">AGGRESSIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00077">ike_header.h:77</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structike__sa__t_html"><div class="ttname"><a href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd1/ike__sa_8h_source.html#l00310">ike_sa.h:310</a></div></div>
<div class="ttc" id="structdaemon__t_html_ae221a60416ecd62483aa97ea139025c3"><div class="ttname"><a href="../../d0/def/structdaemon__t.html#ae221a60416ecd62483aa97ea139025c3">daemon_t::bus</a></div><div class="ttdeci">bus_t * bus</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00260">daemon.h:260</a></div></div>
<div class="ttc" id="structmessage__t_html_a8ce10dc5c5401a3861d1ede2f81aee31"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a8ce10dc5c5401a3861d1ede2f81aee31">message_t::set_message_id</a></div><div class="ttdeci">void(* set_message_id)(message_t *this, u_int32_t message_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00080">message.h:80</a></div></div>
<div class="ttc" id="group__encrypted__fragment__payload_html_ga8ab14c4450abbbbe8f109d5d9c691b7a"><div class="ttname"><a href="../../d6/d9c/group__encrypted__fragment__payload.html#ga8ab14c4450abbbbe8f109d5d9c691b7a">encrypted_fragment_payload_create_from_data</a></div><div class="ttdeci">encrypted_fragment_payload_t * encrypted_fragment_payload_create_from_data(u_int16_t num, u_int16_t total, chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da3/encrypted__payload_8c_source.html#l01017">encrypted_payload.c:1017</a></div></div>
<div class="ttc" id="structpayload__t_html_a080809f324fbb7037d2aafed2a4f8fcc"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">payload_t::set_next_type</a></div><div class="ttdeci">void(* set_next_type)(payload_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00375">payload.h:375</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba405ef06c878b2b71eec9e10f83bc4eb3"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba405ef06c878b2b71eec9e10f83bc4eb3">ID_PROT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00067">ike_header.h:67</a></div></div>
<div class="ttc" id="group__libcharon_html_ga3f85ddc91855d7d74beeb2f21fb74dbb"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a></div><div class="ttdeci">daemon_t * charon</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00089">daemon.c:89</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="structbus__t_html_a4b526500303ea672e25429e8f8d7045f"><div class="ttname"><a href="../../dc/db8/structbus__t.html#a4b526500303ea672e25429e8f8d7045f">bus_t::get_sa</a></div><div class="ttdeci">ike_sa_t *(* get_sa)(bus_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00258">bus.h:258</a></div></div>
<div class="ttc" id="group__ike__header_html_gaf0d3ca24e19b97bea55bb93f1e531219"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gaf0d3ca24e19b97bea55bb93f1e531219">IKEV1_MAJOR_VERSION</a></div><div class="ttdeci">#define IKEV1_MAJOR_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00035">ike_header.h:35</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a8ad91963e97959c834d908f0ac9cca66"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a></div><div class="ttdeci">memory_header_t * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00110">leak_detective.c:110</a></div></div>
<div class="ttc" id="message_8c_html_a6551c49d481314545330368807cdc222"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a6551c49d481314545330368807cdc222">clone_message</a></div><div class="ttdeci">static message_t * clone_message(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01872">message.c:1872</a></div></div>
<div class="ttc" id="structmessage__t_html_aa6bded857efef5fda6b91e13c7a74885"><div class="ttname"><a href="../../df/d23/structmessage__t.html#aa6bded857efef5fda6b91e13c7a74885">message_t::set_exchange_type</a></div><div class="ttdeci">void(* set_exchange_type)(message_t *this, exchange_type_t exchange_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00126">message.h:126</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="group__fragment__payload_html_gaa5320303346f3226668e7252293c35c3"><div class="ttname"><a href="../../da/d6d/group__fragment__payload.html#gaa5320303346f3226668e7252293c35c3">fragment_payload_create_from_data</a></div><div class="ttdeci">fragment_payload_t * fragment_payload_create_from_data(u_int8_t num, bool last, chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d40/fragment__payload_8c_source.html#l00213">fragment_payload.c:213</a></div></div>
<div class="ttc" id="structike__sa__t_html_a398b9be139b26cd84657c4ea71addd6d"><div class="ttname"><a href="../../d9/d7d/structike__sa__t.html#a398b9be139b26cd84657c4ea71addd6d">ike_sa_t::get_peer_cfg</a></div><div class="ttdeci">peer_cfg_t *(* get_peer_cfg)(ike_sa_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd1/ike__sa_8h_source.html#l00471">ike_sa.h:471</a></div></div>
<div class="ttc" id="structmessage__t_html"><div class="ttname"><a href="../../df/d23/structmessage__t.html">message_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00045">message.h:45</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00198">payload.h:198</a></div></div>
<div class="ttc" id="structpeer__cfg__t_html"><div class="ttname"><a href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00117">peer_cfg.h:117</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a0a563e9cfc9b0287af285158f9e2f2be_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a0a563e9cfc9b0287af285158f9e2f2be_icgraph.svg" width="256" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0154bbad362c82c985fe191c22961034"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d2/def/structike__header__t.html">ike_header_t</a>* create_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates the IKE header for this message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01611">1611</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d5/d60/utils_8h_source.html#l00147">countof</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00156">ike_header_t::get_initiator_spi</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00170">ike_header_t::get_responder_spi</a>, <a class="el" href="../../df/d0d/ike__header_8c_source.html#l00499">ike_header_create_version()</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00045">IKEV2_MAJOR_VERSION</a>, <a class="el" href="../../dc/df9/payload_8c_source.html#l00323">payload_get_field()</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00149">ike_header_t::payload_interface</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l00180">reserved</a>, <a class="el" href="../../de/d06/encodings_8h_source.html#l00111">RESERVED_BIT</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00261">ike_header_t::set_encryption_flag</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00303">ike_header_t::set_exchange_type</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00247">ike_header_t::set_initiator_flag</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00163">ike_header_t::set_initiator_spi</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00317">ike_header_t::set_message_id</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00177">ike_header_t::set_responder_spi</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00219">ike_header_t::set_response_flag</a>, and <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00233">ike_header_t::set_version_flag</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>.</p>
<div class="fragment"><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;{</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <a class="code" href="../../d2/def/structike__header__t.html">ike_header_t</a> *ike_header;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordtype">bool</span> *<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    ike_header = <a class="code" href="../../d3/d63/group__ike__header.html#ga60af02eaa70b2526de85beddcece156a">ike_header_create_version</a>(this-&gt;major_version,</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                                           this-&gt;minor_version);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#afde9e5981c7a1d948e41842590b9b7d5">set_exchange_type</a>(ike_header, this-&gt;exchange_type);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#aa78659a69c4e863e6423c08aafcce310">set_message_id</a>(ike_header, this-&gt;message_id);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">if</span> (this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a>)</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#aafb8aaba23bd1431e9f690245318f82d">set_response_flag</a>(ike_header, !this-&gt;is_request);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#ae6aa46efaf7c2adb26158ec208890260">set_version_flag</a>(ike_header, this-&gt;version_flag);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a414dc12982864dfd790376637988ad95">set_initiator_flag</a>(ike_header,</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                        this-&gt;ike_sa_id-&gt;is_initiator(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a6654d0c1dc57034d315b87d45218efd4">ike_sa_id</a>));</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a2ea5a15d9cbb78b9d34e9e7b8a4854fd">set_encryption_flag</a>(ike_header, this-&gt;is_encrypted);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#adb3af310470e01de17397d4804d84d8d">set_initiator_spi</a>(ike_header,</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                        this-&gt;ike_sa_id-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a4950bba1888b1eb853fdde236b79d65d">get_initiator_spi</a>(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a6654d0c1dc57034d315b87d45218efd4">ike_sa_id</a>));</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#af9de6c6acd4c34651f88dec57b1534b1">set_responder_spi</a>(ike_header,</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                        this-&gt;ike_sa_id-&gt;<a class="code" href="../../d2/def/structike__header__t.html#af4b20cc48a8f077fff53e7e18d90e56e">get_responder_spi</a>(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a6654d0c1dc57034d315b87d45218efd4">ike_sa_id</a>));</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a>(this-&gt;reserved); i++)</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        reserved = <a class="code" href="../../d0/d90/group__payload.html#gaf219216dcbe0be7f4d5151ba6cdf0371">payload_get_field</a>(&amp;ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#ac619dea3e7f47ee938262fc6ef5b5d2d">payload_interface</a>,</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                                     <a class="code" href="../../d2/d9b/group__encodings.html#gga602a25541a259798b77981836d6cb73faaec4bd3abdbfdf06b2a00ebfc115e0a8">RESERVED_BIT</a>, i);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="keywordflow">if</span> (reserved)</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            *reserved = this-&gt;reserved[i];</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordflow">return</span> ike_header;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;}</div>
<div class="ttc" id="structike__header__t_html_ae6aa46efaf7c2adb26158ec208890260"><div class="ttname"><a href="../../d2/def/structike__header__t.html#ae6aa46efaf7c2adb26158ec208890260">ike_header_t::set_version_flag</a></div><div class="ttdeci">void(* set_version_flag)(ike_header_t *this, bool version)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00233">ike_header.h:233</a></div></div>
<div class="ttc" id="structike__header__t_html_af9de6c6acd4c34651f88dec57b1534b1"><div class="ttname"><a href="../../d2/def/structike__header__t.html#af9de6c6acd4c34651f88dec57b1534b1">ike_header_t::set_responder_spi</a></div><div class="ttdeci">void(* set_responder_spi)(ike_header_t *this, u_int64_t responder_spi)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00177">ike_header.h:177</a></div></div>
<div class="ttc" id="structike__header__t_html_af4b20cc48a8f077fff53e7e18d90e56e"><div class="ttname"><a href="../../d2/def/structike__header__t.html#af4b20cc48a8f077fff53e7e18d90e56e">ike_header_t::get_responder_spi</a></div><div class="ttdeci">u_int64_t(* get_responder_spi)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00170">ike_header.h:170</a></div></div>
<div class="ttc" id="group__utils__i_html_gab317c73e51fb8a68f86165ac831f7b8c"><div class="ttname"><a href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a></div><div class="ttdeci">#define countof(array)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00147">utils.h:147</a></div></div>
<div class="ttc" id="group__ike__header_html_ga60af02eaa70b2526de85beddcece156a"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga60af02eaa70b2526de85beddcece156a">ike_header_create_version</a></div><div class="ttdeci">ike_header_t * ike_header_create_version(int major, int minor)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0d/ike__header_8c_source.html#l00499">ike_header.c:499</a></div></div>
<div class="ttc" id="structprivate__message__t_html_a6654d0c1dc57034d315b87d45218efd4"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#a6654d0c1dc57034d315b87d45218efd4">private_message_t::ike_sa_id</a></div><div class="ttdeci">ike_sa_id_t * ike_sa_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00911">message.c:911</a></div></div>
<div class="ttc" id="group__ike__header_html_ga750bf45eb8428bbe3eefa03537d491e5"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a></div><div class="ttdeci">#define IKEV2_MAJOR_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00045">ike_header.h:45</a></div></div>
<div class="ttc" id="pkcs11_8h_html_a54b44b284e7b978df176ebf111fd52ae"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a></div><div class="ttdeci">#define reserved</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l00180">pkcs11.h:180</a></div></div>
<div class="ttc" id="group__encodings_html_gga602a25541a259798b77981836d6cb73faaec4bd3abdbfdf06b2a00ebfc115e0a8"><div class="ttname"><a href="../../d2/d9b/group__encodings.html#gga602a25541a259798b77981836d6cb73faaec4bd3abdbfdf06b2a00ebfc115e0a8">RESERVED_BIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/encodings_8h_source.html#l00111">encodings.h:111</a></div></div>
<div class="ttc" id="group__payload_html_gaf219216dcbe0be7f4d5151ba6cdf0371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gaf219216dcbe0be7f4d5151ba6cdf0371">payload_get_field</a></div><div class="ttdeci">void * payload_get_field(payload_t *payload, encoding_type_t type, u_int skip)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df9/payload_8c_source.html#l00323">payload.c:323</a></div></div>
<div class="ttc" id="structike__header__t_html_afde9e5981c7a1d948e41842590b9b7d5"><div class="ttname"><a href="../../d2/def/structike__header__t.html#afde9e5981c7a1d948e41842590b9b7d5">ike_header_t::set_exchange_type</a></div><div class="ttdeci">void(* set_exchange_type)(ike_header_t *this, u_int8_t exchange_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00303">ike_header.h:303</a></div></div>
<div class="ttc" id="structike__header__t_html_ac619dea3e7f47ee938262fc6ef5b5d2d"><div class="ttname"><a href="../../d2/def/structike__header__t.html#ac619dea3e7f47ee938262fc6ef5b5d2d">ike_header_t::payload_interface</a></div><div class="ttdeci">payload_t payload_interface</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00149">ike_header.h:149</a></div></div>
<div class="ttc" id="structike__header__t_html_a4950bba1888b1eb853fdde236b79d65d"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a4950bba1888b1eb853fdde236b79d65d">ike_header_t::get_initiator_spi</a></div><div class="ttdeci">u_int64_t(* get_initiator_spi)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00156">ike_header.h:156</a></div></div>
<div class="ttc" id="structike__header__t_html"><div class="ttname"><a href="../../d2/def/structike__header__t.html">ike_header_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00145">ike_header.h:145</a></div></div>
<div class="ttc" id="structike__header__t_html_a414dc12982864dfd790376637988ad95"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a414dc12982864dfd790376637988ad95">ike_header_t::set_initiator_flag</a></div><div class="ttdeci">void(* set_initiator_flag)(ike_header_t *this, bool initiator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00247">ike_header.h:247</a></div></div>
<div class="ttc" id="structike__header__t_html_adb3af310470e01de17397d4804d84d8d"><div class="ttname"><a href="../../d2/def/structike__header__t.html#adb3af310470e01de17397d4804d84d8d">ike_header_t::set_initiator_spi</a></div><div class="ttdeci">void(* set_initiator_spi)(ike_header_t *this, u_int64_t initiator_spi)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00163">ike_header.h:163</a></div></div>
<div class="ttc" id="structike__header__t_html_aafb8aaba23bd1431e9f690245318f82d"><div class="ttname"><a href="../../d2/def/structike__header__t.html#aafb8aaba23bd1431e9f690245318f82d">ike_header_t::set_response_flag</a></div><div class="ttdeci">void(* set_response_flag)(ike_header_t *this, bool response)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00219">ike_header.h:219</a></div></div>
<div class="ttc" id="structike__header__t_html_aa78659a69c4e863e6423c08aafcce310"><div class="ttname"><a href="../../d2/def/structike__header__t.html#aa78659a69c4e863e6423c08aafcce310">ike_header_t::set_message_id</a></div><div class="ttdeci">void(* set_message_id)(ike_header_t *this, u_int32_t message_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00317">ike_header.h:317</a></div></div>
<div class="ttc" id="structike__header__t_html_a2ea5a15d9cbb78b9d34e9e7b8a4854fd"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a2ea5a15d9cbb78b9d34e9e7b8a4854fd">ike_header_t::set_encryption_flag</a></div><div class="ttdeci">void(* set_encryption_flag)(ike_header_t *this, bool encryption)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00261">ike_header.h:261</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a0154bbad362c82c985fe191c22961034_cgraph.svg" width="518" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a0154bbad362c82c985fe191c22961034_icgraph.svg" width="424" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa96012927a0c20c32309bf02f89e7bd9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> decrypt_and_extract </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *&#160;</td>
          <td class="paramname"><em>keymat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2f/structpayload__t.html">payload_t</a> *&#160;</td>
          <td class="paramname"><em>previous</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *&#160;</td>
          <td class="paramname"><em>encryption</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decrypt an encrypted payload and extract all contained payloads. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02317">2317</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00057">chunk_create()</a>, <a class="el" href="../../d8/d39/chunk_8c_source.html#l00035">chunk_empty</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00105">encrypted_payload_t::decrypt</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../da/d39/keymat_8h_source.html#l00088">keymat_t::get_aead</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00079">aead_t::get_block_size</a>, <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00130">keymat_v1_t::get_iv</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00049">encrypted_payload_t::get_length</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../da/d39/keymat_8h_source.html#l00052">keymat_t::get_version</a>, <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00044">IKEV1</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00042">INVALID_ARG</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d7/da0/test__parser_8c_source.html#l00023">parser</a>, <a class="el" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00064">encrypted_payload_t::remove_payload</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00375">payload_t::set_next_type</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00079">encrypted_payload_t::set_transform</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>, <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00144">keymat_v1_t::update_iv</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00048">VERIFY_ERROR</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02464">decrypt_payloads()</a>.</p>
<div class="fragment"><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;{</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *encrypted;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <a class="code" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> chunk;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <a class="code" href="../../d7/d7d/structaead__t.html">aead_t</a> *<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keywordtype">size_t</span> bs;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <span class="keywordflow">if</span> (!keymat)</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;found encrypted payload, but no keymat&quot;</span>);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a>;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    }</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    aead = keymat-&gt;<a class="code" href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">get_aead</a>(keymat, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keywordflow">if</span> (!aead)</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;found encrypted payload, but no transform set&quot;</span>);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a>;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>)</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    {</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <span class="comment">/* reassembled IKEv2 messages are already decrypted, we still call</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">         * decrypt() to parse the contained payloads */</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        status = encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#ac6680ea7d877d2d1517824dcbfa793c8">decrypt</a>(encryption, <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    {</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        bs = aead-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">get_block_size</a>(aead);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#ae93ad3860c4e93a6626c0845063d2aca">set_transform</a>(encryption, aead);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        chunk = this-&gt;packet-&gt;get_data(this-&gt;packet);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        <span class="keywordflow">if</span> (chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> &lt; encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">get_length</a>(encryption) ||</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> &lt; bs)</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        {</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;invalid payload length&quot;</span>);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        <span class="keywordflow">if</span> (keymat-&gt;<a class="code" href="../../d2/d63/structkeymat__t.html#acbb299aa2628908de03d17f807a6b949">get_version</a>(keymat) == <a class="code" href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a>)</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        {   <span class="comment">/* instead of associated data we provide the IV, we also update</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment">             * the IV with the last encrypted block */</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            <a class="code" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *keymat_v1 = (<a class="code" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>*)keymat;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> iv;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            <span class="keywordflow">if</span> (keymat_v1-&gt;<a class="code" href="../../d8/dce/structkeymat__v1__t.html#a199e54d77ae9b2157b90ab487ba16ce6">get_iv</a>(keymat_v1, this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">message_id</a>, &amp;iv))</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;            {</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                status = encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#ac6680ea7d877d2d1517824dcbfa793c8">decrypt</a>(encryption, iv);</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                <span class="keywordflow">if</span> (status == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                {</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                    <span class="keywordflow">if</span> (!keymat_v1-&gt;<a class="code" href="../../d8/dce/structkeymat__v1__t.html#ad58bae359e35ebf26b476c776d8ba17f">update_iv</a>(keymat_v1, this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">message_id</a>,</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;                            <a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(chunk.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> + chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> - bs, bs)))</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                    {</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                        status = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                    }</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;            }</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            {</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                status = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        }</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;        {</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;            chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> -= encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">get_length</a>(encryption);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            status = encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#ac6680ea7d877d2d1517824dcbfa793c8">decrypt</a>(encryption, chunk);</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        }</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    }</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    {</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    }</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <span class="keywordflow">while</span> ((encrypted = encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a8603da09493b2fd9e5a319cb9e619f7e">remove_payload</a>(encryption)))</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    {</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        type = encrypted-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(encrypted);</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        <span class="keywordflow">if</span> (previous)</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        {</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;            previous-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>(previous, type);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        }</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        {</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;            this-&gt;first_payload = <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        }</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;insert decrypted payload of type %N at end of list&quot;</span>,</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;             <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        this-&gt;payloads-&gt;insert_last(this-&gt;payloads, encrypted);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        previous = encrypted;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    }</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_ac6680ea7d877d2d1517824dcbfa793c8"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#ac6680ea7d877d2d1517824dcbfa793c8">encrypted_payload_t::decrypt</a></div><div class="ttdeci">status_t(* decrypt)(encrypted_payload_t *this, chunk_t assoc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00105">encrypted_payload.h:105</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="group__ike__cfg_html_ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00044">ike_cfg.h:44</a></div></div>
<div class="ttc" id="group__payload_html_ga910814947f5e241c851b42e95e8586ee"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a></div><div class="ttdeci">payload_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00043">payload.h:43</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_ae93ad3860c4e93a6626c0845063d2aca"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#ae93ad3860c4e93a6626c0845063d2aca">encrypted_payload_t::set_transform</a></div><div class="ttdeci">void(* set_transform)(encrypted_payload_t *this, aead_t *aead)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00079">encrypted_payload.h:79</a></div></div>
<div class="ttc" id="group__chunk_html_gac9858e0c37c9bf6c0706d0a6e3b6453d"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a></div><div class="ttdeci">chunk_t chunk_empty</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00035">chunk.c:35</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="group__payload_html_ga397bd66f0cc14539cee30d16ae9b0bfa"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a></div><div class="ttdeci">enum_name_t * payload_type_names</div></div>
<div class="ttc" id="structencrypted__payload__t_html_aae31f55ac8256ac61afcbbfbda554da7"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">encrypted_payload_t::get_length</a></div><div class="ttdeci">size_t(* get_length)(encrypted_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00049">encrypted_payload.h:49</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structpayload__t_html_a080809f324fbb7037d2aafed2a4f8fcc"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">payload_t::set_next_type</a></div><div class="ttdeci">void(* set_next_type)(payload_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00375">payload.h:375</a></div></div>
<div class="ttc" id="structaead__t_html"><div class="ttname"><a href="../../d7/d7d/structaead__t.html">aead_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00037">aead.h:37</a></div></div>
<div class="ttc" id="structprivate__message__t_html_a260d5d2f83563517f7a522324fb1c8be"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">private_message_t::message_id</a></div><div class="ttdeci">u_int32_t message_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00906">message.c:906</a></div></div>
<div class="ttc" id="test__parser_8c_html_a40ea9d08a07e5802dbf8c0ff3ecbeb0f"><div class="ttname"><a href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a></div><div class="ttdeci">static conf_parser_t * parser</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da0/test__parser_8c_source.html#l00023">test_parser.c:23</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="group__chunk_html_gad94ca029616a107e89eaa618408fd7b6"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a></div><div class="ttdeci">static chunk_t chunk_create(u_char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00057">chunk.h:57</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structaead__t_html_ae6004b22fa9415839f9c0b6e16e48ae6"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">aead_t::get_block_size</a></div><div class="ttdeci">size_t(* get_block_size)(aead_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00079">aead.h:79</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html_a199e54d77ae9b2157b90ab487ba16ce6"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html#a199e54d77ae9b2157b90ab487ba16ce6">keymat_v1_t::get_iv</a></div><div class="ttdeci">bool(* get_iv)(keymat_v1_t *this, u_int32_t mid, chunk_t *iv)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00130">keymat_v1.h:130</a></div></div>
<div class="ttc" id="structkeymat__t_html_acbb299aa2628908de03d17f807a6b949"><div class="ttname"><a href="../../d2/d63/structkeymat__t.html#acbb299aa2628908de03d17f807a6b949">keymat_t::get_version</a></div><div class="ttdeci">ike_version_t(* get_version)(keymat_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d39/keymat_8h_source.html#l00052">keymat.h:52</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html_ad58bae359e35ebf26b476c776d8ba17f"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html#ad58bae359e35ebf26b476c776d8ba17f">keymat_v1_t::update_iv</a></div><div class="ttdeci">bool(* update_iv)(keymat_v1_t *this, u_int32_t mid, chunk_t last_block)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00144">keymat_v1.h:144</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00032">keymat_v1.h:32</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_a8603da09493b2fd9e5a319cb9e619f7e"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#a8603da09493b2fd9e5a319cb9e619f7e">encrypted_payload_t::remove_payload</a></div><div class="ttdeci">payload_t *(* remove_payload)(encrypted_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00064">encrypted_payload.h:64</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00042">status.h:42</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="structkeymat__t_html_a0fbe23bc433e5f23d641638d47a682e3"><div class="ttname"><a href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">keymat_t::get_aead</a></div><div class="ttdeci">aead_t *(* get_aead)(keymat_t *this, bool in)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d39/keymat_8h_source.html#l00088">keymat.h:88</a></div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00048">status.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_aa96012927a0c20c32309bf02f89e7bd9_cgraph.svg" width="302" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_aa96012927a0c20c32309bf02f89e7bd9_icgraph.svg" width="454" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab28625ca2a5364f377a3dc4a73c559cf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> decrypt_fragment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *&#160;</td>
          <td class="paramname"><em>keymat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a> *&#160;</td>
          <td class="paramname"><em>fragment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decrypt an encrypted fragment payload. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02411">2411</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00105">encrypted_payload_t::decrypt</a>, <a class="el" href="../../da/d39/keymat_8h_source.html#l00088">keymat_t::get_aead</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00079">aead_t::get_block_size</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00049">encrypted_payload_t::get_length</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00042">INVALID_ARG</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00079">encrypted_payload_t::set_transform</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00048">VERIFY_ERROR</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02464">decrypt_payloads()</a>.</p>
<div class="fragment"><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;{</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encrypted = (<a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a>*)fragment;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> chunk;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <a class="code" href="../../d7/d7d/structaead__t.html">aead_t</a> *<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>;</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="keywordtype">size_t</span> bs;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="keywordflow">if</span> (!keymat)</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    {</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;found encrypted fragment payload, but no keymat&quot;</span>);</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a>;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    aead = keymat-&gt;<a class="code" href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">get_aead</a>(keymat, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="keywordflow">if</span> (!aead)</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    {</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;found encrypted fragment payload, but no transform set&quot;</span>);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a>;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    bs = aead-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">get_block_size</a>(aead);</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#ae93ad3860c4e93a6626c0845063d2aca">set_transform</a>(encrypted, aead);</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    chunk = this-&gt;packet-&gt;get_data(this-&gt;packet);</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="keywordflow">if</span> (chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> &lt; encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">get_length</a>(encrypted) ||</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> &lt; bs)</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;invalid payload length&quot;</span>);</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    }</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> -= encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">get_length</a>(encrypted);</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keywordflow">return</span> encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#ac6680ea7d877d2d1517824dcbfa793c8">decrypt</a>(encrypted, chunk);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;}</div>
<div class="ttc" id="structencrypted__payload__t_html_ac6680ea7d877d2d1517824dcbfa793c8"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#ac6680ea7d877d2d1517824dcbfa793c8">encrypted_payload_t::decrypt</a></div><div class="ttdeci">status_t(* decrypt)(encrypted_payload_t *this, chunk_t assoc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00105">encrypted_payload.h:105</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_ae93ad3860c4e93a6626c0845063d2aca"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#ae93ad3860c4e93a6626c0845063d2aca">encrypted_payload_t::set_transform</a></div><div class="ttdeci">void(* set_transform)(encrypted_payload_t *this, aead_t *aead)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00079">encrypted_payload.h:79</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_aae31f55ac8256ac61afcbbfbda554da7"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">encrypted_payload_t::get_length</a></div><div class="ttdeci">size_t(* get_length)(encrypted_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00049">encrypted_payload.h:49</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structaead__t_html"><div class="ttname"><a href="../../d7/d7d/structaead__t.html">aead_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00037">aead.h:37</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structaead__t_html_ae6004b22fa9415839f9c0b6e16e48ae6"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">aead_t::get_block_size</a></div><div class="ttdeci">size_t(* get_block_size)(aead_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00079">aead.h:79</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00042">status.h:42</a></div></div>
<div class="ttc" id="structkeymat__t_html_a0fbe23bc433e5f23d641638d47a682e3"><div class="ttname"><a href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">keymat_t::get_aead</a></div><div class="ttdeci">aead_t *(* get_aead)(keymat_t *this, bool in)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d39/keymat_8h_source.html#l00088">keymat.h:88</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00037">encrypted_payload.h:37</a></div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00048">status.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ab28625ca2a5364f377a3dc4a73c559cf_icgraph.svg" width="435" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a574b26ea7b254ebdfad14c73f6caf99d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> decrypt_payloads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *&#160;</td>
          <td class="paramname"><em>keymat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decrypt payload from the encrypted payload </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02464">2464</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d0/d6d/message_8c_source.html#l02447">accept_unencrypted_mm()</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00077">AGGRESSIVE</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02317">decrypt_and_extract()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02411">decrypt_fragment()</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00110">encrypted_payload_t::destroy</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00085">payload_rule_t::encrypted</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00998">get_payload_rule()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02218">is_connectivity_check()</a>, <a class="el" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00269">PL_UNKNOWN</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00319">PLV1_ENCRYPTED</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00198">PLV2_ENCRYPTED</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00233">PLV2_FRAGMENT</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00105">previous</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00048">VERIFY_ERROR</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02612">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;{</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload, *<a class="code" href="../../d4/d2b/leak__detective_8c.html#aa0e8a700cbc78af5e62cea0c5c01705e">previous</a> = NULL;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <a class="code" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> *rule;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <a class="code" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    <span class="keywordtype">char</span> *was_encrypted = NULL;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    enumerator = this-&gt;payloads-&gt;create_enumerator(this-&gt;payloads);</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    {</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        type = payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;process payload of type %N&quot;</span>, <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        <span class="keywordflow">if</span> (type == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a> || type == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8">PLV1_ENCRYPTED</a> ||</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            type == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>)</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        {</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            <span class="keywordflow">if</span> (was_encrypted)</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            {</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;%s can&#39;t contain other payloads of type %N&quot;</span>,</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                     was_encrypted, <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                status = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            }</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        }</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="keywordflow">if</span> (type == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a> || type == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8">PLV1_ENCRYPTED</a>)</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        {</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            <a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encryption;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;found an encrypted payload&quot;</span>);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            encryption = (<a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a>*)payload;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;            this-&gt;payloads-&gt;remove_at(this-&gt;payloads, enumerator);</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            <span class="keywordflow">if</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, NULL))</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            {</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;encrypted payload is not last payload&quot;</span>);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a9af651f57dd7d06c5b85b7f634ad1fc2">destroy</a>(encryption);</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                status = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;            }</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            status = <a class="code" href="../../d0/d6d/message_8c.html#aa96012927a0c20c32309bf02f89e7bd9">decrypt_and_extract</a>(<span class="keyword">this</span>, keymat, previous, encryption);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a9af651f57dd7d06c5b85b7f634ad1fc2">destroy</a>(encryption);</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;            <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            {</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            }</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;            was_encrypted = <span class="stringliteral">&quot;encrypted payload&quot;</span>;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        }</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>)</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;            <a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a> *fragment;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;found an encrypted fragment payload&quot;</span>);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            fragment = (<a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a>*)payload;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            <span class="keywordflow">if</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, NULL))</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;            {</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;encrypted fragment payload is not last payload&quot;</span>);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                status = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            }</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;            status = <a class="code" href="../../d0/d6d/message_8c.html#ab28625ca2a5364f377a3dc4a73c559cf">decrypt_fragment</a>(<span class="keyword">this</span>, keymat, fragment);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            {</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            was_encrypted = <span class="stringliteral">&quot;encrypted fragment payload&quot;</span>;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        <span class="keywordflow">if</span> (type != <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a">PL_UNKNOWN</a> &amp;&amp; !was_encrypted &amp;&amp;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            !<a class="code" href="../../d0/d6d/message_8c.html#ac8944b8c52386a8cb9f1fa878b62acd1">is_connectivity_check</a>(<span class="keyword">this</span>, payload) &amp;&amp;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;            this-&gt;exchange_type != <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba128db069f37b5cd1b44901dff4db4ae0">AGGRESSIVE</a>)</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            rule = <a class="code" href="../../d0/d6d/message_8c.html#ac2cf8cf2c2016e48b002c4acc5d51a51">get_payload_rule</a>(<span class="keyword">this</span>, type);</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            <span class="keywordflow">if</span> ((!rule || rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#a45ad3f2d9cf98a9d4adc72b9fad4fb54">encrypted</a>) &amp;&amp;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                !<a class="code" href="../../d0/d6d/message_8c.html#ac1857d0b7287aa1b7eec51df16f234cb">accept_unencrypted_mm</a>(<span class="keyword">this</span>, type))</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            {</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;payload type %N was not encrypted&quot;</span>,</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;                     <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                status = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;            }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        }</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        previous = payload;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    }</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="message_8c_html_aa96012927a0c20c32309bf02f89e7bd9"><div class="ttname"><a href="../../d0/d6d/message_8c.html#aa96012927a0c20c32309bf02f89e7bd9">decrypt_and_extract</a></div><div class="ttdeci">static status_t decrypt_and_extract(private_message_t *this, keymat_t *keymat, payload_t *previous, encrypted_payload_t *encryption)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02317">message.c:2317</a></div></div>
<div class="ttc" id="leak__detective_8c_html_aa0e8a700cbc78af5e62cea0c5c01705e"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#aa0e8a700cbc78af5e62cea0c5c01705e">previous</a></div><div class="ttdeci">memory_header_t * previous</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00105">leak_detective.c:105</a></div></div>
<div class="ttc" id="structpayload__rule__t_html"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00077">message.c:77</a></div></div>
<div class="ttc" id="group__payload_html_ga910814947f5e241c851b42e95e8586ee"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a></div><div class="ttdeci">payload_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00043">payload.h:43</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba128db069f37b5cd1b44901dff4db4ae0"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba128db069f37b5cd1b44901dff4db4ae0">AGGRESSIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00077">ike_header.h:77</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="group__payload_html_ga397bd66f0cc14539cee30d16ae9b0bfa"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a></div><div class="ttdeci">enum_name_t * payload_type_names</div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8">PLV1_ENCRYPTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00319">payload.h:319</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="message_8c_html_ac1857d0b7287aa1b7eec51df16f234cb"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ac1857d0b7287aa1b7eec51df16f234cb">accept_unencrypted_mm</a></div><div class="ttdeci">static bool accept_unencrypted_mm(private_message_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02447">message.c:2447</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_a9af651f57dd7d06c5b85b7f634ad1fc2"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#a9af651f57dd7d06c5b85b7f634ad1fc2">encrypted_payload_t::destroy</a></div><div class="ttdeci">void(* destroy)(encrypted_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00110">encrypted_payload.h:110</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="message_8c_html_ac2cf8cf2c2016e48b002c4acc5d51a51"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ac2cf8cf2c2016e48b002c4acc5d51a51">get_payload_rule</a></div><div class="ttdeci">static payload_rule_t * get_payload_rule(private_message_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00998">message.c:998</a></div></div>
<div class="ttc" id="message_8c_html_ab28625ca2a5364f377a3dc4a73c559cf"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ab28625ca2a5364f377a3dc4a73c559cf">decrypt_fragment</a></div><div class="ttdeci">static status_t decrypt_fragment(private_message_t *this, keymat_t *keymat, encrypted_fragment_payload_t *fragment)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02411">message.c:2411</a></div></div>
<div class="ttc" id="structencrypted__fragment__payload__t_html"><div class="ttname"><a href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00033">encrypted_fragment_payload.h:33</a></div></div>
<div class="ttc" id="structpayload__rule__t_html_a45ad3f2d9cf98a9d4adc72b9fad4fb54"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html#a45ad3f2d9cf98a9d4adc72b9fad4fb54">payload_rule_t::encrypted</a></div><div class="ttdeci">bool encrypted</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00085">message.c:85</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="message_8c_html_ac8944b8c52386a8cb9f1fa878b62acd1"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ac8944b8c52386a8cb9f1fa878b62acd1">is_connectivity_check</a></div><div class="ttdeci">static bool is_connectivity_check(private_message_t *this, payload_t *payload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02218">message.c:2218</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00198">payload.h:198</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a">PL_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00269">payload.h:269</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00037">encrypted_payload.h:37</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00048">status.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a574b26ea7b254ebdfad14c73f6caf99d_cgraph.svg" width="100%" height="556"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a574b26ea7b254ebdfad14c73f6caf99d_icgraph.svg" width="264" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab502192691e076bfa0a75e1939a5d04b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> finalize_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *&#160;</td>
          <td class="paramname"><em>keymat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d70/structgenerator__t.html">generator_t</a> *&#160;</td>
          <td class="paramname"><em>generator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *&#160;</td>
          <td class="paramname"><em>encrypted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Encrypts and adds the encrypted payload (if any) to the payload list and finalizes the message generation. Destroys the given generator. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01788">1788</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00251">chunk_clone</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00057">chunk_create()</a>, <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00155">keymat_v1_t::confirm_iv</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00065">generator_t::destroy</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00110">encrypted_payload_t::destroy</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00091">encrypted_payload_t::encrypt</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00049">generator_t::generate_payload</a>, <a class="el" href="../../da/d39/keymat_8h_source.html#l00088">keymat_t::get_aead</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00079">aead_t::get_block_size</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00060">generator_t::get_chunk</a>, <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00130">keymat_v1_t::get_iv</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00049">encrypted_payload_t::get_length</a>, <a class="el" href="../../d5/d17/byteorder_8h_source.html#l00067">htoun32()</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00082">INFORMATIONAL_V1</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00050">INVALID_STATE</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00042">encrypted_payload_t::payload_interface</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, and <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00144">keymat_v1_t::update_iv</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01844">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;{</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <a class="code" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *keymat_v1 = (<a class="code" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>*)keymat;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> chunk;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    u_int32_t *lenpos;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="keywordflow">if</span> (encrypted)</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    {</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        <span class="keywordflow">if</span> (this-&gt;is_encrypted)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        {   <span class="comment">/* for IKEv1 instead of associated data we provide the IV */</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            <span class="keywordflow">if</span> (!keymat_v1-&gt;<a class="code" href="../../d8/dce/structkeymat__v1__t.html#a199e54d77ae9b2157b90ab487ba16ce6">get_iv</a>(keymat_v1, this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">message_id</a>, &amp;chunk))</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">destroy</a>(generator);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a9af651f57dd7d06c5b85b7f634ad1fc2">destroy</a>(encrypted);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        }</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        {   <span class="comment">/* build associated data (without header of encrypted payload) */</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            chunk = generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a90f85582f88eead65677e5ac095740b2">get_chunk</a>(generator, &amp;lenpos);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="comment">/* fill in length, including encrypted payload */</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            <a class="code" href="../../da/da5/group__byteorder__i.html#gaae216721dfa593756394194c3bb70d9b">htoun32</a>(lenpos, chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> + encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">get_length</a>(encrypted));</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        }</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        this-&gt;payloads-&gt;insert_last(this-&gt;payloads, encrypted);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        <span class="keywordflow">if</span> (encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#ac5ee2b1b5a0ff39eb633de7e99e6f898">encrypt</a>(encrypted, this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">message_id</a>, chunk) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        {</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">destroy</a>(generator);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a>;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        }</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generate_payload</a>(generator, &amp;encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a487edda678c9323ca8c09bf063b0fb22">payload_interface</a>);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    chunk = generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a90f85582f88eead65677e5ac095740b2">get_chunk</a>(generator, &amp;lenpos);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <a class="code" href="../../da/da5/group__byteorder__i.html#gaae216721dfa593756394194c3bb70d9b">htoun32</a>(lenpos, chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    this-&gt;packet-&gt;set_data(this-&gt;packet, <a class="code" href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a>(chunk));</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="keywordflow">if</span> (this-&gt;is_encrypted &amp;&amp; this-&gt;exchange_type != <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a>)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        <span class="comment">/* update the IV for the next IKEv1 message */</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> last_block;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <a class="code" href="../../d7/d7d/structaead__t.html">aead_t</a> *<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="keywordtype">size_t</span> bs;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        aead = keymat-&gt;<a class="code" href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">get_aead</a>(keymat, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        bs = aead-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">get_block_size</a>(aead);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        last_block = <a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(chunk.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> + chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> - bs, bs);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="keywordflow">if</span> (!keymat_v1-&gt;<a class="code" href="../../d8/dce/structkeymat__v1__t.html#ad58bae359e35ebf26b476c776d8ba17f">update_iv</a>(keymat_v1, this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">message_id</a>, last_block) ||</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            !keymat_v1-&gt;<a class="code" href="../../d8/dce/structkeymat__v1__t.html#aa50f2640e99013027ec859e348ffcdc1">confirm_iv</a>(keymat_v1, this-&gt;message_id))</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">destroy</a>(generator);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        }</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">destroy</a>(generator);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;}</div>
<div class="ttc" id="structencrypted__payload__t_html_a487edda678c9323ca8c09bf063b0fb22"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#a487edda678c9323ca8c09bf063b0fb22">encrypted_payload_t::payload_interface</a></div><div class="ttdeci">payload_t payload_interface</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00042">encrypted_payload.h:42</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00082">ike_header.h:82</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_aae31f55ac8256ac61afcbbfbda554da7"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">encrypted_payload_t::get_length</a></div><div class="ttdeci">size_t(* get_length)(encrypted_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00049">encrypted_payload.h:49</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structgenerator__t_html_aabd82edcd3cf7286b7e8a1ce7a2e8158"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">generator_t::destroy</a></div><div class="ttdeci">void(* destroy)(generator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00065">generator.h:65</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00050">status.h:50</a></div></div>
<div class="ttc" id="structaead__t_html"><div class="ttname"><a href="../../d7/d7d/structaead__t.html">aead_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00037">aead.h:37</a></div></div>
<div class="ttc" id="structprivate__message__t_html_a260d5d2f83563517f7a522324fb1c8be"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">private_message_t::message_id</a></div><div class="ttdeci">u_int32_t message_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00906">message.c:906</a></div></div>
<div class="ttc" id="group__chunk_html_gad94ca029616a107e89eaa618408fd7b6"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a></div><div class="ttdeci">static chunk_t chunk_create(u_char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00057">chunk.h:57</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html_aa50f2640e99013027ec859e348ffcdc1"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html#aa50f2640e99013027ec859e348ffcdc1">keymat_v1_t::confirm_iv</a></div><div class="ttdeci">bool(* confirm_iv)(keymat_v1_t *this, u_int32_t mid)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00155">keymat_v1.h:155</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structaead__t_html_ae6004b22fa9415839f9c0b6e16e48ae6"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">aead_t::get_block_size</a></div><div class="ttdeci">size_t(* get_block_size)(aead_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00079">aead.h:79</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_a9af651f57dd7d06c5b85b7f634ad1fc2"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#a9af651f57dd7d06c5b85b7f634ad1fc2">encrypted_payload_t::destroy</a></div><div class="ttdeci">void(* destroy)(encrypted_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00110">encrypted_payload.h:110</a></div></div>
<div class="ttc" id="structgenerator__t_html_a90f85582f88eead65677e5ac095740b2"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#a90f85582f88eead65677e5ac095740b2">generator_t::get_chunk</a></div><div class="ttdeci">chunk_t(* get_chunk)(generator_t *this, u_int32_t **lenpos)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00060">generator.h:60</a></div></div>
<div class="ttc" id="group__chunk_html_gac7a055a5fa92106988cddbc641899871"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a></div><div class="ttdeci">#define chunk_clone(chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00251">chunk.h:251</a></div></div>
<div class="ttc" id="structgenerator__t_html_a8867b5316e300d9b7d2291c5a69be143"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generator_t::generate_payload</a></div><div class="ttdeci">void(* generate_payload)(generator_t *this, payload_t *payload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00049">generator.h:49</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html_a199e54d77ae9b2157b90ab487ba16ce6"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html#a199e54d77ae9b2157b90ab487ba16ce6">keymat_v1_t::get_iv</a></div><div class="ttdeci">bool(* get_iv)(keymat_v1_t *this, u_int32_t mid, chunk_t *iv)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00130">keymat_v1.h:130</a></div></div>
<div class="ttc" id="group__byteorder__i_html_gaae216721dfa593756394194c3bb70d9b"><div class="ttname"><a href="../../da/da5/group__byteorder__i.html#gaae216721dfa593756394194c3bb70d9b">htoun32</a></div><div class="ttdeci">static void htoun32(void *network, u_int32_t host)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d17/byteorder_8h_source.html#l00067">byteorder.h:67</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_ac5ee2b1b5a0ff39eb633de7e99e6f898"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#ac5ee2b1b5a0ff39eb633de7e99e6f898">encrypted_payload_t::encrypt</a></div><div class="ttdeci">status_t(* encrypt)(encrypted_payload_t *this, u_int64_t mid, chunk_t assoc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00091">encrypted_payload.h:91</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html_ad58bae359e35ebf26b476c776d8ba17f"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html#ad58bae359e35ebf26b476c776d8ba17f">keymat_v1_t::update_iv</a></div><div class="ttdeci">bool(* update_iv)(keymat_v1_t *this, u_int32_t mid, chunk_t last_block)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00144">keymat_v1.h:144</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00032">keymat_v1.h:32</a></div></div>
<div class="ttc" id="structkeymat__t_html_a0fbe23bc433e5f23d641638d47a682e3"><div class="ttname"><a href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">keymat_t::get_aead</a></div><div class="ttdeci">aead_t *(* get_aead)(keymat_t *this, bool in)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d39/keymat_8h_source.html#l00088">keymat.h:88</a></div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ab502192691e076bfa0a75e1939a5d04b_cgraph.svg" width="283" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ab502192691e076bfa0a75e1939a5d04b_icgraph.svg" width="262" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaf699226234aa58a876efdf1e8b5d1e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fragment_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d6f/structfragment__t.html">fragment_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00963">963</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l00969">reset_defrag()</a>.</p>
<div class="fragment"><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;{</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;this-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;}</div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_aaf699226234aa58a876efdf1e8b5d1e8_cgraph.svg" width="363" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_aaf699226234aa58a876efdf1e8b5d1e8_icgraph.svg" width="576" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace0bd3f2f46246ad6c4f8dfcad5b6621"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> generate_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *&#160;</td>
          <td class="paramname"><em>keymat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d70/structgenerator__t.html">generator_t</a> **&#160;</td>
          <td class="paramname"><em>out_generator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> **&#160;</td>
          <td class="paramname"><em>encrypted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generates the message, if needed, wraps the payloads in an encrypted payload.</p>
<p>The generator and the possible enrypted payload are returned. The latter is not yet encrypted (but the transform is set). It is also not added to the payload list (so unless there are unencrypted payloads that list will be empty afterwards). </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">1657</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00092">BUF_LEN</a>, <a class="el" href="../../d8/d39/chunk_8c_source.html#l00035">chunk_empty</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01611">create_header()</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00322">ike_header_t::destroy</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00085">payload_rule_t::encrypted</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00134">EXCHANGE_TYPE_UNDEFINED</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00049">generator_t::generate_payload</a>, <a class="el" href="../../d3/d52/generator_8c_source.html#l00582">generator_create()</a>, <a class="el" href="../../da/d39/keymat_8h_source.html#l00088">keymat_t::get_aead</a>, <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00118">keymat_v1_t::get_hash_phase2</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00980">get_message_rule()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00998">get_payload_rule()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01272">get_string()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../da/d39/keymat_8h_source.html#l00052">keymat_t::get_version</a>, <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l01215">hash</a>, <a class="el" href="../../d9/da0/hash__payload_8c_source.html#l00152">hash_payload_create()</a>, <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00044">IKEV1</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00045">IKEV2_MAJOR_VERSION</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00082">INFORMATIONAL_V1</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00050">INVALID_STATE</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00110">next</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00040">NOT_SUPPORTED</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01480">order_payloads()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00048">PL_NONE</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00088">PLV1_HASH</a>, <a class="el" href="../../dd/d54/hash__payload_8h_source.html#l00044">hash_payload_t::set_hash</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00375">payload_t::set_next_type</a>, <a class="el" href="../../d9/d7b/settings__lexer_8c_source.html#l00645">str</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l01543">wrap_payloads()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/dbf/ike__sa_8c_source.html#l01051">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;{</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *keymat_v1 = (<a class="code" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>*)keymat;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <a class="code" href="../../d0/d70/structgenerator__t.html">generator_t</a> *generator;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <a class="code" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> next_type;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <a class="code" href="../../d7/d7d/structaead__t.html">aead_t</a> *<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a> = NULL;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d4/d58/tls__crypto_8c.html#afdf31b993d57256d72c36a66ed2bf4d4">hash</a> = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="../../d9/d7b/settings__lexer_8c.html#a94688a4a25a03cfbc6929fe15b1f8df0">str</a>[<a class="code" href="../../d6/d87/group__utils__i.html#ga8b5839f71a3b6e7d64b2d5e9967e3dd1">BUF_LEN</a>];</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <a class="code" href="../../d2/def/structike__header__t.html">ike_header_t</a> *ike_header;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload, *<a class="code" href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a>;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keywordtype">bool</span> encrypting = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">if</span> (this-&gt;exchange_type == <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba23e9bc548b721e5df5e98b681e73faad">EXCHANGE_TYPE_UNDEFINED</a>)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;exchange type is not defined&quot;</span>);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="keywordflow">if</span> (this-&gt;packet-&gt;get_source(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#aeb2f3f6d2defc37da6130d09ee863525">packet</a>) == NULL ||</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        this-&gt;packet-&gt;get_destination(this-&gt;packet) == NULL)</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    {</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;source/destination not defined&quot;</span>);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a>;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    this-&gt;rule = <a class="code" href="../../d0/d6d/message_8c.html#aef38b51cc48772f0530dabb1a53dbb52">get_message_rule</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;rule)</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    {</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;no message rules specified for this message type&quot;</span>);</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a9bf1138c8c1f4519e5b814514b750ca3">NOT_SUPPORTED</a>;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    }</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;sort_disabled)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#acb66d9136fff56df15318f1eb49efe47">order_payloads</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordflow">if</span> (keymat &amp;&amp; keymat-&gt;<a class="code" href="../../d2/d63/structkeymat__t.html#acbb299aa2628908de03d17f807a6b949">get_version</a>(keymat) == <a class="code" href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a>)</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="comment">/* get a hash for this message, if any is required */</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordflow">if</span> (keymat_v1-&gt;<a class="code" href="../../d8/dce/structkeymat__v1__t.html#aefa2b8c913f0dc188364a0823950e2b8">get_hash_phase2</a>(keymat_v1, &amp;this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#adcce362c21caa0fc13c5096626be0727">public</a>, &amp;hash))</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        {   <span class="comment">/* insert a HASH payload as first payload */</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            <a class="code" href="../../dc/d77/structhash__payload__t.html">hash_payload_t</a> *hash_payload;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            hash_payload = <a class="code" href="../../d7/d93/group__hash__payload.html#ga9c62236336f854e498722511d45f7023">hash_payload_create</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a>);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            hash_payload-&gt;<a class="code" href="../../dc/d77/structhash__payload__t.html#aa128efe66c955f910d6dea3c01299f52">set_hash</a>(hash_payload, hash);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            this-&gt;payloads-&gt;insert_first(this-&gt;payloads, hash_payload);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            <span class="keywordflow">if</span> (this-&gt;exchange_type == <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a>)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                this-&gt;is_encrypted = encrypting = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;hash);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="keywordflow">if</span> (this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a>)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        encrypting = this-&gt;rule-&gt;encrypted;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!encrypting)</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="comment">/* If at least one payload requires encryption, encrypt the message.</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">         * If no key material is available, the flag will be reset below. */</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        enumerator = this-&gt;payloads-&gt;create_enumerator(this-&gt;payloads);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, (<span class="keywordtype">void</span>**)&amp;payload))</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        {</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            <a class="code" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> *rule;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            rule = <a class="code" href="../../d0/d6d/message_8c.html#ac2cf8cf2c2016e48b002c4acc5d51a51">get_payload_rule</a>(<span class="keyword">this</span>, payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload));</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            <span class="keywordflow">if</span> (rule &amp;&amp; rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#a45ad3f2d9cf98a9d4adc72b9fad4fb54">encrypted</a>)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                this-&gt;is_encrypted = encrypting = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;generating %s&quot;</span>, <a class="code" href="../../d0/d6d/message_8c.html#a482b1abf3fc6a6bc6ef02bbe5c309067">get_string</a>(<span class="keyword">this</span>, str, <span class="keyword">sizeof</span>(str)));</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span> (keymat)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        aead = keymat-&gt;<a class="code" href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">get_aead</a>(keymat, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">if</span> (aead &amp;&amp; encrypting)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        *encrypted = <a class="code" href="../../d0/d6d/message_8c.html#ae0fdacc9bc87781e1115f7081a7ca9b6">wrap_payloads</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        (*encrypted)-&gt;set_transform(*encrypted, aead);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;not encrypting payloads&quot;</span>);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        this-&gt;is_encrypted = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="comment">/* generate all payloads with proper next type */</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    *out_generator = generator = <a class="code" href="../../dc/d21/group__generator.html#ga900fbdc44cd59d59e57330264448e53b">generator_create</a>();</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    ike_header = <a class="code" href="../../d0/d6d/message_8c.html#a0154bbad362c82c985fe191c22961034">create_header</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    payload = (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)ike_header;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    enumerator = create_payload_enumerator(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;next))</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>(payload, next-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(next));</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generate_payload</a>(generator, payload);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        payload = <a class="code" href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a>;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    next_type = <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a>;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="keywordflow">if</span> (this-&gt;is_encrypted)</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    {   <span class="comment">/* for encrypted IKEv1 messages */</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        next_type = (*encrypted)-&gt;payload_interface.get_next_type(</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                                                        (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)*encrypted);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    }</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*encrypted)</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    {   <span class="comment">/* use proper IKEv2 encrypted (fragment) payload type */</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        next_type = (*encrypted)-&gt;payload_interface.get_type(</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                                                        (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)*encrypted);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    }</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>(payload, next_type);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generate_payload</a>(generator, payload);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#acc018b2e70e22b16c7cbdede5dc9446e">destroy</a>(ike_header);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html_aefa2b8c913f0dc188364a0823950e2b8"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html#aefa2b8c913f0dc188364a0823950e2b8">keymat_v1_t::get_hash_phase2</a></div><div class="ttdeci">bool(* get_hash_phase2)(keymat_v1_t *this, message_t *message, chunk_t *hash)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00118">keymat_v1.h:118</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00088">payload.h:88</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__ike__cfg_html_ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00044">ike_cfg.h:44</a></div></div>
<div class="ttc" id="structike__header__t_html_acc018b2e70e22b16c7cbdede5dc9446e"><div class="ttname"><a href="../../d2/def/structike__header__t.html#acc018b2e70e22b16c7cbdede5dc9446e">ike_header_t::destroy</a></div><div class="ttdeci">void(* destroy)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00322">ike_header.h:322</a></div></div>
<div class="ttc" id="settings__lexer_8c_html_a94688a4a25a03cfbc6929fe15b1f8df0"><div class="ttname"><a href="../../d9/d7b/settings__lexer_8c.html#a94688a4a25a03cfbc6929fe15b1f8df0">str</a></div><div class="ttdeci">#define str</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7b/settings__lexer_8c_source.html#l00645">settings_lexer.c:645</a></div></div>
<div class="ttc" id="structpayload__rule__t_html"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00077">message.c:77</a></div></div>
<div class="ttc" id="group__payload_html_ga910814947f5e241c851b42e95e8586ee"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a></div><div class="ttdeci">payload_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00043">payload.h:43</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="group__chunk_html_gac9858e0c37c9bf6c0706d0a6e3b6453d"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a></div><div class="ttdeci">chunk_t chunk_empty</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00035">chunk.c:35</a></div></div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="structprivate__message__t_html_aeb2f3f6d2defc37da6130d09ee863525"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#aeb2f3f6d2defc37da6130d09ee863525">private_message_t::packet</a></div><div class="ttdeci">packet_t * packet</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00916">message.c:916</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="tls__crypto_8c_html_afdf31b993d57256d72c36a66ed2bf4d4"><div class="ttname"><a href="../../d4/d58/tls__crypto_8c.html#afdf31b993d57256d72c36a66ed2bf4d4">hash</a></div><div class="ttdeci">tls_hash_algorithm_t hash</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d58/tls__crypto_8c_source.html#l01215">tls_crypto.c:1215</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00082">ike_header.h:82</a></div></div>
<div class="ttc" id="group__generator_html_ga900fbdc44cd59d59e57330264448e53b"><div class="ttname"><a href="../../dc/d21/group__generator.html#ga900fbdc44cd59d59e57330264448e53b">generator_create</a></div><div class="ttdeci">generator_t * generator_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d52/generator_8c_source.html#l00582">generator.c:582</a></div></div>
<div class="ttc" id="structpayload__t_html_a080809f324fbb7037d2aafed2a4f8fcc"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">payload_t::set_next_type</a></div><div class="ttdeci">void(* set_next_type)(payload_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00375">payload.h:375</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00050">status.h:50</a></div></div>
<div class="ttc" id="structaead__t_html"><div class="ttname"><a href="../../d7/d7d/structaead__t.html">aead_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00037">aead.h:37</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a9bf1138c8c1f4519e5b814514b750ca3"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a9bf1138c8c1f4519e5b814514b750ca3">NOT_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00040">status.h:40</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="group__hash__payload_html_ga9c62236336f854e498722511d45f7023"><div class="ttname"><a href="../../d7/d93/group__hash__payload.html#ga9c62236336f854e498722511d45f7023">hash_payload_create</a></div><div class="ttdeci">hash_payload_t * hash_payload_create(payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/da0/hash__payload_8c_source.html#l00152">hash_payload.c:152</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structprivate__message__t_html_adcce362c21caa0fc13c5096626be0727"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#adcce362c21caa0fc13c5096626be0727">private_message_t::public</a></div><div class="ttdeci">message_t public</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00856">message.c:856</a></div></div>
<div class="ttc" id="structhash__payload__t_html"><div class="ttname"><a href="../../dc/d77/structhash__payload__t.html">hash_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d54/hash__payload_8h_source.html#l00032">hash_payload.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="message_8c_html_ac2cf8cf2c2016e48b002c4acc5d51a51"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ac2cf8cf2c2016e48b002c4acc5d51a51">get_payload_rule</a></div><div class="ttdeci">static payload_rule_t * get_payload_rule(private_message_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00998">message.c:998</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a8ad91963e97959c834d908f0ac9cca66"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a></div><div class="ttdeci">memory_header_t * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00110">leak_detective.c:110</a></div></div>
<div class="ttc" id="structgenerator__t_html_a8867b5316e300d9b7d2291c5a69be143"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generator_t::generate_payload</a></div><div class="ttdeci">void(* generate_payload)(generator_t *this, payload_t *payload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00049">generator.h:49</a></div></div>
<div class="ttc" id="group__utils__i_html_ga8b5839f71a3b6e7d64b2d5e9967e3dd1"><div class="ttname"><a href="../../d6/d87/group__utils__i.html#ga8b5839f71a3b6e7d64b2d5e9967e3dd1">BUF_LEN</a></div><div class="ttdeci">#define BUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00092">utils.h:92</a></div></div>
<div class="ttc" id="message_8c_html_ae0fdacc9bc87781e1115f7081a7ca9b6"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ae0fdacc9bc87781e1115f7081a7ca9b6">wrap_payloads</a></div><div class="ttdeci">static encrypted_payload_t * wrap_payloads(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01543">message.c:1543</a></div></div>
<div class="ttc" id="group__ike__header_html_ga750bf45eb8428bbe3eefa03537d491e5"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a></div><div class="ttdeci">#define IKEV2_MAJOR_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00045">ike_header.h:45</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structhash__payload__t_html_aa128efe66c955f910d6dea3c01299f52"><div class="ttname"><a href="../../dc/d77/structhash__payload__t.html#aa128efe66c955f910d6dea3c01299f52">hash_payload_t::set_hash</a></div><div class="ttdeci">void(* set_hash)(hash_payload_t *this, chunk_t hash)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d54/hash__payload_8h_source.html#l00044">hash_payload.h:44</a></div></div>
<div class="ttc" id="structpayload__rule__t_html_a45ad3f2d9cf98a9d4adc72b9fad4fb54"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html#a45ad3f2d9cf98a9d4adc72b9fad4fb54">payload_rule_t::encrypted</a></div><div class="ttdeci">bool encrypted</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00085">message.c:85</a></div></div>
<div class="ttc" id="message_8c_html_a0154bbad362c82c985fe191c22961034"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a0154bbad362c82c985fe191c22961034">create_header</a></div><div class="ttdeci">static ike_header_t * create_header(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01611">message.c:1611</a></div></div>
<div class="ttc" id="message_8c_html_a482b1abf3fc6a6bc6ef02bbe5c309067"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a482b1abf3fc6a6bc6ef02bbe5c309067">get_string</a></div><div class="ttdeci">static char * get_string(private_message_t *this, char *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01272">message.c:1272</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structgenerator__t_html"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html">generator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00042">generator.h:42</a></div></div>
<div class="ttc" id="message_8c_html_aef38b51cc48772f0530dabb1a53dbb52"><div class="ttname"><a href="../../d0/d6d/message_8c.html#aef38b51cc48772f0530dabb1a53dbb52">get_message_rule</a></div><div class="ttdeci">static message_rule_t * get_message_rule(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00980">message.c:980</a></div></div>
<div class="ttc" id="message_8c_html_acb66d9136fff56df15318f1eb49efe47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#acb66d9136fff56df15318f1eb49efe47">order_payloads</a></div><div class="ttdeci">static void order_payloads(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01480">message.c:1480</a></div></div>
<div class="ttc" id="structike__header__t_html"><div class="ttname"><a href="../../d2/def/structike__header__t.html">ike_header_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00145">ike_header.h:145</a></div></div>
<div class="ttc" id="structkeymat__t_html_acbb299aa2628908de03d17f807a6b949"><div class="ttname"><a href="../../d2/d63/structkeymat__t.html#acbb299aa2628908de03d17f807a6b949">keymat_t::get_version</a></div><div class="ttdeci">ike_version_t(* get_version)(keymat_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d39/keymat_8h_source.html#l00052">keymat.h:52</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00032">keymat_v1.h:32</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba23e9bc548b721e5df5e98b681e73faad"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba23e9bc548b721e5df5e98b681e73faad">EXCHANGE_TYPE_UNDEFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00134">ike_header.h:134</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00048">payload.h:48</a></div></div>
<div class="ttc" id="structkeymat__t_html_a0fbe23bc433e5f23d641638d47a682e3"><div class="ttname"><a href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">keymat_t::get_aead</a></div><div class="ttdeci">aead_t *(* get_aead)(keymat_t *this, bool in)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d39/keymat_8h_source.html#l00088">keymat.h:88</a></div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ace0bd3f2f46246ad6c4f8dfcad5b6621_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ace0bd3f2f46246ad6c4f8dfcad5b6621_icgraph.svg" width="272" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aef38b51cc48772f0530dabb1a53dbb52"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../df/dcd/structmessage__rule__t.html">message_rule_t</a>* get_message_rule </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the message rule that applies to this message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00980">980</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d5/d60/utils_8h_source.html#l00147">countof</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l00109">message_rule_t::is_request</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l02612">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;{</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a>(<a class="code" href="../../d0/d6d/message_8c.html#abd569f38c38b78a84afb781f2041068d">message_rules</a>); i++)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">if</span> ((this-&gt;exchange_type == <a class="code" href="../../d0/d6d/message_8c.html#abd569f38c38b78a84afb781f2041068d">message_rules</a>[i].exchange_type) &amp;&amp;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            (this-&gt;is_request == <a class="code" href="../../d0/d6d/message_8c.html#abd569f38c38b78a84afb781f2041068d">message_rules</a>[i].<a class="code" href="../../df/dcd/structmessage__rule__t.html#abe5004f6b73dffa92647e0f9dc5fc826">is_request</a>))</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordflow">return</span> &amp;<a class="code" href="../../d0/d6d/message_8c.html#abd569f38c38b78a84afb781f2041068d">message_rules</a>[i];</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;}</div>
<div class="ttc" id="structmessage__rule__t_html_abe5004f6b73dffa92647e0f9dc5fc826"><div class="ttname"><a href="../../df/dcd/structmessage__rule__t.html#abe5004f6b73dffa92647e0f9dc5fc826">message_rule_t::is_request</a></div><div class="ttdeci">bool is_request</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00109">message.c:109</a></div></div>
<div class="ttc" id="group__utils__i_html_gab317c73e51fb8a68f86165ac831f7b8c"><div class="ttname"><a href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a></div><div class="ttdeci">#define countof(array)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00147">utils.h:147</a></div></div>
<div class="ttc" id="message_8c_html_abd569f38c38b78a84afb781f2041068d"><div class="ttname"><a href="../../d0/d6d/message_8c.html#abd569f38c38b78a84afb781f2041068d">message_rules</a></div><div class="ttdeci">static message_rule_t message_rules[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00733">message.c:733</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_aef38b51cc48772f0530dabb1a53dbb52_icgraph.svg" width="448" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac2cf8cf2c2016e48b002c4acc5d51a51"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a>* get_payload_rule </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Look up a payload rule </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00998">998</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02464">decrypt_payloads()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l01543">wrap_payloads()</a>.</p>
<div class="fragment"><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;{</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; this-&gt;rule-&gt;rule_count;i++)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">if</span> (this-&gt;rule-&gt;rules[i].type == <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>)</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <span class="keywordflow">return</span> &amp;this-&gt;rule-&gt;rules[i];</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;}</div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ac2cf8cf2c2016e48b002c4acc5d51a51_icgraph.svg" width="614" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a482b1abf3fc6a6bc6ef02bbe5c309067"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* get_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>get a string representation of the message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01272">1272</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d6/da4/radius__message_8c_source.html#l00112">attributes</a>, <a class="el" href="../../d1/d7e/cp__payload_8h_source.html#l00040">CFG_ACK</a>, <a class="el" href="../../d1/d7e/cp__payload_8h_source.html#l00038">CFG_REPLY</a>, <a class="el" href="../../d1/d7e/cp__payload_8h_source.html#l00037">CFG_REQUEST</a>, <a class="el" href="../../d1/d7e/cp__payload_8h_source.html#l00039">CFG_SET</a>, <a class="el" href="../../d9/dfc/group__attributes__g.html#gac56906b409200ee634d6c6ae633772fd">configuration_attribute_type_short_names</a>, <a class="el" href="../../d3/d63/aes__crypter_8c_source.html#l00520">cp</a>, <a class="el" href="../../d1/d7e/cp__payload_8h_source.html#l00063">cp_payload_t::create_attribute_enumerator</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d5/d4c/group__leap.html#ga9cd8893869499290c1e5a8327e1b9eb6">eap_code_short_names</a>, <a class="el" href="../../d5/d4c/group__leap.html#ga8d488f662d501a8207bfdddf21b9ffa3">eap_type_short_names</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d6/d12/eap__payload_8h_source.html#l00068">eap_payload_t::get_code</a>, <a class="el" href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00045">encrypted_fragment_payload_t::get_fragment_number</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00269">notify_payload_t::get_notification_data</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00217">notify_payload_t::get_notify_type</a>, <a class="el" href="../../df/d93/fragment__payload_8h_source.html#l00052">fragment_payload_t::get_number</a>, <a class="el" href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00052">encrypted_fragment_payload_t::get_total_fragments</a>, <a class="el" href="../../dd/d7f/configuration__attribute_8h_source.html#l00046">configuration_attribute_t::get_type</a>, <a class="el" href="../../d1/d97/unknown__payload_8h_source.html#l00050">unknown_payload_t::get_type</a>, <a class="el" href="../../d1/d7e/cp__payload_8h_source.html#l00078">cp_payload_t::get_type</a>, <a class="el" href="../../d6/d12/eap__payload_8h_source.html#l00083">eap_payload_t::get_type</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../df/d93/fragment__payload_8h_source.html#l00059">fragment_payload_t::is_last</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00086">MS_NOTIFY_STATUS</a>, <a class="el" href="../../d4/da5/watcher_8c_source.html#l00192">notify()</a>, <a class="el" href="../../da/d2c/group__notify__payload.html#ga5225eff98d02a929b7e54f45b999b5e6">notify_type_short_names</a>, <a class="el" href="../../d0/d90/group__payload.html#ga5866890f998a1941876bc0668e6850cb">payload_type_short_names</a>, <a class="el" href="../../d9/dbe/test__utils_8c_source.html#l00205">pfx</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00269">PL_UNKNOWN</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00118">PLV1_CONFIGURATION</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00256">PLV1_FRAGMENT</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00103">PLV1_NOTIFY</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00203">PLV2_CONFIGURATION</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00208">PLV2_EAP</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00233">PLV2_FRAGMENT</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00173">PLV2_NOTIFY</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d9/d12/printf__hook__builtin_8h_source.html#l00073">snprintf</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>, and <a class="el" href="../../d5/d17/byteorder_8h_source.html#l00123">untoh32()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l02612">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;{</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordtype">int</span> written;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordtype">char</span> *pos = buf;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(buf, 0, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>--;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;%N %s %u [&quot;</span>,</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                       <a class="code" href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a>, this-&gt;exchange_type,</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                       this-&gt;is_request ? <span class="stringliteral">&quot;request&quot;</span> : <span class="stringliteral">&quot;response&quot;</span>,</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                       this-&gt;message_id);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    pos += written;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    enumerator = create_payload_enumerator(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot; %N&quot;</span>, <a class="code" href="../../d0/d90/group__payload.html#ga5866890f998a1941876bc0668e6850cb">payload_type_short_names</a>,</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                           payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload));</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;            <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        pos += written;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a> ||</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102">PLV1_NOTIFY</a>)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            <a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a> *<a class="code" href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            <a class="code" href="../../da/d2c/group__notify__payload.html#gab6c94f52cd7f074f81f537e08b89bdca">notify_type_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            notify = (<a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a>*)payload;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            type = notify-&gt;<a class="code" href="../../dc/d56/structnotify__payload__t.html#acba12460facded9439652c9c5af96dc2">get_notify_type</a>(notify);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            data = notify-&gt;<a class="code" href="../../dc/d56/structnotify__payload__t.html#a1eb88d3dfc85f70811612cabcc38d943">get_notification_data</a>(notify);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="keywordflow">if</span> (type == <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaadd77b29938fb795618e6ca0d3336e47b">MS_NOTIFY_STATUS</a> &amp;&amp; data.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> == 4)</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;(%N(%d))&quot;</span>, <a class="code" href="../../da/d2c/group__notify__payload.html#ga5225eff98d02a929b7e54f45b999b5e6">notify_type_short_names</a>,</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                   type, <a class="code" href="../../da/da5/group__byteorder__i.html#ga439355baab5e35d632f86318c8330043">untoh32</a>(data.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>));</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;(%N)&quot;</span>, <a class="code" href="../../da/d2c/group__notify__payload.html#ga5225eff98d02a929b7e54f45b999b5e6">notify_type_short_names</a>,</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                                   type);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            }</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            pos += written;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a>)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <a class="code" href="../../d5/d42/structeap__payload__t.html">eap_payload_t</a> *eap = (<a class="code" href="../../d5/d42/structeap__payload__t.html">eap_payload_t</a>*)payload;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;            u_int32_t vendor;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            <a class="code" href="../../d5/d4c/group__leap.html#gaf50351c5ee5706e00baa3bc29310ba98">eap_type_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="keywordtype">char</span> method[64] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            type = eap-&gt;<a class="code" href="../../d5/d42/structeap__payload__t.html#a108788060cc5cf6cdf9a58dc87ab08f9">get_type</a>(eap, &amp;vendor);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            <span class="keywordflow">if</span> (type)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                <span class="keywordflow">if</span> (vendor)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                    <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(method, <span class="keyword">sizeof</span>(method), <span class="stringliteral">&quot;/%d-%d&quot;</span>, type, vendor);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                    <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(method, <span class="keyword">sizeof</span>(method), <span class="stringliteral">&quot;/%N&quot;</span>,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                             <a class="code" href="../../d5/d4c/group__leap.html#ga8d488f662d501a8207bfdddf21b9ffa3">eap_type_short_names</a>, type);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;/%N%s&quot;</span>, <a class="code" href="../../d5/d4c/group__leap.html#ga9cd8893869499290c1e5a8327e1b9eb6">eap_code_short_names</a>,</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                               eap-&gt;<a class="code" href="../../d5/d42/structeap__payload__t.html#a7c423cba51310a3f3ba156a27bf7ae38">get_code</a>(eap), method);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            pos += written;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a> ||</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea771bbb72656bf85cfdae78320449e45b">PLV1_CONFIGURATION</a>)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            <a class="code" href="../../d3/da4/structcp__payload__t.html">cp_payload_t</a> *<a class="code" href="../../d3/d63/aes__crypter_8c.html#a55148f5a2d1fe62daf220bd761222599">cp</a> = (<a class="code" href="../../d3/da4/structcp__payload__t.html">cp_payload_t</a>*)payload;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *<a class="code" href="../../d6/da4/radius__message_8c.html#ac926a0091d03176218b67c4eb82e80c7">attributes</a>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            <a class="code" href="../../dc/d48/structconfiguration__attribute__t.html">configuration_attribute_t</a> *attribute;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <span class="keywordtype">bool</span> first = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            <span class="keywordtype">char</span> *<a class="code" href="../../d9/dbe/test__utils_8c.html#a0d17f257a8488152f16f7661f8e7504b">pfx</a>;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            <span class="keywordflow">switch</span> (cp-&gt;<a class="code" href="../../d3/da4/structcp__payload__t.html#aff1cd9eae5d5c5d4248e49b664b36e7f">get_type</a>(cp))</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../df/d04/group__cp__payload.html#gga0550b292138734e5738b9f29a2257f96a268cdcb52cb9f01a1d5fc1a63cd944b2">CFG_REQUEST</a>:</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                    pfx = <span class="stringliteral">&quot;RQ(&quot;</span>;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../df/d04/group__cp__payload.html#gga0550b292138734e5738b9f29a2257f96a10fd13ea3fd8861e2afdbcc66fa8ef67">CFG_REPLY</a>:</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                    pfx = <span class="stringliteral">&quot;RP(&quot;</span>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../df/d04/group__cp__payload.html#gga0550b292138734e5738b9f29a2257f96a11621eb36617fd22c97b225e765db014">CFG_SET</a>:</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                    pfx = <span class="stringliteral">&quot;S(&quot;</span>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../df/d04/group__cp__payload.html#gga0550b292138734e5738b9f29a2257f96a9758098f4f1980b7051818f0aa019b34">CFG_ACK</a>:</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                    pfx = <span class="stringliteral">&quot;A(&quot;</span>;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                    pfx = <span class="stringliteral">&quot;(&quot;</span>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            attributes = cp-&gt;<a class="code" href="../../d3/da4/structcp__payload__t.html#ab89407a26da5d783866ebca0380982b2">create_attribute_enumerator</a>(cp);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            <span class="keywordflow">while</span> (attributes-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(attributes, &amp;attribute))</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;%s%N&quot;</span>, first ? pfx : <span class="stringliteral">&quot; &quot;</span>,</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                   <a class="code" href="../../d9/dfc/group__attributes__g.html#gac56906b409200ee634d6c6ae633772fd">configuration_attribute_type_short_names</a>,</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                   attribute-&gt;<a class="code" href="../../dc/d48/structconfiguration__attribute__t.html#a31305858ddedae72ab0fc3dd6f0b205d">get_type</a>(attribute));</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                {</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                    <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                pos += written;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                first = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;            }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;            attributes-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(attributes);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;            <span class="keywordflow">if</span> (!first)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                    <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                pos += written;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6">PLV1_FRAGMENT</a>)</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            <a class="code" href="../../d1/dcf/structfragment__payload__t.html">fragment_payload_t</a> *frag;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            frag = (<a class="code" href="../../d1/dcf/structfragment__payload__t.html">fragment_payload_t</a>*)payload;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            <span class="keywordflow">if</span> (frag-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#afb37e188ab4743682c07e2e0c0c16991">is_last</a>(frag))</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;(%u/%u)&quot;</span>,</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                            frag-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#a1cde01ec3e51460331a2bd3306e47d5d">get_number</a>(frag), frag-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#a1cde01ec3e51460331a2bd3306e47d5d">get_number</a>(frag));</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;(%u)&quot;</span>, frag-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#a1cde01ec3e51460331a2bd3306e47d5d">get_number</a>(frag));</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            }</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            pos += written;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>)</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            <a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a> *frag;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            frag = (<a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a>*)payload;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;(%u/%u)&quot;</span>,</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                               frag-&gt;<a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html#ae9b160f458d9be52e67942ab435fae7d">get_fragment_number</a>(frag),</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                               frag-&gt;<a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html#a7c8c1b6299865bf9424490b42e0f6d5e">get_total_fragments</a>(frag));</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            pos += written;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a">PL_UNKNOWN</a>)</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            <a class="code" href="../../d0/d76/structunknown__payload__t.html">unknown_payload_t</a> *unknown;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            unknown = (<a class="code" href="../../d0/d76/structunknown__payload__t.html">unknown_payload_t</a>*)payload;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            written = <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot;(%d)&quot;</span>, unknown-&gt;<a class="code" href="../../d0/d76/structunknown__payload__t.html#a7c687f093798d86b6dbfff069a268808">get_type</a>(unknown));</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            <span class="keywordflow">if</span> (written &gt;= <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> || written &lt; 0)</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            pos += written;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a> -= written;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">/* remove last space */</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(pos, <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, <span class="stringliteral">&quot; ]&quot;</span>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">return</span> buf;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;}</div>
<div class="ttc" id="structcp__payload__t_html_aff1cd9eae5d5c5d4248e49b664b36e7f"><div class="ttname"><a href="../../d3/da4/structcp__payload__t.html#aff1cd9eae5d5c5d4248e49b664b36e7f">cp_payload_t::get_type</a></div><div class="ttdeci">config_type_t(* get_type)(cp_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7e/cp__payload_8h_source.html#l00078">cp_payload.h:78</a></div></div>
<div class="ttc" id="group__attributes__g_html_gac56906b409200ee634d6c6ae633772fd"><div class="ttname"><a href="../../d9/dfc/group__attributes__g.html#gac56906b409200ee634d6c6ae633772fd">configuration_attribute_type_short_names</a></div><div class="ttdeci">enum_name_t * configuration_attribute_type_short_names</div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structencrypted__fragment__payload__t_html_a7c8c1b6299865bf9424490b42e0f6d5e"><div class="ttname"><a href="../../db/d72/structencrypted__fragment__payload__t.html#a7c8c1b6299865bf9424490b42e0f6d5e">encrypted_fragment_payload_t::get_total_fragments</a></div><div class="ttdeci">u_int16_t(* get_total_fragments)(encrypted_fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00052">encrypted_fragment_payload.h:52</a></div></div>
<div class="ttc" id="group__leap_html_gaf50351c5ee5706e00baa3bc29310ba98"><div class="ttname"><a href="../../d5/d4c/group__leap.html#gaf50351c5ee5706e00baa3bc29310ba98">eap_type_t</a></div><div class="ttdeci">eap_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d0a/eap_8h_source.html#l00055">eap.h:55</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="structcp__payload__t_html_ab89407a26da5d783866ebca0380982b2"><div class="ttname"><a href="../../d3/da4/structcp__payload__t.html#ab89407a26da5d783866ebca0380982b2">cp_payload_t::create_attribute_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_attribute_enumerator)(cp_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7e/cp__payload_8h_source.html#l00063">cp_payload.h:63</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102">PLV1_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00103">payload.h:103</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="group__cp__payload_html_gga0550b292138734e5738b9f29a2257f96a9758098f4f1980b7051818f0aa019b34"><div class="ttname"><a href="../../df/d04/group__cp__payload.html#gga0550b292138734e5738b9f29a2257f96a9758098f4f1980b7051818f0aa019b34">CFG_ACK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7e/cp__payload_8h_source.html#l00040">cp_payload.h:40</a></div></div>
<div class="ttc" id="structnotify__payload__t_html_acba12460facded9439652c9c5af96dc2"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html#acba12460facded9439652c9c5af96dc2">notify_payload_t::get_notify_type</a></div><div class="ttdeci">notify_type_t(* get_notify_type)(notify_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00217">notify_payload.h:217</a></div></div>
<div class="ttc" id="structnotify__payload__t_html_a1eb88d3dfc85f70811612cabcc38d943"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html#a1eb88d3dfc85f70811612cabcc38d943">notify_payload_t::get_notification_data</a></div><div class="ttdeci">chunk_t(* get_notification_data)(notify_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00269">notify_payload.h:269</a></div></div>
<div class="ttc" id="test__utils_8c_html_a0d17f257a8488152f16f7661f8e7504b"><div class="ttname"><a href="../../d9/dbe/test__utils_8c.html#a0d17f257a8488152f16f7661f8e7504b">pfx</a></div><div class="ttdeci">char * pfx</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbe/test__utils_8c_source.html#l00205">test_utils.c:205</a></div></div>
<div class="ttc" id="group__cp__payload_html_gga0550b292138734e5738b9f29a2257f96a268cdcb52cb9f01a1d5fc1a63cd944b2"><div class="ttname"><a href="../../df/d04/group__cp__payload.html#gga0550b292138734e5738b9f29a2257f96a268cdcb52cb9f01a1d5fc1a63cd944b2">CFG_REQUEST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7e/cp__payload_8h_source.html#l00037">cp_payload.h:37</a></div></div>
<div class="ttc" id="structconfiguration__attribute__t_html_a31305858ddedae72ab0fc3dd6f0b205d"><div class="ttname"><a href="../../dc/d48/structconfiguration__attribute__t.html#a31305858ddedae72ab0fc3dd6f0b205d">configuration_attribute_t::get_type</a></div><div class="ttdeci">configuration_attribute_type_t(* get_type)(configuration_attribute_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7f/configuration__attribute_8h_source.html#l00046">configuration_attribute.h:46</a></div></div>
<div class="ttc" id="structnotify__payload__t_html"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00192">notify_payload.h:192</a></div></div>
<div class="ttc" id="group__notify__payload_html_ga5225eff98d02a929b7e54f45b999b5e6"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ga5225eff98d02a929b7e54f45b999b5e6">notify_type_short_names</a></div><div class="ttdeci">enum_name_t * notify_type_short_names</div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00208">payload.h:208</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structencrypted__fragment__payload__t_html_ae9b160f458d9be52e67942ab435fae7d"><div class="ttname"><a href="../../db/d72/structencrypted__fragment__payload__t.html#ae9b160f458d9be52e67942ab435fae7d">encrypted_fragment_payload_t::get_fragment_number</a></div><div class="ttdeci">u_int16_t(* get_fragment_number)(encrypted_fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00045">encrypted_fragment_payload.h:45</a></div></div>
<div class="ttc" id="aes__crypter_8c_html_a55148f5a2d1fe62daf220bd761222599"><div class="ttname"><a href="../../d3/d63/aes__crypter_8c.html#a55148f5a2d1fe62daf220bd761222599">cp</a></div><div class="ttdeci">#define cp(t, f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d63/aes__crypter_8c_source.html#l00520">aes_crypter.c:520</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea771bbb72656bf85cfdae78320449e45b"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea771bbb72656bf85cfdae78320449e45b">PLV1_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00118">payload.h:118</a></div></div>
<div class="ttc" id="structeap__payload__t_html_a108788060cc5cf6cdf9a58dc87ab08f9"><div class="ttname"><a href="../../d5/d42/structeap__payload__t.html#a108788060cc5cf6cdf9a58dc87ab08f9">eap_payload_t::get_type</a></div><div class="ttdeci">eap_type_t(* get_type)(eap_payload_t *this, u_int32_t *vendor)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d12/eap__payload_8h_source.html#l00083">eap_payload.h:83</a></div></div>
<div class="ttc" id="group__cp__payload_html_gga0550b292138734e5738b9f29a2257f96a11621eb36617fd22c97b225e765db014"><div class="ttname"><a href="../../df/d04/group__cp__payload.html#gga0550b292138734e5738b9f29a2257f96a11621eb36617fd22c97b225e765db014">CFG_SET</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7e/cp__payload_8h_source.html#l00039">cp_payload.h:39</a></div></div>
<div class="ttc" id="group__leap_html_ga8d488f662d501a8207bfdddf21b9ffa3"><div class="ttname"><a href="../../d5/d4c/group__leap.html#ga8d488f662d501a8207bfdddf21b9ffa3">eap_type_short_names</a></div><div class="ttdeci">enum_name_t * eap_type_short_names</div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="radius__message_8c_html_ac926a0091d03176218b67c4eb82e80c7"><div class="ttname"><a href="../../d6/da4/radius__message_8c.html#ac926a0091d03176218b67c4eb82e80c7">attributes</a></div><div class="ttdeci">u_int8_t attributes[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da4/radius__message_8c_source.html#l00112">radius_message.c:112</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="watcher_8c_html_a8f0e10b20c0f4d75132f5af69278c063"><div class="ttname"><a href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a></div><div class="ttdeci">static void notify(private_watcher_t *this, entry_t *entry, watcher_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da5/watcher_8c_source.html#l00192">watcher.c:192</a></div></div>
<div class="ttc" id="structeap__payload__t_html_a7c423cba51310a3f3ba156a27bf7ae38"><div class="ttname"><a href="../../d5/d42/structeap__payload__t.html#a7c423cba51310a3f3ba156a27bf7ae38">eap_payload_t::get_code</a></div><div class="ttdeci">eap_code_t(* get_code)(eap_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d12/eap__payload_8h_source.html#l00068">eap_payload.h:68</a></div></div>
<div class="ttc" id="group__byteorder__i_html_ga439355baab5e35d632f86318c8330043"><div class="ttname"><a href="../../da/da5/group__byteorder__i.html#ga439355baab5e35d632f86318c8330043">untoh32</a></div><div class="ttdeci">static u_int32_t untoh32(void *network)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d17/byteorder_8h_source.html#l00123">byteorder.h:123</a></div></div>
<div class="ttc" id="group__notify__payload_html_gab6c94f52cd7f074f81f537e08b89bdca"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#gab6c94f52cd7f074f81f537e08b89bdca">notify_type_t</a></div><div class="ttdeci">notify_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00038">notify_payload.h:38</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaadd77b29938fb795618e6ca0d3336e47b"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaadd77b29938fb795618e6ca0d3336e47b">MS_NOTIFY_STATUS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00086">notify_payload.h:86</a></div></div>
<div class="ttc" id="structfragment__payload__t_html_afb37e188ab4743682c07e2e0c0c16991"><div class="ttname"><a href="../../d1/dcf/structfragment__payload__t.html#afb37e188ab4743682c07e2e0c0c16991">fragment_payload_t::is_last</a></div><div class="ttdeci">bool(* is_last)(fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d93/fragment__payload_8h_source.html#l00059">fragment_payload.h:59</a></div></div>
<div class="ttc" id="structunknown__payload__t_html"><div class="ttname"><a href="../../d0/d76/structunknown__payload__t.html">unknown_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/unknown__payload_8h_source.html#l00038">unknown_payload.h:38</a></div></div>
<div class="ttc" id="structfragment__payload__t_html"><div class="ttname"><a href="../../d1/dcf/structfragment__payload__t.html">fragment_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d93/fragment__payload_8h_source.html#l00032">fragment_payload.h:32</a></div></div>
<div class="ttc" id="structcp__payload__t_html"><div class="ttname"><a href="../../d3/da4/structcp__payload__t.html">cp_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7e/cp__payload_8h_source.html#l00051">cp_payload.h:51</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a2b341e3994bfbc0aa8d680205abbd28b"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a></div><div class="ttdeci">u_int16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">duplicheck_msg.h:45</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__printf__hook__builtin_html_gaa367b75c5aed883fef5befbdf04835a4"><div class="ttname"><a href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a></div><div class="ttdeci">#define snprintf</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/printf__hook__builtin_8h_source.html#l00073">printf_hook_builtin.h:73</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="structencrypted__fragment__payload__t_html"><div class="ttname"><a href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00033">encrypted_fragment_payload.h:33</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6">PLV1_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00256">payload.h:256</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="group__payload_html_ga5866890f998a1941876bc0668e6850cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga5866890f998a1941876bc0668e6850cb">payload_type_short_names</a></div><div class="ttdeci">enum_name_t * payload_type_short_names</div></div>
<div class="ttc" id="group__leap_html_ga9cd8893869499290c1e5a8327e1b9eb6"><div class="ttname"><a href="../../d5/d4c/group__leap.html#ga9cd8893869499290c1e5a8327e1b9eb6">eap_code_short_names</a></div><div class="ttdeci">enum_name_t * eap_code_short_names</div></div>
<div class="ttc" id="group__cp__payload_html_gga0550b292138734e5738b9f29a2257f96a10fd13ea3fd8861e2afdbcc66fa8ef67"><div class="ttname"><a href="../../df/d04/group__cp__payload.html#gga0550b292138734e5738b9f29a2257f96a10fd13ea3fd8861e2afdbcc66fa8ef67">CFG_REPLY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7e/cp__payload_8h_source.html#l00038">cp_payload.h:38</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="structfragment__payload__t_html_a1cde01ec3e51460331a2bd3306e47d5d"><div class="ttname"><a href="../../d1/dcf/structfragment__payload__t.html#a1cde01ec3e51460331a2bd3306e47d5d">fragment_payload_t::get_number</a></div><div class="ttdeci">u_int8_t(* get_number)(fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d93/fragment__payload_8h_source.html#l00052">fragment_payload.h:52</a></div></div>
<div class="ttc" id="structeap__payload__t_html"><div class="ttname"><a href="../../d5/d42/structeap__payload__t.html">eap_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d12/eap__payload_8h_source.html#l00037">eap_payload.h:37</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="structconfiguration__attribute__t_html"><div class="ttname"><a href="../../dc/d48/structconfiguration__attribute__t.html">configuration_attribute_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7f/configuration__attribute_8h_source.html#l00034">configuration_attribute.h:34</a></div></div>
<div class="ttc" id="structunknown__payload__t_html_a7c687f093798d86b6dbfff069a268808"><div class="ttname"><a href="../../d0/d76/structunknown__payload__t.html#a7c687f093798d86b6dbfff069a268808">unknown_payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(unknown_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/unknown__payload_8h_source.html#l00050">unknown_payload.h:50</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a">PL_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00269">payload.h:269</a></div></div>
<div class="ttc" id="group__ike__header_html_ga70babeab66939657d7fb784231749dfc"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a></div><div class="ttdeci">enum_name_t * exchange_type_names</div></div>
</div><!-- fragment -->
<p><div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a482b1abf3fc6a6bc6ef02bbe5c309067_cgraph.svg" width="590" height="342"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a482b1abf3fc6a6bc6ef02bbe5c309067_icgraph.svg" width="400" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac8944b8c52386a8cb9f1fa878b62acd1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> is_connectivity_check </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2f/structpayload__t.html">payload_t</a> *&#160;</td>
          <td class="paramname"><em>payload</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if a payload is for a mediation extension connectivity check </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02218">2218</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00217">notify_payload_t::get_notify_type</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00117">INFORMATIONAL</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00171">ME_CONNECTAUTH</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00169">ME_CONNECTID</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00167">ME_ENDPOINT</a>, <a class="el" href="../../d4/da5/watcher_8c_source.html#l00192">notify()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00173">PLV2_NOTIFY</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02464">decrypt_payloads()</a>.</p>
<div class="fragment"><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;{</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="preprocessor">#ifdef ME</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">if</span> (this-&gt;exchange_type == <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aabafa167c373be5d40ae9641b2397d67478">INFORMATIONAL</a> &amp;&amp;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>)</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    {</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        <a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a> *<a class="code" href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a> = (<a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a>*)payload;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="keywordflow">switch</span> (notify-&gt;<a class="code" href="../../dc/d56/structnotify__payload__t.html#acba12460facded9439652c9c5af96dc2">get_notify_type</a>(notify))</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0572ed77b3e05a3b2714fb0611a1f9e8">ME_CONNECTID</a>:</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa7f4bd34810118eede5a47e2039d64f4">ME_ENDPOINT</a>:</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa63198554196f091c05c2d55dc72298ec">ME_CONNECTAUTH</a>:</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        }</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !ME */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa63198554196f091c05c2d55dc72298ec"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa63198554196f091c05c2d55dc72298ec">ME_CONNECTAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00171">notify_payload.h:171</a></div></div>
<div class="ttc" id="structnotify__payload__t_html_acba12460facded9439652c9c5af96dc2"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html#acba12460facded9439652c9c5af96dc2">notify_payload_t::get_notify_type</a></div><div class="ttdeci">notify_type_t(* get_notify_type)(notify_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00217">notify_payload.h:217</a></div></div>
<div class="ttc" id="structnotify__payload__t_html"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00192">notify_payload.h:192</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa0572ed77b3e05a3b2714fb0611a1f9e8"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0572ed77b3e05a3b2714fb0611a1f9e8">ME_CONNECTID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00169">notify_payload.h:169</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="watcher_8c_html_a8f0e10b20c0f4d75132f5af69278c063"><div class="ttname"><a href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a></div><div class="ttdeci">static void notify(private_watcher_t *this, entry_t *entry, watcher_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da5/watcher_8c_source.html#l00192">watcher.c:192</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aabafa167c373be5d40ae9641b2397d67478"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aabafa167c373be5d40ae9641b2397d67478">INFORMATIONAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00117">ike_header.h:117</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaaa7f4bd34810118eede5a47e2039d64f4"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa7f4bd34810118eede5a47e2039d64f4">ME_ENDPOINT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00167">notify_payload.h:167</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ac8944b8c52386a8cb9f1fa878b62acd1_cgraph.svg" width="648" height="342"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ac8944b8c52386a8cb9f1fa878b62acd1_icgraph.svg" width="464" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac91d0859890919608d04024adcc7e1fe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> merge_fragments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td>
          <td class="paramname"><em>last</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Merge the cached fragment data and resets the defragmentation state. Also updates the IP addresses to those of the last received fragment. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02746">2746</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../dc/dcc/array_8c_source.html#l00176">array_count()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00332">array_get()</a>, <a class="el" href="../../d3/d18/bio__writer_8c_source.html#l00224">bio_writer_create()</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00050">host_t::clone</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00959">fragment_t::data</a>, <a class="el" href="../../d5/dac/bio__writer_8h_source.html#l00158">bio_writer_t::destroy</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00643">dst</a>, <a class="el" href="../../d5/dac/bio__writer_8h_source.html#l00153">bio_writer_t::extract_buf</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00342">message_t::get_destination</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00322">message_t::get_source</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00969">reset_defrag()</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00642">src</a>, and <a class="el" href="../../d5/dac/bio__writer_8h_source.html#l00078">bio_writer_t::write_data</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02775">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;{</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <a class="code" href="../../d3/d6f/structfragment__t.html">fragment_t</a> *fragment;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <a class="code" href="../../d3/dd5/structbio__writer__t.html">bio_writer_t</a> *writer;</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a>, *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    writer = <a class="code" href="../../dd/d3c/group__bio__writer.html#gac7993ee5c686c5e28413eef0a03e1e89">bio_writer_create</a>(this-&gt;frag-&gt;len);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a>(this-&gt;fragments); i++)</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    {</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        <a class="code" href="../../d1/d0e/group__array.html#ga8f49cd8981e317a31801562481a983fe">array_get</a>(this-&gt;fragments, i, &amp;fragment);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        writer-&gt;<a class="code" href="../../d3/dd5/structbio__writer__t.html#ac23b8ff191e9d7abf091c8dc92faea05">write_data</a>(writer, fragment-&gt;<a class="code" href="../../d3/d6f/structfragment__t.html#a3c1f3166a7e9209be16e3498591f1767">data</a>);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    }</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    data = writer-&gt;<a class="code" href="../../d3/dd5/structbio__writer__t.html#aef91460456a04259f87bf2875a9b2e8e">extract_buf</a>(writer);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    writer-&gt;<a class="code" href="../../d3/dd5/structbio__writer__t.html#acb863252597911b4e4c2e71658cb5883">destroy</a>(writer);</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    <span class="comment">/* set addresses to those of the last fragment we received */</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    src = last-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a2a6d981602d6d21c229ee7890bd9da45">get_source</a>(last);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    dst = last-&gt;<a class="code" href="../../df/d23/structmessage__t.html#ad8708a37f8183186c0abe16d2c72ef30">get_destination</a>(last);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    this-&gt;packet-&gt;set_source(this-&gt;packet, src-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(src));</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    this-&gt;packet-&gt;set_destination(this-&gt;packet, dst-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(dst));</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <a class="code" href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(this-&gt;frag);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    this-&gt;frag = NULL;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;}</div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="structbio__writer__t_html_acb863252597911b4e4c2e71658cb5883"><div class="ttname"><a href="../../d3/dd5/structbio__writer__t.html#acb863252597911b4e4c2e71658cb5883">bio_writer_t::destroy</a></div><div class="ttdeci">void(* destroy)(bio_writer_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dac/bio__writer_8h_source.html#l00158">bio_writer.h:158</a></div></div>
<div class="ttc" id="group__array_html_ga37bb7fb1dde90d6fb84dac0027bb3606"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a></div><div class="ttdeci">int array_count(array_t *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00176">array.c:176</a></div></div>
<div class="ttc" id="message_8c_html_a7c1298a30209676eb847c2c4406e0a22"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a></div><div class="ttdeci">static void reset_defrag(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00969">message.c:969</a></div></div>
<div class="ttc" id="structhost__t_html_aebe9cd9ffd665b04e223c5e8b6ce7114"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">host_t::clone</a></div><div class="ttdeci">host_t *(* clone)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00050">host.h:50</a></div></div>
<div class="ttc" id="structmessage__t_html_ad8708a37f8183186c0abe16d2c72ef30"><div class="ttname"><a href="../../df/d23/structmessage__t.html#ad8708a37f8183186c0abe16d2c72ef30">message_t::get_destination</a></div><div class="ttdeci">host_t *(* get_destination)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00342">message.h:342</a></div></div>
<div class="ttc" id="structfragment__t_html_a3c1f3166a7e9209be16e3498591f1767"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html#a3c1f3166a7e9209be16e3498591f1767">fragment_t::data</a></div><div class="ttdeci">chunk_t data</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00959">message.c:959</a></div></div>
<div class="ttc" id="group__bio__writer_html_gac7993ee5c686c5e28413eef0a03e1e89"><div class="ttname"><a href="../../dd/d3c/group__bio__writer.html#gac7993ee5c686c5e28413eef0a03e1e89">bio_writer_create</a></div><div class="ttdeci">bio_writer_t * bio_writer_create(u_int32_t bufsize)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d18/bio__writer_8c_source.html#l00224">bio_writer.c:224</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="structmessage__t_html_a2a6d981602d6d21c229ee7890bd9da45"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a2a6d981602d6d21c229ee7890bd9da45">message_t::get_source</a></div><div class="ttdeci">host_t *(* get_source)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00322">message.h:322</a></div></div>
<div class="ttc" id="structbio__writer__t_html_ac23b8ff191e9d7abf091c8dc92faea05"><div class="ttname"><a href="../../d3/dd5/structbio__writer__t.html#ac23b8ff191e9d7abf091c8dc92faea05">bio_writer_t::write_data</a></div><div class="ttdeci">void(* write_data)(bio_writer_t *this, chunk_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dac/bio__writer_8h_source.html#l00078">bio_writer.h:78</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a2c489e7a93d1497f3690274e047e8aaf"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a></div><div class="ttdeci">struct sadb_address * dst</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00643">kernel_pfkey_ipsec.c:643</a></div></div>
<div class="ttc" id="structbio__writer__t_html_aef91460456a04259f87bf2875a9b2e8e"><div class="ttname"><a href="../../d3/dd5/structbio__writer__t.html#aef91460456a04259f87bf2875a9b2e8e">bio_writer_t::extract_buf</a></div><div class="ttdeci">chunk_t(* extract_buf)(bio_writer_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dac/bio__writer_8h_source.html#l00153">bio_writer.h:153</a></div></div>
<div class="ttc" id="structbio__writer__t_html"><div class="ttname"><a href="../../d3/dd5/structbio__writer__t.html">bio_writer_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dac/bio__writer_8h_source.html#l00036">bio_writer.h:36</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
<div class="ttc" id="structfragment__t_html"><div class="ttname"><a href="../../d3/d6f/structfragment__t.html">fragment_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00953">message.c:953</a></div></div>
<div class="ttc" id="group__array_html_ga8f49cd8981e317a31801562481a983fe"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga8f49cd8981e317a31801562481a983fe">array_get</a></div><div class="ttdeci">bool array_get(array_t *array, int idx, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00332">array.c:332</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a680c29c0890886d7c4130a706b5a97a0"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a></div><div class="ttdeci">struct sadb_address * src</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00642">kernel_pfkey_ipsec.c:642</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ac91d0859890919608d04024adcc7e1fe_cgraph.svg" width="100%" height="533"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-30" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ac91d0859890919608d04024adcc7e1fe_icgraph.svg" width="262" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aac6a3c893ccf084181f910de9d06cb34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_ike_sa_id&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *&#160;</td>
          <td class="paramname"><em>ike_sa_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01013">1013</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d4/db2/ike__sa__id_8h_source.html#l00117">ike_sa_id_t::clone</a>, and <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>.</p>
<div class="fragment"><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;{</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;ike_sa_id);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    this-&gt;ike_sa_id = ike_sa_id-&gt;<a class="code" href="../../dc/da6/structike__sa__id__t.html#abe6bdfd91b34d404f90f780344cdad6c">clone</a>(ike_sa_id);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;}</div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="structike__sa__id__t_html_abe6bdfd91b34d404f90f780344cdad6c"><div class="ttname"><a href="../../dc/da6/structike__sa__id__t.html#abe6bdfd91b34d404f90f780344cdad6c">ike_sa_id_t::clone</a></div><div class="ttdeci">ike_sa_id_t *(* clone)(ike_sa_id_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/db2/ike__sa__id_8h_source.html#l00117">ike_sa_id.h:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a102ed491cd3677f743791a84238aa58c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_ike_sa_id&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01020">1020</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;{</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">return</span> this-&gt;ike_sa_id;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a70e317774884c3f6897d203682d7edb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_message_id&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>message_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01026">1026</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;{</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    this-&gt;message_id = message_id;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a86098549feb9c126898b35579f270935"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_message_id&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01032">1032</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;{</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">return</span> this-&gt;message_id;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6f9010bc1b47cf91b52a934dc9afd072"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_initiator_spi&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01038">1038</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;{</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">return</span> (this-&gt;ike_sa_id-&gt;get_initiator_spi(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a6654d0c1dc57034d315b87d45218efd4">ike_sa_id</a>));</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;}</div>
<div class="ttc" id="structprivate__message__t_html_a6654d0c1dc57034d315b87d45218efd4"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#a6654d0c1dc57034d315b87d45218efd4">private_message_t::ike_sa_id</a></div><div class="ttdeci">ike_sa_id_t * ike_sa_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00911">message.c:911</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a33053520e0324e872e0df97ce5da2cf1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_responder_spi&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int64_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01044">1044</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;{</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">return</span> (this-&gt;ike_sa_id-&gt;get_responder_spi(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a6654d0c1dc57034d315b87d45218efd4">ike_sa_id</a>));</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;}</div>
<div class="ttc" id="structprivate__message__t_html_a6654d0c1dc57034d315b87d45218efd4"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#a6654d0c1dc57034d315b87d45218efd4">private_message_t::ike_sa_id</a></div><div class="ttdeci">ike_sa_id_t * ike_sa_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00911">message.c:911</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9e7a312e8b4d34a0b59c01d3340d3de4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_major_version&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>major_version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01050">1050</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;{</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    this-&gt;major_version = major_version;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab37046c767986eca8dce22ab42e96ef4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_major_version&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01056">1056</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;{</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="keywordflow">return</span> this-&gt;major_version;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4f8b3e59fc845389d8fbfd7cf2aa47b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_minor_version&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>minor_version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01062">1062</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;{</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    this-&gt;minor_version = minor_version;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a876229d434abd4096a628f03ded16211"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_minor_version&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01068">1068</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;{</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">return</span> this-&gt;minor_version;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91e09527bde32f25b2cbdd3b43ca7d15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_exchange_type&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d63/group__ike__header.html#ga7ac65c9d137f83d2cc8d0177749d3aab">exchange_type_t</a>&#160;</td>
          <td class="paramname"><em>exchange_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01074">1074</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;{</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    this-&gt;exchange_type = exchange_type;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3bc8d79261b9c7f5c4b0470f8cbefd52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_exchange_type&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d63/group__ike__header.html#ga7ac65c9d137f83d2cc8d0177749d3aab">exchange_type_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01080">1080</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;{</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">return</span> this-&gt;exchange_type;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a94ce4cd8818b37fc8d616d10e0fa2da1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_first_payload_type&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01086">1086</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">return</span> this-&gt;first_payload;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af952654ad3cc3ac5a719680851f600fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_request&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01092">1092</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../df/d12/mconsole_8c_source.html#l00091">request()</a>.</p>
<div class="fragment"><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;{</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    this-&gt;is_request = <a class="code" href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a>;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;}</div>
<div class="ttc" id="mconsole_8c_html_a251c32cfa402f283bd6349486d9caac0"><div class="ttname"><a href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a></div><div class="ttdeci">static int request(private_mconsole_t *this, void(*cb)(void *, char *, size_t), void *data, char *command,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d12/mconsole_8c_source.html#l00091">mconsole.c:91</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-31" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_af952654ad3cc3ac5a719680851f600fa_cgraph.svg" width="435" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5423f94cb34d32d6eeb522f8ef3cbac5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_request&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01098">1098</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;{</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">return</span> this-&gt;is_request;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae9a20770de3aecc1423d56c460fcf0fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_version_flag&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01104">1104</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;{</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    this-&gt;version_flag = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a10474850d49cd9040781f8ee46bc94d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_reserved_header_bit&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01110">1110</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d5/d60/utils_8h_source.html#l00147">countof</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l00180">reserved</a>.</p>
<div class="fragment"><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;{</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">if</span> (nr &lt; <a class="code" href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a>(this-&gt;<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>))</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>[nr];</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__utils__i_html_gab317c73e51fb8a68f86165ac831f7b8c"><div class="ttname"><a href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a></div><div class="ttdeci">#define countof(array)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00147">utils.h:147</a></div></div>
<div class="ttc" id="pkcs11_8h_html_a54b44b284e7b978df176ebf111fd52ae"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a></div><div class="ttdeci">#define reserved</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l00180">pkcs11.h:180</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a942681362ff8b4f8d7f3f8534bd9977f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_reserved_header_bit&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>nr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01120">1120</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d5/d60/utils_8h_source.html#l00147">countof</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l00180">reserved</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;{</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">if</span> (nr &lt; <a class="code" href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a>(this-&gt;<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>))</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        this-&gt;<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>[nr] = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;}</div>
<div class="ttc" id="group__utils__i_html_gab317c73e51fb8a68f86165ac831f7b8c"><div class="ttname"><a href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a></div><div class="ttdeci">#define countof(array)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00147">utils.h:147</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="pkcs11_8h_html_a54b44b284e7b978df176ebf111fd52ae"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a></div><div class="ttdeci">#define reserved</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l00180">pkcs11.h:180</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5435e3dd3193276738a67e6889fb6c25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">is_encoded&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01129">1129</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;{</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">return</span> this-&gt;packet-&gt;get_data(this-&gt;packet).ptr != NULL;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a57622794339721a03f04bac45a45d00e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">is_fragmented&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01135">1135</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../dc/dcc/array_8c_source.html#l00176">array_count()</a>.</p>
<div class="fragment"><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;{</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a>(this-&gt;fragments) &gt; 0;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;}</div>
<div class="ttc" id="group__array_html_ga37bb7fb1dde90d6fb84dac0027bb3606"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a></div><div class="ttdeci">int array_count(array_t *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00176">array.c:176</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-32" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a57622794339721a03f04bac45a45d00e_cgraph.svg" width="230" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae715e0f710ef02749697edc09a8cdc3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">add_payload&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2f/structpayload__t.html">payload_t</a> *&#160;</td>
          <td class="paramname"><em>payload</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01141">1141</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00048">PL_NONE</a>, and <a class="el" href="../../d4/d8b/payload_8h_source.html#l00375">payload_t::set_next_type</a>.</p>
<div class="fragment"><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;{</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *last_payload;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordflow">if</span> (this-&gt;payloads-&gt;get_count(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#aeef00a06d9807a91acdddd8707907932">payloads</a>) &gt; 0)</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    {</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        this-&gt;payloads-&gt;get_last(this-&gt;payloads, (<span class="keywordtype">void</span> **)&amp;last_payload);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        last_payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>(last_payload, payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload));</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        this-&gt;first_payload = payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>(payload, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a>);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    this-&gt;payloads-&gt;insert_last(this-&gt;payloads, payload);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a> ,<span class="stringliteral">&quot;added payload of type %N to message&quot;</span>,</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;         <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload));</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="structprivate__message__t_html_aeef00a06d9807a91acdddd8707907932"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#aeef00a06d9807a91acdddd8707907932">private_message_t::payloads</a></div><div class="ttdeci">linked_list_t * payloads</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00927">message.c:927</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="group__payload_html_ga397bd66f0cc14539cee30d16ae9b0bfa"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a></div><div class="ttdeci">enum_name_t * payload_type_names</div></div>
<div class="ttc" id="structpayload__t_html_a080809f324fbb7037d2aafed2a4f8fcc"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">payload_t::set_next_type</a></div><div class="ttdeci">void(* set_next_type)(payload_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00375">payload.h:375</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00048">payload.h:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaf7f4a028e2848f2acfe219f57958ecb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">add_notify&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>flush</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d2c/group__notify__payload.html#gab6c94f52cd7f074f81f537e08b89bdca">notify_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01162">1162</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d4/d8b/payload_8h_source.html#l00394">payload_t::destroy</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00045">IKEV2_MAJOR_VERSION</a>, <a class="el" href="../../d4/da5/watcher_8c_source.html#l00192">notify()</a>, <a class="el" href="../../db/d98/notify__payload_8c_source.html#l00714">notify_payload_create()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00103">PLV1_NOTIFY</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00173">PLV2_NOTIFY</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00278">notify_payload_t::set_notification_data</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00224">notify_payload_t::set_notify_type</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>
<div class="fragment"><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;{</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a> *<a class="code" href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">if</span> (flush)</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keywordflow">while</span> (this-&gt;payloads-&gt;remove_last(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#aeef00a06d9807a91acdddd8707907932">payloads</a>,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                                (<span class="keywordtype">void</span>**)&amp;payload) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a9848c240e1c7b47d3db1d39964b56995">destroy</a>(payload);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">if</span> (this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a>)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        notify = <a class="code" href="../../da/d2c/group__notify__payload.html#ga3fbf18951a2b31fadb0cb192cfb035dd">notify_payload_create</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>);</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        notify = <a class="code" href="../../da/d2c/group__notify__payload.html#ga3fbf18951a2b31fadb0cb192cfb035dd">notify_payload_create</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102">PLV1_NOTIFY</a>);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    notify-&gt;<a class="code" href="../../dc/d56/structnotify__payload__t.html#a33e15adc5cf5cedf8e9e7125a48e9f71">set_notify_type</a>(notify, <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    notify-&gt;<a class="code" href="../../dc/d56/structnotify__payload__t.html#a8e2310561ec266ca21b32530b890f734">set_notification_data</a>(notify, data);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    add_payload(<span class="keyword">this</span>, (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)notify);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;}</div>
<div class="ttc" id="structpayload__t_html_a9848c240e1c7b47d3db1d39964b56995"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a9848c240e1c7b47d3db1d39964b56995">payload_t::destroy</a></div><div class="ttdeci">void(* destroy)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00394">payload.h:394</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102">PLV1_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00103">payload.h:103</a></div></div>
<div class="ttc" id="structprivate__message__t_html_aeef00a06d9807a91acdddd8707907932"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#aeef00a06d9807a91acdddd8707907932">private_message_t::payloads</a></div><div class="ttdeci">linked_list_t * payloads</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00927">message.c:927</a></div></div>
<div class="ttc" id="group__notify__payload_html_ga3fbf18951a2b31fadb0cb192cfb035dd"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ga3fbf18951a2b31fadb0cb192cfb035dd">notify_payload_create</a></div><div class="ttdeci">notify_payload_t * notify_payload_create(payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d98/notify__payload_8c_source.html#l00714">notify_payload.c:714</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="structnotify__payload__t_html_a8e2310561ec266ca21b32530b890f734"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html#a8e2310561ec266ca21b32530b890f734">notify_payload_t::set_notification_data</a></div><div class="ttdeci">void(* set_notification_data)(notify_payload_t *this, chunk_t notification_data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00278">notify_payload.h:278</a></div></div>
<div class="ttc" id="structnotify__payload__t_html"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00192">notify_payload.h:192</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="watcher_8c_html_a8f0e10b20c0f4d75132f5af69278c063"><div class="ttname"><a href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a></div><div class="ttdeci">static void notify(private_watcher_t *this, entry_t *entry, watcher_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da5/watcher_8c_source.html#l00192">watcher.c:192</a></div></div>
<div class="ttc" id="group__ike__header_html_ga750bf45eb8428bbe3eefa03537d491e5"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a></div><div class="ttdeci">#define IKEV2_MAJOR_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00045">ike_header.h:45</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="structnotify__payload__t_html_a33e15adc5cf5cedf8e9e7125a48e9f71"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html#a33e15adc5cf5cedf8e9e7125a48e9f71">notify_payload_t::set_notify_type</a></div><div class="ttdeci">void(* set_notify_type)(notify_payload_t *this, notify_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00224">notify_payload.h:224</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-33" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_aaf7f4a028e2848f2acfe219f57958ecb_cgraph.svg" width="100%" height="594"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a37c9e3ce3edd6f36dacf42da1118ad39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_source&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>host</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01189">1189</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;{</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    this-&gt;packet-&gt;set_source(this-&gt;packet, host);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc2e55167342d42d2a8dee573a71005a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_destination&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>host</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01195">1195</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;{</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    this-&gt;packet-&gt;set_destination(this-&gt;packet, host);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a468a70bd034bfc1c56de7d1ab37fdd95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_source&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01201">1201</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;{</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">return</span> this-&gt;packet-&gt;get_source(this-&gt;packet);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad316348afda8668c18293010c33dd4ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_destination&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01207">1207</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;{</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">return</span> this-&gt;packet-&gt;get_destination(this-&gt;packet);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a858fb58760435d85a45bef5ed1ad4aa6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">create_payload_enumerator&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01213">1213</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;{</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">return</span> this-&gt;payloads-&gt;create_enumerator(this-&gt;payloads);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4d748b3d0c9acde3edbf16a12a7671a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">remove_payload_at&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *&#160;</td>
          <td class="paramname"><em>enumerator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01219">1219</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;{</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    this-&gt;payloads-&gt;remove_at(this-&gt;payloads, enumerator);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af24ce060d08047a4c227ef966e101969"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_payload&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d2f/structpayload__t.html">payload_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01225">1225</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../da/dfc/test__enum_8c_source.html#l00156">found</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, and <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>.</p>
<div class="fragment"><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;{</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *current, *<a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a> = NULL;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    enumerator = create_payload_enumerator(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;current))</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">if</span> (current-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(current) == <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            found = current;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;}</div>
<div class="ttc" id="test__enum_8c_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/test__enum_8c_source.html#l00156">test_enum.c:156</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a33fb580610bce177b1766f84ebc10003"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_notify&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d2c/group__notify__payload.html#gab6c94f52cd7f074f81f537e08b89bdca">notify_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01244">1244</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00217">notify_payload_t::get_notify_type</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d4/da5/watcher_8c_source.html#l00192">notify()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00103">PLV1_NOTIFY</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00173">PLV2_NOTIFY</a>, and <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>.</p>
<div class="fragment"><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;{</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a> *<a class="code" href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a> = NULL;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    enumerator = create_payload_enumerator(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a> ||</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102">PLV1_NOTIFY</a>)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            notify = (<a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a>*)payload;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="keywordflow">if</span> (notify-&gt;<a class="code" href="../../dc/d56/structnotify__payload__t.html#acba12460facded9439652c9c5af96dc2">get_notify_type</a>(notify) == <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>)</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            notify = NULL;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea36b8cf8eb2c8a419d6f3f02607f81102">PLV1_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00103">payload.h:103</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="structnotify__payload__t_html_acba12460facded9439652c9c5af96dc2"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html#acba12460facded9439652c9c5af96dc2">notify_payload_t::get_notify_type</a></div><div class="ttdeci">notify_type_t(* get_notify_type)(notify_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00217">notify_payload.h:217</a></div></div>
<div class="ttc" id="structnotify__payload__t_html"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00192">notify_payload.h:192</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="watcher_8c_html_a8f0e10b20c0f4d75132f5af69278c063"><div class="ttname"><a href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a></div><div class="ttdeci">static void notify(private_watcher_t *this, entry_t *entry, watcher_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da5/watcher_8c_source.html#l00192">watcher.c:192</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-34" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a33fb580610bce177b1766f84ebc10003_cgraph.svg" width="576" height="342"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3fbc0af87af04a57177965925438dcfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">disable_sort&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01471">1471</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;{</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    this-&gt;sort_disabled = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c683a50cbb2bc3b6108ed19b82a5cab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/dce/x509__pkcs10_8c.html#a353d21bcb86800e9d2707bebc9fb4c9c">generate</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *&#160;</td>
          <td class="paramname"><em>keymat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d88/structpacket__t.html">packet_t</a> **&#160;</td>
          <td class="paramname"><em>packet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01844">1844</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d3/d76/packet_8h_source.html#l00115">packet_t::clone</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01788">finalize_message()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>
<div class="fragment"><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;{</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <a class="code" href="../../d0/d70/structgenerator__t.html">generator_t</a> *generator = NULL;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encrypted = NULL;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    status = <a class="code" href="../../d0/d6d/message_8c.html#ace0bd3f2f46246ad6c4f8dfcad5b6621">generate_message</a>(<span class="keyword">this</span>, keymat, &amp;generator, &amp;encrypted);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    {</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(generator);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    status = <a class="code" href="../../d0/d6d/message_8c.html#ab502192691e076bfa0a75e1939a5d04b">finalize_message</a>(<span class="keyword">this</span>, keymat, generator, encrypted);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="keywordflow">if</span> (packet)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        *packet = this-&gt;packet-&gt;<a class="code" href="../../d7/d88/structpacket__t.html#af8509b331cdccc6639798b6fcf1b9eb6">clone</a>(this-&gt;packet);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    }</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;}</div>
<div class="ttc" id="structpacket__t_html_af8509b331cdccc6639798b6fcf1b9eb6"><div class="ttname"><a href="../../d7/d88/structpacket__t.html#af8509b331cdccc6639798b6fcf1b9eb6">packet_t::clone</a></div><div class="ttdeci">packet_t *(* clone)(packet_t *packet)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d76/packet_8h_source.html#l00115">packet.h:115</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="message_8c_html_ab502192691e076bfa0a75e1939a5d04b"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ab502192691e076bfa0a75e1939a5d04b">finalize_message</a></div><div class="ttdeci">static status_t finalize_message(private_message_t *this, keymat_t *keymat, generator_t *generator, encrypted_payload_t *encrypted)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01788">message.c:1788</a></div></div>
<div class="ttc" id="structgenerator__t_html"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html">generator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00042">generator.h:42</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="message_8c_html_ace0bd3f2f46246ad6c4f8dfcad5b6621"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ace0bd3f2f46246ad6c4f8dfcad5b6621">generate_message</a></div><div class="ttdeci">static status_t generate_message(private_message_t *this, keymat_t *keymat, generator_t **out_generator, encrypted_payload_t **encrypted)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01657">message.c:1657</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00037">encrypted_payload.h:37</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-35" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a5c683a50cbb2bc3b6108ed19b82a5cab_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac43eddb961afe2dff86eac30d38cdac9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fragment&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *&#160;</td>
          <td class="paramname"><em>keymat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>frag_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> **&#160;</td>
          <td class="paramname"><em>fragments</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01966">1966</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00161">array_create()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00242">array_create_enumerator()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00291">array_insert()</a>, <a class="el" href="../../db/d63/array_8h_source.html#l00045">ARRAY_TAIL</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00057">chunk_create()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00271">chunk_skip()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01953">clear_fragments()</a>, <a class="el" href="../../d1/d14/fetch_8c_source.html#l00022">count</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01895">create_fragment()</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00065">generator_t::destroy</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00110">encrypted_payload_t::destroy</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00410">message_t::destroy</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00643">dst</a>, <a class="el" href="../../de/d46/enumerator_8c_source.html#l00637">enumerator_create_single()</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01788">finalize_message()</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00258">message_t::generate</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00071">encrypted_payload_t::generate_payloads</a>, <a class="el" href="../../d3/d52/generator_8c_source.html#l00582">generator_create()</a>, <a class="el" href="../../d3/d52/generator_8c_source.html#l00605">generator_create_no_dbg()</a>, <a class="el" href="../../da/d39/keymat_8h_source.html#l00088">keymat_t::get_aead</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00079">aead_t::get_block_size</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00060">generator_t::get_chunk</a>, <a class="el" href="../../d3/d76/packet_8h_source.html#l00074">packet_t::get_data</a>, <a class="el" href="../../d3/d76/packet_8h_source.html#l00067">packet_t::get_destination</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00079">host_t::get_family</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00086">aead_t::get_icv_size</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00093">aead_t::get_iv_size</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00049">encrypted_payload_t::get_length</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00368">payload_t::get_next_type</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00102">host_t::get_port</a>, <a class="el" href="../../d3/d76/packet_8h_source.html#l00060">packet_t::get_source</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00035">IKEV1_MAJOR_VERSION</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00045">IKEV2_MAJOR_VERSION</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00185">IKEV2_UDP_PORT</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">len</a>, <a class="el" href="../../d1/ddf/align_8h_source.html#l00036">min</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00110">next</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00042">encrypted_payload_t::payload_interface</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00048">PL_NONE</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00198">PLV2_ENCRYPTED</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01962">REDUCE_FRAG_LEN</a>, <a class="el" href="../../d1/ddf/align_8h_source.html#l00063">round_down()</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00642">src</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>
<div class="fragment"><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;{</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encrypted = NULL;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <a class="code" href="../../d0/d70/structgenerator__t.html">generator_t</a> *generator = NULL;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <a class="code" href="../../df/d23/structmessage__t.html">message_t</a> *fragment;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <a class="code" href="../../d7/d88/structpacket__t.html">packet_t</a> *packet;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <a class="code" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="code" href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a> = <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a>;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    u_int16_t num, <a class="code" href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a>, *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    u_int32_t *lenpos;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    src = this-&gt;packet-&gt;<a class="code" href="../../d7/d88/structpacket__t.html#a5e3b5103daa8e5c4bedd73c2ee00651d">get_source</a>(this-&gt;packet);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    dst = this-&gt;packet-&gt;<a class="code" href="../../d7/d88/structpacket__t.html#ab647d499cdf2d33707dc772cc4a3ef3b">get_destination</a>(this-&gt;packet);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="keywordflow">if</span> (!frag_len)</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        frag_len = (src-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(src) == AF_INET) ? 576 : 1280;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <span class="comment">/* frag_len is the complete IP datagram length, account for overhead (we</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">     * assume no IP options/extension headers are used) */</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, (src-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(src) == AF_INET) ? 20 : 40);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="comment">/* 8 (UDP header) */</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, 8);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    <span class="keywordflow">if</span> (dst-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a52984b25f1f57af2ce1af7f2382a3524">get_port</a>(dst) != <a class="code" href="../../d0/db7/group__libcharon.html#ga2d25bf72f679d0f56c02c865d88914b7">IKEV2_UDP_PORT</a> &amp;&amp;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        src-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a52984b25f1f57af2ce1af7f2382a3524">get_port</a>(src) != <a class="code" href="../../d0/db7/group__libcharon.html#ga2d25bf72f679d0f56c02c865d88914b7">IKEV2_UDP_PORT</a>)</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    {   <span class="comment">/* reduce length due to non-ESP marker */</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, 4);</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keywordflow">if</span> (is_encoded(<span class="keyword">this</span>))</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    {</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="keywordflow">if</span> (this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a>)</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;            encrypted = (<a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a>*)get_payload(<span class="keyword">this</span>, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a>);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        data = this-&gt;packet-&gt;<a class="code" href="../../d7/d88/structpacket__t.html#ad7b3c4ef22ebac17b1104cfe8be4997f">get_data</a>(this-&gt;packet);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        len = data.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    {</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        status = <a class="code" href="../../d0/d6d/message_8c.html#ace0bd3f2f46246ad6c4f8dfcad5b6621">generate_message</a>(<span class="keyword">this</span>, keymat, &amp;generator, &amp;encrypted);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        {</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(generator);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        data = generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a90f85582f88eead65677e5ac095740b2">get_chunk</a>(generator, &amp;lenpos);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        len = data.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> + (encrypted ? encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">get_length</a>(encrypted) : 0);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">/* check if we actually need to fragment the message and if we have an</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">     * encrypted payload for IKEv2 */</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordflow">if</span> (len &lt;= frag_len ||</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;       (this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a> &amp;&amp; !encrypted))</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    {</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        <span class="keywordflow">if</span> (generator)</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            status = <a class="code" href="../../d0/d6d/message_8c.html#ab502192691e076bfa0a75e1939a5d04b">finalize_message</a>(<span class="keyword">this</span>, keymat, generator, encrypted);</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;            <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            {</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        }</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        *fragments = <a class="code" href="../../d3/de6/group__enumerator.html#ga84d904f94e6806d9b58c911e545f29c9">enumerator_create_single</a>(this-&gt;packet, NULL);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    }</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="comment">/* frag_len denoted the maximum IKE message size so far, later on it will</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">     * denote the maximum content size of a fragment payload, therefore,</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">     * account for IKE header */</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, 28);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keywordflow">if</span> (this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#gaf0d3ca24e19b97bea55bb93f1e531219">IKEV1_MAJOR_VERSION</a>)</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        <span class="keywordflow">if</span> (generator)</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;            status = <a class="code" href="../../d0/d6d/message_8c.html#ab502192691e076bfa0a75e1939a5d04b">finalize_message</a>(<span class="keyword">this</span>, keymat, generator, encrypted);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;            <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;            {</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;            }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            data = this-&gt;packet-&gt;<a class="code" href="../../d7/d88/structpacket__t.html#ad7b3c4ef22ebac17b1104cfe8be4997f">get_data</a>(this-&gt;packet);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;            generator = NULL;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;        }</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        <span class="comment">/* overhead for the fragmentation payload header */</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, 8);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    {</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <a class="code" href="../../d7/d7d/structaead__t.html">aead_t</a> *<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <span class="keywordflow">if</span> (generator)</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        {</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;            generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">destroy</a>(generator);</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            generator = <a class="code" href="../../dc/d21/group__generator.html#ga900fbdc44cd59d59e57330264448e53b">generator_create</a>();</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        }</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        {   <span class="comment">/* do not log again if it was generated previously */</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            generator = <a class="code" href="../../dc/d21/group__generator.html#ga9eda05f909e101ccdf5165fa763eb4c1">generator_create_no_dbg</a>();</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        next = encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a487edda678c9323ca8c09bf063b0fb22">payload_interface</a>.<a class="code" href="../../d7/d2f/structpayload__t.html#a3d4fed0210ddf9b275e99dbbd5f63c40">get_next_type</a>((<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)encrypted);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a06e9c120391d4de87de3c370eed77411">generate_payloads</a>(encrypted, generator);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        data = generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a90f85582f88eead65677e5ac095740b2">get_chunk</a>(generator, &amp;lenpos);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <span class="keywordflow">if</span> (!is_encoded(<span class="keyword">this</span>))</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;            encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a9af651f57dd7d06c5b85b7f634ad1fc2">destroy</a>(encrypted);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        aead = keymat-&gt;<a class="code" href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">get_aead</a>(keymat, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        <span class="comment">/* overhead for the encrypted fragment payload */</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, aead-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#a435a49016294655c08847b48d52bd2da">get_iv_size</a>(aead));</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, aead-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ac7f5836698d2db36a19bc6cea7adf156">get_icv_size</a>(aead));</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        <span class="comment">/* header */</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, 8);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <span class="comment">/* padding and padding length */</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        frag_len = <a class="code" href="../../da/dbd/group__align__i.html#ga385f1987ce11f57d873277c78b606da9">round_down</a>(frag_len, aead-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">get_block_size</a>(aead));</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a>(frag_len, 1);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="comment">/* TODO-FRAG: if there are unencrypted payloads, should we account for</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">         * their length in the first fragment? we still would have to add</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">         * an encrypted fragment payload (albeit empty), even so we couldn&#39;t</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment">         * prevent IP fragmentation in every case */</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    count = data.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> / frag_len + (data.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> % frag_len ? 1 : 0);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    this-&gt;fragments = <a class="code" href="../../d1/d0e/group__array.html#ga9acc78bc2e06102ff37133b5aa0e0a4f">array_create</a>(0, count);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;splitting IKE message with length of %zu bytes into &quot;</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;         <span class="stringliteral">&quot;%hu fragments&quot;</span>, len, count);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="keywordflow">for</span> (num = 1; num &lt;= <a class="code" href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>; num++)</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    {</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        len = <a class="code" href="../../da/dbd/group__align__i.html#gabb702d8b501669a23aa0ab3b281b9384">min</a>(data.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>, frag_len);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        fragment = <a class="code" href="../../d0/d6d/message_8c.html#a0a563e9cfc9b0287af285158f9e2f2be">create_fragment</a>(<span class="keyword">this</span>, next, num, count,</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                                   <a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(data.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>, len));</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        status = fragment-&gt;<a class="code" href="../../df/d23/structmessage__t.html#aae7838702ef7d9391825d8121da33799">generate</a>(fragment, keymat, &amp;packet);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        fragment-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a7b0d962cdedc3f301cba4a916a9768fb">destroy</a>(fragment);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        {</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;failed to generate IKE fragment&quot;</span>);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            <a class="code" href="../../d0/d6d/message_8c.html#a423da2b869370a56c247175103fe3390">clear_fragments</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(generator);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        <a class="code" href="../../d1/d0e/group__array.html#ga47238d69e35235b059ea47cdd82120e2">array_insert</a>(this-&gt;fragments, <a class="code" href="../../d1/d0e/group__array.html#gga7e863e36a9cd2f51b2e6b75b480ca277a75aa680cd4d00464234e2b3f1595030f">ARRAY_TAIL</a>, packet);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        data = <a class="code" href="../../d4/d87/group__chunk.html#gaaabd31666a00f250bb4a339c82373be8">chunk_skip</a>(data, len);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    *fragments = <a class="code" href="../../d1/d0e/group__array.html#ga58c74ec30d19f124535db5b5b94a1abc">array_create_enumerator</a>(this-&gt;fragments);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(generator);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;}</div>
<div class="ttc" id="structencrypted__payload__t_html_a487edda678c9323ca8c09bf063b0fb22"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#a487edda678c9323ca8c09bf063b0fb22">encrypted_payload_t::payload_interface</a></div><div class="ttdeci">payload_t payload_interface</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00042">encrypted_payload.h:42</a></div></div>
<div class="ttc" id="structaead__t_html_a435a49016294655c08847b48d52bd2da"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#a435a49016294655c08847b48d52bd2da">aead_t::get_iv_size</a></div><div class="ttdeci">size_t(* get_iv_size)(aead_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00093">aead.h:93</a></div></div>
<div class="ttc" id="group__align__i_html_ga385f1987ce11f57d873277c78b606da9"><div class="ttname"><a href="../../da/dbd/group__align__i.html#ga385f1987ce11f57d873277c78b606da9">round_down</a></div><div class="ttdeci">static size_t round_down(size_t size, size_t alignment)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/ddf/align_8h_source.html#l00063">align.h:63</a></div></div>
<div class="ttc" id="group__align__i_html_gabb702d8b501669a23aa0ab3b281b9384"><div class="ttname"><a href="../../da/dbd/group__align__i.html#gabb702d8b501669a23aa0ab3b281b9384">min</a></div><div class="ttdeci">#define min(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/ddf/align_8h_source.html#l00036">align.h:36</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="fetch_8c_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">static int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d14/fetch_8c_source.html#l00022">fetch.c:22</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="structmessage__t_html_a7b0d962cdedc3f301cba4a916a9768fb"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a7b0d962cdedc3f301cba4a916a9768fb">message_t::destroy</a></div><div class="ttdeci">void(* destroy)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00410">message.h:410</a></div></div>
<div class="ttc" id="group__array_html_ga58c74ec30d19f124535db5b5b94a1abc"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga58c74ec30d19f124535db5b5b94a1abc">array_create_enumerator</a></div><div class="ttdeci">enumerator_t * array_create_enumerator(array_t *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00242">array.c:242</a></div></div>
<div class="ttc" id="group__payload_html_ga910814947f5e241c851b42e95e8586ee"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a></div><div class="ttdeci">payload_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00043">payload.h:43</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="group__generator_html_ga9eda05f909e101ccdf5165fa763eb4c1"><div class="ttname"><a href="../../dc/d21/group__generator.html#ga9eda05f909e101ccdf5165fa763eb4c1">generator_create_no_dbg</a></div><div class="ttdeci">generator_t * generator_create_no_dbg()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d52/generator_8c_source.html#l00605">generator.c:605</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="structmessage__t_html_aae7838702ef7d9391825d8121da33799"><div class="ttname"><a href="../../df/d23/structmessage__t.html#aae7838702ef7d9391825d8121da33799">message_t::generate</a></div><div class="ttdeci">status_t(* generate)(message_t *this, keymat_t *keymat, packet_t **packet)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00258">message.h:258</a></div></div>
<div class="ttc" id="message_8c_html_a0a563e9cfc9b0287af285158f9e2f2be"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a0a563e9cfc9b0287af285158f9e2f2be">create_fragment</a></div><div class="ttdeci">static message_t * create_fragment(private_message_t *this, payload_type_t next, u_int16_t num, u_int16_t count, chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01895">message.c:1895</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_aae31f55ac8256ac61afcbbfbda554da7"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#aae31f55ac8256ac61afcbbfbda554da7">encrypted_payload_t::get_length</a></div><div class="ttdeci">size_t(* get_length)(encrypted_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00049">encrypted_payload.h:49</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structgenerator__t_html_aabd82edcd3cf7286b7e8a1ce7a2e8158"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">generator_t::destroy</a></div><div class="ttdeci">void(* destroy)(generator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00065">generator.h:65</a></div></div>
<div class="ttc" id="group__generator_html_ga900fbdc44cd59d59e57330264448e53b"><div class="ttname"><a href="../../dc/d21/group__generator.html#ga900fbdc44cd59d59e57330264448e53b">generator_create</a></div><div class="ttdeci">generator_t * generator_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d52/generator_8c_source.html#l00582">generator.c:582</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_a06e9c120391d4de87de3c370eed77411"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#a06e9c120391d4de87de3c370eed77411">encrypted_payload_t::generate_payloads</a></div><div class="ttdeci">void(* generate_payloads)(encrypted_payload_t *this, generator_t *generator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00071">encrypted_payload.h:71</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="structaead__t_html"><div class="ttname"><a href="../../d7/d7d/structaead__t.html">aead_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00037">aead.h:37</a></div></div>
<div class="ttc" id="structpayload__t_html_a3d4fed0210ddf9b275e99dbbd5f63c40"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a3d4fed0210ddf9b275e99dbbd5f63c40">payload_t::get_next_type</a></div><div class="ttdeci">payload_type_t(* get_next_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00368">payload.h:368</a></div></div>
<div class="ttc" id="group__enumerator_html_ga84d904f94e6806d9b58c911e545f29c9"><div class="ttname"><a href="../../d3/de6/group__enumerator.html#ga84d904f94e6806d9b58c911e545f29c9">enumerator_create_single</a></div><div class="ttdeci">enumerator_t * enumerator_create_single(void *item, void(*cleanup)(void *item))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d46/enumerator_8c_source.html#l00637">enumerator.c:637</a></div></div>
<div class="ttc" id="message_8c_html_a423da2b869370a56c247175103fe3390"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a423da2b869370a56c247175103fe3390">clear_fragments</a></div><div class="ttdeci">static void clear_fragments(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01953">message.c:1953</a></div></div>
<div class="ttc" id="group__chunk_html_gad94ca029616a107e89eaa618408fd7b6"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a></div><div class="ttdeci">static chunk_t chunk_create(u_char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00057">chunk.h:57</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="group__array_html_ga47238d69e35235b059ea47cdd82120e2"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga47238d69e35235b059ea47cdd82120e2">array_insert</a></div><div class="ttdeci">void array_insert(array_t *array, int idx, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00291">array.c:291</a></div></div>
<div class="ttc" id="group__ike__header_html_gaf0d3ca24e19b97bea55bb93f1e531219"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gaf0d3ca24e19b97bea55bb93f1e531219">IKEV1_MAJOR_VERSION</a></div><div class="ttdeci">#define IKEV1_MAJOR_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00035">ike_header.h:35</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structaead__t_html_ae6004b22fa9415839f9c0b6e16e48ae6"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">aead_t::get_block_size</a></div><div class="ttdeci">size_t(* get_block_size)(aead_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00079">aead.h:79</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_a9af651f57dd7d06c5b85b7f634ad1fc2"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#a9af651f57dd7d06c5b85b7f634ad1fc2">encrypted_payload_t::destroy</a></div><div class="ttdeci">void(* destroy)(encrypted_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00110">encrypted_payload.h:110</a></div></div>
<div class="ttc" id="structgenerator__t_html_a90f85582f88eead65677e5ac095740b2"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#a90f85582f88eead65677e5ac095740b2">generator_t::get_chunk</a></div><div class="ttdeci">chunk_t(* get_chunk)(generator_t *this, u_int32_t **lenpos)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00060">generator.h:60</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="group__array_html_ga9acc78bc2e06102ff37133b5aa0e0a4f"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga9acc78bc2e06102ff37133b5aa0e0a4f">array_create</a></div><div class="ttdeci">array_t * array_create(u_int esize, u_int8_t reserve)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00161">array.c:161</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a8ad91963e97959c834d908f0ac9cca66"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a></div><div class="ttdeci">memory_header_t * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00110">leak_detective.c:110</a></div></div>
<div class="ttc" id="message_8c_html_a7e5204ff05bf7fac32b7b74055b73065"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a7e5204ff05bf7fac32b7b74055b73065">REDUCE_FRAG_LEN</a></div><div class="ttdeci">#define REDUCE_FRAG_LEN(fl, amount)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01962">message.c:1962</a></div></div>
<div class="ttc" id="group__array_html_gga7e863e36a9cd2f51b2e6b75b480ca277a75aa680cd4d00464234e2b3f1595030f"><div class="ttname"><a href="../../d1/d0e/group__array.html#gga7e863e36a9cd2f51b2e6b75b480ca277a75aa680cd4d00464234e2b3f1595030f">ARRAY_TAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d63/array_8h_source.html#l00045">array.h:45</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a2b341e3994bfbc0aa8d680205abbd28b"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a></div><div class="ttdeci">u_int16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">duplicheck_msg.h:45</a></div></div>
<div class="ttc" id="group__ike__header_html_ga750bf45eb8428bbe3eefa03537d491e5"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a></div><div class="ttdeci">#define IKEV2_MAJOR_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00045">ike_header.h:45</a></div></div>
<div class="ttc" id="message_8c_html_ab502192691e076bfa0a75e1939a5d04b"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ab502192691e076bfa0a75e1939a5d04b">finalize_message</a></div><div class="ttdeci">static status_t finalize_message(private_message_t *this, keymat_t *keymat, generator_t *generator, encrypted_payload_t *encrypted)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01788">message.c:1788</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a2c489e7a93d1497f3690274e047e8aaf"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a></div><div class="ttdeci">struct sadb_address * dst</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00643">kernel_pfkey_ipsec.c:643</a></div></div>
<div class="ttc" id="structpacket__t_html_a5e3b5103daa8e5c4bedd73c2ee00651d"><div class="ttname"><a href="../../d7/d88/structpacket__t.html#a5e3b5103daa8e5c4bedd73c2ee00651d">packet_t::get_source</a></div><div class="ttdeci">host_t *(* get_source)(packet_t *packet)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d76/packet_8h_source.html#l00060">packet.h:60</a></div></div>
<div class="ttc" id="structaead__t_html_ac7f5836698d2db36a19bc6cea7adf156"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#ac7f5836698d2db36a19bc6cea7adf156">aead_t::get_icv_size</a></div><div class="ttdeci">size_t(* get_icv_size)(aead_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00086">aead.h:86</a></div></div>
<div class="ttc" id="group__chunk_html_gaaabd31666a00f250bb4a339c82373be8"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaaabd31666a00f250bb4a339c82373be8">chunk_skip</a></div><div class="ttdeci">static chunk_t chunk_skip(chunk_t chunk, size_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00271">chunk.h:271</a></div></div>
<div class="ttc" id="structgenerator__t_html"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html">generator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00042">generator.h:42</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
<div class="ttc" id="structpacket__t_html"><div class="ttname"><a href="../../d7/d88/structpacket__t.html">packet_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d76/packet_8h_source.html#l00039">packet.h:39</a></div></div>
<div class="ttc" id="structmessage__t_html"><div class="ttname"><a href="../../df/d23/structmessage__t.html">message_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00045">message.h:45</a></div></div>
<div class="ttc" id="group__libcharon_html_ga2d25bf72f679d0f56c02c865d88914b7"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga2d25bf72f679d0f56c02c865d88914b7">IKEV2_UDP_PORT</a></div><div class="ttdeci">#define IKEV2_UDP_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00185">daemon.h:185</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00048">payload.h:48</a></div></div>
<div class="ttc" id="structhost__t_html_a75956f3fa34ec58543cb717d7a6dbba6"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">host_t::get_family</a></div><div class="ttdeci">int(* get_family)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00079">host.h:79</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00198">payload.h:198</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="structpacket__t_html_ab647d499cdf2d33707dc772cc4a3ef3b"><div class="ttname"><a href="../../d7/d88/structpacket__t.html#ab647d499cdf2d33707dc772cc4a3ef3b">packet_t::get_destination</a></div><div class="ttdeci">host_t *(* get_destination)(packet_t *packet)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d76/packet_8h_source.html#l00067">packet.h:67</a></div></div>
<div class="ttc" id="message_8c_html_ace0bd3f2f46246ad6c4f8dfcad5b6621"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ace0bd3f2f46246ad6c4f8dfcad5b6621">generate_message</a></div><div class="ttdeci">static status_t generate_message(private_message_t *this, keymat_t *keymat, generator_t **out_generator, encrypted_payload_t **encrypted)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01657">message.c:1657</a></div></div>
<div class="ttc" id="structhost__t_html_a52984b25f1f57af2ce1af7f2382a3524"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a52984b25f1f57af2ce1af7f2382a3524">host_t::get_port</a></div><div class="ttdeci">u_int16_t(* get_port)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00102">host.h:102</a></div></div>
<div class="ttc" id="structkeymat__t_html_a0fbe23bc433e5f23d641638d47a682e3"><div class="ttname"><a href="../../d2/d63/structkeymat__t.html#a0fbe23bc433e5f23d641638d47a682e3">keymat_t::get_aead</a></div><div class="ttdeci">aead_t *(* get_aead)(keymat_t *this, bool in)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d39/keymat_8h_source.html#l00088">keymat.h:88</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a680c29c0890886d7c4130a706b5a97a0"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a></div><div class="ttdeci">struct sadb_address * src</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00642">kernel_pfkey_ipsec.c:642</a></div></div>
<div class="ttc" id="structpacket__t_html_ad7b3c4ef22ebac17b1104cfe8be4997f"><div class="ttname"><a href="../../d7/d88/structpacket__t.html#ad7b3c4ef22ebac17b1104cfe8be4997f">packet_t::get_data</a></div><div class="ttdeci">chunk_t(* get_data)(packet_t *packet)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d76/packet_8h_source.html#l00074">packet.h:74</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00037">encrypted_payload.h:37</a></div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-36" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ac43eddb961afe2dff86eac30d38cdac9_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab5cb08c76286c1aed390b894d964c622"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_packet&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d88/structpacket__t.html">packet_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02118">2118</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;{</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordflow">return</span> this-&gt;packet-&gt;clone(this-&gt;packet);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8ad93ee69d7220ba513a91ce95134c83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_packet_data&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02124">2124</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;{</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordflow">return</span> this-&gt;packet-&gt;get_data(this-&gt;packet);</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a401f958b80c6184c2459837b0a73740b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_fragments&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02130">2130</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../dc/dcc/array_8c_source.html#l00242">array_create_enumerator()</a>.</p>
<div class="fragment"><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;{</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d1/d0e/group__array.html#ga58c74ec30d19f124535db5b5b94a1abc">array_create_enumerator</a>(this-&gt;fragments);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;}</div>
<div class="ttc" id="group__array_html_ga58c74ec30d19f124535db5b5b94a1abc"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga58c74ec30d19f124535db5b5b94a1abc">array_create_enumerator</a></div><div class="ttdeci">enumerator_t * array_create_enumerator(array_t *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00242">array.c:242</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-37" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a401f958b80c6184c2459837b0a73740b_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2536f0440a9a31154ea9cc73a05de33a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">parse_header&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02136">2136</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d5/d60/utils_8h_source.html#l00147">countof</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00322">ike_header_t::destroy</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00254">ike_header_t::get_encryption_flag</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00296">ike_header_t::get_exchange_type</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00240">ike_header_t::get_initiator_flag</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00156">ike_header_t::get_initiator_spi</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00184">ike_header_t::get_maj_version</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00310">ike_header_t::get_message_id</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00198">ike_header_t::get_min_version</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00368">payload_t::get_next_type</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00170">ike_header_t::get_responder_spi</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00212">ike_header_t::get_response_flag</a>, <a class="el" href="../../d7/d05/ike__sa__id_8c_source.html#l00137">ike_sa_id_create()</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00035">IKEV1_MAJOR_VERSION</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00045">IKEV2_MAJOR_VERSION</a>, <a class="el" href="../../d7/da0/test__parser_8c_source.html#l00023">parser</a>, <a class="el" href="../../dc/df9/payload_8c_source.html#l00323">payload_get_field()</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00149">ike_header_t::payload_interface</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00264">PL_HEADER</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00256">PLV1_FRAGMENT</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l00180">reserved</a>, <a class="el" href="../../de/d06/encodings_8h_source.html#l00111">RESERVED_BIT</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, and <a class="el" href="../../d4/d8b/payload_8h_source.html#l00389">payload_t::verify</a>.</p>
<div class="fragment"><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;{</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <a class="code" href="../../d2/def/structike__header__t.html">ike_header_t</a> *ike_header;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="keywordtype">bool</span> *<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;parsing header of message&quot;</span>);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>)</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    {   <span class="comment">/* reassembled IKEv2 message, header is inherited from fragments */</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    }</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>-&gt;reset_context(this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    status = this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>-&gt;parse_payload(this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3fbb0444d5ec56e0d4770f7b32b1e2c6">PL_HEADER</a>,</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;                                         (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>**)&amp;ike_header);</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    {</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;header could not be parsed&quot;</span>);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    }</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    status = ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#ac619dea3e7f47ee938262fc6ef5b5d2d">payload_interface</a>.<a class="code" href="../../d7/d2f/structpayload__t.html#abc808c0f264c5dc2a96e7df177003462">verify</a>(</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                                        &amp;ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#ac619dea3e7f47ee938262fc6ef5b5d2d">payload_interface</a>);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;header verification failed&quot;</span>);</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#acc018b2e70e22b16c7cbdede5dc9446e">destroy</a>(ike_header);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    }</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;ike_sa_id);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    this-&gt;ike_sa_id = <a class="code" href="../../d1/d7f/group__ike__sa__id.html#gaa080d65d35119ab2dd69b73309c14566">ike_sa_id_create</a>(</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                                    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a22cf85877c9db99be8a869116198e6d2">get_maj_version</a>(ike_header),</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                                    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a4950bba1888b1eb853fdde236b79d65d">get_initiator_spi</a>(ike_header),</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                                    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#af4b20cc48a8f077fff53e7e18d90e56e">get_responder_spi</a>(ike_header),</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                                    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a229f76c69930b687b2e2e628b90e34aa">get_initiator_flag</a>(ike_header));</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    this-&gt;exchange_type = ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a3724a71e2f92ad05dfa685ae50545ec6">get_exchange_type</a>(ike_header);</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    this-&gt;message_id = ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a2cd4661763ef9c6953a8d625e88fbcd1">get_message_id</a>(ike_header);</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    this-&gt;major_version = ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a22cf85877c9db99be8a869116198e6d2">get_maj_version</a>(ike_header);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    this-&gt;minor_version = ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a8a4474e38da81ef41a1ef7dab4ecbfee">get_min_version</a>(ike_header);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordflow">if</span> (this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a>)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        this-&gt;is_request = !ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a6beac1b87b8d2548793c3c305ee785a5">get_response_flag</a>(ike_header);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    }</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        this-&gt;is_encrypted = ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#a8537967dff6192e2fdc775438f8a1b6c">get_encryption_flag</a>(ike_header);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    }</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    this-&gt;first_payload = ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#ac619dea3e7f47ee938262fc6ef5b5d2d">payload_interface</a>.<a class="code" href="../../d7/d2f/structpayload__t.html#a3d4fed0210ddf9b275e99dbbd5f63c40">get_next_type</a>(</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                                                &amp;ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#ac619dea3e7f47ee938262fc6ef5b5d2d">payload_interface</a>);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keywordflow">if</span> (this-&gt;first_payload == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6">PLV1_FRAGMENT</a> &amp;&amp; this-&gt;is_encrypted)</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    {   <span class="comment">/* racoon sets the encrypted bit when sending a fragment, but these</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">         * messages are really not encrypted */</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        this-&gt;is_encrypted = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    }</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a>(this-&gt;reserved); i++)</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        reserved = <a class="code" href="../../d0/d90/group__payload.html#gaf219216dcbe0be7f4d5151ba6cdf0371">payload_get_field</a>(&amp;ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#ac619dea3e7f47ee938262fc6ef5b5d2d">payload_interface</a>,</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                                     <a class="code" href="../../d2/d9b/group__encodings.html#gga602a25541a259798b77981836d6cb73faaec4bd3abdbfdf06b2a00ebfc115e0a8">RESERVED_BIT</a>, i);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        <span class="keywordflow">if</span> (reserved)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            this-&gt;reserved[i] = *<a class="code" href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a>;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    }</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    ike_header-&gt;<a class="code" href="../../d2/def/structike__header__t.html#acc018b2e70e22b16c7cbdede5dc9446e">destroy</a>(ike_header);</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>-&gt;set_major_version(this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>, this-&gt;major_version);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;parsed a %N %s header&quot;</span>, <a class="code" href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a>,</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;         this-&gt;exchange_type, this-&gt;major_version == <a class="code" href="../../d3/d63/group__ike__header.html#gaf0d3ca24e19b97bea55bb93f1e531219">IKEV1_MAJOR_VERSION</a> ?</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;         <span class="stringliteral">&quot;message&quot;</span> : (this-&gt;is_request ? <span class="stringliteral">&quot;request&quot;</span> : <span class="stringliteral">&quot;response&quot;</span>));</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="structike__header__t_html_a229f76c69930b687b2e2e628b90e34aa"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a229f76c69930b687b2e2e628b90e34aa">ike_header_t::get_initiator_flag</a></div><div class="ttdeci">bool(* get_initiator_flag)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00240">ike_header.h:240</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structike__header__t_html_af4b20cc48a8f077fff53e7e18d90e56e"><div class="ttname"><a href="../../d2/def/structike__header__t.html#af4b20cc48a8f077fff53e7e18d90e56e">ike_header_t::get_responder_spi</a></div><div class="ttdeci">u_int64_t(* get_responder_spi)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00170">ike_header.h:170</a></div></div>
<div class="ttc" id="structike__header__t_html_acc018b2e70e22b16c7cbdede5dc9446e"><div class="ttname"><a href="../../d2/def/structike__header__t.html#acc018b2e70e22b16c7cbdede5dc9446e">ike_header_t::destroy</a></div><div class="ttdeci">void(* destroy)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00322">ike_header.h:322</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="group__utils__i_html_gab317c73e51fb8a68f86165ac831f7b8c"><div class="ttname"><a href="../../d6/d87/group__utils__i.html#gab317c73e51fb8a68f86165ac831f7b8c">countof</a></div><div class="ttdeci">#define countof(array)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00147">utils.h:147</a></div></div>
<div class="ttc" id="structike__header__t_html_a22cf85877c9db99be8a869116198e6d2"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a22cf85877c9db99be8a869116198e6d2">ike_header_t::get_maj_version</a></div><div class="ttdeci">u_int8_t(* get_maj_version)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00184">ike_header.h:184</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3fbb0444d5ec56e0d4770f7b32b1e2c6"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3fbb0444d5ec56e0d4770f7b32b1e2c6">PL_HEADER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00264">payload.h:264</a></div></div>
<div class="ttc" id="structike__header__t_html_a2cd4661763ef9c6953a8d625e88fbcd1"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a2cd4661763ef9c6953a8d625e88fbcd1">ike_header_t::get_message_id</a></div><div class="ttdeci">u_int32_t(* get_message_id)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00310">ike_header.h:310</a></div></div>
<div class="ttc" id="test__parser_8c_html_a40ea9d08a07e5802dbf8c0ff3ecbeb0f"><div class="ttname"><a href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a></div><div class="ttdeci">static conf_parser_t * parser</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da0/test__parser_8c_source.html#l00023">test_parser.c:23</a></div></div>
<div class="ttc" id="structpayload__t_html_a3d4fed0210ddf9b275e99dbbd5f63c40"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a3d4fed0210ddf9b275e99dbbd5f63c40">payload_t::get_next_type</a></div><div class="ttdeci">payload_type_t(* get_next_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00368">payload.h:368</a></div></div>
<div class="ttc" id="group__ike__header_html_gaf0d3ca24e19b97bea55bb93f1e531219"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gaf0d3ca24e19b97bea55bb93f1e531219">IKEV1_MAJOR_VERSION</a></div><div class="ttdeci">#define IKEV1_MAJOR_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00035">ike_header.h:35</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="structike__header__t_html_a8537967dff6192e2fdc775438f8a1b6c"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a8537967dff6192e2fdc775438f8a1b6c">ike_header_t::get_encryption_flag</a></div><div class="ttdeci">bool(* get_encryption_flag)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00254">ike_header.h:254</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="structike__header__t_html_a6beac1b87b8d2548793c3c305ee785a5"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a6beac1b87b8d2548793c3c305ee785a5">ike_header_t::get_response_flag</a></div><div class="ttdeci">bool(* get_response_flag)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00212">ike_header.h:212</a></div></div>
<div class="ttc" id="structpayload__t_html_abc808c0f264c5dc2a96e7df177003462"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#abc808c0f264c5dc2a96e7df177003462">payload_t::verify</a></div><div class="ttdeci">status_t(* verify)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00389">payload.h:389</a></div></div>
<div class="ttc" id="group__ike__header_html_ga750bf45eb8428bbe3eefa03537d491e5"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga750bf45eb8428bbe3eefa03537d491e5">IKEV2_MAJOR_VERSION</a></div><div class="ttdeci">#define IKEV2_MAJOR_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00045">ike_header.h:45</a></div></div>
<div class="ttc" id="group__ike__sa__id_html_gaa080d65d35119ab2dd69b73309c14566"><div class="ttname"><a href="../../d1/d7f/group__ike__sa__id.html#gaa080d65d35119ab2dd69b73309c14566">ike_sa_id_create</a></div><div class="ttdeci">ike_sa_id_t * ike_sa_id_create(u_int8_t ike_version, u_int64_t initiator_spi, u_int64_t responder_spi, bool is_initiator_flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d05/ike__sa__id_8c_source.html#l00137">ike_sa_id.c:137</a></div></div>
<div class="ttc" id="pkcs11_8h_html_a54b44b284e7b978df176ebf111fd52ae"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#a54b44b284e7b978df176ebf111fd52ae">reserved</a></div><div class="ttdeci">#define reserved</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l00180">pkcs11.h:180</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6">PLV1_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00256">payload.h:256</a></div></div>
<div class="ttc" id="group__encodings_html_gga602a25541a259798b77981836d6cb73faaec4bd3abdbfdf06b2a00ebfc115e0a8"><div class="ttname"><a href="../../d2/d9b/group__encodings.html#gga602a25541a259798b77981836d6cb73faaec4bd3abdbfdf06b2a00ebfc115e0a8">RESERVED_BIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/encodings_8h_source.html#l00111">encodings.h:111</a></div></div>
<div class="ttc" id="group__payload_html_gaf219216dcbe0be7f4d5151ba6cdf0371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gaf219216dcbe0be7f4d5151ba6cdf0371">payload_get_field</a></div><div class="ttdeci">void * payload_get_field(payload_t *payload, encoding_type_t type, u_int skip)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df9/payload_8c_source.html#l00323">payload.c:323</a></div></div>
<div class="ttc" id="structike__header__t_html_ac619dea3e7f47ee938262fc6ef5b5d2d"><div class="ttname"><a href="../../d2/def/structike__header__t.html#ac619dea3e7f47ee938262fc6ef5b5d2d">ike_header_t::payload_interface</a></div><div class="ttdeci">payload_t payload_interface</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00149">ike_header.h:149</a></div></div>
<div class="ttc" id="structike__header__t_html_a4950bba1888b1eb853fdde236b79d65d"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a4950bba1888b1eb853fdde236b79d65d">ike_header_t::get_initiator_spi</a></div><div class="ttdeci">u_int64_t(* get_initiator_spi)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00156">ike_header.h:156</a></div></div>
<div class="ttc" id="structike__header__t_html"><div class="ttname"><a href="../../d2/def/structike__header__t.html">ike_header_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00145">ike_header.h:145</a></div></div>
<div class="ttc" id="structike__header__t_html_a8a4474e38da81ef41a1ef7dab4ecbfee"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a8a4474e38da81ef41a1ef7dab4ecbfee">ike_header_t::get_min_version</a></div><div class="ttdeci">u_int8_t(* get_min_version)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00198">ike_header.h:198</a></div></div>
<div class="ttc" id="structike__header__t_html_a3724a71e2f92ad05dfa685ae50545ec6"><div class="ttname"><a href="../../d2/def/structike__header__t.html#a3724a71e2f92ad05dfa685ae50545ec6">ike_header_t::get_exchange_type</a></div><div class="ttdeci">u_int8_t(* get_exchange_type)(ike_header_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00296">ike_header.h:296</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="group__ike__header_html_ga70babeab66939657d7fb784231749dfc"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a></div><div class="ttdeci">enum_name_t * exchange_type_names</div></div>
</div><!-- fragment -->
<p><div id="dynsection-38" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a2536f0440a9a31154ea9cc73a05de33a_cgraph.svg" width="262" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0d3da12f5f1d7965d8bd7c39a0ee10fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">parse_body&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> *&#160;</td>
          <td class="paramname"><em>keymat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02612">2612</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d5/d60/utils_8h_source.html#l00092">BUF_LEN</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00319">chunk_equals_const()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00155">keymat_v1_t::confirm_iv</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00059">DBG3</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02464">decrypt_payloads()</a>, <a class="el" href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../dd/d54/hash__payload_8h_source.html#l00051">hash_payload_t::get_hash</a>, <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00118">keymat_v1_t::get_hash_phase2</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00980">get_message_rule()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01272">get_string()</a>, <a class="el" href="../../da/d39/keymat_8h_source.html#l00052">keymat_t::get_version</a>, <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l01215">hash</a>, <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00044">IKEV1</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00082">INFORMATIONAL_V1</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00040">NOT_SUPPORTED</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02243">parse_payloads()</a>, <a class="el" href="../../d7/da0/test__parser_8c_source.html#l00023">parser</a>, <a class="el" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00088">PLV1_HASH</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, <a class="el" href="../../d9/d7b/settings__lexer_8c_source.html#l00645">str</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02559">verify()</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00048">VERIFY_ERROR</a>.</p>
<div class="fragment"><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;{</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="../../d9/d7b/settings__lexer_8c.html#a94688a4a25a03cfbc6929fe15b1f8df0">str</a>[<a class="code" href="../../d6/d87/group__utils__i.html#ga8b5839f71a3b6e7d64b2d5e9967e3dd1">BUF_LEN</a>];</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;parsing body of message, first payload is %N&quot;</span>,</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;         <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, this-&gt;first_payload);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    this-&gt;rule = <a class="code" href="../../d0/d6d/message_8c.html#aef38b51cc48772f0530dabb1a53dbb52">get_message_rule</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;rule)</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    {</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;no message rules specified for a %N %s&quot;</span>,</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;             <a class="code" href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a>, this-&gt;exchange_type,</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;             this-&gt;is_request ? <span class="stringliteral">&quot;request&quot;</span> : <span class="stringliteral">&quot;response&quot;</span>);</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a9bf1138c8c1f4519e5b814514b750ca3">NOT_SUPPORTED</a>;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    }</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="comment">/* reassembled IKEv2 messages are already parsed (except for the payloads</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment">     * contained in the encrypted payload, which are handled below) */</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>)</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    {</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        status = <a class="code" href="../../d0/d6d/message_8c.html#a44720d7d2b793ce08b703694683ec0a6">parse_payloads</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        {   <span class="comment">/* error is already logged */</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        }</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    status = <a class="code" href="../../d0/d6d/message_8c.html#a574b26ea7b254ebdfad14c73f6caf99d">decrypt_payloads</a>(<span class="keyword">this</span>, keymat);</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    {</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;could not decrypt payloads&quot;</span>);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    }</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    status = <a class="code" href="../../d0/d6d/message_8c.html#a48b41cdef3c57a4d00b378e7d9da1f8b">verify</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    {</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    }</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;parsed %s&quot;</span>, <a class="code" href="../../d0/d6d/message_8c.html#a482b1abf3fc6a6bc6ef02bbe5c309067">get_string</a>(<span class="keyword">this</span>, str, <span class="keyword">sizeof</span>(str)));</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    <span class="keywordflow">if</span> (keymat &amp;&amp; keymat-&gt;<a class="code" href="../../d2/d63/structkeymat__t.html#acbb299aa2628908de03d17f807a6b949">get_version</a>(keymat) == <a class="code" href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a>)</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    {</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <a class="code" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *keymat_v1 = (<a class="code" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>*)keymat;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d4/d58/tls__crypto_8c.html#afdf31b993d57256d72c36a66ed2bf4d4">hash</a>;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        <span class="keywordflow">if</span> (keymat_v1-&gt;<a class="code" href="../../d8/dce/structkeymat__v1__t.html#aefa2b8c913f0dc188364a0823950e2b8">get_hash_phase2</a>(keymat_v1, &amp;this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#adcce362c21caa0fc13c5096626be0727">public</a>, &amp;hash))</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        {</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            <a class="code" href="../../dc/d77/structhash__payload__t.html">hash_payload_t</a> *hash_payload;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;            <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> other_hash;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;            <span class="keywordflow">if</span> (this-&gt;first_payload != <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a>)</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            {</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;                <span class="keywordflow">if</span> (this-&gt;exchange_type == <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a>)</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;                {</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;                    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;ignoring unprotected INFORMATIONAL from %H&quot;</span>,</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                         this-&gt;packet-&gt;get_source(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#aeb2f3f6d2defc37da6130d09ee863525">packet</a>));</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                }</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;expected HASH payload as first payload&quot;</span>);</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                }</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;hash);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;            }</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            hash_payload = (<a class="code" href="../../dc/d77/structhash__payload__t.html">hash_payload_t</a>*)get_payload(<span class="keyword">this</span>, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a>);</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            other_hash = hash_payload-&gt;<a class="code" href="../../dc/d77/structhash__payload__t.html#a5385e68663f1032993ca943075e6a262">get_hash</a>(hash_payload);</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gae1a8fc8c690a2b5690bd1dad92492367">DBG3</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;HASH received %B\nHASH expected %B&quot;</span>,</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                 &amp;other_hash, &amp;hash);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d87/group__chunk.html#gaef4ef97b1a4298f2b3aacb9fe48a2c85">chunk_equals_const</a>(hash, other_hash))</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            {</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;received HASH payload does not match&quot;</span>);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;hash);</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            }</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;hash);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        }</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="keywordflow">if</span> (this-&gt;is_encrypted &amp;&amp; this-&gt;exchange_type != <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a>)</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        {   <span class="comment">/* message verified, confirm IV */</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            <span class="keywordflow">if</span> (!keymat_v1-&gt;<a class="code" href="../../d8/dce/structkeymat__v1__t.html#aa50f2640e99013027ec859e348ffcdc1">confirm_iv</a>(keymat_v1, this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">message_id</a>))</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;            {</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;            }</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        }</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html_aefa2b8c913f0dc188364a0823950e2b8"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html#aefa2b8c913f0dc188364a0823950e2b8">keymat_v1_t::get_hash_phase2</a></div><div class="ttdeci">bool(* get_hash_phase2)(keymat_v1_t *this, message_t *message, chunk_t *hash)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00118">keymat_v1.h:118</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00088">payload.h:88</a></div></div>
<div class="ttc" id="group__ike__cfg_html_ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00044">ike_cfg.h:44</a></div></div>
<div class="ttc" id="settings__lexer_8c_html_a94688a4a25a03cfbc6929fe15b1f8df0"><div class="ttname"><a href="../../d9/d7b/settings__lexer_8c.html#a94688a4a25a03cfbc6929fe15b1f8df0">str</a></div><div class="ttdeci">#define str</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7b/settings__lexer_8c_source.html#l00645">settings_lexer.c:645</a></div></div>
<div class="ttc" id="message_8c_html_a48b41cdef3c57a4d00b378e7d9da1f8b"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a48b41cdef3c57a4d00b378e7d9da1f8b">verify</a></div><div class="ttdeci">static status_t verify(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02559">message.c:2559</a></div></div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="structprivate__message__t_html_aeb2f3f6d2defc37da6130d09ee863525"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#aeb2f3f6d2defc37da6130d09ee863525">private_message_t::packet</a></div><div class="ttdeci">packet_t * packet</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00916">message.c:916</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="group__payload_html_ga397bd66f0cc14539cee30d16ae9b0bfa"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a></div><div class="ttdeci">enum_name_t * payload_type_names</div></div>
<div class="ttc" id="structhash__payload__t_html_a5385e68663f1032993ca943075e6a262"><div class="ttname"><a href="../../dc/d77/structhash__payload__t.html#a5385e68663f1032993ca943075e6a262">hash_payload_t::get_hash</a></div><div class="ttdeci">chunk_t(* get_hash)(hash_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d54/hash__payload_8h_source.html#l00051">hash_payload.h:51</a></div></div>
<div class="ttc" id="tls__crypto_8c_html_afdf31b993d57256d72c36a66ed2bf4d4"><div class="ttname"><a href="../../d4/d58/tls__crypto_8c.html#afdf31b993d57256d72c36a66ed2bf4d4">hash</a></div><div class="ttdeci">tls_hash_algorithm_t hash</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d58/tls__crypto_8c_source.html#l01215">tls_crypto.c:1215</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00082">ike_header.h:82</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a9bf1138c8c1f4519e5b814514b750ca3"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a9bf1138c8c1f4519e5b814514b750ca3">NOT_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00040">status.h:40</a></div></div>
<div class="ttc" id="structprivate__message__t_html_a260d5d2f83563517f7a522324fb1c8be"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#a260d5d2f83563517f7a522324fb1c8be">private_message_t::message_id</a></div><div class="ttdeci">u_int32_t message_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00906">message.c:906</a></div></div>
<div class="ttc" id="test__parser_8c_html_a40ea9d08a07e5802dbf8c0ff3ecbeb0f"><div class="ttname"><a href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a></div><div class="ttdeci">static conf_parser_t * parser</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da0/test__parser_8c_source.html#l00023">test_parser.c:23</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html_aa50f2640e99013027ec859e348ffcdc1"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html#aa50f2640e99013027ec859e348ffcdc1">keymat_v1_t::confirm_iv</a></div><div class="ttdeci">bool(* confirm_iv)(keymat_v1_t *this, u_int32_t mid)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00155">keymat_v1.h:155</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structprivate__message__t_html_adcce362c21caa0fc13c5096626be0727"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#adcce362c21caa0fc13c5096626be0727">private_message_t::public</a></div><div class="ttdeci">message_t public</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00856">message.c:856</a></div></div>
<div class="ttc" id="structhash__payload__t_html"><div class="ttname"><a href="../../dc/d77/structhash__payload__t.html">hash_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d54/hash__payload_8h_source.html#l00032">hash_payload.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="message_8c_html_a574b26ea7b254ebdfad14c73f6caf99d"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a574b26ea7b254ebdfad14c73f6caf99d">decrypt_payloads</a></div><div class="ttdeci">static status_t decrypt_payloads(private_message_t *this, keymat_t *keymat)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02464">message.c:2464</a></div></div>
<div class="ttc" id="group__utils__i_html_ga8b5839f71a3b6e7d64b2d5e9967e3dd1"><div class="ttname"><a href="../../d6/d87/group__utils__i.html#ga8b5839f71a3b6e7d64b2d5e9967e3dd1">BUF_LEN</a></div><div class="ttdeci">#define BUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00092">utils.h:92</a></div></div>
<div class="ttc" id="message_8c_html_a482b1abf3fc6a6bc6ef02bbe5c309067"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a482b1abf3fc6a6bc6ef02bbe5c309067">get_string</a></div><div class="ttdeci">static char * get_string(private_message_t *this, char *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01272">message.c:1272</a></div></div>
<div class="ttc" id="group__chunk_html_gaef4ef97b1a4298f2b3aacb9fe48a2c85"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaef4ef97b1a4298f2b3aacb9fe48a2c85">chunk_equals_const</a></div><div class="ttdeci">static bool chunk_equals_const(chunk_t a, chunk_t b)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00319">chunk.h:319</a></div></div>
<div class="ttc" id="group__bus_html_gae1a8fc8c690a2b5690bd1dad92492367"><div class="ttname"><a href="../../de/d50/group__bus.html#gae1a8fc8c690a2b5690bd1dad92492367">DBG3</a></div><div class="ttdeci">#define DBG3(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00059">bus.h:59</a></div></div>
<div class="ttc" id="message_8c_html_aef38b51cc48772f0530dabb1a53dbb52"><div class="ttname"><a href="../../d0/d6d/message_8c.html#aef38b51cc48772f0530dabb1a53dbb52">get_message_rule</a></div><div class="ttdeci">static message_rule_t * get_message_rule(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00980">message.c:980</a></div></div>
<div class="ttc" id="structkeymat__t_html_acbb299aa2628908de03d17f807a6b949"><div class="ttname"><a href="../../d2/d63/structkeymat__t.html#acbb299aa2628908de03d17f807a6b949">keymat_t::get_version</a></div><div class="ttdeci">ike_version_t(* get_version)(keymat_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d39/keymat_8h_source.html#l00052">keymat.h:52</a></div></div>
<div class="ttc" id="structkeymat__v1__t_html"><div class="ttname"><a href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/da7/keymat__v1_8h_source.html#l00032">keymat_v1.h:32</a></div></div>
<div class="ttc" id="message_8c_html_a44720d7d2b793ce08b703694683ec0a6"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a44720d7d2b793ce08b703694683ec0a6">parse_payloads</a></div><div class="ttdeci">static status_t parse_payloads(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02243">message.c:2243</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="group__ike__header_html_ga70babeab66939657d7fb784231749dfc"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a></div><div class="ttdeci">enum_name_t * exchange_type_names</div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00048">status.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-39" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a0d3da12f5f1d7965d8bd7c39a0ee10fd_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a25aa04281d47a67d202211b65f200c49"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">add_fragment_v1&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02775">2775</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d0/d6d/message_8c_source.html#l02706">add_fragment()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00176">array_count()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00161">array_create()</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00040">DBG_IKE</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../df/d93/fragment__payload_8h_source.html#l00066">fragment_payload_t::get_data</a>, <a class="el" href="../../df/d93/fragment__payload_8h_source.html#l00045">fragment_payload_t::get_id</a>, <a class="el" href="../../df/d93/fragment__payload_8h_source.html#l00052">fragment_payload_t::get_number</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00376">message_t::get_payload</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00042">INVALID_ARG</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00050">INVALID_STATE</a>, <a class="el" href="../../df/d93/fragment__payload_8h_source.html#l00059">fragment_payload_t::is_last</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02746">merge_fragments()</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00054">NEED_MORE</a>, <a class="el" href="../../d7/da0/test__parser_8c_source.html#l00023">parser</a>, <a class="el" href="../../db/dd5/libcharon_2encoding_2parser_8c_source.html#l00659">parser_create()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00256">PLV1_FRAGMENT</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00969">reset_defrag()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>
<div class="fragment"><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;{</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    <a class="code" href="../../d1/dcf/structfragment__payload__t.html">fragment_payload_t</a> *payload;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    u_int8_t num;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;frag)</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    {</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a>;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    }</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;    payload = (<a class="code" href="../../d1/dcf/structfragment__payload__t.html">fragment_payload_t</a>*)message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#adb93ba87d076213556e0b16efe62db1e">get_payload</a>(message, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6">PLV1_FRAGMENT</a>);</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    <span class="keywordflow">if</span> (!payload)</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;    {</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a>;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    }</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;fragments || this-&gt;message_id != payload-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#a59646c10fb4856b9487321ba3cae1aef">get_id</a>(payload))</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    {</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        this-&gt;message_id = payload-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#a59646c10fb4856b9487321ba3cae1aef">get_id</a>(payload);</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        <span class="comment">/* we don&#39;t know the total number of fragments, assume something */</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        this-&gt;fragments = <a class="code" href="../../d1/d0e/group__array.html#ga9acc78bc2e06102ff37133b5aa0e0a4f">array_create</a>(0, 4);</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    }</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    num = payload-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#a1cde01ec3e51460331a2bd3306e47d5d">get_number</a>(payload);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    data = payload-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#ad87cb97fb793ca2b47e66a32c98a1b57">get_data</a>(payload);</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;frag-&gt;last &amp;&amp; payload-&gt;<a class="code" href="../../d1/dcf/structfragment__payload__t.html#afb37e188ab4743682c07e2e0c0c16991">is_last</a>(payload))</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;    {</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        this-&gt;frag-&gt;last = num;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    }</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    status = <a class="code" href="../../d0/d6d/message_8c.html#a6d777e43d5027e42909f0a85d666712d">add_fragment</a>(<span class="keyword">this</span>, num, data);</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    {</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    }</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a>(this-&gt;fragments) != this-&gt;frag-&gt;last)</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    {</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;        <span class="comment">/* there are some fragments missing */</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;received fragment #%hhu, waiting for complete IKE &quot;</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;             <span class="stringliteral">&quot;message&quot;</span>, num);</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750">NEED_MORE</a>;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    }</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;received fragment #%hhu, reassembling fragmented IKE &quot;</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;         <span class="stringliteral">&quot;message&quot;</span>, num);</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    data = <a class="code" href="../../d0/d6d/message_8c.html#ac91d0859890919608d04024adcc7e1fe">merge_fragments</a>(<span class="keyword">this</span>, message);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    this-&gt;packet-&gt;set_data(this-&gt;packet, data);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a> = <a class="code" href="../../dd/da8/group__parser.html#ga4f907e86ca85c0c5c10ad1d70a2db48b">parser_create</a>(data);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="keywordflow">if</span> (parse_header(<span class="keyword">this</span>) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    {</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;failed to parse header of reassembled IKE message&quot;</span>);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    }</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;}</div>
<div class="ttc" id="structfragment__payload__t_html_ad87cb97fb793ca2b47e66a32c98a1b57"><div class="ttname"><a href="../../d1/dcf/structfragment__payload__t.html#ad87cb97fb793ca2b47e66a32c98a1b57">fragment_payload_t::get_data</a></div><div class="ttdeci">chunk_t(* get_data)(fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d93/fragment__payload_8h_source.html#l00066">fragment_payload.h:66</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="group__array_html_ga37bb7fb1dde90d6fb84dac0027bb3606"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a></div><div class="ttdeci">int array_count(array_t *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00176">array.c:176</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00040">debug.h:40</a></div></div>
<div class="ttc" id="message_8c_html_a7c1298a30209676eb847c2c4406e0a22"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a></div><div class="ttdeci">static void reset_defrag(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00969">message.c:969</a></div></div>
<div class="ttc" id="structmessage__t_html_adb93ba87d076213556e0b16efe62db1e"><div class="ttname"><a href="../../df/d23/structmessage__t.html#adb93ba87d076213556e0b16efe62db1e">message_t::get_payload</a></div><div class="ttdeci">payload_t *(* get_payload)(message_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00376">message.h:376</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00050">status.h:50</a></div></div>
<div class="ttc" id="test__parser_8c_html_a40ea9d08a07e5802dbf8c0ff3ecbeb0f"><div class="ttname"><a href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a></div><div class="ttdeci">static conf_parser_t * parser</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da0/test__parser_8c_source.html#l00023">test_parser.c:23</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="message_8c_html_ac91d0859890919608d04024adcc7e1fe"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ac91d0859890919608d04024adcc7e1fe">merge_fragments</a></div><div class="ttdeci">static chunk_t merge_fragments(private_message_t *this, message_t *last)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02746">message.c:2746</a></div></div>
<div class="ttc" id="group__array_html_ga9acc78bc2e06102ff37133b5aa0e0a4f"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga9acc78bc2e06102ff37133b5aa0e0a4f">array_create</a></div><div class="ttdeci">array_t * array_create(u_int esize, u_int8_t reserve)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00161">array.c:161</a></div></div>
<div class="ttc" id="structfragment__payload__t_html_afb37e188ab4743682c07e2e0c0c16991"><div class="ttname"><a href="../../d1/dcf/structfragment__payload__t.html#afb37e188ab4743682c07e2e0c0c16991">fragment_payload_t::is_last</a></div><div class="ttdeci">bool(* is_last)(fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d93/fragment__payload_8h_source.html#l00059">fragment_payload.h:59</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750">NEED_MORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00054">status.h:54</a></div></div>
<div class="ttc" id="structfragment__payload__t_html"><div class="ttname"><a href="../../d1/dcf/structfragment__payload__t.html">fragment_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d93/fragment__payload_8h_source.html#l00032">fragment_payload.h:32</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3c33285d0ce4c9d934c5060dab8905a6">PLV1_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00256">payload.h:256</a></div></div>
<div class="ttc" id="group__parser_html_ga4f907e86ca85c0c5c10ad1d70a2db48b"><div class="ttname"><a href="../../dd/da8/group__parser.html#ga4f907e86ca85c0c5c10ad1d70a2db48b">parser_create</a></div><div class="ttdeci">parser_t * parser_create(chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd5/libcharon_2encoding_2parser_8c_source.html#l00659">libcharon/encoding/parser.c:659</a></div></div>
<div class="ttc" id="structfragment__payload__t_html_a1cde01ec3e51460331a2bd3306e47d5d"><div class="ttname"><a href="../../d1/dcf/structfragment__payload__t.html#a1cde01ec3e51460331a2bd3306e47d5d">fragment_payload_t::get_number</a></div><div class="ttdeci">u_int8_t(* get_number)(fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d93/fragment__payload_8h_source.html#l00052">fragment_payload.h:52</a></div></div>
<div class="ttc" id="message_8c_html_a6d777e43d5027e42909f0a85d666712d"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a6d777e43d5027e42909f0a85d666712d">add_fragment</a></div><div class="ttdeci">static status_t add_fragment(private_message_t *this, u_int16_t num, chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02706">message.c:2706</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00042">status.h:42</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="structfragment__payload__t_html_a59646c10fb4856b9487321ba3cae1aef"><div class="ttname"><a href="../../d1/dcf/structfragment__payload__t.html#a59646c10fb4856b9487321ba3cae1aef">fragment_payload_t::get_id</a></div><div class="ttdeci">u_int16_t(* get_id)(fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d93/fragment__payload_8h_source.html#l00045">fragment_payload.h:45</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-40" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a25aa04281d47a67d202211b65f200c49_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa337d07c94358c3980c5fcc14ea766b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">add_fragment_v2&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02835">2835</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d0/d6d/message_8c_source.html#l02706">add_fragment()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00176">array_count()</a>, <a class="el" href="../../dc/dcc/array_8c_source.html#l00161">array_create()</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00359">message_t::create_payload_enumerator</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00040">DBG_IKE</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d3/da3/encrypted__payload_8c_source.html#l00784">encrypted_payload_create_from_plain()</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00059">encrypted_fragment_payload_t::get_content</a>, <a class="el" href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00045">encrypted_fragment_payload_t::get_fragment_number</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00087">message_t::get_message_id</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00368">payload_t::get_next_type</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00376">message_t::get_payload</a>, <a class="el" href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00052">encrypted_fragment_payload_t::get_total_fragments</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00042">INVALID_ARG</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00050">INVALID_STATE</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00948">MAX_FRAGMENTS</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02746">merge_fragments()</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00054">NEED_MORE</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00233">PLV2_FRAGMENT</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00366">message_t::remove_payload_at</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00969">reset_defrag()</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>
<div class="fragment"><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;{</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a> *encrypted_fragment;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encrypted;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    u_int16_t total, num;</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;frag)</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    {</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a>;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    }</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    payload = message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#adb93ba87d076213556e0b16efe62db1e">get_payload</a>(message, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keywordflow">if</span> (!payload || this-&gt;message_id != message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a43c37f5c6b09cca4c19d84f18dae9db3">get_message_id</a>(message))</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    {</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a>;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    }</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    encrypted_fragment = (<a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a>*)payload;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    total = encrypted_fragment-&gt;<a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html#a7c8c1b6299865bf9424490b42e0f6d5e">get_total_fragments</a>(encrypted_fragment);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="keywordflow">if</span> (total &gt; <a class="code" href="../../d0/d6d/message_8c.html#a3e3558ae64440370a8d1eca6f4447a9c">MAX_FRAGMENTS</a>)</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;maximum fragment count exceeded&quot;</span>);</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    }</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;fragments || total &gt; this-&gt;frag-&gt;last)</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    {</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        this-&gt;frag-&gt;last = total;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        this-&gt;fragments = <a class="code" href="../../d1/d0e/group__array.html#ga9acc78bc2e06102ff37133b5aa0e0a4f">array_create</a>(0, total);</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    }</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    num = encrypted_fragment-&gt;<a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html#ae9b160f458d9be52e67942ab435fae7d">get_fragment_number</a>(encrypted_fragment);</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    data = encrypted_fragment-&gt;<a class="code" href="../../db/d72/structencrypted__fragment__payload__t.html#aed05d814313b57d9b95d26235d2346f8">get_content</a>(encrypted_fragment);</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    status = <a class="code" href="../../d0/d6d/message_8c.html#a6d777e43d5027e42909f0a85d666712d">add_fragment</a>(<span class="keyword">this</span>, num, data);</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    {</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    }</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="keywordflow">if</span> (num == 1)</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    {</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        <span class="comment">/* the first fragment denotes the payload type of the first payload in</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;<span class="comment">         * the original encrypted payload, cache that */</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        this-&gt;first_payload = payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a3d4fed0210ddf9b275e99dbbd5f63c40">get_next_type</a>(payload);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        <span class="comment">/* move all unencrypted payloads contained in the first fragment */</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        enumerator = message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a3416f25289258d2993aec831125da6fd">create_payload_enumerator</a>(message);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        {</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;            <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) != <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>)</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;            {</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#abe82bc8b1d26aa205c3dcb8f43fecc06">remove_payload_at</a>(message, enumerator);</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                this-&gt;payloads-&gt;insert_last(this-&gt;payloads, payload);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;            }</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        }</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    }</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a>(this-&gt;fragments) != total)</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    {</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        <span class="comment">/* there are some fragments missing */</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;received fragment #%hu of %hu, waiting for complete IKE &quot;</span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;             <span class="stringliteral">&quot;message&quot;</span>, num, total);</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750">NEED_MORE</a>;</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    }</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;received fragment #%hu of %hu, reassembling fragmented IKE &quot;</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;         <span class="stringliteral">&quot;message&quot;</span>, num, total);</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    data = <a class="code" href="../../d0/d6d/message_8c.html#ac91d0859890919608d04024adcc7e1fe">merge_fragments</a>(<span class="keyword">this</span>, message);</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    encrypted = <a class="code" href="../../d8/d20/group__encrypted__payload.html#gad97cffeb3d79857c7849968609003410">encrypted_payload_create_from_plain</a>(this-&gt;first_payload, data);</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    this-&gt;payloads-&gt;insert_last(this-&gt;payloads, encrypted);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="comment">/* update next payload type (could be an unencrypted payload) */</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    this-&gt;payloads-&gt;get_first(this-&gt;payloads, (<span class="keywordtype">void</span>**)&amp;payload);</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    this-&gt;first_payload = payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload);</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;}</div>
<div class="ttc" id="structencrypted__fragment__payload__t_html_a7c8c1b6299865bf9424490b42e0f6d5e"><div class="ttname"><a href="../../db/d72/structencrypted__fragment__payload__t.html#a7c8c1b6299865bf9424490b42e0f6d5e">encrypted_fragment_payload_t::get_total_fragments</a></div><div class="ttdeci">u_int16_t(* get_total_fragments)(encrypted_fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00052">encrypted_fragment_payload.h:52</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="message_8c_html_a3e3558ae64440370a8d1eca6f4447a9c"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3e3558ae64440370a8d1eca6f4447a9c">MAX_FRAGMENTS</a></div><div class="ttdeci">#define MAX_FRAGMENTS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00948">message.c:948</a></div></div>
<div class="ttc" id="group__array_html_ga37bb7fb1dde90d6fb84dac0027bb3606"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga37bb7fb1dde90d6fb84dac0027bb3606">array_count</a></div><div class="ttdeci">int array_count(array_t *array)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00176">array.c:176</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00040">debug.h:40</a></div></div>
<div class="ttc" id="message_8c_html_a7c1298a30209676eb847c2c4406e0a22"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a></div><div class="ttdeci">static void reset_defrag(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00969">message.c:969</a></div></div>
<div class="ttc" id="structmessage__t_html_adb93ba87d076213556e0b16efe62db1e"><div class="ttname"><a href="../../df/d23/structmessage__t.html#adb93ba87d076213556e0b16efe62db1e">message_t::get_payload</a></div><div class="ttdeci">payload_t *(* get_payload)(message_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00376">message.h:376</a></div></div>
<div class="ttc" id="structencrypted__fragment__payload__t_html_ae9b160f458d9be52e67942ab435fae7d"><div class="ttname"><a href="../../db/d72/structencrypted__fragment__payload__t.html#ae9b160f458d9be52e67942ab435fae7d">encrypted_fragment_payload_t::get_fragment_number</a></div><div class="ttdeci">u_int16_t(* get_fragment_number)(encrypted_fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00045">encrypted_fragment_payload.h:45</a></div></div>
<div class="ttc" id="structmessage__t_html_abe82bc8b1d26aa205c3dcb8f43fecc06"><div class="ttname"><a href="../../df/d23/structmessage__t.html#abe82bc8b1d26aa205c3dcb8f43fecc06">message_t::remove_payload_at</a></div><div class="ttdeci">void(* remove_payload_at)(message_t *this, enumerator_t *enumerator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00366">message.h:366</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a3a01eacac22f2ede34b2e254ad6c5f6a">INVALID_STATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00050">status.h:50</a></div></div>
<div class="ttc" id="structpayload__t_html_a3d4fed0210ddf9b275e99dbbd5f63c40"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a3d4fed0210ddf9b275e99dbbd5f63c40">payload_t::get_next_type</a></div><div class="ttdeci">payload_type_t(* get_next_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00368">payload.h:368</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__encrypted__payload_html_gad97cffeb3d79857c7849968609003410"><div class="ttname"><a href="../../d8/d20/group__encrypted__payload.html#gad97cffeb3d79857c7849968609003410">encrypted_payload_create_from_plain</a></div><div class="ttdeci">encrypted_payload_t * encrypted_payload_create_from_plain(payload_type_t next, chunk_t plain)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da3/encrypted__payload_8c_source.html#l00784">encrypted_payload.c:784</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="message_8c_html_ac91d0859890919608d04024adcc7e1fe"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ac91d0859890919608d04024adcc7e1fe">merge_fragments</a></div><div class="ttdeci">static chunk_t merge_fragments(private_message_t *this, message_t *last)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02746">message.c:2746</a></div></div>
<div class="ttc" id="group__array_html_ga9acc78bc2e06102ff37133b5aa0e0a4f"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga9acc78bc2e06102ff37133b5aa0e0a4f">array_create</a></div><div class="ttdeci">array_t * array_create(u_int esize, u_int8_t reserve)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00161">array.c:161</a></div></div>
<div class="ttc" id="structmessage__t_html_a43c37f5c6b09cca4c19d84f18dae9db3"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a43c37f5c6b09cca4c19d84f18dae9db3">message_t::get_message_id</a></div><div class="ttdeci">u_int32_t(* get_message_id)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00087">message.h:87</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a311d3fea7ad9c032aede4e7116653750">NEED_MORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00054">status.h:54</a></div></div>
<div class="ttc" id="structencrypted__fragment__payload__t_html_aed05d814313b57d9b95d26235d2346f8"><div class="ttname"><a href="../../db/d72/structencrypted__fragment__payload__t.html#aed05d814313b57d9b95d26235d2346f8">encrypted_fragment_payload_t::get_content</a></div><div class="ttdeci">chunk_t(* get_content)(encrypted_fragment_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00059">encrypted_fragment_payload.h:59</a></div></div>
<div class="ttc" id="structencrypted__fragment__payload__t_html"><div class="ttname"><a href="../../db/d72/structencrypted__fragment__payload__t.html">encrypted_fragment_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/de8/encrypted__fragment__payload_8h_source.html#l00033">encrypted_fragment_payload.h:33</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structmessage__t_html_a3416f25289258d2993aec831125da6fd"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a3416f25289258d2993aec831125da6fd">message_t::create_payload_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_payload_enumerator)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00359">message.h:359</a></div></div>
<div class="ttc" id="message_8c_html_a6d777e43d5027e42909f0a85d666712d"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a6d777e43d5027e42909f0a85d666712d">add_fragment</a></div><div class="ttdeci">static status_t add_fragment(private_message_t *this, u_int16_t num, chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l02706">message.c:2706</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586a8aef620618e53cd85fbda6c65b47eb1b">INVALID_ARG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00042">status.h:42</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00037">encrypted_payload.h:37</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-41" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-41-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-41-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-41-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_aa337d07c94358c3980c5fcc14ea766b1_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae480795c305d11ad29dbece004b85786"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/ddc/windows_2thread_8c.html#a343cd07ea8770e572cfe3a7d39ea8401">destroy</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02915">2915</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../dc/dcc/array_8c_source.html#l00547">array_destroy_offset()</a>, <a class="el" href="../../dc/d21/daemon_8c_source.html#l00452">destroy()</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../d7/da0/test__parser_8c_source.html#l00023">parser</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l00969">reset_defrag()</a>.</p>
<div class="fragment"><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;{</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;ike_sa_id);</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>);</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    this-&gt;payloads-&gt;destroy_offset(this-&gt;payloads, offsetof(<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>, <a class="code" href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a>));</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    this-&gt;packet-&gt;destroy(this-&gt;packet);</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <span class="keywordflow">if</span> (this-&gt;frag)</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    {</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <a class="code" href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(this-&gt;frag);</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    }</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    {</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        <a class="code" href="../../d1/d0e/group__array.html#ga9aacf785ead590ada5ca80138c34e909">array_destroy_offset</a>(this-&gt;fragments, offsetof(<a class="code" href="../../d7/d88/structpacket__t.html">packet_t</a>, <a class="code" href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a>));</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    }</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;}</div>
<div class="ttc" id="daemon_8c_html_a1e824dfeaa337e709772cb0c8e6c8dcc"><div class="ttname"><a href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a></div><div class="ttdeci">static void destroy(private_daemon_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00452">daemon.c:452</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="message_8c_html_a7c1298a30209676eb847c2c4406e0a22"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a7c1298a30209676eb847c2c4406e0a22">reset_defrag</a></div><div class="ttdeci">static void reset_defrag(private_message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00969">message.c:969</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="test__parser_8c_html_a40ea9d08a07e5802dbf8c0ff3ecbeb0f"><div class="ttname"><a href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a></div><div class="ttdeci">static conf_parser_t * parser</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da0/test__parser_8c_source.html#l00023">test_parser.c:23</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="structpacket__t_html"><div class="ttname"><a href="../../d7/d88/structpacket__t.html">packet_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d76/packet_8h_source.html#l00039">packet.h:39</a></div></div>
<div class="ttc" id="group__array_html_ga9aacf785ead590ada5ca80138c34e909"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga9aacf785ead590ada5ca80138c34e909">array_destroy_offset</a></div><div class="ttdeci">void array_destroy_offset(array_t *array, size_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00547">array.c:547</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-42" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-42-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-42-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-42-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ae480795c305d11ad29dbece004b85786_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="acb66d9136fff56df15318f1eb49efe47"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void order_payloads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>reorder payloads depending on reordering rules </p>
<p>... and check notify for type. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01480">1480</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list_t::create_enumerator</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00223">linked_list_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a>, <a class="el" href="../../d2/d22/notify__payload_8h_source.html#l00217">notify_payload_t::get_notify_type</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00085">linked_list_t::insert_first</a>, <a class="el" href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list_create()</a>, <a class="el" href="../../d2/d21/test__linked__list_8c_source.html#l00024">list</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00097">payload_order_t::notify</a>, <a class="el" href="../../d4/da5/watcher_8c_source.html#l00192">notify()</a>, <a class="el" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00173">PLV2_NOTIFY</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00116">linked_list_t::remove_at</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00155">linked_list_t::remove_last</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l00095">payload_order_t::type</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>.</p>
<div class="fragment"><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;{</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <a class="code" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *<a class="code" href="../../d2/d21/test__linked__list_8c.html#a92188d30f4d71257634d1ea6d960def6">list</a>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;order payloads in message&quot;</span>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="comment">/* move to temp list */</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    list = <a class="code" href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a>();</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordflow">while</span> (this-&gt;payloads-&gt;remove_last(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#aeef00a06d9807a91acdddd8707907932">payloads</a>,</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;                                       (<span class="keywordtype">void</span>**)&amp;payload) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        list-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a194fcf22ffc6b8866a8ae8ad148b4034">insert_first</a>(list, payload);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">/* for each rule, ... */</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; this-&gt;rule-&gt;order_count; i++)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        <a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a> *<a class="code" href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a>;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <a class="code" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> order;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        order = this-&gt;rule-&gt;order[i];</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="comment">/* ... find all payload ... */</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        enumerator = list-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">create_enumerator</a>(list);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            <span class="comment">/* ... with that type ... */</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;            <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == order.<a class="code" href="../../d2/de1/structpayload__order__t.html#a635fecd0219ffac1a1a199e5107388d7">type</a>)</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;            {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                notify = (<a class="code" href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a>*)payload;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                <span class="keywordflow">if</span> (order.<a class="code" href="../../d2/de1/structpayload__order__t.html#a635fecd0219ffac1a1a199e5107388d7">type</a> != <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a> || order.<a class="code" href="../../d2/de1/structpayload__order__t.html#ad6c2ed9c3ef3b68e4059fee900924317">notify</a> == 0 ||</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                    order.<a class="code" href="../../d2/de1/structpayload__order__t.html#ad6c2ed9c3ef3b68e4059fee900924317">notify</a> == notify-&gt;<a class="code" href="../../dc/d56/structnotify__payload__t.html#acba12460facded9439652c9c5af96dc2">get_notify_type</a>(notify))</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                    list-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a1c05c74ee845bea914b3e08a4c95c677">remove_at</a>(list, enumerator);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                    add_payload(<span class="keyword">this</span>, payload);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">/* append all payloads without a rule to the end */</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordflow">while</span> (list-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a3263f4ceb4a332234b592e504700fa13">remove_last</a>(list, (<span class="keywordtype">void</span>**)&amp;payload) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="comment">/* do not complain about payloads in private use space */</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) &lt; 128)</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;payload %N has no ordering rule in %N %s&quot;</span>,</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload),</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                 <a class="code" href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a>, this-&gt;rule-&gt;exchange_type,</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                 this-&gt;rule-&gt;is_request ? <span class="stringliteral">&quot;request&quot;</span> : <span class="stringliteral">&quot;response&quot;</span>);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        add_payload(<span class="keyword">this</span>, payload);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    list-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#ae4650546592eff6a3bb056cf22e3e692">destroy</a>(list);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="test__linked__list_8c_html_a92188d30f4d71257634d1ea6d960def6"><div class="ttname"><a href="../../d2/d21/test__linked__list_8c.html#a92188d30f4d71257634d1ea6d960def6">list</a></div><div class="ttdeci">static linked_list_t * list</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d21/test__linked__list_8c_source.html#l00024">test_linked_list.c:24</a></div></div>
<div class="ttc" id="structlinked__list__t_html_a1c05c74ee845bea914b3e08a4c95c677"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a1c05c74ee845bea914b3e08a4c95c677">linked_list_t::remove_at</a></div><div class="ttdeci">void(* remove_at)(linked_list_t *this, enumerator_t *enumerator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00116">linked_list.h:116</a></div></div>
<div class="ttc" id="structprivate__message__t_html_aeef00a06d9807a91acdddd8707907932"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#aeef00a06d9807a91acdddd8707907932">private_message_t::payloads</a></div><div class="ttdeci">linked_list_t * payloads</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00927">message.c:927</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="structnotify__payload__t_html_acba12460facded9439652c9c5af96dc2"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html#acba12460facded9439652c9c5af96dc2">notify_payload_t::get_notify_type</a></div><div class="ttdeci">notify_type_t(* get_notify_type)(notify_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00217">notify_payload.h:217</a></div></div>
<div class="ttc" id="structnotify__payload__t_html"><div class="ttname"><a href="../../dc/d56/structnotify__payload__t.html">notify_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00192">notify_payload.h:192</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="group__payload_html_ga397bd66f0cc14539cee30d16ae9b0bfa"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a></div><div class="ttdeci">enum_name_t * payload_type_names</div></div>
<div class="ttc" id="group__linked__list_html_ga15bb4333e53dbef32d196e4388f43fdf"><div class="ttname"><a href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a></div><div class="ttdeci">linked_list_t * linked_list_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list.c:484</a></div></div>
<div class="ttc" id="structpayload__order__t_html"><div class="ttname"><a href="../../d2/de1/structpayload__order__t.html">payload_order_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00093">message.c:93</a></div></div>
<div class="ttc" id="structlinked__list__t_html_a3263f4ceb4a332234b592e504700fa13"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a3263f4ceb4a332234b592e504700fa13">linked_list_t::remove_last</a></div><div class="ttdeci">status_t(* remove_last)(linked_list_t *this, void **item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00155">linked_list.h:155</a></div></div>
<div class="ttc" id="structlinked__list__t_html_aa079d50cc4028f12d65c75cbb53f8c8a"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">linked_list_t::create_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_enumerator)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list.h:71</a></div></div>
<div class="ttc" id="structlinked__list__t_html_a194fcf22ffc6b8866a8ae8ad148b4034"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a194fcf22ffc6b8866a8ae8ad148b4034">linked_list_t::insert_first</a></div><div class="ttdeci">void(* insert_first)(linked_list_t *this, void *item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00085">linked_list.h:85</a></div></div>
<div class="ttc" id="structpayload__order__t_html_ad6c2ed9c3ef3b68e4059fee900924317"><div class="ttname"><a href="../../d2/de1/structpayload__order__t.html#ad6c2ed9c3ef3b68e4059fee900924317">payload_order_t::notify</a></div><div class="ttdeci">notify_type_t notify</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00097">message.c:97</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="watcher_8c_html_a8f0e10b20c0f4d75132f5af69278c063"><div class="ttname"><a href="../../d4/da5/watcher_8c.html#a8f0e10b20c0f4d75132f5af69278c063">notify</a></div><div class="ttdeci">static void notify(private_watcher_t *this, entry_t *entry, watcher_event_t event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da5/watcher_8c_source.html#l00192">watcher.c:192</a></div></div>
<div class="ttc" id="structpayload__order__t_html_a635fecd0219ffac1a1a199e5107388d7"><div class="ttname"><a href="../../d2/de1/structpayload__order__t.html#a635fecd0219ffac1a1a199e5107388d7">payload_order_t::type</a></div><div class="ttdeci">payload_type_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00095">message.c:95</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="structlinked__list__t_html_ae4650546592eff6a3bb056cf22e3e692"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#ae4650546592eff6a3bb056cf22e3e692">linked_list_t::destroy</a></div><div class="ttdeci">void(* destroy)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00223">linked_list.h:223</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structlinked__list__t_html"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html">linked_list_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00054">linked_list.h:54</a></div></div>
<div class="ttc" id="group__ike__header_html_ga70babeab66939657d7fb784231749dfc"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#ga70babeab66939657d7fb784231749dfc">exchange_type_names</a></div><div class="ttdeci">enum_name_t * exchange_type_names</div></div>
</div><!-- fragment -->
<p><div id="dynsection-43" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-43-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-43-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-43-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_acb66d9136fff56df15318f1eb49efe47_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-44" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-44-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-44-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-44-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_acb66d9136fff56df15318f1eb49efe47_icgraph.svg" width="432" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a44720d7d2b793ce08b703694683ec0a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> parse_payloads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parses and verifies the unencrypted payloads contained in the message </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02243">2243</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00394">payload_t::destroy</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00368">payload_t::get_next_type</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00046">PARSE_ERROR</a>, <a class="el" href="../../d7/da0/test__parser_8c_source.html#l00023">parser</a>, <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00042">encrypted_payload_t::payload_interface</a>, <a class="el" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00048">PL_NONE</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00269">PL_UNKNOWN</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00319">PLV1_ENCRYPTED</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00198">PLV2_ENCRYPTED</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00233">PLV2_FRAGMENT</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00375">payload_t::set_next_type</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00389">payload_t::verify</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00048">VERIFY_ERROR</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02612">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;{</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <a class="code" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> = this-&gt;first_payload;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keywordflow">if</span> (this-&gt;is_encrypted)</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    {   <span class="comment">/* wrap the whole encrypted IKEv1 message in a special encrypted</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment">         * payload which is then handled just like a regular payload */</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encryption;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        status = this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>-&gt;parse_payload(this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8">PLV1_ENCRYPTED</a>,</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                                             (<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>**)&amp;encryption);</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        {</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;failed to wrap encrypted IKEv1 message&quot;</span>);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ad73f40ad2eef48a6ca24988909c66c3e">PARSE_ERROR</a>;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;        encryption-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#a487edda678c9323ca8c09bf063b0fb22">payload_interface</a>.<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>((<a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a>*)encryption,</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                                                    this-&gt;first_payload);</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;        this-&gt;payloads-&gt;insert_last(this-&gt;payloads, encryption);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <span class="keywordflow">while</span> (type != <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a>)</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    {</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;starting parsing a %N payload&quot;</span>,</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;             <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        status = this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>-&gt;parse_payload(this-&gt;<a class="code" href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a>, type, &amp;payload);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        {</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;payload type %N could not be parsed&quot;</span>,</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ad73f40ad2eef48a6ca24988909c66c3e">PARSE_ERROR</a>;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        }</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;verifying payload of type %N&quot;</span>, <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        status = payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#abc808c0f264c5dc2a96e7df177003462">verify</a>(payload);</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;%N payload verification failed&quot;</span>,</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;            payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a9848c240e1c7b47d3db1d39964b56995">destroy</a>(payload);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        }</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a">PL_UNKNOWN</a>)</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        {</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;%N payload unknown or not allowed&quot;</span>,</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        }</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;%N payload verified, adding to payload list&quot;</span>,</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        }</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        this-&gt;payloads-&gt;insert_last(this-&gt;payloads, payload);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        <span class="comment">/* an encrypted (fragment) payload MUST be the last one, so STOP here.</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment">         * decryption is done later */</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        <span class="keywordflow">if</span> (type == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a> || type == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>)</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        {</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;%N payload found, stop parsing&quot;</span>,</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        }</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        type = payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a3d4fed0210ddf9b275e99dbbd5f63c40">get_next_type</a>(payload);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html_a487edda678c9323ca8c09bf063b0fb22"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#a487edda678c9323ca8c09bf063b0fb22">encrypted_payload_t::payload_interface</a></div><div class="ttdeci">payload_t payload_interface</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00042">encrypted_payload.h:42</a></div></div>
<div class="ttc" id="structpayload__t_html_a9848c240e1c7b47d3db1d39964b56995"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a9848c240e1c7b47d3db1d39964b56995">payload_t::destroy</a></div><div class="ttdeci">void(* destroy)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00394">payload.h:394</a></div></div>
<div class="ttc" id="group__payload_html_ga910814947f5e241c851b42e95e8586ee"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a></div><div class="ttdeci">payload_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00043">payload.h:43</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ad73f40ad2eef48a6ca24988909c66c3e"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ad73f40ad2eef48a6ca24988909c66c3e">PARSE_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00046">status.h:46</a></div></div>
<div class="ttc" id="group__payload_html_ga397bd66f0cc14539cee30d16ae9b0bfa"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a></div><div class="ttdeci">enum_name_t * payload_type_names</div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8">PLV1_ENCRYPTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00319">payload.h:319</a></div></div>
<div class="ttc" id="structpayload__t_html_a080809f324fbb7037d2aafed2a4f8fcc"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">payload_t::set_next_type</a></div><div class="ttdeci">void(* set_next_type)(payload_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00375">payload.h:375</a></div></div>
<div class="ttc" id="test__parser_8c_html_a40ea9d08a07e5802dbf8c0ff3ecbeb0f"><div class="ttname"><a href="../../d7/da0/test__parser_8c.html#a40ea9d08a07e5802dbf8c0ff3ecbeb0f">parser</a></div><div class="ttdeci">static conf_parser_t * parser</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/da0/test__parser_8c_source.html#l00023">test_parser.c:23</a></div></div>
<div class="ttc" id="structpayload__t_html_a3d4fed0210ddf9b275e99dbbd5f63c40"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a3d4fed0210ddf9b275e99dbbd5f63c40">payload_t::get_next_type</a></div><div class="ttdeci">payload_type_t(* get_next_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00368">payload.h:368</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="structpayload__t_html_abc808c0f264c5dc2a96e7df177003462"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#abc808c0f264c5dc2a96e7df177003462">payload_t::verify</a></div><div class="ttdeci">status_t(* verify)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00389">payload.h:389</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00048">payload.h:48</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00198">payload.h:198</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa20e31a2ddd71c8f9bbf58d6fedadd3a">PL_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00269">payload.h:269</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00037">encrypted_payload.h:37</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00048">status.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-45" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-45-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-45-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-45-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a44720d7d2b793ce08b703694683ec0a6_icgraph.svg" width="254" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7c1298a30209676eb847c2c4406e0a22"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void reset_defrag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00969">969</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../dc/dcc/array_8c_source.html#l00541">array_destroy_function()</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l00963">fragment_destroy()</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02706">add_fragment()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02746">merge_fragments()</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l02775">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;{</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="../../d1/d0e/group__array.html#ga0640eb34d80a88b4bf2c6af35478556f">array_destroy_function</a>(this-&gt;fragments, (<span class="keywordtype">void</span>*)<a class="code" href="../../d0/d6d/message_8c.html#aaf699226234aa58a876efdf1e8b5d1e8">fragment_destroy</a>, NULL);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    this-&gt;fragments = NULL;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    this-&gt;frag-&gt;last = 0;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    this-&gt;frag-&gt;len = 0;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;}</div>
<div class="ttc" id="group__array_html_ga0640eb34d80a88b4bf2c6af35478556f"><div class="ttname"><a href="../../d1/d0e/group__array.html#ga0640eb34d80a88b4bf2c6af35478556f">array_destroy_function</a></div><div class="ttdeci">void array_destroy_function(array_t *array, array_callback_t cb, void *user)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcc/array_8c_source.html#l00541">array.c:541</a></div></div>
<div class="ttc" id="message_8c_html_aaf699226234aa58a876efdf1e8b5d1e8"><div class="ttname"><a href="../../d0/d6d/message_8c.html#aaf699226234aa58a876efdf1e8b5d1e8">fragment_destroy</a></div><div class="ttdeci">static void fragment_destroy(fragment_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00963">message.c:963</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-46" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-46-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-46-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-46-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a7c1298a30209676eb847c2c4406e0a22_cgraph.svg" width="579" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-47" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-47-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-47-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-47-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a7c1298a30209676eb847c2c4406e0a22_icgraph.svg" width="406" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a48b41cdef3c57a4d00b378e7d9da1f8b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Verify a message and all payload according to message/payload rules </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l02559">2559</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d4/d6d/trap__manager_8c_source.html#l00552">complete()</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../da/dfc/test__enum_8c_source.html#l00156">found</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00083">payload_rule_t::max_occurence</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00081">payload_rule_t::min_occurence</a>, <a class="el" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00087">payload_rule_t::sufficient</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00079">payload_rule_t::type</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00048">VERIFY_ERROR</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02612">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;{</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d4/d6d/trap__manager_8c.html#aca5803084aebbae35e9d54299b3883c1">complete</a> = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;verifying message structure&quot;</span>);</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="comment">/* check for payloads with wrong count */</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; this-&gt;rule-&gt;rule_count; i++)</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    {</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        <a class="code" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> *rule;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a> = 0;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        rule = &amp;this-&gt;rule-&gt;rules[i];</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        enumerator = create_payload_enumerator(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        {</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            <a class="code" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            type = payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            <span class="keywordflow">if</span> (type == rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#add79a988d3cf92c0d4ffe7faa8fe0d8d">type</a>)</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            {</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                found++;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;found payload of type %N&quot;</span>,</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                     <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                <span class="keywordflow">if</span> (found &gt; rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#a2c27e78d4b62ddf5a4a48149beafd373">max_occurence</a>)</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                {</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;payload of type %N more than %d times (%d) &quot;</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                         <span class="stringliteral">&quot;occurred in current message&quot;</span>, <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>,</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                         type, rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#a2c27e78d4b62ddf5a4a48149beafd373">max_occurence</a>, found);</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;            }</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        }</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        <span class="keywordflow">if</span> (!complete &amp;&amp; found &lt; rule-&gt;min_occurence)</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        {</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;payload of type %N not occurred %d times (%d)&quot;</span>,</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#add79a988d3cf92c0d4ffe7faa8fe0d8d">type</a>, rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#a37c7d53436bf3676a06193391ebe5991">min_occurence</a>, found);</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a>;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        }</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        <span class="keywordflow">if</span> (found &amp;&amp; rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#a1d7d1b682c97cc9c84392e447f009d95">sufficient</a>)</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        {</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            complete = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        }</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    }</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="test__enum_8c_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/test__enum_8c_source.html#l00156">test_enum.c:156</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structpayload__rule__t_html_add79a988d3cf92c0d4ffe7faa8fe0d8d"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html#add79a988d3cf92c0d4ffe7faa8fe0d8d">payload_rule_t::type</a></div><div class="ttdeci">payload_type_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00079">message.c:79</a></div></div>
<div class="ttc" id="structpayload__rule__t_html"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00077">message.c:77</a></div></div>
<div class="ttc" id="group__payload_html_ga910814947f5e241c851b42e95e8586ee"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a></div><div class="ttdeci">payload_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00043">payload.h:43</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="group__payload_html_ga397bd66f0cc14539cee30d16ae9b0bfa"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a></div><div class="ttdeci">enum_name_t * payload_type_names</div></div>
<div class="ttc" id="structpayload__rule__t_html_a2c27e78d4b62ddf5a4a48149beafd373"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html#a2c27e78d4b62ddf5a4a48149beafd373">payload_rule_t::max_occurence</a></div><div class="ttdeci">size_t max_occurence</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00083">message.c:83</a></div></div>
<div class="ttc" id="trap__manager_8c_html_aca5803084aebbae35e9d54299b3883c1"><div class="ttname"><a href="../../d4/d6d/trap__manager_8c.html#aca5803084aebbae35e9d54299b3883c1">complete</a></div><div class="ttdeci">static void complete(private_trap_manager_t *this, ike_sa_t *ike_sa, child_sa_t *child_sa)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6d/trap__manager_8c_source.html#l00552">trap_manager.c:552</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="structpayload__rule__t_html_a1d7d1b682c97cc9c84392e447f009d95"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html#a1d7d1b682c97cc9c84392e447f009d95">payload_rule_t::sufficient</a></div><div class="ttdeci">bool sufficient</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00087">message.c:87</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structpayload__rule__t_html_a37c7d53436bf3676a06193391ebe5991"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html#a37c7d53436bf3676a06193391ebe5991">payload_rule_t::min_occurence</a></div><div class="ttdeci">size_t min_occurence</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00081">message.c:81</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586abd924ad7765d6deaf1db5521454ebce0">VERIFY_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00048">status.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-48" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-48-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-48-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-48-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a48b41cdef3c57a4d00b378e7d9da1f8b_cgraph.svg" width="446" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-49" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-49-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-49-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-49-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_a48b41cdef3c57a4d00b378e7d9da1f8b_icgraph.svg" width="195" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae0fdacc9bc87781e1115f7081a7ca9b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a>* wrap_payloads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d17/structprivate__message__t.html">private_message_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrap payloads in an encrypted payload </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l01543">1543</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

<p>References <a class="el" href="../../d4/d26/encrypted__payload_8h_source.html#l00056">encrypted_payload_t::add_payload</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00054">DBG_ENC</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00223">linked_list_t::destroy</a>, <a class="el" href="../../d2/da7/pkcs7_8c_source.html#l00180">encrypt()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00085">payload_rule_t::encrypted</a>, <a class="el" href="../../d3/da3/encrypted__payload_8c_source.html#l00741">encrypted_payload_create()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l00998">get_payload_rule()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00147">linked_list_t::insert_last</a>, <a class="el" href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list_create()</a>, <a class="el" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00319">PLV1_ENCRYPTED</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00198">PLV2_ENCRYPTED</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00233">PLV2_FRAGMENT</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00093">linked_list_t::remove_first</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>.</p>
<div class="fragment"><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;{</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a> *encrypted = NULL;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <a class="code" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *payloads;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *current;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="comment">/* move all payloads to a temporary list */</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    payloads = <a class="code" href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a>();</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keywordflow">while</span> (this-&gt;payloads-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a6bb14cb07b3dcfa640b69436a6f88a8c">remove_first</a>(this-&gt;<a class="code" href="../../d0/d17/structprivate__message__t.html#aeef00a06d9807a91acdddd8707907932">payloads</a>,</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                                        (<span class="keywordtype">void</span>**)&amp;current) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keywordflow">if</span> (current-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(current) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>)</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        {   <span class="comment">/* treat encrypted fragment payload as encrypted payload */</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            encrypted = (<a class="code" href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a>*)current;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        }</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            payloads-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a5150f69ff51c8d6d0ed680fad1120c02">insert_last</a>(payloads, current);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="keywordflow">if</span> (encrypted)</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    {   <span class="comment">/* simply adopt all the unencrypted payloads */</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        this-&gt;payloads-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#ae4650546592eff6a3bb056cf22e3e692">destroy</a>(this-&gt;payloads);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        this-&gt;payloads = payloads;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordflow">return</span> encrypted;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordflow">if</span> (this-&gt;is_encrypted)</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        encrypted = <a class="code" href="../../d8/d20/group__encrypted__payload.html#ga417533ed15f9594d37ef821750e52c19">encrypted_payload_create</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8">PLV1_ENCRYPTED</a>);</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    }</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        encrypted = <a class="code" href="../../d8/d20/group__encrypted__payload.html#ga417533ed15f9594d37ef821750e52c19">encrypted_payload_create</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a>);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    }</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="keywordflow">while</span> (payloads-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a6bb14cb07b3dcfa640b69436a6f88a8c">remove_first</a>(payloads, (<span class="keywordtype">void</span>**)&amp;current) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <a class="code" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> *rule;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <a class="code" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="../../d2/da7/pkcs7_8c.html#a2c48115da6e8d8b77bbe4a1d50d8e329">encrypt</a> = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        type = current-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(current);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        rule = <a class="code" href="../../d0/d6d/message_8c.html#ac2cf8cf2c2016e48b002c4acc5d51a51">get_payload_rule</a>(<span class="keyword">this</span>, type);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        <span class="keywordflow">if</span> (rule)</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;            encrypt = rule-&gt;<a class="code" href="../../dc/d56/structpayload__rule__t.html#a45ad3f2d9cf98a9d4adc72b9fad4fb54">encrypted</a>;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="keywordflow">if</span> (encrypt || this-&gt;is_encrypted)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        {   <span class="comment">/* encryption is forced for IKEv1 */</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;insert payload %N into encrypted payload&quot;</span>,</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            encrypted-&gt;<a class="code" href="../../dd/daa/structencrypted__payload__t.html#aaa97eacf2df0d54acd27701fe7b84b2c">add_payload</a>(encrypted, current);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a>, <span class="stringliteral">&quot;insert payload %N unencrypted&quot;</span>,</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                 <a class="code" href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a>, type);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            add_payload(<span class="keyword">this</span>, current);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    }</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    payloads-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#ae4650546592eff6a3bb056cf22e3e692">destroy</a>(payloads);</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keywordflow">return</span> encrypted;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;}</div>
<div class="ttc" id="structencrypted__payload__t_html_aaa97eacf2df0d54acd27701fe7b84b2c"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html#aaa97eacf2df0d54acd27701fe7b84b2c">encrypted_payload_t::add_payload</a></div><div class="ttdeci">void(* add_payload)(encrypted_payload_t *this, payload_t *payload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00056">encrypted_payload.h:56</a></div></div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="group__encrypted__payload_html_ga417533ed15f9594d37ef821750e52c19"><div class="ttname"><a href="../../d8/d20/group__encrypted__payload.html#ga417533ed15f9594d37ef821750e52c19">encrypted_payload_create</a></div><div class="ttdeci">encrypted_payload_t * encrypted_payload_create(payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da3/encrypted__payload_8c_source.html#l00741">encrypted_payload.c:741</a></div></div>
<div class="ttc" id="structlinked__list__t_html_a6bb14cb07b3dcfa640b69436a6f88a8c"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a6bb14cb07b3dcfa640b69436a6f88a8c">linked_list_t::remove_first</a></div><div class="ttdeci">status_t(* remove_first)(linked_list_t *this, void **item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00093">linked_list.h:93</a></div></div>
<div class="ttc" id="structprivate__message__t_html_aeef00a06d9807a91acdddd8707907932"><div class="ttname"><a href="../../d0/d17/structprivate__message__t.html#aeef00a06d9807a91acdddd8707907932">private_message_t::payloads</a></div><div class="ttdeci">linked_list_t * payloads</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00927">message.c:927</a></div></div>
<div class="ttc" id="structpayload__rule__t_html"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00077">message.c:77</a></div></div>
<div class="ttc" id="group__payload_html_ga910814947f5e241c851b42e95e8586ee"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a></div><div class="ttdeci">payload_type_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00043">payload.h:43</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="group__payload_html_ga397bd66f0cc14539cee30d16ae9b0bfa"><div class="ttname"><a href="../../d0/d90/group__payload.html#ga397bd66f0cc14539cee30d16ae9b0bfa">payload_type_names</a></div><div class="ttdeci">enum_name_t * payload_type_names</div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead895191973c886493493ff66f64e70a8">PLV1_ENCRYPTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00319">payload.h:319</a></div></div>
<div class="ttc" id="group__linked__list_html_ga15bb4333e53dbef32d196e4388f43fdf"><div class="ttname"><a href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a></div><div class="ttdeci">linked_list_t * linked_list_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list.c:484</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2cafdab31bbf1bbcbe9a2e95957bcba9">DBG_ENC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00054">debug.h:54</a></div></div>
<div class="ttc" id="message_8c_html_ac2cf8cf2c2016e48b002c4acc5d51a51"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ac2cf8cf2c2016e48b002c4acc5d51a51">get_payload_rule</a></div><div class="ttdeci">static payload_rule_t * get_payload_rule(private_message_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00998">message.c:998</a></div></div>
<div class="ttc" id="structlinked__list__t_html_a5150f69ff51c8d6d0ed680fad1120c02"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a5150f69ff51c8d6d0ed680fad1120c02">linked_list_t::insert_last</a></div><div class="ttdeci">void(* insert_last)(linked_list_t *this, void *item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00147">linked_list.h:147</a></div></div>
<div class="ttc" id="structlinked__list__t_html_ae4650546592eff6a3bb056cf22e3e692"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#ae4650546592eff6a3bb056cf22e3e692">linked_list_t::destroy</a></div><div class="ttdeci">void(* destroy)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00223">linked_list.h:223</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structpayload__rule__t_html_a45ad3f2d9cf98a9d4adc72b9fad4fb54"><div class="ttname"><a href="../../dc/d56/structpayload__rule__t.html#a45ad3f2d9cf98a9d4adc72b9fad4fb54">payload_rule_t::encrypted</a></div><div class="ttdeci">bool encrypted</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00085">message.c:85</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="structlinked__list__t_html"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html">linked_list_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00054">linked_list.h:54</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeadb03aae611a8056f47eacbf7acbe372e">PLV2_ENCRYPTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00198">payload.h:198</a></div></div>
<div class="ttc" id="pkcs7_8c_html_a2c48115da6e8d8b77bbe4a1d50d8e329"><div class="ttname"><a href="../../d2/da7/pkcs7_8c.html#a2c48115da6e8d8b77bbe4a1d50d8e329">encrypt</a></div><div class="ttdeci">static int encrypt(chunk_t chunk, certificate_t *cert)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da7/pkcs7_8c_source.html#l00180">pkcs7.c:180</a></div></div>
<div class="ttc" id="structencrypted__payload__t_html"><div class="ttname"><a href="../../dd/daa/structencrypted__payload__t.html">encrypted_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d26/encrypted__payload_8h_source.html#l00037">encrypted_payload.h:37</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-50" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-50-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-50-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-50-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ae0fdacc9bc87781e1115f7081a7ca9b6_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-51" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-51-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-51-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-51-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d0/d6d/message_8c_ae0fdacc9bc87781e1115f7081a7ca9b6_icgraph.svg" width="430" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="aefbbaec701dfc9491b58feb290276bc6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> create_child_sa_i_order[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa49756e872ab4edaea405b81d9d63aa34">REKEY_SA</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5">IPCOMP_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2">USE_TRANSPORT_MODE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212">ESP_TFC_PADDING_NOT_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0">NON_FIRST_FRAGMENTS_ALSO</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a>,                    0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0},</div>
<div class="line">}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00168">payload.h:168</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5">IPCOMP_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00092">notify_payload.h:92</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0">NON_FIRST_FRAGMENTS_ALSO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00100">notify_payload.h:100</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2">USE_TRANSPORT_MODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00096">notify_payload.h:96</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa49756e872ab4edaea405b81d9d63aa34"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa49756e872ab4edaea405b81d9d63aa34">REKEY_SA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00098">notify_payload.h:98</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00188">payload.h:188</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00138">payload.h:138</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00193">payload.h:193</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212">ESP_TFC_PADDING_NOT_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00099">notify_payload.h:99</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
</div><!-- fragment --><p>payload order for CREATE_CHILD_SA from initiator. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00352">352</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6edf5057079822ba83cc529d2413db4c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> create_child_sa_i_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a>,                    1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0,  <a class="code" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>,       <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00168">payload.h:168</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00188">payload.h:188</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00138">payload.h:138</a></div></div>
<div class="ttc" id="message_8c_html_a38b3c546e75469ac1ebe228f78b51b07"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a></div><div class="ttdeci">#define MAX_VID_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00059">message.c:59</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00193">payload.h:193</a></div></div>
<div class="ttc" id="message_8c_html_a3973eab87906a64f6c2f84dd30c87f47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a></div><div class="ttdeci">#define MAX_NOTIFY_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00044">message.c:44</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
</div><!-- fragment --><p>Message rule for CREATE_CHILD_SA from initiator. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00336">336</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8b392ad6bda37ea9a6e18fb3d1329ea5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> create_child_sa_r_order[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5">IPCOMP_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2">USE_TRANSPORT_MODE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212">ESP_TFC_PADDING_NOT_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0">NON_FIRST_FRAGMENTS_ALSO</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a>,                    0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3b150a3b94a12896c7b4dc0426b66350">ADDITIONAL_TS_POSSIBLE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0},</div>
<div class="line">}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00168">payload.h:168</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5">IPCOMP_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00092">notify_payload.h:92</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0">NON_FIRST_FRAGMENTS_ALSO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00100">notify_payload.h:100</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2">USE_TRANSPORT_MODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00096">notify_payload.h:96</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa3b150a3b94a12896c7b4dc0426b66350"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3b150a3b94a12896c7b4dc0426b66350">ADDITIONAL_TS_POSSIBLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00091">notify_payload.h:91</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00188">payload.h:188</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00138">payload.h:138</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00193">payload.h:193</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212">ESP_TFC_PADDING_NOT_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00099">notify_payload.h:99</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
</div><!-- fragment --><p>payload order for CREATE_CHILD_SA from responder. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00387">387</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a742f3c4cf7888cd9bde9e36be1d8c58e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> create_child_sa_r_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a>,                    1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0,  <a class="code" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>,       <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00168">payload.h:168</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00188">payload.h:188</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00138">payload.h:138</a></div></div>
<div class="ttc" id="message_8c_html_a38b3c546e75469ac1ebe228f78b51b07"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a></div><div class="ttdeci">#define MAX_VID_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00059">message.c:59</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00193">payload.h:193</a></div></div>
<div class="ttc" id="message_8c_html_a3973eab87906a64f6c2f84dd30c87f47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a></div><div class="ttdeci">#define MAX_NOTIFY_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00044">message.c:44</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
</div><!-- fragment --><p>Message rule for CREATE_CHILD_SA from responder. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00371">371</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a92513e460d7b086c961e6a19bc33768c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> ike_auth_i_order[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea46ef6d66e6d8fd2d62de10efd4110bb6">PLV2_ID_INITIATOR</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8">PLV2_CERTIFICATE</a>,              0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaabe783c459550a2063b00988bc7dee61c">INITIAL_CONTACT</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa41bd77d12fbcbde18d866f54f1c14f36">HTTP_CERT_LOOKUP_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17">PLV2_CERTREQ</a>,                  0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e">PLV2_ID_RESPONDER</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040">PLV2_AUTH</a>,                     0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a>,                      0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5">IPCOMP_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2">USE_TRANSPORT_MODE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212">ESP_TFC_PADDING_NOT_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0">NON_FIRST_FRAGMENTS_ALSO</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa19eae656e7dee71b655abc7d4d947430">MOBIKE_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29782c06fab82a3b5a6ea57cf3d418f1">ADDITIONAL_IP4_ADDRESS</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaadae514a926d833373305c019819ec51b">ADDITIONAL_IP6_ADDRESS</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa6be3949cd1376d951485bc045a96d819">NO_ADDITIONAL_ADDRESSES</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0},</div>
<div class="line">}</div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5">IPCOMP_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00092">notify_payload.h:92</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040">PLV2_AUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00163">payload.h:163</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0">NON_FIRST_FRAGMENTS_ALSO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00100">notify_payload.h:100</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea46ef6d66e6d8fd2d62de10efd4110bb6"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea46ef6d66e6d8fd2d62de10efd4110bb6">PLV2_ID_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00143">payload.h:143</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2">USE_TRANSPORT_MODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00096">notify_payload.h:96</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa6be3949cd1376d951485bc045a96d819"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa6be3949cd1376d951485bc045a96d819">NO_ADDITIONAL_ADDRESSES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00105">notify_payload.h:105</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00208">payload.h:208</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00188">payload.h:188</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17">PLV2_CERTREQ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00158">payload.h:158</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaadae514a926d833373305c019819ec51b"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaadae514a926d833373305c019819ec51b">ADDITIONAL_IP6_ADDRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00104">notify_payload.h:104</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e">PLV2_ID_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00148">payload.h:148</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa19eae656e7dee71b655abc7d4d947430"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa19eae656e7dee71b655abc7d4d947430">MOBIKE_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00102">notify_payload.h:102</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa29782c06fab82a3b5a6ea57cf3d418f1"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29782c06fab82a3b5a6ea57cf3d418f1">ADDITIONAL_IP4_ADDRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00103">notify_payload.h:103</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00193">payload.h:193</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa41bd77d12fbcbde18d866f54f1c14f36"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa41bd77d12fbcbde18d866f54f1c14f36">HTTP_CERT_LOOKUP_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00097">notify_payload.h:97</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212">ESP_TFC_PADDING_NOT_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00099">notify_payload.h:99</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8">PLV2_CERTIFICATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00153">payload.h:153</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaabe783c459550a2063b00988bc7dee61c"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaabe783c459550a2063b00988bc7dee61c">INITIAL_CONTACT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00089">notify_payload.h:89</a></div></div>
</div><!-- fragment --><p>payload order for IKE_AUTH initiator </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00207">207</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad5e9f53d9e3629d93c9e261315d18735"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> ike_auth_i_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a>,                      0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040">PLV2_AUTH</a>,                     0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea46ef6d66e6d8fd2d62de10efd4110bb6">PLV2_ID_INITIATOR</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8">PLV2_CERTIFICATE</a>,              0,  <a class="code" href="../../d0/d6d/message_8c.html#ae1bf82ba0751af9ecd6eb3586f0a01ae">MAX_CERT_PAYLOADS</a>,      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17">PLV2_CERTREQ</a>,                  0,  <a class="code" href="../../d0/d6d/message_8c.html#ad4c9c82da02268e686d587f92e2c137e">MAX_CERTREQ_PAYLOADS</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e">PLV2_ID_RESPONDER</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0,  <a class="code" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>,       <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040">PLV2_AUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00163">payload.h:163</a></div></div>
<div class="ttc" id="message_8c_html_ae1bf82ba0751af9ecd6eb3586f0a01ae"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ae1bf82ba0751af9ecd6eb3586f0a01ae">MAX_CERT_PAYLOADS</a></div><div class="ttdeci">#define MAX_CERT_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00054">message.c:54</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea46ef6d66e6d8fd2d62de10efd4110bb6"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea46ef6d66e6d8fd2d62de10efd4110bb6">PLV2_ID_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00143">payload.h:143</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="message_8c_html_ad4c9c82da02268e686d587f92e2c137e"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ad4c9c82da02268e686d587f92e2c137e">MAX_CERTREQ_PAYLOADS</a></div><div class="ttdeci">#define MAX_CERTREQ_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00064">message.c:64</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00208">payload.h:208</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00188">payload.h:188</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17">PLV2_CERTREQ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00158">payload.h:158</a></div></div>
<div class="ttc" id="message_8c_html_a38b3c546e75469ac1ebe228f78b51b07"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a></div><div class="ttdeci">#define MAX_VID_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00059">message.c:59</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e">PLV2_ID_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00148">payload.h:148</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00193">payload.h:193</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8">PLV2_CERTIFICATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00153">payload.h:153</a></div></div>
<div class="ttc" id="message_8c_html_a3973eab87906a64f6c2f84dd30c87f47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a></div><div class="ttdeci">#define MAX_NOTIFY_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00044">message.c:44</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
</div><!-- fragment --><p>Message rule for IKE_AUTH from initiator. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00181">181</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9638fc256bd159c93f01cd6288229efe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> ike_auth_r_order[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e">PLV2_ID_RESPONDER</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8">PLV2_CERTIFICATE</a>,              0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040">PLV2_AUTH</a>,                     0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a>,                      0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5">IPCOMP_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2">USE_TRANSPORT_MODE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212">ESP_TFC_PADDING_NOT_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0">NON_FIRST_FRAGMENTS_ALSO</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa1e70735b5a7619cda2ed5fd6c0daf5d4">AUTH_LIFETIME</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa19eae656e7dee71b655abc7d4d947430">MOBIKE_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29782c06fab82a3b5a6ea57cf3d418f1">ADDITIONAL_IP4_ADDRESS</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaadae514a926d833373305c019819ec51b">ADDITIONAL_IP6_ADDRESS</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa6be3949cd1376d951485bc045a96d819">NO_ADDITIONAL_ADDRESSES</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0},</div>
<div class="line">}</div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaa99e29da84cd0b7ecd26a28726224ca5">IPCOMP_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00092">notify_payload.h:92</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040">PLV2_AUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00163">payload.h:163</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa3d832477cd688fd3484f3507444a4ae0">NON_FIRST_FRAGMENTS_ALSO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00100">notify_payload.h:100</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29a8c4ad7ab959004d41d3e7ef57c4e2">USE_TRANSPORT_MODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00096">notify_payload.h:96</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa6be3949cd1376d951485bc045a96d819"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa6be3949cd1376d951485bc045a96d819">NO_ADDITIONAL_ADDRESSES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00105">notify_payload.h:105</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00208">payload.h:208</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00188">payload.h:188</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaadae514a926d833373305c019819ec51b"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaadae514a926d833373305c019819ec51b">ADDITIONAL_IP6_ADDRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00104">notify_payload.h:104</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e">PLV2_ID_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00148">payload.h:148</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa19eae656e7dee71b655abc7d4d947430"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa19eae656e7dee71b655abc7d4d947430">MOBIKE_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00102">notify_payload.h:102</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa29782c06fab82a3b5a6ea57cf3d418f1"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa29782c06fab82a3b5a6ea57cf3d418f1">ADDITIONAL_IP4_ADDRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00103">notify_payload.h:103</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00193">payload.h:193</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa38ec03ac36c6191ca76560ab72672212">ESP_TFC_PADDING_NOT_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00099">notify_payload.h:99</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8">PLV2_CERTIFICATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00153">payload.h:153</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa1e70735b5a7619cda2ed5fd6c0daf5d4"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa1e70735b5a7619cda2ed5fd6c0daf5d4">AUTH_LIFETIME</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00110">notify_payload.h:110</a></div></div>
</div><!-- fragment --><p>payload order for IKE_AUTH responder </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00255">255</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2964eae37b9d6fa4c537ea67f02a827c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> ike_auth_r_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a>,                      0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040">PLV2_AUTH</a>,                     0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8">PLV2_CERTIFICATE</a>,              0,  <a class="code" href="../../d0/d6d/message_8c.html#ae1bf82ba0751af9ecd6eb3586f0a01ae">MAX_CERT_PAYLOADS</a>,      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e">PLV2_ID_RESPONDER</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a>,             0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0,  <a class="code" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>,       <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea49a003552f202c295efd08ecc395f040">PLV2_AUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00163">payload.h:163</a></div></div>
<div class="ttc" id="message_8c_html_ae1bf82ba0751af9ecd6eb3586f0a01ae"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ae1bf82ba0751af9ecd6eb3586f0a01ae">MAX_CERT_PAYLOADS</a></div><div class="ttdeci">#define MAX_CERT_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00054">message.c:54</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaa4732fe49356c8c15750989876f46b51">PLV2_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00208">payload.h:208</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea62c37a96303a1ad4af8bab4efd7ef1f4">PLV2_TS_INITIATOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00188">payload.h:188</a></div></div>
<div class="ttc" id="message_8c_html_a38b3c546e75469ac1ebe228f78b51b07"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a></div><div class="ttdeci">#define MAX_VID_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00059">message.c:59</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2f0688c6c3194efbddcc8f8ed9cad98e">PLV2_ID_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00148">payload.h:148</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea6d2df2e136680e7d54b6d0b28858d371">PLV2_TS_RESPONDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00193">payload.h:193</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae6920dca2886d012aadb076f6f746ec8">PLV2_CERTIFICATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00153">payload.h:153</a></div></div>
<div class="ttc" id="message_8c_html_a3973eab87906a64f6c2f84dd30c87f47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a></div><div class="ttdeci">#define MAX_NOTIFY_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00044">message.c:44</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
</div><!-- fragment --><p>Message rule for IKE_AUTH from responder. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00237">237</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="afe511bd7dd3c87d3a9f726224733c8e9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> ike_sa_init_i_order[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaad332f40ff939841638eb5ff5bfcb9834">COOKIE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a>,                    0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a">NAT_DETECTION_SOURCE_IP</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3">NAT_DETECTION_DESTINATION_IP</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0},</div>
<div class="line">}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00168">payload.h:168</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3">NAT_DETECTION_DESTINATION_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00094">notify_payload.h:94</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a">NAT_DETECTION_SOURCE_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00093">notify_payload.h:93</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00138">payload.h:138</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaad332f40ff939841638eb5ff5bfcb9834"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaad332f40ff939841638eb5ff5bfcb9834">COOKIE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00095">notify_payload.h:95</a></div></div>
</div><!-- fragment --><p>payload order for IKE_SA_INIT initiator </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00137">137</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="abc4bfd8aaaa377a07fe518c10a3bec62"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> ike_sa_init_i_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a>,             1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a>,                    1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0,  <a class="code" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>,       <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00168">payload.h:168</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00138">payload.h:138</a></div></div>
<div class="ttc" id="message_8c_html_a38b3c546e75469ac1ebe228f78b51b07"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a></div><div class="ttdeci">#define MAX_VID_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00059">message.c:59</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="message_8c_html_a3973eab87906a64f6c2f84dd30c87f47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a></div><div class="ttdeci">#define MAX_NOTIFY_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00044">message.c:44</a></div></div>
</div><!-- fragment --><p>Message rule for IKE_SA_INIT from initiator. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00125">125</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a476a1e9804ef4b85f6c4f0f8b2014fed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> ike_sa_init_r_order[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a>,             0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a>,                    0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a">NAT_DETECTION_SOURCE_IP</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3">NAT_DETECTION_DESTINATION_IP</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa41bd77d12fbcbde18d866f54f1c14f36">HTTP_CERT_LOOKUP_SUPPORTED</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17">PLV2_CERTREQ</a>,                  0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0},</div>
<div class="line">}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00168">payload.h:168</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3">NAT_DETECTION_DESTINATION_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00094">notify_payload.h:94</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a">NAT_DETECTION_SOURCE_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00093">notify_payload.h:93</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00138">payload.h:138</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17">PLV2_CERTREQ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00158">payload.h:158</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa41bd77d12fbcbde18d866f54f1c14f36"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa41bd77d12fbcbde18d866f54f1c14f36">HTTP_CERT_LOOKUP_SUPPORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00097">notify_payload.h:97</a></div></div>
</div><!-- fragment --><p>payload order for IKE_SA_INIT responder </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00165">165</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6a334ff924c1215d2282940536ec5f8b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> ike_sa_init_r_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>,     1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a>,             1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a>,                    1,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17">PLV2_CERTREQ</a>,                  0,  <a class="code" href="../../d0/d6d/message_8c.html#ad4c9c82da02268e686d587f92e2c137e">MAX_CERTREQ_PAYLOADS</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0,  <a class="code" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>,       <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,  FALSE},</div>
<div class="line">}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea376971f76d424307775dd569fcc67e90">PLV2_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00168">payload.h:168</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="message_8c_html_ad4c9c82da02268e686d587f92e2c137e"><div class="ttname"><a href="../../d0/d6d/message_8c.html#ad4c9c82da02268e686d587f92e2c137e">MAX_CERTREQ_PAYLOADS</a></div><div class="ttdeci">#define MAX_CERTREQ_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00064">message.c:64</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeae897568d57f8f4edd822dc638f3dbd70">PLV2_KEY_EXCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00138">payload.h:138</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea304ed2f8b35bbe82eb5ed1cc851a7e17">PLV2_CERTREQ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00158">payload.h:158</a></div></div>
<div class="ttc" id="message_8c_html_a38b3c546e75469ac1ebe228f78b51b07"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a></div><div class="ttdeci">#define MAX_VID_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00059">message.c:59</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="message_8c_html_a3973eab87906a64f6c2f84dd30c87f47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a></div><div class="ttdeci">#define MAX_NOTIFY_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00044">message.c:44</a></div></div>
</div><!-- fragment --><p>Message rule for IKE_SA_INIT from responder. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00152">152</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8f86c8440b70bccd00ad7b11a2af21a2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> informational_i_order[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaeb915b04085a29db49d325cbaefc17cc">UPDATE_SA_ADDRESSES</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a">NAT_DETECTION_SOURCE_IP</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3">NAT_DETECTION_DESTINATION_IP</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa73c7bea88adf285d87dea66f974e7518">COOKIE2</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f">PLV2_DELETE</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0},</div>
<div class="line">}</div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3">NAT_DETECTION_DESTINATION_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00094">notify_payload.h:94</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a">NAT_DETECTION_SOURCE_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00093">notify_payload.h:93</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaaeb915b04085a29db49d325cbaefc17cc"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaeb915b04085a29db49d325cbaefc17cc">UPDATE_SA_ADDRESSES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00106">notify_payload.h:106</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f">PLV2_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00178">payload.h:178</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa73c7bea88adf285d87dea66f974e7518"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa73c7bea88adf285d87dea66f974e7518">COOKIE2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00107">notify_payload.h:107</a></div></div>
</div><!-- fragment --><p>payload order for INFORMATIONAL initiator </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00294">294</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8bcaeabc0de01edffc5564810112c72e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> informational_i_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f">PLV2_DELETE</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a1cf903b5b85af33775169d09695b3fb4">MAX_DELETE_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0,  <a class="code" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>,       <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="message_8c_html_a1cf903b5b85af33775169d09695b3fb4"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a1cf903b5b85af33775169d09695b3fb4">MAX_DELETE_PAYLOADS</a></div><div class="ttdeci">#define MAX_DELETE_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00049">message.c:49</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="message_8c_html_a38b3c546e75469ac1ebe228f78b51b07"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a></div><div class="ttdeci">#define MAX_VID_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00059">message.c:59</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f">PLV2_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00178">payload.h:178</a></div></div>
<div class="ttc" id="message_8c_html_a3973eab87906a64f6c2f84dd30c87f47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a></div><div class="ttdeci">#define MAX_NOTIFY_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00044">message.c:44</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
</div><!-- fragment --><p>Message rule for INFORMATIONAL from initiator. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00282">282</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="af7aca85772df5de7297265313dc7ae68"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/de1/structpayload__order__t.html">payload_order_t</a> informational_r_order[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaeb915b04085a29db49d325cbaefc17cc">UPDATE_SA_ADDRESSES</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a">NAT_DETECTION_SOURCE_IP</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3">NAT_DETECTION_DESTINATION_IP</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   <a class="code" href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa73c7bea88adf285d87dea66f974e7518">COOKIE2</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f">PLV2_DELETE</a>,                   0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0},</div>
<div class="line">}</div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa9c033e0fd2336656fc328a38c25212a3">NAT_DETECTION_DESTINATION_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00094">notify_payload.h:94</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa0a4ba9b1c6105448652d398d0a4cd26a">NAT_DETECTION_SOURCE_IP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00093">notify_payload.h:93</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaaeb915b04085a29db49d325cbaefc17cc"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaaeb915b04085a29db49d325cbaefc17cc">UPDATE_SA_ADDRESSES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00106">notify_payload.h:106</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f">PLV2_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00178">payload.h:178</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
<div class="ttc" id="group__notify__payload_html_ggab6c94f52cd7f074f81f537e08b89bdcaa73c7bea88adf285d87dea66f974e7518"><div class="ttname"><a href="../../da/d2c/group__notify__payload.html#ggab6c94f52cd7f074f81f537e08b89bdcaa73c7bea88adf285d87dea66f974e7518">COOKIE2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d22/notify__payload_8h_source.html#l00107">notify_payload.h:107</a></div></div>
</div><!-- fragment --><p>payload order for INFORMATIONAL responder </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00321">321</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1dc31af4b015b32fa174b4975f93baa2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d56/structpayload__rule__t.html">payload_rule_t</a> informational_r_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line"></div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a>,                 0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   TRUE},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a>,            0,  1,                      <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f">PLV2_DELETE</a>,                   0,  <a class="code" href="../../d0/d6d/message_8c.html#a1cf903b5b85af33775169d09695b3fb4">MAX_DELETE_PAYLOADS</a>,    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">    {<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a>,                0,  <a class="code" href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a>,       <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,   <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>},</div>
<div class="line">}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="message_8c_html_a1cf903b5b85af33775169d09695b3fb4"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a1cf903b5b85af33775169d09695b3fb4">MAX_DELETE_PAYLOADS</a></div><div class="ttdeci">#define MAX_DELETE_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00049">message.c:49</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeab68ea9a64037c502d7abfdb2c70a6ecd">PLV2_CONFIGURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00203">payload.h:203</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea3f2167a7028929a14e91414444bf02a4">PLV2_VENDOR_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00183">payload.h:183</a></div></div>
<div class="ttc" id="message_8c_html_a38b3c546e75469ac1ebe228f78b51b07"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a38b3c546e75469ac1ebe228f78b51b07">MAX_VID_PAYLOADS</a></div><div class="ttdeci">#define MAX_VID_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00059">message.c:59</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea2d35446caa39ad6537f32e7474bd952c">PLV2_NOTIFY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00173">payload.h:173</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea55fd960110e43d80e96a44794b98be9f">PLV2_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00178">payload.h:178</a></div></div>
<div class="ttc" id="message_8c_html_a3973eab87906a64f6c2f84dd30c87f47"><div class="ttname"><a href="../../d0/d6d/message_8c.html#a3973eab87906a64f6c2f84dd30c87f47">MAX_NOTIFY_PAYLOADS</a></div><div class="ttdeci">#define MAX_NOTIFY_PAYLOADS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l00044">message.c:44</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea4970eacf20b700748d8d1b782d9c20cb">PLV2_FRAGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00233">payload.h:233</a></div></div>
</div><!-- fragment --><p>Message rule for INFORMATIONAL from responder. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00309">309</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
<a class="anchor" id="abd569f38c38b78a84afb781f2041068d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/dcd/structmessage__rule__t.html">message_rule_t</a> message_rules[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Message rules, defines allowed payloads. </p>

<p>Definition at line <a class="el" href="../../d0/d6d/message_8c_source.html#l00733">733</a> of file <a class="el" href="../../d0/d6d/message_8c_source.html">message.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_6f5ceac4aae5af0cdf8d7537278832cd.html">libcharon</a></li><li class="navelem"><a class="el" href="../../dir_01cb0b2e878b9d228bff90b1955627e8.html">encoding</a></li><li class="navelem"><a class="el" href="../../d0/d6d/message_8c.html">message.c</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:03:52 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
