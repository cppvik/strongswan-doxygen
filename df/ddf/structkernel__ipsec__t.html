<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: kernel_ipsec_t Struct Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('df/ddf/structkernel__ipsec__t.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../d7/d32/structkernel__ipsec__t-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">kernel_ipsec_t Struct Reference<div class="ingroups"><a class="el" href="../../dc/d4a/group__kernel__ipsec.html">kernel_ipsec</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>&quot;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a03d76555af66d012ad9debf297d4c25b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/group__kernel__interface.html#ga039a38d35321a297417331e6a9731d05">kernel_feature_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a03d76555af66d012ad9debf297d4c25b">get_features</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this)</td></tr>
<tr class="separator:a03d76555af66d012ad9debf297d4c25b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf0eda4bfe4822446b4ecd4e53b720b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#acf0eda4bfe4822446b4ecd4e53b720b1">get_spi</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t *spi)</td></tr>
<tr class="separator:acf0eda4bfe4822446b4ecd4e53b720b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79af7cc2ee1f6b90607aba1f0230ff4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a79af7cc2ee1f6b90607aba1f0230ff4a">get_cpi</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int16_t *cpi)</td></tr>
<tr class="separator:a79af7cc2ee1f6b90607aba1f0230ff4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5864e84eb0e54e2970eb8c4b4e8cea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#aec5864e84eb0e54e2970eb8c4b4e8cea">add_sa</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t reqid, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, u_int32_t tfc, <a class="el" href="../../db/d18/structlifetime__cfg__t.html">lifetime_cfg_t</a> *lifetime, u_int16_t enc_alg, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> enc_key, u_int16_t int_alg, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> int_key, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a> mode, u_int16_t ipcomp, u_int16_t cpi, u_int32_t replay_window, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> encap, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> esn, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> inbound, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d4/da5/watcher_8c.html#a555c5ce92a336acef1ff02fb00381924">update</a>, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *src_ts, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *dst_ts)</td></tr>
<tr class="separator:aec5864e84eb0e54e2970eb8c4b4e8cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d09dd8e1eaf076ee967f181f6c1c530"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a6d09dd8e1eaf076ee967f181f6c1c530">update_sa</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t cpi, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *new_src, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *new_dst, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> encap, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> new_encap, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark)</td></tr>
<tr class="separator:a6d09dd8e1eaf076ee967f181f6c1c530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2fcceb4a727974d00d23978759021b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#ae2fcceb4a727974d00d23978759021b8">query_sa</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, u_int64_t *<a class="el" href="../../d4/d2b/leak__detective_8c.html#a560b3a4f7e96e03dde71fcb1eb36d25f">bytes</a>, u_int64_t *packets, time_t *time)</td></tr>
<tr class="separator:ae2fcceb4a727974d00d23978759021b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a474ee3aef44ce035ce6bebf8635d2d31"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a474ee3aef44ce035ce6bebf8635d2d31">del_sa</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t cpi, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark)</td></tr>
<tr class="separator:a474ee3aef44ce035ce6bebf8635d2d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f3cc17dd31474ba2b3f24ef64cae48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#ab2f3cc17dd31474ba2b3f24ef64cae48">flush_sas</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this)</td></tr>
<tr class="separator:ab2f3cc17dd31474ba2b3f24ef64cae48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab79511a78f8a5cad6a39b331f905c411"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#ab79511a78f8a5cad6a39b331f905c411">add_policy</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga9819e3d53b7af6756cde6e1299376d43">policy_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../df/d7b/structipsec__sa__cfg__t.html">ipsec_sa_cfg_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga8f7b420ca3c549a6e610bb9fa30da31f">policy_priority_t</a> priority)</td></tr>
<tr class="separator:ab79511a78f8a5cad6a39b331f905c411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e8fadb9db482f9f818223845840a7d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a9e8fadb9db482f9f818223845840a7d8">query_policy</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, time_t *use_time)</td></tr>
<tr class="separator:a9e8fadb9db482f9f818223845840a7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c97e3425477b13f4bbe285a962fd5cd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a6c97e3425477b13f4bbe285a962fd5cd">del_policy</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga9819e3d53b7af6756cde6e1299376d43">policy_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../df/d7b/structipsec__sa__cfg__t.html">ipsec_sa_cfg_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga8f7b420ca3c549a6e610bb9fa30da31f">policy_priority_t</a> priority)</td></tr>
<tr class="separator:a6c97e3425477b13f4bbe285a962fd5cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dadfd7d294ed208f886f2164d1b61fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a1dadfd7d294ed208f886f2164d1b61fc">flush_policies</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this)</td></tr>
<tr class="separator:a1dadfd7d294ed208f886f2164d1b61fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6b18187bbac29c6bdc2ec154eb8d3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a7d6b18187bbac29c6bdc2ec154eb8d3a">bypass_socket</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, int fd, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</td></tr>
<tr class="separator:a7d6b18187bbac29c6bdc2ec154eb8d3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bcba4248d4518121465be78082d12c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#a4bcba4248d4518121465be78082d12c4">enable_udp_decap</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, int fd, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a9e26a4afe91a21810290057677a17a11">port</a>)</td></tr>
<tr class="separator:a4bcba4248d4518121465be78082d12c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9c91574b3599ed53ed2920a04f10d04"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html#ae9c91574b3599ed53ed2920a04f10d04">destroy</a> )(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this)</td></tr>
<tr class="separator:ae9c91574b3599ed53ed2920a04f10d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface to the ipsec subsystem of the kernel.</p>
<p>The kernel ipsec interface handles the communication with the kernel for SA and policy management. It allows setup of these, and provides further the handling of kernel events. Policy information are cached in the interface. This is necessary to do reference counting. The Linux kernel does not allow the same policy installed twice, but we need this as CHILD_SA exist multiple times when rekeying. Thats why we do reference counting of policies. </p>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00046">46</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>
</div><h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ab79511a78f8a5cad6a39b331f905c411"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::add_policy)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga9819e3d53b7af6756cde6e1299376d43">policy_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../df/d7b/structipsec__sa__cfg__t.html">ipsec_sa_cfg_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga8f7b420ca3c549a6e610bb9fa30da31f">policy_priority_t</a> priority)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a policy to the SPD.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address of SA </td></tr>
    <tr><td class="paramname">dst</td><td>dest address of SA </td></tr>
    <tr><td class="paramname">src_ts</td><td>traffic selector to match traffic source </td></tr>
    <tr><td class="paramname">dst_ts</td><td>traffic selector to match traffic dest </td></tr>
    <tr><td class="paramname">direction</td><td>direction of traffic, POLICY_(IN|OUT|FWD) </td></tr>
    <tr><td class="paramname">type</td><td>type of policy, POLICY_(IPSEC|PASS|DROP) </td></tr>
    <tr><td class="paramname">sa</td><td>details about the SA(s) tied to this policy </td></tr>
    <tr><td class="paramname">mark</td><td>mark for this policy </td></tr>
    <tr><td class="paramname">priority</td><td>priority of this policy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00200">200</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="aec5864e84eb0e54e2970eb8c4b4e8cea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::add_sa)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t reqid, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, u_int32_t tfc, <a class="el" href="../../db/d18/structlifetime__cfg__t.html">lifetime_cfg_t</a> *lifetime, u_int16_t enc_alg, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> enc_key, u_int16_t int_alg, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> int_key, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a> mode, u_int16_t ipcomp, u_int16_t cpi, u_int32_t replay_window, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> encap, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> esn, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> inbound, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d4/da5/watcher_8c.html#a555c5ce92a336acef1ff02fb00381924">update</a>, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *src_ts, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *dst_ts)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add an SA to the SAD.</p>
<p>This function does install a single SA for a single protocol in one direction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address for this SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address for this SA </td></tr>
    <tr><td class="paramname">spi</td><td>SPI allocated by us or remote peer </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for this SA (ESP/AH) </td></tr>
    <tr><td class="paramname">reqid</td><td>unique ID for this SA </td></tr>
    <tr><td class="paramname">mark</td><td>mark for this SA </td></tr>
    <tr><td class="paramname">tfc</td><td>Traffic Flow Confidentiality padding for this SA </td></tr>
    <tr><td class="paramname">lifetime</td><td><a class="el" href="../../db/d18/structlifetime__cfg__t.html">lifetime_cfg_t</a> for this SA </td></tr>
    <tr><td class="paramname">enc_alg</td><td>Algorithm to use for encryption (ESP only) </td></tr>
    <tr><td class="paramname">enc_key</td><td>key to use for encryption </td></tr>
    <tr><td class="paramname">int_alg</td><td>Algorithm to use for integrity protection </td></tr>
    <tr><td class="paramname">int_key</td><td>key to use for integrity protection </td></tr>
    <tr><td class="paramname">mode</td><td>mode of the SA (tunnel, transport) </td></tr>
    <tr><td class="paramname">ipcomp</td><td>IPComp transform to use </td></tr>
    <tr><td class="paramname">cpi</td><td>CPI for IPComp </td></tr>
    <tr><td class="paramname">replay_window</td><td>anti-replay window size </td></tr>
    <tr><td class="paramname">initiator</td><td>TRUE if initiator of the exchange creating this SA </td></tr>
    <tr><td class="paramname">encap</td><td>enable UDP encapsulation for NAT traversal </td></tr>
    <tr><td class="paramname">esn</td><td>TRUE to use Extended Sequence Numbers </td></tr>
    <tr><td class="paramname">inbound</td><td>TRUE if this is an inbound SA </td></tr>
    <tr><td class="paramname">update</td><td>TRUE if an SPI has already been allocated for SA </td></tr>
    <tr><td class="paramname">src_ts</td><td>list of source traffic selectors </td></tr>
    <tr><td class="paramname">dst_ts</td><td>list of destination traffic selectors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00109">109</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7d6b18187bbac29c6bdc2ec154eb8d3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_ipsec_t::bypass_socket)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, int fd, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Install a bypass policy for the given socket.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>socket file descriptor to setup policy for </td></tr>
    <tr><td class="paramname">family</td><td>protocol family of the socket </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE of policy set up successfully </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00264">264</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6c97e3425477b13f4bbe285a962fd5cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::del_policy)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga9819e3d53b7af6756cde6e1299376d43">policy_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../df/d7b/structipsec__sa__cfg__t.html">ipsec_sa_cfg_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga8f7b420ca3c549a6e610bb9fa30da31f">policy_priority_t</a> priority)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a policy from the SPD.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address of SA </td></tr>
    <tr><td class="paramname">dst</td><td>dest address of SA </td></tr>
    <tr><td class="paramname">src_ts</td><td>traffic selector to match traffic source </td></tr>
    <tr><td class="paramname">dst_ts</td><td>traffic selector to match traffic dest </td></tr>
    <tr><td class="paramname">direction</td><td>direction of traffic, POLICY_(IN|OUT|FWD) </td></tr>
    <tr><td class="paramname">type</td><td>type of policy, POLICY_(IPSEC|PASS|DROP) </td></tr>
    <tr><td class="paramname">sa</td><td>details about the SA(s) tied to this policy </td></tr>
    <tr><td class="paramname">mark</td><td>mark for this policy </td></tr>
    <tr><td class="paramname">priority</td><td>priority of the policy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00242">242</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a474ee3aef44ce035ce6bebf8635d2d31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::del_sa)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t cpi, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete a previusly installed SA from the SAD.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address for this SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address for this SA </td></tr>
    <tr><td class="paramname">spi</td><td>SPI allocated by us or remote peer </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for this SA (ESP/AH) </td></tr>
    <tr><td class="paramname">cpi</td><td>CPI for IPComp or 0 </td></tr>
    <tr><td class="paramname">mark</td><td>optional mark for this SA </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00175">175</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae9c91574b3599ed53ed2920a04f10d04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_ipsec_t::destroy)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroy the implementation. </p>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00280">280</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4bcba4248d4518121465be78082d12c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_ipsec_t::enable_udp_decap)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, int fd, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a9e26a4afe91a21810290057677a17a11">port</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enable decapsulation of ESP-in-UDP packets for the given port/socket.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>socket file descriptor </td></tr>
    <tr><td class="paramname">family</td><td>protocol family of the socket </td></tr>
    <tr><td class="paramname">port</td><td>the UDP port </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if UDP decapsulation was enabled successfully </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00274">274</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1dadfd7d294ed208f886f2164d1b61fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::flush_policies)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flush all policies from the SPD.</p>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00255">255</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab2f3cc17dd31474ba2b3f24ef64cae48"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::flush_sas)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flush all SAs from the SAD.</p>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00184">184</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a79af7cc2ee1f6b90607aba1f0230ff4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::get_cpi)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int16_t *cpi)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a Compression Parameter Index (CPI) from the kernel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address of SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address of SA </td></tr>
    <tr><td class="paramname">cpi</td><td>allocated cpi </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00075">75</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a03d76555af66d012ad9debf297d4c25b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/db7/group__kernel__interface.html#ga039a38d35321a297417331e6a9731d05">kernel_feature_t</a>(* kernel_ipsec_t::get_features)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the feature set supported by this kernel backend.</p>
<dl class="section return"><dt>Returns</dt><dd>ORed feature-set of backend </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00053">53</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="acf0eda4bfe4822446b4ecd4e53b720b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::get_spi)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t *spi)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a SPI from the kernel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address of SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address of SA </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for SA (ESP/AH) </td></tr>
    <tr><td class="paramname">spi</td><td>allocated spi </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00064">64</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9e8fadb9db482f9f818223845840a7d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::query_policy)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, time_t *use_time)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Query the use time of a policy.</p>
<p>The use time of a policy is the time the policy was used for the last time. It is not the system time, but a monotonic timestamp as returned by time_monotonic.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">src_ts</td><td>traffic selector to match traffic source </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dst_ts</td><td>traffic selector to match traffic dest </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">direction</td><td>direction of traffic, POLICY_(IN|OUT|FWD) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mark</td><td>optional mark </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">use_time</td><td>the monotonic timestamp of this SA's last use </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00222">222</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae2fcceb4a727974d00d23978759021b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::query_sa)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, u_int64_t *<a class="el" href="../../d4/d2b/leak__detective_8c.html#a560b3a4f7e96e03dde71fcb1eb36d25f">bytes</a>, u_int64_t *packets, time_t *time)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Query the number of bytes processed by an SA from the SAD.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">src</td><td>source address for this SA </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dst</td><td>destination address for this SA </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">spi</td><td>SPI allocated by us or remote peer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">protocol</td><td>protocol for this SA (ESP/AH) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mark</td><td>optional mark for this SA </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bytes</td><td>the number of bytes processed by SA </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">packets</td><td>number of packets processed by SA </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">time</td><td>last (monotonic) time of SA use </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00160">160</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<a class="anchor" id="a6d09dd8e1eaf076ee967f181f6c1c530"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_ipsec_t::update_sa)(<a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a> *this, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t cpi, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *new_src, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *new_dst, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> encap, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> new_encap, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update the hosts on an installed SA.</p>
<p>We cannot directly update the destination address as the kernel requires the spi, the protocol AND the destination address (and family) to identify SAs. Therefore if the destination address changed we create a new SA and delete the old one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spi</td><td>SPI of the SA </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for this SA (ESP/AH) </td></tr>
    <tr><td class="paramname">cpi</td><td>CPI for IPComp, 0 if no IPComp is used </td></tr>
    <tr><td class="paramname">src</td><td>current source address </td></tr>
    <tr><td class="paramname">dst</td><td>current destination address </td></tr>
    <tr><td class="paramname">new_src</td><td>new source address </td></tr>
    <tr><td class="paramname">new_dst</td><td>new destination address </td></tr>
    <tr><td class="paramname">encap</td><td>current use of UDP encapsulation </td></tr>
    <tr><td class="paramname">new_encap</td><td>new use of UDP encapsulation </td></tr>
    <tr><td class="paramname">mark</td><td>optional mark for this SA </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed, NOT_SUPPORTED if the kernel interface can't update the SA </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html#l00141">141</a> of file <a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="../../d3/d46/kernel__ipsec_8h_source.html">kernel_ipsec.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../df/ddf/structkernel__ipsec__t.html">kernel_ipsec_t</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:27 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
