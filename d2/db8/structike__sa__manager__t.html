<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: ike_sa_manager_t Struct Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/db8/structike__sa__manager__t.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../de/d6c/structike__sa__manager__t-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ike_sa_manager_t Struct Reference<div class="ingroups"><a class="el" href="../../d9/dc4/group__ike__sa__manager.html">ike_sa_manager</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>&quot;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for ike_sa_manager_t:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../dc/d9f/structike__sa__manager__t__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a89136da14b05a270a93ca24b6fc96041"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a89136da14b05a270a93ca24b6fc96041">checkout</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *sa_id)</td></tr>
<tr class="separator:a89136da14b05a270a93ca24b6fc96041"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afaf56e6a4f064c5fd154cd94af4893a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#afaf56e6a4f064c5fd154cd94af4893a4">checkout_new</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../dd/d6e/group__ike__cfg.html#gaf1772828c8c0e7d70e61a65f8b7653f2">ike_version_t</a> <a class="el" href="../../d2/d0b/version_8c.html#a5fd4c14b95cb371aafc8810b4bf2bad9">version</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>)</td></tr>
<tr class="separator:afaf56e6a4f064c5fd154cd94af4893a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8d26c24c146e8b435a97a7a9f303f4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a1c8d26c24c146e8b435a97a7a9f303f4">checkout_by_message</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message)</td></tr>
<tr class="separator:a1c8d26c24c146e8b435a97a7a9f303f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3549e96ab073bdb5ae0c1f7fe1343e47"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a3549e96ab073bdb5ae0c1f7fe1343e47">checkout_by_config</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *peer_cfg)</td></tr>
<tr class="separator:a3549e96ab073bdb5ae0c1f7fe1343e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a00f6ba54c104c9d8abc0e92b112180"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a0a00f6ba54c104c9d8abc0e92b112180">check_uniqueness</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *ike_sa, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> force_replace)</td></tr>
<tr class="separator:a0a00f6ba54c104c9d8abc0e92b112180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf352d3d470a6cb075654cd0554a7190"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#acf352d3d470a6cb075654cd0554a7190">has_contact</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="el" href="../../de/dca/__copyright_8c.html#a8d99cc5943d3316a2bdf3e111028fc7a">me</a>, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *other, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</td></tr>
<tr class="separator:acf352d3d470a6cb075654cd0554a7190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b306297d56f5f39880678ab389bd90e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a5b306297d56f5f39880678ab389bd90e">checkout_by_id</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, u_int32_t <a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>)</td></tr>
<tr class="separator:a5b306297d56f5f39880678ab389bd90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25013323f66243ce894a6f2d8efdabd9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a25013323f66243ce894a6f2d8efdabd9">checkout_by_name</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, char *<a class="el" href="../../d7/da0/test__parser_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> child)</td></tr>
<tr class="separator:a25013323f66243ce894a6f2d8efdabd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a380e79bbf4a9865d53b5ff17e414c1f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a380e79bbf4a9865d53b5ff17e414c1f2">create_enumerator</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> wait)</td></tr>
<tr class="separator:a380e79bbf4a9865d53b5ff17e414c1f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a3d822333003af4f1ad636d860f664b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a2a3d822333003af4f1ad636d860f664b">create_id_enumerator</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="el" href="../../de/dca/__copyright_8c.html#a8d99cc5943d3316a2bdf3e111028fc7a">me</a>, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *other, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</td></tr>
<tr class="separator:a2a3d822333003af4f1ad636d860f664b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6e1b4f8b0d0465c08b27be4a3a9f8d"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a7c6e1b4f8b0d0465c08b27be4a3a9f8d">checkin</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *ike_sa)</td></tr>
<tr class="separator:a7c6e1b4f8b0d0465c08b27be4a3a9f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8439440e32ec39e0ab664188a1c0cd"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a0b8439440e32ec39e0ab664188a1c0cd">checkin_and_destroy</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *ike_sa)</td></tr>
<tr class="separator:a0b8439440e32ec39e0ab664188a1c0cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a881f4ff99c9089f50b2e6057ef492c92"><td class="memItemLeft" align="right" valign="top">u_int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a881f4ff99c9089f50b2e6057ef492c92">get_count</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this)</td></tr>
<tr class="separator:a881f4ff99c9089f50b2e6057ef492c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37f348992904d82416a392f80ec4f9b1"><td class="memItemLeft" align="right" valign="top">u_int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a37f348992904d82416a392f80ec4f9b1">get_half_open_count</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> responder_only)</td></tr>
<tr class="separator:a37f348992904d82416a392f80ec4f9b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adddc998ad70d053f0d9f9782c56bcccd"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#adddc998ad70d053f0d9f9782c56bcccd">set_spi_cb</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/dc4/group__ike__sa__manager.html#gab3e2a1ef385b124b71b4db2a5692b572">spi_cb_t</a> <a class="el" href="../../d4/dbf/integrity__checker_8c.html#aa031f022c8f58ea5f468a68268858ad1">callback</a>, void *<a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>)</td></tr>
<tr class="separator:adddc998ad70d053f0d9f9782c56bcccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add14f1bedeae2190a79c29a24a99f7cd"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#add14f1bedeae2190a79c29a24a99f7cd">flush</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this)</td></tr>
<tr class="separator:add14f1bedeae2190a79c29a24a99f7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a98bc673ea7e205c26b5ea3f5e9fcd2"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/db8/structike__sa__manager__t.html#a2a98bc673ea7e205c26b5ea3f5e9fcd2">destroy</a> )(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this)</td></tr>
<tr class="separator:a2a98bc673ea7e205c26b5ea3f5e9fcd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manages and synchronizes access to all IKE_SAs.</p>
<p>To synchronize access to thread-unsave IKE_SAs, they are checked out for use and checked in afterwards. A checked out SA is exclusively accessible by the owning thread. </p>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00050">50</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>
</div><h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a0a00f6ba54c104c9d8abc0e92b112180"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* ike_sa_manager_t::check_uniqueness)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *ike_sa, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> force_replace)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check for duplicates of the given IKE_SA.</p>
<p>Measures are taken according to the uniqueness policy of the IKE_SA. The return value indicates whether duplicates have been found and if further measures should be taken (e.g. cancelling an IKE_AUTH exchange). <a class="el" href="../../d2/db8/structike__sa__manager__t.html#a0a00f6ba54c104c9d8abc0e92b112180">check_uniqueness()</a> must be called before the IKE_SA is complete, deadlocks occur otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ike_sa</td><td>ike_sa to check </td></tr>
    <tr><td class="paramname">force_replace</td><td>replace existing SAs, regardless of unique policy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if the given IKE_SA has duplicates and should be deleted </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00125">125</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d42/xauth_8c_source.html#l00149">allowed()</a>, and <a class="el" href="../../d4/d06/aggressive__mode_8c_source.html#l00210">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c6e1b4f8b0d0465c08b27be4a3a9f8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* ike_sa_manager_t::checkin)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *ike_sa)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checkin the SA after usage.</p>
<p>If the IKE_SA is not registered in the manager, a new entry is created.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ike_sa_id</td><td>the SA identifier, will be updated </td></tr>
    <tr><td class="paramname">ike_sa</td><td>checked out SA </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00200">200</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/df5/unity__handler_8c_source.html#l00205">add_exclude_async()</a>, <a class="el" href="../../d1/d52/eap__radius__dae_8c_source.html#l00295">apply_lifetime()</a>, <a class="el" href="../../d5/dec/child__sa__manager_8c_source.html#l00204">checkout_ikesa()</a>, <a class="el" href="../../d0/d53/nm__service_8c_source.html#l00284">connect_()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00200">disconnect()</a>, <a class="el" href="../../d4/dcb/ike__rekey_8c_source.html#l00093">establish_new()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00226">initiate_connection()</a>, <a class="el" href="../../d9/d32/connect__manager_8c_source.html#l01179">initiate_mediated()</a>, <a class="el" href="../../d0/d49/adopt__children__job_8c_source.html#l00057">METHOD()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00635">process_child_add()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00869">process_child_delete()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00127">process_ike_add()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00519">process_ike_iv()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00474">process_ike_mid()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00310">process_ike_update()</a>, <a class="el" href="../../d0/d76/ha__cache_8c_source.html#l00254">rekey_segment()</a>, <a class="el" href="../../d1/dd0/eap__radius__accounting_8c_source.html#l00515">send_interim()</a>, and <a class="el" href="../../d3/d0b/task__manager__v2_8c_source.html#l01524">trigger_mbb_reauth()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b8439440e32ec39e0ab664188a1c0cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* ike_sa_manager_t::checkin_and_destroy)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a> *ike_sa)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroy a checked out SA.</p>
<p>The IKE SA is destroyed without notification of the remote peer. Use this only if the other peer doesn't respond or behaves not as predicted. Checking in and destruction is an atomic operation (for the IKE_SA), so this can be called if the SA is in a "unclean" state, without the risk that another thread can get the SA.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ike_sa</td><td>SA to delete </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00214">214</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d52/eap__radius__dae_8c_source.html#l00295">apply_lifetime()</a>, <a class="el" href="../../d0/d53/nm__service_8c_source.html#l00284">connect_()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00226">initiate_connection()</a>, <a class="el" href="../../d9/d32/connect__manager_8c_source.html#l01179">initiate_mediated()</a>, <a class="el" href="../../d0/d49/adopt__children__job_8c_source.html#l00057">METHOD()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00127">process_ike_add()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00572">process_ike_delete()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00310">process_ike_update()</a>, <a class="el" href="../../d0/d76/ha__cache_8c_source.html#l00254">rekey_segment()</a>, and <a class="el" href="../../d3/d0b/task__manager__v2_8c_source.html#l01524">trigger_mbb_reauth()</a>.</p>

</div>
</div>
<a class="anchor" id="a89136da14b05a270a93ca24b6fc96041"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a>*(* ike_sa_manager_t::checkout)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *sa_id)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checkout an existing IKE_SA.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ike_sa_id</td><td>the SA identifier, will be updated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>checked out IKE_SA if found</li>
<li>NULL, if specified IKE_SA is not found. </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00060">60</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/df5/unity__handler_8c_source.html#l00205">add_exclude_async()</a>, <a class="el" href="../../d1/d52/eap__radius__dae_8c_source.html#l00295">apply_lifetime()</a>, <a class="el" href="../../d5/dec/child__sa__manager_8c_source.html#l00204">checkout_ikesa()</a>, <a class="el" href="../../d9/d32/connect__manager_8c_source.html#l01179">initiate_mediated()</a>, <a class="el" href="../../d0/d49/adopt__children__job_8c_source.html#l00057">METHOD()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00635">process_child_add()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00869">process_child_delete()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00127">process_ike_add()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00572">process_ike_delete()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00519">process_ike_iv()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00474">process_ike_mid()</a>, <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00310">process_ike_update()</a>, <a class="el" href="../../d0/d76/ha__cache_8c_source.html#l00254">rekey_segment()</a>, and <a class="el" href="../../d1/dd0/eap__radius__accounting_8c_source.html#l00515">send_interim()</a>.</p>

</div>
</div>
<a class="anchor" id="a3549e96ab073bdb5ae0c1f7fe1343e47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a>*(* ike_sa_manager_t::checkout_by_config)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *peer_cfg)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checkout an IKE_SA for initiation by a peer_config.</p>
<p>To initiate, a CHILD_SA may be established within an existing IKE_SA. This call checks for an existing IKE_SA by comparing the configuration. If the CHILD_SA can be created in an existing IKE_SA, the matching SA is returned. If no IKE_SA is found, a new one is created. This is also the case when the found IKE_SA is in the DELETING state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">peer_cfg</td><td>configuration used to find an existing IKE_SA </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>checked out/created IKE_SA </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00108">108</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d53/nm__service_8c_source.html#l00284">connect_()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00226">initiate_connection()</a>, and <a class="el" href="../../d1/d75/controller_8c_source.html#l00352">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a5b306297d56f5f39880678ab389bd90e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a>*(* ike_sa_manager_t::checkout_by_id)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, u_int32_t <a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check out an IKE_SA a unique ID.</p>
<p>Every IKE_SA is uniquely identified by a numerical ID. This checkout function uses the unique ID of the IKE_SA to check it out.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>unique ID of the object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>checked out IKE_SA, if found</li>
<li>NULL, if not found </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00150">150</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d75/controller_8c_source.html#l00492">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a1c8d26c24c146e8b435a97a7a9f303f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a>*(* ike_sa_manager_t::checkout_by_message)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checkout an IKE_SA by a message.</p>
<p>In some situations, it is necessary that the manager knows the message to use for the checkout. This has the following reasons:</p>
<ol type="1">
<li>If the targeted IKE_SA is already processing a message, we do not check it out if the message ID is the same.</li>
<li>If it is an IKE_SA_INIT request, we have to check if it is a retransmission. If so, we have to drop the message, we would create another unneeded IKE_SA for each retransmitted packet.</li>
</ol>
<p>A call to <a class="el" href="../../d2/db8/structike__sa__manager__t.html#a1c8d26c24c146e8b435a97a7a9f303f4">checkout_by_message()</a> returns a (maybe new created) IKE_SA. If processing the message does not make sense (for the reasons above), NULL is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ike_sa_id</td><td>the SA identifier, will be updated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>checked out/created IKE_SA</li>
<li>NULL to not process message further </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00093">93</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d43/process__message__job_8c_source.html#l00045">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a25013323f66243ce894a6f2d8efdabd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a>*(* ike_sa_manager_t::checkout_by_name)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, char *<a class="el" href="../../d7/da0/test__parser_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> child)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check out an IKE_SA by the policy/connection name.</p>
<p>Check out the IKE_SA by the configuration name, either from the IKE- or one of its CHILD_SAs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>name of the connection/policy </td></tr>
    <tr><td class="paramname">child</td><td>TRUE to use policy name, FALSE to use conn name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>checked out IKE_SA, if found</li>
<li>NULL, if not found </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00164">164</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00200">disconnect()</a>.</p>

</div>
</div>
<a class="anchor" id="afaf56e6a4f064c5fd154cd94af4893a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d7d/structike__sa__t.html">ike_sa_t</a>*(* ike_sa_manager_t::checkout_new)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../dd/d6e/group__ike__cfg.html#gaf1772828c8c0e7d70e61a65f8b7653f2">ike_version_t</a> <a class="el" href="../../d2/d0b/version_8c.html#a5fd4c14b95cb371aafc8810b4bf2bad9">version</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and check out a new IKE_SA.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">version</td><td>IKE version of this SA </td></tr>
    <tr><td class="paramname">initiator</td><td>TRUE for initiator, FALSE otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>created and checked out IKE_SA </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00069">69</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/dcb/ike__rekey_8c_source.html#l00151">METHOD()</a>, and <a class="el" href="../../d3/d0b/task__manager__v2_8c_source.html#l01524">trigger_mbb_reauth()</a>.</p>

</div>
</div>
<a class="anchor" id="a380e79bbf4a9865d53b5ff17e414c1f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a>*(* ike_sa_manager_t::create_enumerator)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> wait)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an enumerator over all stored IKE_SAs.</p>
<p>While enumerating an IKE_SA, it is temporarily checked out and automatically checked in after the current enumeration step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wait</td><td>TRUE to wait for checked out SAs, FALSE to skip </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>enumerator over all IKE_SAs. </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00176">176</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d52/eap__radius__dae_8c_source.html#l00202">add_matching_ike_sas()</a>, <a class="el" href="../../d0/d9f/systime__fix__plugin_8c_source.html#l00123">check_systime()</a>, <a class="el" href="../../d3/de7/eap__radius__plugin_8c_source.html#l00408">delete_all_async()</a>, <a class="el" href="../../da/dfd/ha__segments_8c_source.html#l00132">enable_disable()</a>, <a class="el" href="../../d1/d75/controller_8c_source.html#l00345">METHOD()</a>, <a class="el" href="../../d0/d76/ha__cache_8c_source.html#l00254">rekey_segment()</a>, and <a class="el" href="../../dd/dda/stroke__socket_8c_source.html#l00424">stroke_export()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a3d822333003af4f1ad636d860f664b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a>*(* ike_sa_manager_t::create_id_enumerator)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="el" href="../../de/dca/__copyright_8c.html#a8d99cc5943d3316a2bdf3e111028fc7a">me</a>, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *other, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create an enumerator over ike_sa_id_t*, matching peer identities.</p>
<p>The remote peer is identified by its XAuth or EAP identity, if available.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">me</td><td>local peer identity to match </td></tr>
    <tr><td class="paramname">other</td><td>remote peer identity to match </td></tr>
    <tr><td class="paramname">family</td><td>address family to match, 0 for any </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>enumerator over ike_sa_id_t* </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00188">188</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d49/adopt__children__job_8c_source.html#l00057">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a98bc673ea7e205c26b5ea3f5e9fcd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* ike_sa_manager_t::destroy)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroys the manager with all associated SAs.</p>
<p>A call to <a class="el" href="../../d2/db8/structike__sa__manager__t.html#add14f1bedeae2190a79c29a24a99f7cd">flush()</a> is required before calling destroy. </p>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00262">262</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

</div>
</div>
<a class="anchor" id="add14f1bedeae2190a79c29a24a99f7cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* ike_sa_manager_t::flush)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete all existing IKE_SAs and destroy them immediately.</p>
<p>Threads will be driven out, so all SAs can be deleted cleanly. To a <a class="el" href="../../d2/db8/structike__sa__manager__t.html#add14f1bedeae2190a79c29a24a99f7cd">flush()</a>, an immediate call to <a class="el" href="../../d2/db8/structike__sa__manager__t.html#a2a98bc673ea7e205c26b5ea3f5e9fcd2">destroy()</a> is mandatory; no other method may be used. </p>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00255">255</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

</div>
</div>
<a class="anchor" id="a881f4ff99c9089f50b2e6057ef492c92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_int(* ike_sa_manager_t::get_count)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the number of IKE_SAs currently registered.</p>
<dl class="section return"><dt>Returns</dt><dd>number of registered IKE_SAs </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00221">221</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d64/vici__query_8c_source.html#l00930">CALLBACK()</a>, <a class="el" href="../../d4/d98/load__tester__plugin_8c_source.html#l00103">do_load_test()</a>, and <a class="el" href="../../dd/df3/stroke__list_8c_source.html#l00461">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a37f348992904d82416a392f80ec4f9b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u_int(* ike_sa_manager_t::get_half_open_count)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> responder_only)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the number of IKE_SAs which are in the connecting state.</p>
<p>To prevent the server from resource exhaustion, cookies and other mechanisms are used. The number of half open IKE_SAs is a good indicator to see if a peer is flooding the server. If a host is supplied, only the number of half open IKE_SAs with this IP are counted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>NULL for all, IP for half open IKE_SAs with IP </td></tr>
    <tr><td class="paramname">responder_only</td><td>TRUE to return only the number of responding SAs </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of half open IKE_SAs </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00236">236</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d64/vici__query_8c_source.html#l00930">CALLBACK()</a>, <a class="el" href="../../d0/d09/receiver_8c_source.html#l00323">drop_ike_sa_init()</a>, and <a class="el" href="../../d1/d75/controller_8c_source.html#l00352">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="acf352d3d470a6cb075654cd0554a7190"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* ike_sa_manager_t::has_contact)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="el" href="../../de/dca/__copyright_8c.html#a8d99cc5943d3316a2bdf3e111028fc7a">me</a>, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *other, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if we already have a connected IKE_SA between two identities.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">me</td><td>own identity </td></tr>
    <tr><td class="paramname">other</td><td>remote identity </td></tr>
    <tr><td class="paramname">family</td><td>address family to include in uniqueness check </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if we have a connected IKE_SA </dd></dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00136">136</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/dde/main__mode_8c_source.html#l00211">add_initial_contact()</a>, and <a class="el" href="../../de/dc6/ike__auth_8c_source.html#l00388">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="adddc998ad70d053f0d9f9782c56bcccd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* ike_sa_manager_t::set_spi_cb)(<a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a> *this, <a class="el" href="../../d9/dc4/group__ike__sa__manager.html#gab3e2a1ef385b124b71b4db2a5692b572">spi_cb_t</a> <a class="el" href="../../d4/dbf/integrity__checker_8c.html#aa031f022c8f58ea5f468a68268858ad1">callback</a>, void *<a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the callback to generate IKE SPIs</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>callback to register </td></tr>
    <tr><td class="paramname">data</td><td>data provided to callback </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html#l00245">245</a> of file <a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d10/tkm__spi__generator_8c_source.html#l00053">tkm_spi_generator_register()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="../../df/dfa/ike__sa__manager_8h_source.html">ike_sa_manager.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d2/db8/structike__sa__manager__t.html">ike_sa_manager_t</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:27 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
