<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: proposal_substructure</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d6/d71/group__proposal__substructure.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">proposal_substructure<div class="ingroups"><a class="el" href="../../da/d0f/group__payloads.html">payloads</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for proposal_substructure:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure.svg" width="286" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga80644a13304287bdd02edfaebd1bb183"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d71/group__proposal__substructure.html#ga80644a13304287bdd02edfaebd1bb183">encap_t</a></td></tr>
<tr class="separator:ga80644a13304287bdd02edfaebd1bb183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67d0ab7ba7d8ed2dfb0cb91271016985"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d71/group__proposal__substructure.html#ga67d0ab7ba7d8ed2dfb0cb91271016985">proposal_substructure_t</a></td></tr>
<tr class="separator:ga67d0ab7ba7d8ed2dfb0cb91271016985"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga94089dafca07099af41f0ba3dfd7db39"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a> { <a class="el" href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39a295c0c45f8e818c9f87ce2316ea07058">ENCAP_NONE</a> = 0, 
<a class="el" href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39a10d905005b5ff109c3c15ab3be32c9d5">ENCAP_UDP</a>, 
<a class="el" href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39ad19702fa8921acf39fad5dd230a988df">ENCAP_UDP_DRAFT_00_03</a>
 }</td></tr>
<tr class="separator:ga94089dafca07099af41f0ba3dfd7db39"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad73e112be0e9ace7724a1f2916a52b80"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d71/group__proposal__substructure.html#gad73e112be0e9ace7724a1f2916a52b80">proposal_substructure_create</a> (<a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>)</td></tr>
<tr class="separator:gad73e112be0e9ace7724a1f2916a52b80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1429e5b3f5fdd5e37228391b0dd00dd1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d71/group__proposal__substructure.html#ga1429e5b3f5fdd5e37228391b0dd00dd1">proposal_substructure_create_from_proposal_v2</a> (<a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>)</td></tr>
<tr class="separator:ga1429e5b3f5fdd5e37228391b0dd00dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00bb12c5883ff1c6a5b7ca88cba0d5ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d71/group__proposal__substructure.html#ga00bb12c5883ff1c6a5b7ca88cba0d5ac">proposal_substructure_create_from_proposal_v1</a> (<a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, u_int32_t lifetime, u_int64_t lifebytes, <a class="el" href="../../da/d5b/group__authenticator.html#ga8071dc90e8e461c4be73b26588aead90">auth_method_t</a> auth, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a> mode, <a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a> udp)</td></tr>
<tr class="separator:ga00bb12c5883ff1c6a5b7ca88cba0d5ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa5c12125229b25b10320d21f6ed8877"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d71/group__proposal__substructure.html#gafa5c12125229b25b10320d21f6ed8877">proposal_substructure_create_from_proposals_v1</a> (<a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *proposals, u_int32_t lifetime, u_int64_t lifebytes, <a class="el" href="../../da/d5b/group__authenticator.html#ga8071dc90e8e461c4be73b26588aead90">auth_method_t</a> auth, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a> mode, <a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a> udp)</td></tr>
<tr class="separator:gafa5c12125229b25b10320d21f6ed8877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaedb90af1501afa61e185a695d78fd558"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d71/group__proposal__substructure.html#gaedb90af1501afa61e185a695d78fd558">proposal_substructure_create_for_ipcomp_v1</a> (u_int32_t lifetime, u_int64_t lifebytes, u_int16_t cpi, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a> mode, <a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a> udp, u_int8_t proposal_number)</td></tr>
<tr class="separator:gaedb90af1501afa61e185a695d78fd558"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga80644a13304287bdd02edfaebd1bb183"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a> <a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/d17/proposal__substructure_8h_source.html#l00026">26</a> of file <a class="el" href="../../df/d17/proposal__substructure_8h_source.html">proposal_substructure.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga67d0ab7ba7d8ed2dfb0cb91271016985"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/d17/proposal__substructure_8h_source.html#l00027">27</a> of file <a class="el" href="../../df/d17/proposal__substructure_8h_source.html">proposal_substructure.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga94089dafca07099af41f0ba3dfd7db39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encap type for proposal substructure </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="gga94089dafca07099af41f0ba3dfd7db39a295c0c45f8e818c9f87ce2316ea07058"></a>ENCAP_NONE</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga94089dafca07099af41f0ba3dfd7db39a10d905005b5ff109c3c15ab3be32c9d5"></a>ENCAP_UDP</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga94089dafca07099af41f0ba3dfd7db39ad19702fa8921acf39fad5dd230a988df"></a>ENCAP_UDP_DRAFT_00_03</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="../../df/d17/proposal__substructure_8h_source.html#l00040">40</a> of file <a class="el" href="../../df/d17/proposal__substructure_8h_source.html">proposal_substructure.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;             {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39a295c0c45f8e818c9f87ce2316ea07058">ENCAP_NONE</a> = 0,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39a10d905005b5ff109c3c15ab3be32c9d5">ENCAP_UDP</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39ad19702fa8921acf39fad5dd230a988df">ENCAP_UDP_DRAFT_00_03</a>,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;};</div>
<div class="ttc" id="group__proposal__substructure_html_gga94089dafca07099af41f0ba3dfd7db39ad19702fa8921acf39fad5dd230a988df"><div class="ttname"><a href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39ad19702fa8921acf39fad5dd230a988df">ENCAP_UDP_DRAFT_00_03</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d17/proposal__substructure_8h_source.html#l00043">proposal_substructure.h:43</a></div></div>
<div class="ttc" id="group__proposal__substructure_html_gga94089dafca07099af41f0ba3dfd7db39a295c0c45f8e818c9f87ce2316ea07058"><div class="ttname"><a href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39a295c0c45f8e818c9f87ce2316ea07058">ENCAP_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d17/proposal__substructure_8h_source.html#l00041">proposal_substructure.h:41</a></div></div>
<div class="ttc" id="group__proposal__substructure_html_gga94089dafca07099af41f0ba3dfd7db39a10d905005b5ff109c3c15ab3be32c9d5"><div class="ttname"><a href="../../d6/d71/group__proposal__substructure.html#gga94089dafca07099af41f0ba3dfd7db39a10d905005b5ff109c3c15ab3be32c9d5">ENCAP_UDP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d17/proposal__substructure_8h_source.html#l00042">proposal_substructure.h:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gad73e112be0e9ace7724a1f2916a52b80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a>* proposal_substructure_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d90/group__payload.html#ga910814947f5e241c851b42e95e8586ee">payload_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an empty <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> object</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>PLV2_PROPOSAL_SUBSTRUCTURE or PLV1_PROPOSAL_SUBSTRUCTURE </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> object </dd></dl>

<p>Definition at line <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01217">1217</a> of file <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html">proposal_substructure.c</a>.</p>

<p>References <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l00435">compute_length()</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list_create()</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00048">PL_NONE</a>, and <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>.</p>

<p>Referenced by <a class="el" href="../../dc/df9/payload_8c_source.html#l00187">payload_create()</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01609">proposal_substructure_create_for_ipcomp_v1()</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01535">proposal_substructure_create_from_proposal_v1()</a>, and <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01519">proposal_substructure_create_from_proposal_v2()</a>.</p>
<div class="fragment"><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;{</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(<span class="keyword">this</span>,</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        .<span class="keyword">public</span> = {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            .payload_interface = {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                .verify = _verify,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                .get_encoding_rules = _get_encoding_rules,</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                .get_header_length = _get_header_length,</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                .get_length = _get_length,</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                .get_next_type = _get_next_type,</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                .set_next_type = _set_next_type,</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                .get_type = _get_type,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                .destroy = _destroy,</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            },</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            .set_proposal_number = _set_proposal_number,</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            .get_proposal_number = _get_proposal_number,</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            .set_protocol_id = _set_protocol_id,</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            .get_protocol_id = _get_protocol_id,</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            .set_is_last_proposal = _set_is_last_proposal,</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            .get_proposals = _get_proposals,</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            .create_substructure_enumerator = _create_substructure_enumerator,</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            .set_spi = _set_spi,</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            .get_spi = _get_spi,</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            .get_cpi = _get_cpi,</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            .get_lifetime = _get_lifetime,</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            .get_lifebytes = _get_lifebytes,</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            .get_auth_method = _get_auth_method,</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            .get_encap_mode = _get_encap_mode,</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            .destroy = _destroy,</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        },</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        .next_payload = <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a>,</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        .transforms = <a class="code" href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a>(),</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        .type = <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>,</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    );</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <a class="code" href="../../d6/dba/proposal__substructure_8c.html#ae41211f5db0d00daffe91d0391f86909">compute_length</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;}</div>
<div class="ttc" id="group__linked__list_html_ga15bb4333e53dbef32d196e4388f43fdf"><div class="ttname"><a href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a></div><div class="ttdeci">linked_list_t * linked_list_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list.c:484</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_ae41211f5db0d00daffe91d0391f86909"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#ae41211f5db0d00daffe91d0391f86909">compute_length</a></div><div class="ttdeci">static void compute_length(private_proposal_substructure_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00435">proposal_substructure.c:435</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structprivate__proposal__substructure__t_html"><div class="ttname"><a href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00038">proposal_substructure.c:38</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00048">payload.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_gad73e112be0e9ace7724a1f2916a52b80_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_gad73e112be0e9ace7724a1f2916a52b80_icgraph.svg" width="100%" height="516"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gaedb90af1501afa61e185a695d78fd558"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a>* proposal_substructure_create_for_ipcomp_v1 </td>
          <td>(</td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int64_t&#160;</td>
          <td class="paramname"><em>lifebytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>cpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a>&#160;</td>
          <td class="paramname"><em>udp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>proposal_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an IKEv1 <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> for IPComp with the given proposal_number (e.g. of a ESP proposal to bundle them).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lifetime</td><td>lifetime in seconds </td></tr>
    <tr><td class="paramname">lifebytes</td><td>lifebytes, in bytes </td></tr>
    <tr><td class="paramname">cpi</td><td>the CPI to be used </td></tr>
    <tr><td class="paramname">mode</td><td>IPsec encapsulation mode, TRANSPORT or TUNNEL </td></tr>
    <tr><td class="paramname">udp</td><td>ENCAP_UDP to use UDP encapsulation </td></tr>
    <tr><td class="paramname">proposal_number</td><td>the proposal number of the proposal to be linked </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>IKEv1 <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> PLV1_PROPOSAL_SUBSTRUCTURE</dd></dl>
<p>See header. </p>

<p>Definition at line <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01609">1609</a> of file <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html">proposal_substructure.c</a>.</p>

<p>References <a class="el" href="../../d7/dfc/transform__substructure_8h_source.html#l00057">transform_substructure_t::add_transform_attribute</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l00460">add_transform_substructure()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00251">chunk_clone</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l00435">compute_length()</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l00845">get_ikev1_mode()</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l00321">IKEV1_IPCOMP_DEFLATE</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l00283">IKEV1_LIFE_TYPE_KILOBYTES</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l00282">IKEV1_LIFE_TYPE_SECONDS</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00279">PLV1_PROPOSAL_SUBSTRUCTURE</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00299">PLV1_TRANSFORM_ATTRIBUTE</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00289">PLV1_TRANSFORM_SUBSTRUCTURE</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01217">proposal_substructure_create()</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00046">PROTO_IPCOMP</a>, <a class="el" href="../../db/dfb/transform__attribute_8h_source.html#l00056">TATTR_PH2_ENCAP_MODE</a>, <a class="el" href="../../db/dfb/transform__attribute_8h_source.html#l00054">TATTR_PH2_SA_LIFE_DURATION</a>, <a class="el" href="../../db/dfb/transform__attribute_8h_source.html#l00053">TATTR_PH2_SA_LIFE_TYPE</a>, <a class="el" href="../../d2/d93/transform__attribute_8c_source.html#l00252">transform_attribute_create_value()</a>, and <a class="el" href="../../d0/d62/transform__substructure_8c_source.html#l00305">transform_substructure_create_type()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d1a/sa__payload_8c_source.html#l00560">sa_payload_create_from_proposals_v1()</a>.</p>
<div class="fragment"><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;{</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <a class="code" href="../../d2/d7b/structtransform__substructure__t.html">transform_substructure_t</a> *transform;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keyword">this</span> = (<a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a>*)</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                        <a class="code" href="../../d6/d71/group__proposal__substructure.html#gad73e112be0e9ace7724a1f2916a52b80">proposal_substructure_create</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeabb5621203585d4ce4e6328684f9b37e5">PLV1_PROPOSAL_SUBSTRUCTURE</a>);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">/* we currently support DEFLATE only */</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    transform = <a class="code" href="../../d0/d5c/group__transform__substructure.html#ga9342b01373e2d842549982ac66d48dc8">transform_substructure_create_type</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea43745a903f110fd61ecebe7a3a2f1988">PLV1_TRANSFORM_SUBSTRUCTURE</a>,</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                                                   1, <a class="code" href="../../d6/dba/proposal__substructure_8c.html#a5864d95ac68c899a8dbf2a3438c04b7ea1ebb2ae61649b41bb6734389dfe8ac87">IKEV1_IPCOMP_DEFLATE</a>);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    transform-&gt;<a class="code" href="../../d2/d7b/structtransform__substructure__t.html#a3d9654f85ea77b8080efcb5f2b80129f">add_transform_attribute</a>(transform,</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <a class="code" href="../../d9/dad/group__transform__attribute.html#gaa0e84baba8a541b4eb4926a21f975df2">transform_attribute_create_value</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaebb79fe0c28b17a87b536e936bd2b1e9">PLV1_TRANSFORM_ATTRIBUTE</a>,</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                            <a class="code" href="../../d9/dad/group__transform__attribute.html#gga7500cb312fee08e208549699b72ff4a7a5e09ee9efda2fdfc31b9a3899cd602ae">TATTR_PH2_ENCAP_MODE</a>, <a class="code" href="../../d6/dba/proposal__substructure_8c.html#ad6638c554b73c4ff680af2afd822f100">get_ikev1_mode</a>(mode, udp)));</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordflow">if</span> (lifetime)</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    {</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        transform-&gt;<a class="code" href="../../d2/d7b/structtransform__substructure__t.html#a3d9654f85ea77b8080efcb5f2b80129f">add_transform_attribute</a>(transform,</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            <a class="code" href="../../d9/dad/group__transform__attribute.html#gaa0e84baba8a541b4eb4926a21f975df2">transform_attribute_create_value</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaebb79fe0c28b17a87b536e936bd2b1e9">PLV1_TRANSFORM_ATTRIBUTE</a>,</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                            <a class="code" href="../../d9/dad/group__transform__attribute.html#gga7500cb312fee08e208549699b72ff4a7ae3f90acee898576403ce7954e1640467">TATTR_PH2_SA_LIFE_TYPE</a>, <a class="code" href="../../d6/dba/proposal__substructure_8c.html#a02341377b85a55ce0b49e01bbc09c0c4a7167f0cbac607be4b26f5fad6a55a92b">IKEV1_LIFE_TYPE_SECONDS</a>));</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        transform-&gt;<a class="code" href="../../d2/d7b/structtransform__substructure__t.html#a3d9654f85ea77b8080efcb5f2b80129f">add_transform_attribute</a>(transform,</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            <a class="code" href="../../d9/dad/group__transform__attribute.html#gaa0e84baba8a541b4eb4926a21f975df2">transform_attribute_create_value</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaebb79fe0c28b17a87b536e936bd2b1e9">PLV1_TRANSFORM_ATTRIBUTE</a>,</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                            <a class="code" href="../../d9/dad/group__transform__attribute.html#gga7500cb312fee08e208549699b72ff4a7ad2284e4cfcbd48c7bbbb6295b96647bb">TATTR_PH2_SA_LIFE_DURATION</a>, lifetime));</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    }</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">if</span> (lifebytes)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        transform-&gt;<a class="code" href="../../d2/d7b/structtransform__substructure__t.html#a3d9654f85ea77b8080efcb5f2b80129f">add_transform_attribute</a>(transform,</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            <a class="code" href="../../d9/dad/group__transform__attribute.html#gaa0e84baba8a541b4eb4926a21f975df2">transform_attribute_create_value</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaebb79fe0c28b17a87b536e936bd2b1e9">PLV1_TRANSFORM_ATTRIBUTE</a>,</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                            <a class="code" href="../../d9/dad/group__transform__attribute.html#gga7500cb312fee08e208549699b72ff4a7ae3f90acee898576403ce7954e1640467">TATTR_PH2_SA_LIFE_TYPE</a>, <a class="code" href="../../d6/dba/proposal__substructure_8c.html#a02341377b85a55ce0b49e01bbc09c0c4ad9c323cb2f84d63a6c6e097ed1cd21f4">IKEV1_LIFE_TYPE_KILOBYTES</a>));</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        transform-&gt;<a class="code" href="../../d2/d7b/structtransform__substructure__t.html#a3d9654f85ea77b8080efcb5f2b80129f">add_transform_attribute</a>(transform,</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            <a class="code" href="../../d9/dad/group__transform__attribute.html#gaa0e84baba8a541b4eb4926a21f975df2">transform_attribute_create_value</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaebb79fe0c28b17a87b536e936bd2b1e9">PLV1_TRANSFORM_ATTRIBUTE</a>,</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                            <a class="code" href="../../d9/dad/group__transform__attribute.html#gga7500cb312fee08e208549699b72ff4a7ad2284e4cfcbd48c7bbbb6295b96647bb">TATTR_PH2_SA_LIFE_DURATION</a>, lifebytes / 1000));</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <a class="code" href="../../d6/dba/proposal__substructure_8c.html#a011b033eaf1ade0daff600bb549716c2">add_transform_substructure</a>(<span class="keyword">this</span>, transform);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    this-&gt;spi = <a class="code" href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a>(<a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(cpi));</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    this-&gt;spi_size = this-&gt;spi.len;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    this-&gt;protocol_id = <a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda77e52cfe85db85702e307fece5303dcd">PROTO_IPCOMP</a>;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    this-&gt;proposal_number = proposal_number;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <a class="code" href="../../d6/dba/proposal__substructure_8c.html#ae41211f5db0d00daffe91d0391f86909">compute_length</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;}</div>
<div class="ttc" id="proposal__substructure_8c_html_a02341377b85a55ce0b49e01bbc09c0c4ad9c323cb2f84d63a6c6e097ed1cd21f4"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#a02341377b85a55ce0b49e01bbc09c0c4ad9c323cb2f84d63a6c6e097ed1cd21f4">IKEV1_LIFE_TYPE_KILOBYTES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00283">proposal_substructure.c:283</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="group__transform__attribute_html_gga7500cb312fee08e208549699b72ff4a7ad2284e4cfcbd48c7bbbb6295b96647bb"><div class="ttname"><a href="../../d9/dad/group__transform__attribute.html#gga7500cb312fee08e208549699b72ff4a7ad2284e4cfcbd48c7bbbb6295b96647bb">TATTR_PH2_SA_LIFE_DURATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfb/transform__attribute_8h_source.html#l00054">transform_attribute.h:54</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_ae41211f5db0d00daffe91d0391f86909"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#ae41211f5db0d00daffe91d0391f86909">compute_length</a></div><div class="ttdeci">static void compute_length(private_proposal_substructure_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00435">proposal_substructure.c:435</a></div></div>
<div class="ttc" id="group__transform__attribute_html_gaa0e84baba8a541b4eb4926a21f975df2"><div class="ttname"><a href="../../d9/dad/group__transform__attribute.html#gaa0e84baba8a541b4eb4926a21f975df2">transform_attribute_create_value</a></div><div class="ttdeci">transform_attribute_t * transform_attribute_create_value(payload_type_t type, transform_attribute_type_t kind, u_int64_t value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d93/transform__attribute_8c_source.html#l00252">transform_attribute.c:252</a></div></div>
<div class="ttc" id="group__transform__substructure_html_ga9342b01373e2d842549982ac66d48dc8"><div class="ttname"><a href="../../d0/d5c/group__transform__substructure.html#ga9342b01373e2d842549982ac66d48dc8">transform_substructure_create_type</a></div><div class="ttdeci">transform_substructure_t * transform_substructure_create_type(payload_type_t type, u_int8_t type_or_number, u_int16_t id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d62/transform__substructure_8c_source.html#l00305">transform_substructure.c:305</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_a011b033eaf1ade0daff600bb549716c2"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#a011b033eaf1ade0daff600bb549716c2">add_transform_substructure</a></div><div class="ttdeci">static void add_transform_substructure(private_proposal_substructure_t *this, transform_substructure_t *transform)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00460">proposal_substructure.c:460</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeaebb79fe0c28b17a87b536e936bd2b1e9"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeaebb79fe0c28b17a87b536e936bd2b1e9">PLV1_TRANSFORM_ATTRIBUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00299">payload.h:299</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_ad6638c554b73c4ff680af2afd822f100"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#ad6638c554b73c4ff680af2afd822f100">get_ikev1_mode</a></div><div class="ttdeci">static u_int16_t get_ikev1_mode(ipsec_mode_t mode, encap_t udp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00845">proposal_substructure.c:845</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea43745a903f110fd61ecebe7a3a2f1988"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea43745a903f110fd61ecebe7a3a2f1988">PLV1_TRANSFORM_SUBSTRUCTURE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00289">payload.h:289</a></div></div>
<div class="ttc" id="group__transform__attribute_html_gga7500cb312fee08e208549699b72ff4a7ae3f90acee898576403ce7954e1640467"><div class="ttname"><a href="../../d9/dad/group__transform__attribute.html#gga7500cb312fee08e208549699b72ff4a7ae3f90acee898576403ce7954e1640467">TATTR_PH2_SA_LIFE_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfb/transform__attribute_8h_source.html#l00053">transform_attribute.h:53</a></div></div>
<div class="ttc" id="group__proposal__substructure_html_gad73e112be0e9ace7724a1f2916a52b80"><div class="ttname"><a href="../../d6/d71/group__proposal__substructure.html#gad73e112be0e9ace7724a1f2916a52b80">proposal_substructure_create</a></div><div class="ttdeci">proposal_substructure_t * proposal_substructure_create(payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01217">proposal_substructure.c:1217</a></div></div>
<div class="ttc" id="group__chunk_html_gac7a055a5fa92106988cddbc641899871"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a></div><div class="ttdeci">#define chunk_clone(chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00251">chunk.h:251</a></div></div>
<div class="ttc" id="structtransform__substructure__t_html_a3d9654f85ea77b8080efcb5f2b80129f"><div class="ttname"><a href="../../d2/d7b/structtransform__substructure__t.html#a3d9654f85ea77b8080efcb5f2b80129f">transform_substructure_t::add_transform_attribute</a></div><div class="ttdeci">void(* add_transform_attribute)(transform_substructure_t *this, transform_attribute_t *attribute)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dfc/transform__substructure_8h_source.html#l00057">transform_substructure.h:57</a></div></div>
<div class="ttc" id="structtransform__substructure__t_html"><div class="ttname"><a href="../../d2/d7b/structtransform__substructure__t.html">transform_substructure_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dfc/transform__substructure_8h_source.html#l00045">transform_substructure.h:45</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_a02341377b85a55ce0b49e01bbc09c0c4a7167f0cbac607be4b26f5fad6a55a92b"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#a02341377b85a55ce0b49e01bbc09c0c4a7167f0cbac607be4b26f5fad6a55a92b">IKEV1_LIFE_TYPE_SECONDS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00282">proposal_substructure.c:282</a></div></div>
<div class="ttc" id="structprivate__proposal__substructure__t_html"><div class="ttname"><a href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00038">proposal_substructure.c:38</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeabb5621203585d4ce4e6328684f9b37e5"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeabb5621203585d4ce4e6328684f9b37e5">PLV1_PROPOSAL_SUBSTRUCTURE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00279">payload.h:279</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_a5864d95ac68c899a8dbf2a3438c04b7ea1ebb2ae61649b41bb6734389dfe8ac87"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#a5864d95ac68c899a8dbf2a3438c04b7ea1ebb2ae61649b41bb6734389dfe8ac87">IKEV1_IPCOMP_DEFLATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00321">proposal_substructure.c:321</a></div></div>
<div class="ttc" id="group__transform__attribute_html_gga7500cb312fee08e208549699b72ff4a7a5e09ee9efda2fdfc31b9a3899cd602ae"><div class="ttname"><a href="../../d9/dad/group__transform__attribute.html#gga7500cb312fee08e208549699b72ff4a7a5e09ee9efda2fdfc31b9a3899cd602ae">TATTR_PH2_ENCAP_MODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfb/transform__attribute_8h_source.html#l00056">transform_attribute.h:56</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cda77e52cfe85db85702e307fece5303dcd"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda77e52cfe85db85702e307fece5303dcd">PROTO_IPCOMP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00046">proposal.h:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_gaedb90af1501afa61e185a695d78fd558_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_gaedb90af1501afa61e185a695d78fd558_icgraph.svg" width="100%" height="377"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga00bb12c5883ff1c6a5b7ca88cba0d5ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a>* proposal_substructure_create_from_proposal_v1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *&#160;</td>
          <td class="paramname"><em>proposal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int64_t&#160;</td>
          <td class="paramname"><em>lifebytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5b/group__authenticator.html#ga8071dc90e8e461c4be73b26588aead90">auth_method_t</a>&#160;</td>
          <td class="paramname"><em>auth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a>&#160;</td>
          <td class="paramname"><em>udp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an IKEv1 <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> from a <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proposal</td><td>proposal to build a substruct out of it </td></tr>
    <tr><td class="paramname">lifetime</td><td>lifetime in seconds </td></tr>
    <tr><td class="paramname">lifebytes</td><td>lifebytes, in bytes </td></tr>
    <tr><td class="paramname">auth</td><td>authentication method to use, or AUTH_NONE </td></tr>
    <tr><td class="paramname">mode</td><td>IPsec encapsulation mode, TRANSPORT or TUNNEL </td></tr>
    <tr><td class="paramname">udp</td><td>ENCAP_UDP to use UDP encapsulation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> object PLV1_PROPOSAL_SUBSTRUCTURE</dd></dl>
<p>See header. </p>

<p>Definition at line <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01535">1535</a> of file <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html">proposal_substructure.c</a>.</p>

<p>References <a class="el" href="../../d1/d41/proposal_8h_source.html#l00137">proposal_t::get_protocol</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00279">PLV1_PROPOSAL_SUBSTRUCTURE</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01217">proposal_substructure_create()</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00044">PROTO_AH</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00045">PROTO_ESP</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00043">PROTO_IKE</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01486">set_data()</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01332">set_from_proposal_v1()</a>, and <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01261">set_from_proposal_v1_ike()</a>.</p>

<p>Referenced by <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01564">proposal_substructure_create_from_proposals_v1()</a>.</p>
<div class="fragment"><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;{</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keyword">this</span> = (<a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a>*)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                        <a class="code" href="../../d6/d71/group__proposal__substructure.html#gad73e112be0e9ace7724a1f2916a52b80">proposal_substructure_create</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeabb5621203585d4ce4e6328684f9b37e5">PLV1_PROPOSAL_SUBSTRUCTURE</a>);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordflow">switch</span> (proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#afe4ae5935443bca7d998525b2e0954db">get_protocol</a>(proposal))</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a>:</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            <a class="code" href="../../d6/dba/proposal__substructure_8c.html#a263fc9d286d8a9a188ff50f268be1794">set_from_proposal_v1_ike</a>(<span class="keyword">this</span>, proposal, lifetime, auth, 1);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a>:</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f">PROTO_AH</a>:</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <a class="code" href="../../d6/dba/proposal__substructure_8c.html#ad62e30a446eafd79f2ae081d086e2b68">set_from_proposal_v1</a>(<span class="keyword">this</span>, proposal, lifetime,</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                 lifebytes, mode, udp, 1);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <a class="code" href="../../d6/dba/proposal__substructure_8c.html#aee46d8bf7ed69187788995076df80c18">set_data</a>(<span class="keyword">this</span>, proposal);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;}</div>
<div class="ttc" id="proposal__substructure_8c_html_ad62e30a446eafd79f2ae081d086e2b68"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#ad62e30a446eafd79f2ae081d086e2b68">set_from_proposal_v1</a></div><div class="ttdeci">static void set_from_proposal_v1(private_proposal_substructure_t *this, proposal_t *proposal, u_int32_t lifetime, u_int64_t lifebytes, ipsec_mode_t mode, encap_t udp, int number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01332">proposal_substructure.c:1332</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_aee46d8bf7ed69187788995076df80c18"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#aee46d8bf7ed69187788995076df80c18">set_data</a></div><div class="ttdeci">static void set_data(private_proposal_substructure_t *this, proposal_t *proposal)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01486">proposal_substructure.c:1486</a></div></div>
<div class="ttc" id="group__proposal__substructure_html_gad73e112be0e9ace7724a1f2916a52b80"><div class="ttname"><a href="../../d6/d71/group__proposal__substructure.html#gad73e112be0e9ace7724a1f2916a52b80">proposal_substructure_create</a></div><div class="ttdeci">proposal_substructure_t * proposal_substructure_create(payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01217">proposal_substructure.c:1217</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_a263fc9d286d8a9a188ff50f268be1794"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#a263fc9d286d8a9a188ff50f268be1794">set_from_proposal_v1_ike</a></div><div class="ttdeci">static void set_from_proposal_v1_ike(private_proposal_substructure_t *this, proposal_t *proposal, u_int32_t lifetime, auth_method_t method, int number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01261">proposal_substructure.c:1261</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00045">proposal.h:45</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f">PROTO_AH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00044">proposal.h:44</a></div></div>
<div class="ttc" id="structproposal__t_html_afe4ae5935443bca7d998525b2e0954db"><div class="ttname"><a href="../../df/d06/structproposal__t.html#afe4ae5935443bca7d998525b2e0954db">proposal_t::get_protocol</a></div><div class="ttdeci">protocol_id_t(* get_protocol)(proposal_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00137">proposal.h:137</a></div></div>
<div class="ttc" id="structprivate__proposal__substructure__t_html"><div class="ttname"><a href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00038">proposal_substructure.c:38</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eeabb5621203585d4ce4e6328684f9b37e5"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eeabb5621203585d4ce4e6328684f9b37e5">PLV1_PROPOSAL_SUBSTRUCTURE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00279">payload.h:279</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00043">proposal.h:43</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_ga00bb12c5883ff1c6a5b7ca88cba0d5ac_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_ga00bb12c5883ff1c6a5b7ca88cba0d5ac_icgraph.svg" width="100%" height="377"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1429e5b3f5fdd5e37228391b0dd00dd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a>* proposal_substructure_create_from_proposal_v2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *&#160;</td>
          <td class="paramname"><em>proposal</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an IKEv2 <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> from a <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proposal</td><td>proposal to build a substruct out of it </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> PLV2_PROPOSAL_SUBSTRUCTURE </dd></dl>

<p>Definition at line <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01519">1519</a> of file <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html">proposal_substructure.c</a>.</p>

<p>References <a class="el" href="../../d4/d8b/payload_8h_source.html#l00133">PLV2_SECURITY_ASSOCIATION</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01217">proposal_substructure_create()</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01486">set_data()</a>, and <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01419">set_from_proposal_v2()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d1a/sa__payload_8c_source.html#l00263">add_proposal_v2()</a>.</p>
<div class="fragment"><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;{</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keyword">this</span> = (<a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a>*)</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                            <a class="code" href="../../d6/d71/group__proposal__substructure.html#gad73e112be0e9ace7724a1f2916a52b80">proposal_substructure_create</a>(<a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a>);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <a class="code" href="../../d6/dba/proposal__substructure_8c.html#a8d594a989e97fa06af96164fbc33a47d">set_from_proposal_v2</a>(<span class="keyword">this</span>, proposal);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <a class="code" href="../../d6/dba/proposal__substructure_8c.html#aee46d8bf7ed69187788995076df80c18">set_data</a>(<span class="keyword">this</span>, proposal);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;}</div>
<div class="ttc" id="proposal__substructure_8c_html_aee46d8bf7ed69187788995076df80c18"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#aee46d8bf7ed69187788995076df80c18">set_data</a></div><div class="ttdeci">static void set_data(private_proposal_substructure_t *this, proposal_t *proposal)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01486">proposal_substructure.c:1486</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_a8d594a989e97fa06af96164fbc33a47d"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#a8d594a989e97fa06af96164fbc33a47d">set_from_proposal_v2</a></div><div class="ttdeci">static void set_from_proposal_v2(private_proposal_substructure_t *this, proposal_t *proposal)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01419">proposal_substructure.c:1419</a></div></div>
<div class="ttc" id="group__proposal__substructure_html_gad73e112be0e9ace7724a1f2916a52b80"><div class="ttname"><a href="../../d6/d71/group__proposal__substructure.html#gad73e112be0e9ace7724a1f2916a52b80">proposal_substructure_create</a></div><div class="ttdeci">proposal_substructure_t * proposal_substructure_create(payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01217">proposal_substructure.c:1217</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea0a35c0027c75bd32c5cb090d59d54383">PLV2_SECURITY_ASSOCIATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00133">payload.h:133</a></div></div>
<div class="ttc" id="structprivate__proposal__substructure__t_html"><div class="ttname"><a href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00038">proposal_substructure.c:38</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_ga1429e5b3f5fdd5e37228391b0dd00dd1_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_ga1429e5b3f5fdd5e37228391b0dd00dd1_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gafa5c12125229b25b10320d21f6ed8877"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a>* proposal_substructure_create_from_proposals_v1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *&#160;</td>
          <td class="paramname"><em>proposals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>lifetime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int64_t&#160;</td>
          <td class="paramname"><em>lifebytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5b/group__authenticator.html#ga8071dc90e8e461c4be73b26588aead90">auth_method_t</a>&#160;</td>
          <td class="paramname"><em>auth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d71/group__proposal__substructure.html#ga94089dafca07099af41f0ba3dfd7db39">encap_t</a>&#160;</td>
          <td class="paramname"><em>udp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an IKEv1 <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> from a list of <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proposals</td><td>list of <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> to encode in a substructure </td></tr>
    <tr><td class="paramname">lifetime</td><td>lifetime in seconds </td></tr>
    <tr><td class="paramname">lifebytes</td><td>lifebytes, in bytes </td></tr>
    <tr><td class="paramname">auth</td><td>authentication method to use, or AUTH_NONE </td></tr>
    <tr><td class="paramname">mode</td><td>IPsec encapsulation mode, TRANSPORT or TUNNEL </td></tr>
    <tr><td class="paramname">udp</td><td>ENCAP_UDP to use UDP encapsulation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>IKEv1 <a class="el" href="../../d9/d53/structproposal__substructure__t.html">proposal_substructure_t</a> PLV1_PROPOSAL_SUBSTRUCTURE</dd></dl>
<p>See header. </p>

<p>Definition at line <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01564">1564</a> of file <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html">proposal_substructure.c</a>.</p>

<p>References <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list_t::create_enumerator</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00137">proposal_t::get_protocol</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00650">proposal</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01535">proposal_substructure_create_from_proposal_v1()</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00044">PROTO_AH</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00045">PROTO_ESP</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00043">PROTO_IKE</a>, <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01332">set_from_proposal_v1()</a>, and <a class="el" href="../../d6/dba/proposal__substructure_8c_source.html#l01261">set_from_proposal_v1_ike()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d1a/sa__payload_8c_source.html#l00560">sa_payload_create_from_proposals_v1()</a>.</p>
<div class="fragment"><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;{</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a> *<span class="keyword">this</span> = NULL;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <a class="code" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordtype">int</span> number = 0;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    enumerator = proposals-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">create_enumerator</a>(proposals);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;proposal))</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordflow">if</span> (!<span class="keyword">this</span>)</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            <span class="keyword">this</span> = (<a class="code" href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a>*)</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                        <a class="code" href="../../d6/d71/group__proposal__substructure.html#ga00bb12c5883ff1c6a5b7ca88cba0d5ac">proposal_substructure_create_from_proposal_v1</a>(</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                                proposal, lifetime, lifebytes, auth, mode, udp);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            ++number;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        }</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            <span class="keywordflow">switch</span> (proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#afe4ae5935443bca7d998525b2e0954db">get_protocol</a>(proposal))</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a>:</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                    <a class="code" href="../../d6/dba/proposal__substructure_8c.html#a263fc9d286d8a9a188ff50f268be1794">set_from_proposal_v1_ike</a>(<span class="keyword">this</span>, proposal, lifetime,</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                                             auth, ++number);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a>:</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f">PROTO_AH</a>:</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                    <a class="code" href="../../d6/dba/proposal__substructure_8c.html#ad62e30a446eafd79f2ae081d086e2b68">set_from_proposal_v1</a>(<span class="keyword">this</span>, proposal, lifetime,</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                                         lifebytes, mode, udp, ++number);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    }</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;}</div>
<div class="ttc" id="structproposal__t_html"><div class="ttname"><a href="../../df/d06/structproposal__t.html">proposal_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00062">proposal.h:62</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_ad62e30a446eafd79f2ae081d086e2b68"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#ad62e30a446eafd79f2ae081d086e2b68">set_from_proposal_v1</a></div><div class="ttdeci">static void set_from_proposal_v1(private_proposal_substructure_t *this, proposal_t *proposal, u_int32_t lifetime, u_int64_t lifebytes, ipsec_mode_t mode, encap_t udp, int number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01332">proposal_substructure.c:1332</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="group__proposal__substructure_html_ga00bb12c5883ff1c6a5b7ca88cba0d5ac"><div class="ttname"><a href="../../d6/d71/group__proposal__substructure.html#ga00bb12c5883ff1c6a5b7ca88cba0d5ac">proposal_substructure_create_from_proposal_v1</a></div><div class="ttdeci">proposal_substructure_t * proposal_substructure_create_from_proposal_v1(proposal_t *proposal, u_int32_t lifetime, u_int64_t lifebytes, auth_method_t auth, ipsec_mode_t mode, encap_t udp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01535">proposal_substructure.c:1535</a></div></div>
<div class="ttc" id="structlinked__list__t_html_aa079d50cc4028f12d65c75cbb53f8c8a"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">linked_list_t::create_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_enumerator)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list.h:71</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="proposal__substructure_8c_html_a263fc9d286d8a9a188ff50f268be1794"><div class="ttname"><a href="../../d6/dba/proposal__substructure_8c.html#a263fc9d286d8a9a188ff50f268be1794">set_from_proposal_v1_ike</a></div><div class="ttdeci">static void set_from_proposal_v1_ike(private_proposal_substructure_t *this, proposal_t *proposal, u_int32_t lifetime, auth_method_t method, int number)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l01261">proposal_substructure.c:1261</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00045">proposal.h:45</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a5372eff556866bada29dd4643e028e02"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a></div><div class="ttdeci">struct sadb_prop * proposal</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00650">kernel_pfkey_ipsec.c:650</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f">PROTO_AH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00044">proposal.h:44</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structproposal__t_html_afe4ae5935443bca7d998525b2e0954db"><div class="ttname"><a href="../../df/d06/structproposal__t.html#afe4ae5935443bca7d998525b2e0954db">proposal_t::get_protocol</a></div><div class="ttdeci">protocol_id_t(* get_protocol)(proposal_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00137">proposal.h:137</a></div></div>
<div class="ttc" id="structprivate__proposal__substructure__t_html"><div class="ttname"><a href="../../dc/daf/structprivate__proposal__substructure__t.html">private_proposal_substructure_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dba/proposal__substructure_8c_source.html#l00038">proposal_substructure.c:38</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00043">proposal.h:43</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_gafa5c12125229b25b10320d21f6ed8877_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d6/d71/group__proposal__substructure_gafa5c12125229b25b10320d21f6ed8877_icgraph.svg" width="100%" height="377"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:14 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
