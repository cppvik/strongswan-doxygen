<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: tkm</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('da/dac/group__tkm.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tkm</div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for tkm:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../da/dac/group__tkm.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:d2/dca/group__tkm-eescallbacks"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dca/group__tkm-eescallbacks.html">ees callbacks</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d6/d53/group__tkm-ehandler"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d53/group__tkm-ehandler.html">exception handler</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d6/ddb/group__tkm-chunk-map"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/ddb/group__tkm-chunk-map.html">chunk map</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:de/d43/group__tkm-credential"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d43/group__tkm-credential.html">credential set</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:da/df6/group__tkm-dh"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df6/group__tkm-dh.html">diffie hellman</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dc/dbd/group__tkm-credential-enc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dbd/group__tkm-credential-enc.html">credential encoder</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d1/dda/group__tkm-id-manager"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dda/group__tkm-id-manager.html">id manager</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:db/d7a/group__tkm-kernel-ipsec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d7a/group__tkm-kernel-ipsec.html">kernel ipsec</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d9/dad/group__tkm-kernel-sad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dad/group__tkm-kernel-sad.html">kernel sad</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d9/d4a/group__tkm-keymat"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d4a/group__tkm-keymat.html">keymat</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:db/d5f/group__tkm-listener"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d5f/group__tkm-listener.html">listener</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d6/d3d/group__tkm-nonceg"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d3d/group__tkm-nonceg.html">nonce generator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dc/dc6/group__tkm-privkey"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/dc6/group__tkm-privkey.html">private key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d1/d48/group__tkm-pubkey"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d48/group__tkm-pubkey.html">public key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:da/da2/group__tkm-spi-generator"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/da2/group__tkm-spi-generator.html">spi generator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d8/d79/group__tkm-types"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d79/group__tkm-types.html">types</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:da/df0/group__tkm-utils"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df0/group__tkm-utils.html">utils</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d79/structtkm__t.html">tkm_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga07575862fbca14570c1daf0474f922be"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d2/d79/structtkm__t.html">tkm_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dac/group__tkm.html#ga07575862fbca14570c1daf0474f922be">tkm_t</a></td></tr>
<tr class="separator:ga07575862fbca14570c1daf0474f922be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacdcb535c4e85f4312dba8d4490fca5ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dac/group__tkm.html#gacdcb535c4e85f4312dba8d4490fca5ad">tkm_init</a> ()</td></tr>
<tr class="separator:gacdcb535c4e85f4312dba8d4490fca5ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8eb8689cc7351e0c91ea710f83a5e486"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dac/group__tkm.html#ga8eb8689cc7351e0c91ea710f83a5e486">tkm_deinit</a> ()</td></tr>
<tr class="separator:ga8eb8689cc7351e0c91ea710f83a5e486"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga65920a91b7e93d80b8bb9dc7338a8f47"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d79/structtkm__t.html">tkm_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dac/group__tkm.html#ga65920a91b7e93d80b8bb9dc7338a8f47">tkm</a></td></tr>
<tr class="separator:ga65920a91b7e93d80b8bb9dc7338a8f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Untrusted IKEv2 component used with Trusted Key Manager for IKE disaggregation.</p>
<p>The untrusted IKEv2 component used in conjunction with the Trusted Key Manager infrastructure is implemented as a separate charon instance located in its own directory below the strongSwan top-level source directory (src/charon-tkm). This has the advantage that the TKM code is contained and does not mix with other strongSwan files. The charon-tkm binary startup code is modeled after the charon-nm instance, a special charon daemon variant to be used with the GNOME NetworkManager project. The major difference is the registration of custom TKM plugins as the final step of the startup phase. The charon-tkm daemon does not rely on the dynamic plugin loading mechanism for its core plugins, they are statically registered before entering the main processing loop.</p>
<p>The following diagram shows the main components of the system and how they communicate. </p>
<pre class="fragment">    +------------+            +------------+             +------------+
    | xfrm-proxy |&lt;-[tkm-rpc-&gt;| charon-tkm |&lt;-[tkm-rpc]-&gt;|    TKM     |
    +------------+            +------------+             +------------+
          ^                                                    ^
 [Netlink | XFRM]                                        [XFRM | Netlink]
          |                                                    v
    +-----------------------------------------------------------------+
    |                            Kernel                               |
    +-----------------------------------------------------------------+</pre><p> Since the charon-tkm code uses the tkm-rpc library written in Ada, the daemon has to be built using an Ada-aware toolchain. The integration of Ada code into the strongSwan codebase is explained in the TKM documentation, section 5.4.1: <a href="http://www.codelabs.ch/tkm#anchor-doc">http://www.codelabs.ch/tkm#anchor-doc</a>.</p>
<p>The Trusted Key Manager (TKM) is a minimal Trusted Computing Base which implements security-critical functions of the IKEv2 protocol.</p>
<p>The xfrm-proxy receives XFRM Acquire and Expiry events from the kernel and forwards them to the charon-tkm IKE daemon for further processing.</p>
<p>The underlying concept of IKE disaggregation and the design of TKM and all related components, of which charon-tkm is one component, is presented in detail in the project documentation found at <a href="http://www.codelabs.ch/tkm#anchor-doc">http://www.codelabs.ch/tkm#anchor-doc</a>. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga07575862fbca14570c1daf0474f922be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d2/d79/structtkm__t.html">tkm_t</a> <a class="el" href="../../d2/d79/structtkm__t.html">tkm_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../db/db7/tkm_8h_source.html#l00077">77</a> of file <a class="el" href="../../db/db7/tkm_8h_source.html">tkm.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga8eb8689cc7351e0c91ea710f83a5e486"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tkm_deinit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deinitialize trusted key manager, destroys "tkm" instance.</p>
<p>Described in header. </p>

<p>Definition at line <a class="el" href="../../d8/dca/tkm_8c_source.html#l00109">109</a> of file <a class="el" href="../../d8/dca/tkm_8c_source.html">tkm.c</a>.</p>

<p>References <a class="el" href="../../d8/d39/chunk_8c_source.html#l00339">chunk_map()</a>, <a class="el" href="../../db/d21/tkm__id__manager_8h_source.html#l00090">tkm_id_manager_t::destroy</a>, <a class="el" href="../../d8/dca/tkm_8c.html#a18a35415d8f5b6834026636444ad2e4b">ees_server_finalize()</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, and <a class="el" href="../../db/db7/tkm_8h_source.html#l00087">tkm_t::idmgr</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d9f/charon-tkm_8c_source.html#l00231">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../da/dac/group__tkm.html#ga65920a91b7e93d80b8bb9dc7338a8f47">tkm</a>)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="../../d7/df4/structprivate__tkm__t.html">private_tkm_t</a> *<span class="keyword">this</span> = (<a class="code" href="../../d7/df4/structprivate__tkm__t.html">private_tkm_t</a>*)<a class="code" href="../../da/dac/group__tkm.html#ga65920a91b7e93d80b8bb9dc7338a8f47">tkm</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    this-&gt;<span class="keyword">public</span>.<a class="code" href="../../d2/d79/structtkm__t.html#a5acaa2f620f235a214623d3f7360025f">idmgr</a>-&gt;<a class="code" href="../../d0/d4a/structtkm__id__manager__t.html#a78c6d65129f1ebea52d2d8287afcfd54">destroy</a>(this-&gt;<span class="keyword">public</span>.idmgr);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    this-&gt;<span class="keyword">public</span>.chunk_map-&gt;destroy(this-&gt;<span class="keyword">public</span>.<a class="code" href="../../d4/d87/group__chunk.html#gacf27867de490f5002ea59616f97e4bfb">chunk_map</a>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    this-&gt;<span class="keyword">public</span>.sad-&gt;destroy(this-&gt;<span class="keyword">public</span>.sad);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="../../d8/dca/tkm_8c.html#a18a35415d8f5b6834026636444ad2e4b">ees_server_finalize</a>();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    tkmlib_final();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="../../da/dac/group__tkm.html#ga65920a91b7e93d80b8bb9dc7338a8f47">tkm</a> = NULL;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="ttc" id="structprivate__tkm__t_html"><div class="ttname"><a href="../../d7/df4/structprivate__tkm__t.html">private_tkm_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/tkm_8c_source.html#l00036">tkm.c:36</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="group__chunk_html_gacf27867de490f5002ea59616f97e4bfb"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gacf27867de490f5002ea59616f97e4bfb">chunk_map</a></div><div class="ttdeci">chunk_t * chunk_map(char *path, bool wr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00339">chunk.c:339</a></div></div>
<div class="ttc" id="structtkm__id__manager__t_html_a78c6d65129f1ebea52d2d8287afcfd54"><div class="ttname"><a href="../../d0/d4a/structtkm__id__manager__t.html#a78c6d65129f1ebea52d2d8287afcfd54">tkm_id_manager_t::destroy</a></div><div class="ttdeci">void(* destroy)(tkm_id_manager_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/tkm__id__manager_8h_source.html#l00090">tkm_id_manager.h:90</a></div></div>
<div class="ttc" id="group__tkm_html_ga65920a91b7e93d80b8bb9dc7338a8f47"><div class="ttname"><a href="../../da/dac/group__tkm.html#ga65920a91b7e93d80b8bb9dc7338a8f47">tkm</a></div><div class="ttdeci">tkm_t * tkm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/tkm_8c_source.html#l00047">tkm.c:47</a></div></div>
<div class="ttc" id="structtkm__t_html_a5acaa2f620f235a214623d3f7360025f"><div class="ttname"><a href="../../d2/d79/structtkm__t.html#a5acaa2f620f235a214623d3f7360025f">tkm_t::idmgr</a></div><div class="ttdeci">tkm_id_manager_t * idmgr</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db7/tkm_8h_source.html#l00087">tkm.h:87</a></div></div>
<div class="ttc" id="tkm_8c_html_a18a35415d8f5b6834026636444ad2e4b"><div class="ttname"><a href="../../d8/dca/tkm_8c.html#a18a35415d8f5b6834026636444ad2e4b">ees_server_finalize</a></div><div class="ttdeci">void ees_server_finalize(void)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/dac/group__tkm_ga8eb8689cc7351e0c91ea710f83a5e486_cgraph.svg" width="584" height="291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/dac/group__tkm_ga8eb8689cc7351e0c91ea710f83a5e486_icgraph.svg" width="192" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gacdcb535c4e85f4312dba8d4490fca5ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> tkm_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize trusted key manager, creates "tkm" instance.</p>
<dl class="section return"><dt>Returns</dt><dd>FALSE if initialization error occurred</dd></dl>
<p>Described in header. </p>

<p>Definition at line <a class="el" href="../../d8/dca/tkm_8c_source.html#l00052">52</a> of file <a class="el" href="../../d8/dca/tkm_8c_source.html">tkm.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00036">DBG_DMN</a>, <a class="el" href="../../d8/dca/tkm_8c.html#a18a35415d8f5b6834026636444ad2e4b">ees_server_finalize()</a>, <a class="el" href="../../d8/dca/tkm_8c.html#a88011b91606d275faa785dc2f0a26c3b">ees_server_init()</a>, <a class="el" href="../../d8/dca/tkm_8c_source.html#l00025">EES_SOCKET</a>, <a class="el" href="../../d8/dca/tkm_8c.html#a8b83f793851431948ba16f859549e1ba">ehandler_init()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../de/d60/settings_8h_source.html#l00166">settings_t::get_str</a>, <a class="el" href="../../d8/dca/tkm_8c_source.html#l00024">IKE_SOCKET</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../df/d09/id__manager__tests_8c_source.html#l00021">limits</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00150">library_t::ns</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00240">library_t::settings</a>, <a class="el" href="../../d6/d15/tkm__chunk__map_8c_source.html#l00154">tkm_chunk_map_create()</a>, <a class="el" href="../../db/d21/tkm__id__manager_8h_source.html#l00043">TKM_CTX_AE</a>, <a class="el" href="../../db/d21/tkm__id__manager_8h_source.html#l00039">TKM_CTX_CC</a>, <a class="el" href="../../db/d21/tkm__id__manager_8h_source.html#l00037">TKM_CTX_DH</a>, <a class="el" href="../../db/d21/tkm__id__manager_8h_source.html#l00045">TKM_CTX_ESA</a>, <a class="el" href="../../db/d21/tkm__id__manager_8h_source.html#l00041">TKM_CTX_ISA</a>, <a class="el" href="../../db/d21/tkm__id__manager_8h_source.html#l00035">TKM_CTX_NONCE</a>, <a class="el" href="../../dd/db4/tkm__id__manager_8c_source.html#l00142">tkm_id_manager_create()</a>, <a class="el" href="../../db/d04/tkm__kernel__sad_8c_source.html#l00348">tkm_kernel_sad_create()</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d9f/charon-tkm_8c_source.html#l00231">main()</a>, and <a class="el" href="../../d7/d19/charon-tkm_2tests_2tests_8c_source.html#l00047">test_runner_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="../../d7/df4/structprivate__tkm__t.html">private_tkm_t</a> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    active_requests_type max_requests;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">char</span> *ikesock, *eessock;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="../../d1/dda/group__tkm-id-manager.html#ga3d071b60e70ce8210bec84b116d76e43">tkm_limits_t</a> <a class="code" href="../../df/d09/id__manager__tests_8c.html#a49febd8b0a4966dc1d97af74e3861750">limits</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">/* initialize TKM client library */</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    tkmlib_init();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="../../d8/dca/tkm_8c.html#a8b83f793851431948ba16f859549e1ba">ehandler_init</a>();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    ikesock = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>-&gt;<a class="code" href="../../db/d2f/structsettings__t.html#ad71845306a0bdfa694487e3458712f45">get_str</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>, <span class="stringliteral">&quot;%s.ike_socket&quot;</span>, <a class="code" href="../../d8/dca/tkm_8c.html#a2b2f7902fb32ffcc9ddc25ec76d1432c">IKE_SOCKET</a>,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                     <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">ns</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (ike_init(ikesock) != TKM_OK)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        tkmlib_final();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a>, <span class="stringliteral">&quot;connected to TKM via socket &#39;%s&#39;&quot;</span>, ikesock);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    eessock = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>-&gt;<a class="code" href="../../db/d2f/structsettings__t.html#ad71845306a0bdfa694487e3458712f45">get_str</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>, <span class="stringliteral">&quot;%s.ees_socket&quot;</span>, <a class="code" href="../../d8/dca/tkm_8c.html#ad91d02df6ad7c324c767f1b08a7e7888">EES_SOCKET</a>,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                     <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">ns</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="../../d8/dca/tkm_8c.html#a88011b91606d275faa785dc2f0a26c3b">ees_server_init</a>(eessock);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a>, <span class="stringliteral">&quot;serving EES requests on socket &#39;%s&#39;&quot;</span>, eessock);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">if</span> (ike_tkm_reset() != TKM_OK)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="../../d8/dca/tkm_8c.html#a18a35415d8f5b6834026636444ad2e4b">ees_server_finalize</a>();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        tkmlib_final();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">/* get limits from tkm */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">if</span> (ike_tkm_limits(&amp;max_requests, &amp;limits[<a class="code" href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7ab4818b7fc4f932bb5a9d15fa51d442cf">TKM_CTX_NONCE</a>], &amp;limits[<a class="code" href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a8088c8c0e00a4d1be33b2b510231dd7d">TKM_CTX_DH</a>],</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                       &amp;limits[<a class="code" href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a1929ba55595520f575819c59fc19feb7">TKM_CTX_CC</a>], &amp;limits[<a class="code" href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a121b182f4fd0815da3114abf3b1a01fc">TKM_CTX_AE</a>],</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                       &amp;limits[<a class="code" href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a5f02d6bec31a315ef14ddbc42c89edba">TKM_CTX_ISA</a>], &amp;limits[<a class="code" href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a666cdcb9ae8ac30894309a732e026d61">TKM_CTX_ESA</a>]) != TKM_OK)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="../../d8/dca/tkm_8c.html#a18a35415d8f5b6834026636444ad2e4b">ees_server_finalize</a>();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        tkmlib_final();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(<span class="keyword">this</span>,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        .<span class="keyword">public</span> = {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            .idmgr = <a class="code" href="../../d1/dda/group__tkm-id-manager.html#ga7b82b741597391521f2ca95eedbc7772">tkm_id_manager_create</a>(limits),</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            .chunk_map = <a class="code" href="../../d6/ddb/group__tkm-chunk-map.html#gad9c7d0712dfd5758b3152085f1e0fe13">tkm_chunk_map_create</a>(),</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            .sad = <a class="code" href="../../d9/dad/group__tkm-kernel-sad.html#gaa412e5343f6d0683ec16ad6c0c552edc">tkm_kernel_sad_create</a>(),</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        },</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    );</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="../../da/dac/group__tkm.html#ga65920a91b7e93d80b8bb9dc7338a8f47">tkm</a> = &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="id__manager__tests_8c_html_a49febd8b0a4966dc1d97af74e3861750"><div class="ttname"><a href="../../df/d09/id__manager__tests_8c.html#a49febd8b0a4966dc1d97af74e3861750">limits</a></div><div class="ttdeci">static const tkm_limits_t limits</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d09/id__manager__tests_8c_source.html#l00021">id_manager_tests.c:21</a></div></div>
<div class="ttc" id="structsettings__t_html_ad71845306a0bdfa694487e3458712f45"><div class="ttname"><a href="../../db/d2f/structsettings__t.html#ad71845306a0bdfa694487e3458712f45">settings_t::get_str</a></div><div class="ttdeci">char *(* get_str)(settings_t *this, char *key, char *def,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d60/settings_8h_source.html#l00166">settings.h:166</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa3768bde8bcdcb7ba9ffd0eac47329f03">DBG_DMN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00036">debug.h:36</a></div></div>
<div class="ttc" id="group__tkm-id-manager_html_gga7d8a607034a7346eca6287703655f6e7a1929ba55595520f575819c59fc19feb7"><div class="ttname"><a href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a1929ba55595520f575819c59fc19feb7">TKM_CTX_CC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/tkm__id__manager_8h_source.html#l00039">tkm_id_manager.h:39</a></div></div>
<div class="ttc" id="group__tkm-id-manager_html_gga7d8a607034a7346eca6287703655f6e7ab4818b7fc4f932bb5a9d15fa51d442cf"><div class="ttname"><a href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7ab4818b7fc4f932bb5a9d15fa51d442cf">TKM_CTX_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/tkm__id__manager_8h_source.html#l00035">tkm_id_manager.h:35</a></div></div>
<div class="ttc" id="structprivate__tkm__t_html"><div class="ttname"><a href="../../d7/df4/structprivate__tkm__t.html">private_tkm_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/tkm_8c_source.html#l00036">tkm.c:36</a></div></div>
<div class="ttc" id="tkm_8c_html_ad91d02df6ad7c324c767f1b08a7e7888"><div class="ttname"><a href="../../d8/dca/tkm_8c.html#ad91d02df6ad7c324c767f1b08a7e7888">EES_SOCKET</a></div><div class="ttdeci">#define EES_SOCKET</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/tkm_8c_source.html#l00025">tkm.c:25</a></div></div>
<div class="ttc" id="group__tkm-id-manager_html_gga7d8a607034a7346eca6287703655f6e7a121b182f4fd0815da3114abf3b1a01fc"><div class="ttname"><a href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a121b182f4fd0815da3114abf3b1a01fc">TKM_CTX_AE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/tkm__id__manager_8h_source.html#l00043">tkm_id_manager.h:43</a></div></div>
<div class="ttc" id="tkm_8c_html_a2b2f7902fb32ffcc9ddc25ec76d1432c"><div class="ttname"><a href="../../d8/dca/tkm_8c.html#a2b2f7902fb32ffcc9ddc25ec76d1432c">IKE_SOCKET</a></div><div class="ttdeci">#define IKE_SOCKET</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/tkm_8c_source.html#l00024">tkm.c:24</a></div></div>
<div class="ttc" id="group__tkm-kernel-sad_html_gaa412e5343f6d0683ec16ad6c0c552edc"><div class="ttname"><a href="../../d9/dad/group__tkm-kernel-sad.html#gaa412e5343f6d0683ec16ad6c0c552edc">tkm_kernel_sad_create</a></div><div class="ttdeci">tkm_kernel_sad_t * tkm_kernel_sad_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d04/tkm__kernel__sad_8c_source.html#l00348">tkm_kernel_sad.c:348</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__tkm-id-manager_html_gga7d8a607034a7346eca6287703655f6e7a5f02d6bec31a315ef14ddbc42c89edba"><div class="ttname"><a href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a5f02d6bec31a315ef14ddbc42c89edba">TKM_CTX_ISA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/tkm__id__manager_8h_source.html#l00041">tkm_id_manager.h:41</a></div></div>
<div class="ttc" id="tkm_8c_html_a8b83f793851431948ba16f859549e1ba"><div class="ttname"><a href="../../d8/dca/tkm_8c.html#a8b83f793851431948ba16f859549e1ba">ehandler_init</a></div><div class="ttdeci">void ehandler_init(void)</div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structlibrary__t_html_aea9e6313fee01053f94cdc4a5a00e2bd"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">library_t::ns</a></div><div class="ttdeci">const char * ns</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00150">library.h:150</a></div></div>
<div class="ttc" id="group__tkm-id-manager_html_gga7d8a607034a7346eca6287703655f6e7a666cdcb9ae8ac30894309a732e026d61"><div class="ttname"><a href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a666cdcb9ae8ac30894309a732e026d61">TKM_CTX_ESA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/tkm__id__manager_8h_source.html#l00045">tkm_id_manager.h:45</a></div></div>
<div class="ttc" id="tkm_8c_html_a88011b91606d275faa785dc2f0a26c3b"><div class="ttname"><a href="../../d8/dca/tkm_8c.html#a88011b91606d275faa785dc2f0a26c3b">ees_server_init</a></div><div class="ttdeci">result_type ees_server_init(const char *const address)</div></div>
<div class="ttc" id="group__tkm-id-manager_html_ga3d071b60e70ce8210bec84b116d76e43"><div class="ttname"><a href="../../d1/dda/group__tkm-id-manager.html#ga3d071b60e70ce8210bec84b116d76e43">tkm_limits_t</a></div><div class="ttdeci">uint64_t tkm_limits_t[TKM_CTX_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/tkm__id__manager_8h_source.html#l00059">tkm_id_manager.h:59</a></div></div>
<div class="ttc" id="group__tkm_html_ga65920a91b7e93d80b8bb9dc7338a8f47"><div class="ttname"><a href="../../da/dac/group__tkm.html#ga65920a91b7e93d80b8bb9dc7338a8f47">tkm</a></div><div class="ttdeci">tkm_t * tkm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dca/tkm_8c_source.html#l00047">tkm.c:47</a></div></div>
<div class="ttc" id="group__tkm-id-manager_html_ga7b82b741597391521f2ca95eedbc7772"><div class="ttname"><a href="../../d1/dda/group__tkm-id-manager.html#ga7b82b741597391521f2ca95eedbc7772">tkm_id_manager_create</a></div><div class="ttdeci">tkm_id_manager_t * tkm_id_manager_create(const tkm_limits_t limits)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db4/tkm__id__manager_8c_source.html#l00142">tkm_id_manager.c:142</a></div></div>
<div class="ttc" id="group__tkm-chunk-map_html_gad9c7d0712dfd5758b3152085f1e0fe13"><div class="ttname"><a href="../../d6/ddb/group__tkm-chunk-map.html#gad9c7d0712dfd5758b3152085f1e0fe13">tkm_chunk_map_create</a></div><div class="ttdeci">tkm_chunk_map_t * tkm_chunk_map_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d15/tkm__chunk__map_8c_source.html#l00154">tkm_chunk_map.c:154</a></div></div>
<div class="ttc" id="tkm_8c_html_a18a35415d8f5b6834026636444ad2e4b"><div class="ttname"><a href="../../d8/dca/tkm_8c.html#a18a35415d8f5b6834026636444ad2e4b">ees_server_finalize</a></div><div class="ttdeci">void ees_server_finalize(void)</div></div>
<div class="ttc" id="structlibrary__t_html_ad435178668da74384948b6a151d913f5"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">library_t::settings</a></div><div class="ttdeci">settings_t * settings</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00240">library.h:240</a></div></div>
<div class="ttc" id="group__tkm-id-manager_html_gga7d8a607034a7346eca6287703655f6e7a8088c8c0e00a4d1be33b2b510231dd7d"><div class="ttname"><a href="../../d1/dda/group__tkm-id-manager.html#gga7d8a607034a7346eca6287703655f6e7a8088c8c0e00a4d1be33b2b510231dd7d">TKM_CTX_DH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/tkm__id__manager_8h_source.html#l00037">tkm_id_manager.h:37</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../da/dac/group__tkm_gacdcb535c4e85f4312dba8d4490fca5ad_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../da/dac/group__tkm_gacdcb535c4e85f4312dba8d4490fca5ad_icgraph.svg" width="339" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ga65920a91b7e93d80b8bb9dc7338a8f47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d79/structtkm__t.html">tkm_t</a>* tkm</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Trusted key manager instance, set after <a class="el" href="../../da/dac/group__tkm.html#gacdcb535c4e85f4312dba8d4490fca5ad">tkm_init()</a> and before <a class="el" href="../../da/dac/group__tkm.html#ga8eb8689cc7351e0c91ea710f83a5e486">tkm_deinit()</a> calls.</p>
<p>Single instance of <a class="el" href="../../d2/d79/structtkm__t.html">tkm_t</a>. </p>

<p>Definition at line <a class="el" href="../../d8/dca/tkm_8c_source.html#l00047">47</a> of file <a class="el" href="../../d8/dca/tkm_8c_source.html">tkm.c</a>.</p>

<p>Referenced by <a class="el" href="../../da/dc8/ees__callbacks_8c_source.html#l00033">charon_esa_expire()</a>, <a class="el" href="../../d1/de8/tkm__diffie__hellman_8c_source.html#l00089">METHOD()</a>, <a class="el" href="../../d9/d6e/nonceg__tests_8c_source.html#l00035">START_TEST()</a>, <a class="el" href="../../d1/de8/tkm__diffie__hellman_8c_source.html#l00200">tkm_diffie_hellman_create()</a>, and <a class="el" href="../../d9/d3b/tkm__keymat_8c_source.html#l00506">tkm_keymat_create()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:25 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
