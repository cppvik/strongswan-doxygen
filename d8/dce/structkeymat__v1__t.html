<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: keymat_v1_t Struct Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d8/dce/structkeymat__v1__t.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../dd/d59/structkeymat__v1__t-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">keymat_v1_t Struct Reference<div class="ingroups"><a class="el" href="../../db/d4c/group__keymat__v1.html">keymat_v1</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>&quot;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for keymat_v1_t:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../de/def/structkeymat__v1__t__coll__graph.svg" width="178" height="128"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7aedd765e9f1c8758bd1a7c76fb9eb09"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#a7aedd765e9f1c8758bd1a7c76fb9eb09">keymat</a></td></tr>
<tr class="separator:a7aedd765e9f1c8758bd1a7c76fb9eb09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a388aab99e740785ba0530626081974a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#a388aab99e740785ba0530626081974a7">derive_ike_keys</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dh_other, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, <a class="el" href="../../da/d5b/group__authenticator.html#ga8071dc90e8e461c4be73b26588aead90">auth_method_t</a> auth, <a class="el" href="../../d7/d7c/structshared__key__t.html">shared_key_t</a> *shared_key)</td></tr>
<tr class="separator:a388aab99e740785ba0530626081974a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac85c2617fd92ed0284373e5d14a11dba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#ac85c2617fd92ed0284373e5d14a11dba">derive_child_keys</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, u_int32_t spi_i, u_int32_t spi_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_r)</td></tr>
<tr class="separator:ac85c2617fd92ed0284373e5d14a11dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8826e4d4b2b562570979d08e0a87ec32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#a8826e4d4b2b562570979d08e0a87ec32">create_hasher</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>)</td></tr>
<tr class="separator:a8826e4d4b2b562570979d08e0a87ec32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e587181d1dcbd6859f3a6ae2f48099e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d72/structhasher__t.html">hasher_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#a3e587181d1dcbd6859f3a6ae2f48099e">get_hasher</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this)</td></tr>
<tr class="separator:a3e587181d1dcbd6859f3a6ae2f48099e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0ae27aa1dedb3855703984d5f3a37e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#a6f0ae27aa1dedb3855703984d5f3a37e">get_hash</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dh_other, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *ike_sa_id, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> sa_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td></tr>
<tr class="separator:a6f0ae27aa1dedb3855703984d5f3a37e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa2b8c913f0dc188364a0823950e2b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#aefa2b8c913f0dc188364a0823950e2b8">get_hash_phase2</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td></tr>
<tr class="separator:aefa2b8c913f0dc188364a0823950e2b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a199e54d77ae9b2157b90ab487ba16ce6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#a199e54d77ae9b2157b90ab487ba16ce6">get_iv</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, u_int32_t mid, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *iv)</td></tr>
<tr class="separator:a199e54d77ae9b2157b90ab487ba16ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad58bae359e35ebf26b476c776d8ba17f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#ad58bae359e35ebf26b476c776d8ba17f">update_iv</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, u_int32_t mid, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> last_block)</td></tr>
<tr class="separator:ad58bae359e35ebf26b476c776d8ba17f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50f2640e99013027ec859e348ffcdc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dce/structkeymat__v1__t.html#aa50f2640e99013027ec859e348ffcdc1">confirm_iv</a> )(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, u_int32_t mid)</td></tr>
<tr class="separator:aa50f2640e99013027ec859e348ffcdc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Derivation and management of sensitive keying material, IKEv1 variant. </p>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00032">32</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>
</div><h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="aa50f2640e99013027ec859e348ffcdc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v1_t::confirm_iv)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, u_int32_t mid)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Confirms the updated IV for the given message ID.</p>
<p>To actually make the new IV available via get_iv this method has to be called after update_iv.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mid</td><td>message ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if IV confirmed successfully </dd></dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00155">155</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01788">finalize_message()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l02612">METHOD()</a>, and <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00519">process_ike_iv()</a>.</p>

</div>
</div>
<a class="anchor" id="a8826e4d4b2b562570979d08e0a87ec32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v1_t::create_hasher)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create the negotiated hasher.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proposal</td><td>selected algorithms </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if creation was successful </dd></dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00086">86</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00127">process_ike_add()</a>.</p>

</div>
</div>
<a class="anchor" id="ac85c2617fd92ed0284373e5d14a11dba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v1_t::derive_child_keys)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, u_int32_t spi_i, u_int32_t spi_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_r)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Derive keys for the CHILD_SA.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proposal</td><td>selected algorithms </td></tr>
    <tr><td class="paramname">dh</td><td>diffie hellman key, NULL if none used </td></tr>
    <tr><td class="paramname">spi_i</td><td>SPI chosen by initiatior </td></tr>
    <tr><td class="paramname">spi_r</td><td>SPI chosen by responder </td></tr>
    <tr><td class="paramname">nonce_i</td><td>quick mode initiator nonce </td></tr>
    <tr><td class="paramname">nonce_r</td><td>quick mode responder nonce </td></tr>
    <tr><td class="paramname">encr_i</td><td>allocated initiators encryption key </td></tr>
    <tr><td class="paramname">integ_i</td><td>allocated initiators integrity key </td></tr>
    <tr><td class="paramname">encr_r</td><td>allocated responders encryption key </td></tr>
    <tr><td class="paramname">integ_r</td><td>allocated responders integrity key </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00074">74</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00635">process_child_add()</a>.</p>

</div>
</div>
<a class="anchor" id="a388aab99e740785ba0530626081974a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v1_t::derive_ike_keys)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dh_other, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, <a class="el" href="../../da/d5b/group__authenticator.html#ga8071dc90e8e461c4be73b26588aead90">auth_method_t</a> auth, <a class="el" href="../../d7/d7c/structshared__key__t.html">shared_key_t</a> *shared_key)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Derive keys for the IKE_SA.</p>
<p>These keys are not handed out, but are used by the associated signers, crypters and authentication functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proposal</td><td>selected algorithms </td></tr>
    <tr><td class="paramname">dh</td><td>diffie hellman key allocated by create_dh() </td></tr>
    <tr><td class="paramname">dh_other</td><td>public DH value from other peer </td></tr>
    <tr><td class="paramname">nonce_i</td><td>initiators nonce value </td></tr>
    <tr><td class="paramname">nonce_r</td><td>responders nonce value </td></tr>
    <tr><td class="paramname">id</td><td>IKE_SA identifier </td></tr>
    <tr><td class="paramname">auth</td><td>authentication method </td></tr>
    <tr><td class="paramname">shared_key</td><td>PSK in case of AUTH_CLASS_PSK, NULL otherwise </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE on success </dd></dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00055">55</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00127">process_ike_add()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f0ae27aa1dedb3855703984d5f3a37e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v1_t::get_hash)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dh_other, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *ike_sa_id, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> sa_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get HASH data for authentication.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initiatior</td><td>TRUE to create HASH_I, FALSE for HASH_R </td></tr>
    <tr><td class="paramname">dh</td><td>public DH value of peer to create HASH for </td></tr>
    <tr><td class="paramname">dh_other</td><td>others public DH value </td></tr>
    <tr><td class="paramname">ike_sa_id</td><td>IKE_SA identifier </td></tr>
    <tr><td class="paramname">sa_i</td><td>encoded SA payload of initiator </td></tr>
    <tr><td class="paramname">id</td><td>encoded IDii payload for HASH_I (IDir for HASH_R) </td></tr>
    <tr><td class="paramname">hash</td><td>chunk receiving allocated HASH data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if hash allocated successfully </dd></dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00107">107</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../d6/d90/psk__v1__authenticator_8c_source.html#l00070">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="aefa2b8c913f0dc188364a0823950e2b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v1_t::get_hash_phase2)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get HASH data for integrity/authentication in Phase 2 exchanges.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>message to generate the HASH data for </td></tr>
    <tr><td class="paramname">hash</td><td>chunk receiving allocated hash data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if hash allocated successfully </dd></dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00118">118</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l01657">generate_message()</a>, and <a class="el" href="../../d0/d6d/message_8c_source.html#l02612">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e587181d1dcbd6859f3a6ae2f48099e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d72/structhasher__t.html">hasher_t</a>*(* keymat_v1_t::get_hasher)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the negotiated hasher.</p>
<dl class="section return"><dt>Returns</dt><dd>allocated hasher or NULL </dd></dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00093">93</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

</div>
</div>
<a class="anchor" id="a199e54d77ae9b2157b90ab487ba16ce6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v1_t::get_iv)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, u_int32_t mid, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *iv)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the IV for a message with the given message ID.</p>
<p>The return chunk contains internal data and is valid until the next get_iv/udpate_iv/confirm_iv call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mid</td><td>message ID </td></tr>
    <tr><td class="paramname">iv</td><td>chunk receiving IV, internal data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if IV allocated successfully </dd></dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00130">130</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02317">decrypt_and_extract()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01788">finalize_message()</a>, and <a class="el" href="../../dc/dd5/ha__ike_8c_source.html#l00275">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a7aedd765e9f1c8758bd1a7c76fb9eb09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> keymat_v1_t::keymat</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implements <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>. </p>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00037">37</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/d9e/keymat_8c_source.html#l00026">keymat_create()</a>.</p>

</div>
</div>
<a class="anchor" id="ad58bae359e35ebf26b476c776d8ba17f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v1_t::update_iv)(<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *this, u_int32_t mid, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> last_block)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the IV for the next message with the given message ID.</p>
<p>A call of <a class="el" href="../../d8/dce/structkeymat__v1__t.html#aa50f2640e99013027ec859e348ffcdc1">confirm_iv()</a> is required in order to actually make the IV available. This is needed for the inbound case where we store the last block of the encrypted message but want to update the IV only after verification of the decrypted message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mid</td><td>message ID </td></tr>
    <tr><td class="paramname">last_block</td><td>last block of encrypted message (gets cloned) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if IV updated successfully </dd></dl>

<p>Definition at line <a class="el" href="../../de/da7/keymat__v1_8h_source.html#l00144">144</a> of file <a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d6d/message_8c_source.html#l02317">decrypt_and_extract()</a>, <a class="el" href="../../d0/d6d/message_8c_source.html#l01788">finalize_message()</a>, and <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00519">process_ike_iv()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:27 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
