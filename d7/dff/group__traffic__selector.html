<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: traffic_selector</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d7/dff/group__traffic__selector.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">traffic_selector<div class="ingroups"><a class="el" href="../../de/d7e/group__selectors.html">selectors</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for traffic_selector:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector.svg" width="243" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga2dbb77fbb113563bdd9b44ee8c586855"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga2dbb77fbb113563bdd9b44ee8c586855">ts_type_t</a></td></tr>
<tr class="separator:ga2dbb77fbb113563bdd9b44ee8c586855"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga528ab3101244457b77eebf909db03cd8"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga528ab3101244457b77eebf909db03cd8">traffic_selector_t</a></td></tr>
<tr class="separator:ga528ab3101244457b77eebf909db03cd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga626ba88163961e3f06a7032d939b5fea"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a> { <a class="el" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a> = 7, 
<a class="el" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a> = 8
 }</td></tr>
<tr class="separator:ga626ba88163961e3f06a7032d939b5fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1d6504665dab286ee80a7f4f34025a45"><td class="memItemLeft" align="right" valign="top">static u_int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga1d6504665dab286ee80a7f4f34025a45">traffic_selector_icmp_type</a> (u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a9e26a4afe91a21810290057677a17a11">port</a>)</td></tr>
<tr class="separator:ga1d6504665dab286ee80a7f4f34025a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35a2141a376b7568b4fa44b46960bd03"><td class="memItemLeft" align="right" valign="top">static u_int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga35a2141a376b7568b4fa44b46960bd03">traffic_selector_icmp_code</a> (u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a9e26a4afe91a21810290057677a17a11">port</a>)</td></tr>
<tr class="separator:ga35a2141a376b7568b4fa44b46960bd03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf18b4a321dc79811c99189bc57bc129d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#gaf18b4a321dc79811c99189bc57bc129d">traffic_selector_cmp</a> (<a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>, void *<a class="el" href="../../de/dca/__copyright_8c.html#a73c44369d219009b6cef567f28e9d002">opts</a>)</td></tr>
<tr class="separator:gaf18b4a321dc79811c99189bc57bc129d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae04e03c03653d99fb1a0900507a16549"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#gae04e03c03653d99fb1a0900507a16549">traffic_selector_create_from_string</a> (u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, char *from_addr, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, char *to_addr, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>)</td></tr>
<tr class="separator:gae04e03c03653d99fb1a0900507a16549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0fac1a12e3cf4220dd2787f4a766a52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#gac0fac1a12e3cf4220dd2787f4a766a52">traffic_selector_create_from_cidr</a> (char *<a class="el" href="../../de/d18/test__enumerator_8c.html#aed1cfb225a5fb77461e7972691e68a72">string</a>, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>)</td></tr>
<tr class="separator:gac0fac1a12e3cf4220dd2787f4a766a52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga710b813ea3909f21e518aa38928607e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga710b813ea3909f21e518aa38928607e2">traffic_selector_create_from_bytes</a> (u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> from_address, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> to_address, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>)</td></tr>
<tr class="separator:ga710b813ea3909f21e518aa38928607e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56641582310d09d5bde8d9754e75f4fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga56641582310d09d5bde8d9754e75f4fc">traffic_selector_create_from_rfc3779_format</a> (<a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> from_addr, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> to_addr)</td></tr>
<tr class="separator:ga56641582310d09d5bde8d9754e75f4fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabbed5b326fa118c23b508ebb34b17543"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#gabbed5b326fa118c23b508ebb34b17543">traffic_selector_create_from_subnet</a> (<a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a2f13c35b1fa3de2bd8c668d4a0d52706">net</a>, u_int8_t netbits, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>)</td></tr>
<tr class="separator:gabbed5b326fa118c23b508ebb34b17543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga07c688b58e8a798558db4636c565de51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga07c688b58e8a798558db4636c565de51">traffic_selector_create_dynamic</a> (u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>)</td></tr>
<tr class="separator:ga07c688b58e8a798558db4636c565de51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21d390799800674b78bc3374f05e4135"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga21d390799800674b78bc3374f05e4135">traffic_selector_printf_hook</a> (<a class="el" href="../../d2/d07/structprintf__hook__data__t.html">printf_hook_data_t</a> *<a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>, <a class="el" href="../../d6/d82/structprintf__hook__spec__t.html">printf_hook_spec_t</a> *spec, const void *const *args)</td></tr>
<tr class="separator:ga21d390799800674b78bc3374f05e4135"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga7a2697e892d4e4b4b7608b490c42775f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d70/structenum__name__t.html">enum_name_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga7a2697e892d4e4b4b7608b490c42775f">ts_type_name</a></td></tr>
<tr class="separator:ga7a2697e892d4e4b4b7608b490c42775f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga528ab3101244457b77eebf909db03cd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00027">27</a> of file <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html">traffic_selector.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga2dbb77fbb113563bdd9b44ee8c586855"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a> <a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00026">26</a> of file <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html">traffic_selector.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ga626ba88163961e3f06a7032d939b5fea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Traffic selector types. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"></a>TS_IPV4_ADDR_RANGE</em>&#160;</td><td class="fielddoc">
<p>A range of IPv4 addresses, represented by two four (4) octet values. The first value is the beginning IPv4 address (inclusive) and the second value is the ending IPv4 address (inclusive). All addresses falling between the two specified addresses are considered to be within the list. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae"></a>TS_IPV6_ADDR_RANGE</em>&#160;</td><td class="fielddoc">
<p>A range of IPv6 addresses, represented by two sixteen (16) octet values. The first value is the beginning IPv6 address (inclusive) and the second value is the ending IPv6 address (inclusive). All addresses falling between the two specified addresses are considered to be within the list. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00035">35</a> of file <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html">traffic_selector.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;               {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a> = 7,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a> = 8</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;};</div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00053">traffic_selector.h:53</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaf18b4a321dc79811c99189bc57bc129d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int traffic_selector_cmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>opts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compare two traffic selectors, usable as sort function</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>first selector to compare </td></tr>
    <tr><td class="paramname">b</td><td>second selector to compare </td></tr>
    <tr><td class="paramname">opts</td><td>optional sort options, currently unused </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>&gt; 0 if a &gt; b, 0 if a == b, &lt; 0 if a &lt; b </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00715">715</a> of file <a class="el" href="../../d3/d58/traffic__selector_8c_source.html">traffic_selector.c</a>.</p>

<p>References <a class="el" href="../../d0/d79/eap__aka__3gpp2__functions_8c_source.html#l00066">a</a>, <a class="el" href="../../d0/d79/eap__aka__3gpp2__functions_8c_source.html#l00075">b</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00707">compare_int()</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00075">private_traffic_selector_t::from4</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00077">private_traffic_selector_t::from6</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00095">private_traffic_selector_t::from_port</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00055">private_traffic_selector_t::protocol</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00555">res</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00087">private_traffic_selector_t::to4</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00089">private_traffic_selector_t::to6</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00100">private_traffic_selector_t::to_port</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00044">TS_IPV4_ADDR_RANGE</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00053">TS_IPV6_ADDR_RANGE</a>, and <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00050">private_traffic_selector_t::type</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00878">METHOD()</a>, and <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00591">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;{</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a> *<a class="code" href="../../d0/d79/eap__aka__3gpp2__functions_8c.html#a9723524f0aac120ec0a4cb7f61c3ec69">a</a>, *<a class="code" href="../../d0/d79/eap__aka__3gpp2__functions_8c.html#a3647b13ff7cca2d3263befc32b63ddf2">b</a>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    a = (<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a>*)a_pub;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    b = (<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a>*)b_pub;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">/* IPv4 before IPv6 */</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    res = <a class="code" href="../../d3/d58/traffic__selector_8c.html#a7b7f943969f4573c0ea4ec21dcfa529e">compare_int</a>(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#adbed5a5cd7b7f7b08bda4639f3f3d681">type</a>, b-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#adbed5a5cd7b7f7b08bda4639f3f3d681">type</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">switch</span> (a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#adbed5a5cd7b7f7b08bda4639f3f3d681">type</a>)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="comment">/* lower starting subnets first */</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            res = memcmp(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#ae58a8a9beef5a31b46f729fee6478100">from4</a>, b-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#ae58a8a9beef5a31b46f729fee6478100">from4</a>, <span class="keyword">sizeof</span>(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#ae58a8a9beef5a31b46f729fee6478100">from4</a>));</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="comment">/* larger subnets first */</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            res = memcmp(b-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a98a4dbca2dd1be00250c7f1504e6ff8f">to4</a>, a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a98a4dbca2dd1be00250c7f1504e6ff8f">to4</a>, <span class="keyword">sizeof</span>(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a98a4dbca2dd1be00250c7f1504e6ff8f">to4</a>));</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            res = memcmp(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a099f79397986f959bbb77e47270afc9a">from6</a>, b-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a099f79397986f959bbb77e47270afc9a">from6</a>, <span class="keyword">sizeof</span>(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a099f79397986f959bbb77e47270afc9a">from6</a>));</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            res = memcmp(b-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#af50937f3dd3b7df4972dd537af505ce7">to6</a>, a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#af50937f3dd3b7df4972dd537af505ce7">to6</a>, <span class="keyword">sizeof</span>(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#af50937f3dd3b7df4972dd537af505ce7">to6</a>));</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">/* lower protocols first */</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    res = <a class="code" href="../../d3/d58/traffic__selector_8c.html#a7b7f943969f4573c0ea4ec21dcfa529e">compare_int</a>(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a9dfa3d7618432a114521b8e60810d23b">protocol</a>, b-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a9dfa3d7618432a114521b8e60810d23b">protocol</a>);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="comment">/* lower starting ports first */</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    res = <a class="code" href="../../d3/d58/traffic__selector_8c.html#a7b7f943969f4573c0ea4ec21dcfa529e">compare_int</a>(a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a1787984630e606158285ad9103f89cb2">from_port</a>, b-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#a1787984630e606158285ad9103f89cb2">from_port</a>);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">/* larger port ranges first */</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/d58/traffic__selector_8c.html#a7b7f943969f4573c0ea4ec21dcfa529e">compare_int</a>(b-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#ad56dde8f4c232b39134e4d9e0fe0f595">to_port</a>, a-&gt;<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html#ad56dde8f4c232b39134e4d9e0fe0f595">to_port</a>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;}</div>
<div class="ttc" id="structprivate__traffic__selector__t_html_a9dfa3d7618432a114521b8e60810d23b"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html#a9dfa3d7618432a114521b8e60810d23b">private_traffic_selector_t::protocol</a></div><div class="ttdeci">u_int8_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00055">traffic_selector.c:55</a></div></div>
<div class="ttc" id="eap__aka__3gpp2__functions_8c_html_a9723524f0aac120ec0a4cb7f61c3ec69"><div class="ttname"><a href="../../d0/d79/eap__aka__3gpp2__functions_8c.html#a9723524f0aac120ec0a4cb7f61c3ec69">a</a></div><div class="ttdeci">static u_int8_t a[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/eap__aka__3gpp2__functions_8c_source.html#l00066">eap_aka_3gpp2_functions.c:66</a></div></div>
<div class="ttc" id="eap__aka__3gpp2__functions_8c_html_a3647b13ff7cca2d3263befc32b63ddf2"><div class="ttname"><a href="../../d0/d79/eap__aka__3gpp2__functions_8c.html#a3647b13ff7cca2d3263befc32b63ddf2">b</a></div><div class="ttdeci">static u_int8_t b[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/eap__aka__3gpp2__functions_8c_source.html#l00075">eap_aka_3gpp2_functions.c:75</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html_ad56dde8f4c232b39134e4d9e0fe0f595"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html#ad56dde8f4c232b39134e4d9e0fe0f595">private_traffic_selector_t::to_port</a></div><div class="ttdeci">u_int16_t to_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00100">traffic_selector.c:100</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html_adbed5a5cd7b7f7b08bda4639f3f3d681"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html#adbed5a5cd7b7f7b08bda4639f3f3d681">private_traffic_selector_t::type</a></div><div class="ttdeci">ts_type_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00050">traffic_selector.c:50</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00040">traffic_selector.c:40</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00053">traffic_selector.h:53</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html_a1787984630e606158285ad9103f89cb2"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html#a1787984630e606158285ad9103f89cb2">private_traffic_selector_t::from_port</a></div><div class="ttdeci">u_int16_t from_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00095">traffic_selector.c:95</a></div></div>
<div class="ttc" id="traffic__selector_8c_html_a7b7f943969f4573c0ea4ec21dcfa529e"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a7b7f943969f4573c0ea4ec21dcfa529e">compare_int</a></div><div class="ttdeci">static int compare_int(int a, int b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00707">traffic_selector.c:707</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html_ae58a8a9beef5a31b46f729fee6478100"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html#ae58a8a9beef5a31b46f729fee6478100">private_traffic_selector_t::from4</a></div><div class="ttdeci">u_int32_t from4[1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00075">traffic_selector.c:75</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#aac31eb68bff694554a182bd796b2f1c5">res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00555">test_traffic_selector.c:555</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html_af50937f3dd3b7df4972dd537af505ce7"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html#af50937f3dd3b7df4972dd537af505ce7">private_traffic_selector_t::to6</a></div><div class="ttdeci">u_int32_t to6[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00089">traffic_selector.c:89</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html_a98a4dbca2dd1be00250c7f1504e6ff8f"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html#a98a4dbca2dd1be00250c7f1504e6ff8f">private_traffic_selector_t::to4</a></div><div class="ttdeci">u_int32_t to4[1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00087">traffic_selector.c:87</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html_a099f79397986f959bbb77e47270afc9a"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html#a099f79397986f959bbb77e47270afc9a">private_traffic_selector_t::from6</a></div><div class="ttdeci">u_int32_t from6[4]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00077">traffic_selector.c:77</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_gaf18b4a321dc79811c99189bc57bc129d_cgraph.svg" width="294" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_gaf18b4a321dc79811c99189bc57bc129d_icgraph.svg" width="307" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga07c688b58e8a798558db4636c565de51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>* traffic_selector_create_dynamic </td>
          <td>(</td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>from_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>to_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a traffic selector for host-to-host cases.</p>
<p>For host2host or virtual IP setups, the traffic selectors gets created at runtime using the external/virtual IP. Using this constructor, a call to set_address() sets this traffic selector to the supplied host.</p>
<p>If protocol is ICMP or ICMPv6 the ports are interpreted as follows: If they are less than 256 the value is assumed to be a message type, if they are greater or equal to 256 they are assumed to be type and code as defined for <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">protocol</td><td>upper layer protocl to allow </td></tr>
    <tr><td class="paramname">from_port</td><td>start of allowed port range </td></tr>
    <tr><td class="paramname">to_port</td><td>end of range </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> object</li>
<li>NULL if type not supported </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00947">947</a> of file <a class="el" href="../../d3/d58/traffic__selector_8c_source.html">traffic_selector.c</a>.</p>

<p>References <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00054">dynamic</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector_create()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00044">TS_IPV4_ADDR_RANGE</a>.</p>

<p>Referenced by <a class="el" href="../../d2/d03/load__tester__config_8c_source.html#l00552">add_ts()</a>, <a class="el" href="../../de/d0b/sql__config_8c_source.html#l00050">build_traffic_selector()</a>, <a class="el" href="../../da/de3/vici__config_8c_source.html#l00536">CALLBACK()</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00557">cmd_connection_create()</a>, <a class="el" href="../../d0/d53/nm__service_8c_source.html#l00284">connect_()</a>, <a class="el" href="../../d2/df2/uci__config_8c_source.html#l00086">create_ts()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00226">initiate_connection()</a>, <a class="el" href="../../d3/d95/config_8c_source.html#l00139">load_child_config()</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00332">METHOD()</a>, <a class="el" href="../../df/d4e/ha__tunnel_8c_source.html#l00178">setup_tunnel()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00365">START_TEST()</a>, and <a class="el" href="../../d0/d7f/medcli__config_8c_source.html#l00060">ts_from_string()</a>.</p>
<div class="fragment"><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;{</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a> *<span class="keyword">this</span> = <a class="code" href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a>(</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                            <a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>, <a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, <a class="code" href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(this-&gt;from6, 0, <span class="keyword">sizeof</span>(this-&gt;from6));</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(this-&gt;to6, 0xFF, <span class="keyword">sizeof</span>(this-&gt;to6));</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    this-&gt;netbits = 0;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ab0288ab608c09f881121c7fe7dc1d052">dynamic</a> = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;}</div>
<div class="ttc" id="ha__message_8c_html_a617f1044052fa90a69727e1b11ff1ce7"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a></div><div class="ttdeci">u_int16_t to_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00053">ha_message.c:53</a></div></div>
<div class="ttc" id="ha__message_8c_html_ad82c402f0fb34c2cbfc1e60d7b6c08a4"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a></div><div class="ttdeci">u_int8_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="traffic__selector_8c_html_a33ffa864c84fe38606daac30bff2a0b0"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a></div><div class="ttdeci">static private_traffic_selector_t * traffic_selector_create(u_int8_t protocol, ts_type_t type, u_int16_t from_port, u_int16_t to_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector.c:964</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00040">traffic_selector.c:40</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="ha__message_8c_html_a5acbaa08fc6b62022375929357d3e749"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a></div><div class="ttdeci">u_int16_t from_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00052">ha_message.c:52</a></div></div>
<div class="ttc" id="ha__message_8c_html_ab0288ab608c09f881121c7fe7dc1d052"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ab0288ab608c09f881121c7fe7dc1d052">dynamic</a></div><div class="ttdeci">u_int8_t dynamic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00054">ha_message.c:54</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga07c688b58e8a798558db4636c565de51_cgraph.svg" width="363" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga07c688b58e8a798558db4636c565de51_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga710b813ea3909f21e518aa38928607e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>* traffic_selector_create_from_bytes </td>
          <td>(</td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>from_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>from_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>to_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>to_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new traffic selector using data read from the net.</p>
<p>There exists a mix of network and host order in the params. But the parser gives us this data in this format, so we don't have to convert twice.</p>
<p>If protocol is ICMP or ICMPv6 the ports are interpreted as follows: If they are less than 256 the value is assumed to be a message type, if they are greater or equal to 256 they are assumed to be type and code as defined for <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">protocol</td><td>protocol for this ts, such as TCP or UDP </td></tr>
    <tr><td class="paramname">type</td><td>type of following addresses, such as TS_IPV4_ADDR_RANGE </td></tr>
    <tr><td class="paramname">from_address</td><td>start of address range, network order </td></tr>
    <tr><td class="paramname">from_port</td><td>port number, host order </td></tr>
    <tr><td class="paramname">to_address</td><td>end of address range, network order </td></tr>
    <tr><td class="paramname">to_port</td><td>port number, host order </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> object </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00780">780</a> of file <a class="el" href="../../d3/d58/traffic__selector_8c_source.html">traffic_selector.c</a>.</p>

<p>References <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00129">calc_netbits()</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00050">memcpy</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector_create()</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00044">TS_IPV4_ADDR_RANGE</a>, and <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00053">TS_IPV6_ADDR_RANGE</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01661">addr2ts()</a>, <a class="el" href="../../de/d0b/sql__config_8c_source.html#l00050">build_traffic_selector()</a>, <a class="el" href="../../d4/df5/unity__handler_8c_source.html#l00072">create_ts()</a>, <a class="el" href="../../df/ddc/id__payload_8c_source.html#l00280">get_ts_from_ip()</a>, <a class="el" href="../../df/ddc/id__payload_8c_source.html#l00247">get_ts_from_range()</a>, <a class="el" href="../../df/ddc/id__payload_8c_source.html#l00258">get_ts_from_subnet()</a>, <a class="el" href="../../d4/d7b/ike__cfg_8c_source.html#l00459">make_range()</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00332">METHOD()</a>, and <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00075">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;{</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a> *<span class="keyword">this</span> = <a class="code" href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a>(<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>,</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                                            <a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, <a class="code" href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.len != 4 || <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.len != 4)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(this-&gt;from4, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.ptr, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.len);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(this-&gt;to4, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.ptr, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.len);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.len != 16 || <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.len != 16)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(this-&gt;from6, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.ptr, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.len);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(this-&gt;to6, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.ptr, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.len);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="../../d3/d58/traffic__selector_8c.html#a1fb5c3f7048c51b60d10b00bea82775d">calc_netbits</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">return</span> (&amp;this-&gt;<span class="keyword">public</span>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;}</div>
<div class="ttc" id="traffic__selector_8c_html_a1fb5c3f7048c51b60d10b00bea82775d"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a1fb5c3f7048c51b60d10b00bea82775d">calc_netbits</a></div><div class="ttdeci">static u_int8_t calc_netbits(private_traffic_selector_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00129">traffic_selector.c:129</a></div></div>
<div class="ttc" id="ha__message_8c_html_a617f1044052fa90a69727e1b11ff1ce7"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a></div><div class="ttdeci">u_int16_t to_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00053">ha_message.c:53</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00198">test_traffic_selector.c:198</a></div></div>
<div class="ttc" id="ha__message_8c_html_ad82c402f0fb34c2cbfc1e60d7b6c08a4"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a></div><div class="ttdeci">u_int8_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="group__memory__i_html_gaed653b4838032a2c5ce8960421c8cfd7"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a></div><div class="ttdeci">#define memcpy(d, s, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00050">memory.h:50</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="traffic__selector_8c_html_a33ffa864c84fe38606daac30bff2a0b0"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a></div><div class="ttdeci">static private_traffic_selector_t * traffic_selector_create(u_int8_t protocol, ts_type_t type, u_int16_t from_port, u_int16_t to_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector.c:964</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00040">traffic_selector.c:40</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00053">traffic_selector.h:53</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a5bafda9519252aa2d0fd038153f77dca"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a></div><div class="ttdeci">char * to</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00199">test_traffic_selector.c:199</a></div></div>
<div class="ttc" id="ha__message_8c_html_a5acbaa08fc6b62022375929357d3e749"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a></div><div class="ttdeci">u_int16_t from_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00052">ha_message.c:52</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga710b813ea3909f21e518aa38928607e2_cgraph.svg" width="363" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga710b813ea3909f21e518aa38928607e2_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gac0fac1a12e3cf4220dd2787f4a766a52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>* traffic_selector_create_from_cidr </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>from_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>to_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a traffic selector from a CIDR string.</p>
<p>If protocol is ICMP or ICMPv6 the ports are interpreted as follows: If they are less than 256 the value is assumed to be a message type, if they are greater or equal to 256 they are assumed to be type and code as defined for <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">string</td><td>CIDR string, such as 10.1.0.0/16 </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for this ts, such as TCP or UDP </td></tr>
    <tr><td class="paramname">from_port</td><td>start of allowed port range </td></tr>
    <tr><td class="paramname">to_port</td><td>end of port range </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>traffic selector, NULL if string invalid </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00928">928</a> of file <a class="el" href="../../d3/d58/traffic__selector_8c_source.html">traffic_selector.c</a>.</p>

<p>References <a class="el" href="../../da/d41/test__bliss__bitpacker_8c_source.html#l00020">bits</a>, <a class="el" href="../../df/da9/host_8c_source.html#l00571">host_create_from_subnet()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00103">net</a>, and <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00858">traffic_selector_create_from_subnet()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00447">add_ts()</a>, <a class="el" href="../../da/de3/vici__config_8c_source.html#l00536">CALLBACK()</a>, <a class="el" href="../../d2/df2/uci__config_8c_source.html#l00086">create_ts()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00391">install_route()</a>, <a class="el" href="../../d3/d95/config_8c_source.html#l00139">load_child_config()</a>, <a class="el" href="../../d4/d7b/ike__cfg_8c_source.html#l00444">make_subnet()</a>, <a class="el" href="../../d9/d44/unity__narrow_8c_source.html#l00226">METHOD()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00061">START_TEST()</a>, and <a class="el" href="../../d0/d7f/medcli__config_8c_source.html#l00060">ts_from_string()</a>.</p>
<div class="fragment"><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;{</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a2f13c35b1fa3de2bd8c668d4a0d52706">net</a>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../da/d41/test__bliss__bitpacker_8c.html#a7afe643191c861f57d5852578e86dd56">bits</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    net = <a class="code" href="../../d7/df1/group__host.html#gae46a29c83ab33eb8cb3f65a52647e72c">host_create_from_subnet</a>(<span class="keywordtype">string</span>, &amp;bits);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <span class="keywordflow">if</span> (net)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gabbed5b326fa118c23b508ebb34b17543">traffic_selector_create_from_subnet</a>(net, bits, <a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                                   <a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, <a class="code" href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    }</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div>
<div class="ttc" id="test__bliss__bitpacker_8c_html_a7afe643191c861f57d5852578e86dd56"><div class="ttname"><a href="../../da/d41/test__bliss__bitpacker_8c.html#a7afe643191c861f57d5852578e86dd56">bits</a></div><div class="ttdeci">static uint32_t bits[]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/test__bliss__bitpacker_8c_source.html#l00020">test_bliss_bitpacker.c:20</a></div></div>
<div class="ttc" id="ha__message_8c_html_a617f1044052fa90a69727e1b11ff1ce7"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a></div><div class="ttdeci">u_int16_t to_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00053">ha_message.c:53</a></div></div>
<div class="ttc" id="ha__message_8c_html_ad82c402f0fb34c2cbfc1e60d7b6c08a4"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a></div><div class="ttdeci">u_int8_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a2f13c35b1fa3de2bd8c668d4a0d52706"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a2f13c35b1fa3de2bd8c668d4a0d52706">net</a></div><div class="ttdeci">char * net</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00103">test_traffic_selector.c:103</a></div></div>
<div class="ttc" id="group__host_html_gae46a29c83ab33eb8cb3f65a52647e72c"><div class="ttname"><a href="../../d7/df1/group__host.html#gae46a29c83ab33eb8cb3f65a52647e72c">host_create_from_subnet</a></div><div class="ttdeci">host_t * host_create_from_subnet(char *string, int *bits)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/host_8c_source.html#l00571">host.c:571</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gabbed5b326fa118c23b508ebb34b17543"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gabbed5b326fa118c23b508ebb34b17543">traffic_selector_create_from_subnet</a></div><div class="ttdeci">traffic_selector_t * traffic_selector_create_from_subnet(host_t *net, u_int8_t netbits, u_int8_t protocol, u_int16_t from_port, u_int16_t to_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00858">traffic_selector.c:858</a></div></div>
<div class="ttc" id="ha__message_8c_html_a5acbaa08fc6b62022375929357d3e749"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a></div><div class="ttdeci">u_int16_t from_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00052">ha_message.c:52</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_gac0fac1a12e3cf4220dd2787f4a766a52_cgraph.svg" width="100%" height="575"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_gac0fac1a12e3cf4220dd2787f4a766a52_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga56641582310d09d5bde8d9754e75f4fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>* traffic_selector_create_from_rfc3779_format </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>from_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>to_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new traffic selector using the RFC 3779 ASN.1 min/max address format</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>type of following addresses, such as TS_IPV4_ADDR_RANGE </td></tr>
    <tr><td class="paramname">from_addr</td><td>start of address range in RFC 3779 ASN.1 BIT STRING format </td></tr>
    <tr><td class="paramname">to_addr</td><td>end of address range in RFC 3779 ASN.1 BIT STRING format </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> object </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00819">819</a> of file <a class="el" href="../../d3/d58/traffic__selector_8c_source.html">traffic_selector.c</a>.</p>

<p>References <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00129">calc_netbits()</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">len</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00201">mask</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00050">memcpy</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector_create()</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00044">TS_IPV4_ADDR_RANGE</a>, and <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00053">TS_IPV6_ADDR_RANGE</a>.</p>

<p>Referenced by <a class="el" href="../../de/d1d/x509__cert_8c_source.html#l01174">parse_ipAddrBlocks()</a>, and <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00129">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;{</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a> *<span class="keyword">this</span> = <a class="code" href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a>(0, <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>, 0, 65535);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            len = 4;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            len = 16;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>, 0x00, len);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>  , 0xff, len);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.len &gt; 1)</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.ptr+1, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>.len-1);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.len &gt; 1)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        u_int8_t <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a09630634038e3c15c486ba89893b8301">mask</a> = <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.ptr[0] ? (1 &lt;&lt; <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.ptr[0]) - 1 : 0;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.ptr+1, <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.len-1);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>[<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>.len-2] |= <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a09630634038e3c15c486ba89893b8301">mask</a>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="../../d3/d58/traffic__selector_8c.html#a1fb5c3f7048c51b60d10b00bea82775d">calc_netbits</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">return</span> (&amp;this-&gt;<span class="keyword">public</span>);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;}</div>
<div class="ttc" id="traffic__selector_8c_html_a1fb5c3f7048c51b60d10b00bea82775d"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a1fb5c3f7048c51b60d10b00bea82775d">calc_netbits</a></div><div class="ttdeci">static u_int8_t calc_netbits(private_traffic_selector_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00129">traffic_selector.c:129</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00198">test_traffic_selector.c:198</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a09630634038e3c15c486ba89893b8301"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a09630634038e3c15c486ba89893b8301">mask</a></div><div class="ttdeci">u_int8_t mask</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00201">test_traffic_selector.c:201</a></div></div>
<div class="ttc" id="group__memory__i_html_gaed653b4838032a2c5ce8960421c8cfd7"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a></div><div class="ttdeci">#define memcpy(d, s, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00050">memory.h:50</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="traffic__selector_8c_html_a33ffa864c84fe38606daac30bff2a0b0"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a></div><div class="ttdeci">static private_traffic_selector_t * traffic_selector_create(u_int8_t protocol, ts_type_t type, u_int16_t from_port, u_int16_t to_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector.c:964</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00040">traffic_selector.c:40</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00053">traffic_selector.h:53</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a2b341e3994bfbc0aa8d680205abbd28b"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a></div><div class="ttdeci">u_int16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">duplicheck_msg.h:45</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a5bafda9519252aa2d0fd038153f77dca"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a></div><div class="ttdeci">char * to</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00199">test_traffic_selector.c:199</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga56641582310d09d5bde8d9754e75f4fc_cgraph.svg" width="363" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga56641582310d09d5bde8d9754e75f4fc_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gae04e03c03653d99fb1a0900507a16549"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>* traffic_selector_create_from_string </td>
          <td>(</td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dff/group__traffic__selector.html#ga626ba88163961e3f06a7032d939b5fea">ts_type_t</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>from_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>from_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>to_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>to_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new traffic selector using human readable params.</p>
<p>If protocol is ICMP or ICMPv6 the ports are interpreted as follows: If they are less than 256 the value is assumed to be a message type, if they are greater or equal to 256 they are assumed to be type and code as defined for <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">protocol</td><td>protocol for this ts, such as TCP or UDP </td></tr>
    <tr><td class="paramname">type</td><td>type of following addresses, such as TS_IPV4_ADDR_RANGE </td></tr>
    <tr><td class="paramname">from_addr</td><td>start of address range as string </td></tr>
    <tr><td class="paramname">from_port</td><td>port number in host order </td></tr>
    <tr><td class="paramname">to_addr</td><td>end of address range as string </td></tr>
    <tr><td class="paramname">to_port</td><td>port number in host order </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> object</li>
<li>NULL if invalid address strings/protocol </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00892">892</a> of file <a class="el" href="../../d3/d58/traffic__selector_8c_source.html">traffic_selector.c</a>.</p>

<p>References <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00129">calc_netbits()</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00051">family</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00198">from</a>, <a class="el" href="../../da/d9b/group__windows.html#ga7fb1f8a8f40e09fa09e625d2a09dc04e">inet_pton()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00199">to</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector_create()</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00044">TS_IPV4_ADDR_RANGE</a>, and <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00053">TS_IPV6_ADDR_RANGE</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d53/nm__service_8c_source.html#l00284">connect_()</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00331">create_child_cfg()</a>, <a class="el" href="../../d7/d79/maemo__service_8c_source.html#l00226">initiate_connection()</a>, <a class="el" href="../../d9/d44/unity__narrow_8c_source.html#l00112">narrow_pre()</a>, and <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00036">START_TEST()</a>.</p>
<div class="fragment"><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;{</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>)</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            family = AF_INET;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            family = AF_INET6;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keyword">this</span> = <a class="code" href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a>(<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a>, <a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, <a class="code" href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../da/d9b/group__windows.html#ga7fb1f8a8f40e09fa09e625d2a09dc04e">inet_pton</a>(family, from_addr, this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>) != 1 ||</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <a class="code" href="../../da/d9b/group__windows.html#ga7fb1f8a8f40e09fa09e625d2a09dc04e">inet_pton</a>(family, to_addr, this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>) != 1)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <a class="code" href="../../d3/d58/traffic__selector_8c.html#a1fb5c3f7048c51b60d10b00bea82775d">calc_netbits</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div>
<div class="ttc" id="traffic__selector_8c_html_a1fb5c3f7048c51b60d10b00bea82775d"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a1fb5c3f7048c51b60d10b00bea82775d">calc_netbits</a></div><div class="ttdeci">static u_int8_t calc_netbits(private_traffic_selector_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00129">traffic_selector.c:129</a></div></div>
<div class="ttc" id="ha__message_8c_html_a617f1044052fa90a69727e1b11ff1ce7"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a></div><div class="ttdeci">u_int16_t to_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00053">ha_message.c:53</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00198">test_traffic_selector.c:198</a></div></div>
<div class="ttc" id="ha__message_8c_html_ad82c402f0fb34c2cbfc1e60d7b6c08a4"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a></div><div class="ttdeci">u_int8_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="ha__message_8c_html_a6494da1d0747e053505497a35ebccbba"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a></div><div class="ttdeci">u_int8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="traffic__selector_8c_html_a33ffa864c84fe38606daac30bff2a0b0"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a></div><div class="ttdeci">static private_traffic_selector_t * traffic_selector_create(u_int8_t protocol, ts_type_t type, u_int16_t from_port, u_int16_t to_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector.c:964</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00040">traffic_selector.c:40</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00053">traffic_selector.h:53</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a5bafda9519252aa2d0fd038153f77dca"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a></div><div class="ttdeci">char * to</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00199">test_traffic_selector.c:199</a></div></div>
<div class="ttc" id="ha__message_8c_html_a5acbaa08fc6b62022375929357d3e749"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a></div><div class="ttdeci">u_int16_t from_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00052">ha_message.c:52</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="group__windows_html_ga7fb1f8a8f40e09fa09e625d2a09dc04e"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga7fb1f8a8f40e09fa09e625d2a09dc04e">inet_pton</a></div><div class="ttdeci">int WINAPI inet_pton(int af, const char *src, void *dst)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_gae04e03c03653d99fb1a0900507a16549_cgraph.svg" width="363" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_gae04e03c03653d99fb1a0900507a16549_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="gabbed5b326fa118c23b508ebb34b17543"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>* traffic_selector_create_from_subnet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>netbits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>from_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>to_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new traffic selector defining a whole subnet.</p>
<p>In most cases, definition of a traffic selector for full subnets is sufficient. This constructor creates a traffic selector for all protocols, all ports and the address range specified by the subnet. Additionally, a protocol and ports may be specified.</p>
<p>If protocol is ICMP or ICMPv6 the ports are interpreted as follows: If they are less than 256 the value is assumed to be a message type, if they are greater or equal to 256 they are assumed to be type and code as defined for <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">net</td><td>subnet to use </td></tr>
    <tr><td class="paramname">netbits</td><td>size of the subnet, as used in e.g. 192.168.0.0/24 notation </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for this ts, such as TCP or UDP </td></tr>
    <tr><td class="paramname">from_port</td><td>start of allowed port range </td></tr>
    <tr><td class="paramname">to_port</td><td>end of port range </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> object</li>
<li>NULL if address family of net not supported </li>
</ul>
</dd></dl>

<p>Definition at line <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00858">858</a> of file <a class="el" href="../../d3/d58/traffic__selector_8c_source.html">traffic_selector.c</a>.</p>

<p>References <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00106">calc_range()</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00130">host_t::destroy</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00198">from</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00095">host_t::get_address</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00079">host_t::get_family</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00050">memcpy</a>, <a class="el" href="../../d1/ddf/align_8h_source.html#l00036">min</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector_create()</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00044">TS_IPV4_ADDR_RANGE</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00053">TS_IPV6_ADDR_RANGE</a>, and <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>.</p>

<p>Referenced by <a class="el" href="../../d4/df5/unity__handler_8c_source.html#l00205">add_exclude_async()</a>, <a class="el" href="../../d5/dd9/stroke__config_8c_source.html#l01089">add_ts()</a>, <a class="el" href="../../d7/d58/quick__mode_8c_source.html#l00553">get_ts()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l00738">install_ipip_ale()</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l01039">sadb_address2ts()</a>, <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l00763">selector2ts()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00094">START_TEST()</a>, and <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00928">traffic_selector_create_from_cidr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;{</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keyword">this</span> = <a class="code" href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a>(<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, 0, <a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, <a class="code" href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">switch</span> (net-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(net))</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">case</span> AF_INET:</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            this-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> = <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">case</span> AF_INET6:</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            this-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> = <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            net-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(net);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    from = net-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(net);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(this-&gt;from, from.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>, from.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    netbits = <a class="code" href="../../da/dbd/group__align__i.html#gabb702d8b501669a23aa0ab3b281b9384">min</a>(netbits, this-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> == <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a> ? 32 : 128);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <a class="code" href="../../d3/d58/traffic__selector_8c.html#a66ba09aae4797862904231be831f2eb0">calc_range</a>(<span class="keyword">this</span>, netbits);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    net-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(net);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<span class="keyword">public</span>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;}</div>
<div class="ttc" id="group__align__i_html_gabb702d8b501669a23aa0ab3b281b9384"><div class="ttname"><a href="../../da/dbd/group__align__i.html#gabb702d8b501669a23aa0ab3b281b9384">min</a></div><div class="ttdeci">#define min(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/ddf/align_8h_source.html#l00036">align.h:36</a></div></div>
<div class="ttc" id="ha__message_8c_html_a617f1044052fa90a69727e1b11ff1ce7"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a></div><div class="ttdeci">u_int16_t to_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00053">ha_message.c:53</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00198">test_traffic_selector.c:198</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="ha__message_8c_html_ad82c402f0fb34c2cbfc1e60d7b6c08a4"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a></div><div class="ttdeci">u_int8_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structhost__t_html_aa3493ae67869e4cd9b4dbe98226650fb"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">host_t::get_address</a></div><div class="ttdeci">chunk_t(* get_address)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00095">host.h:95</a></div></div>
<div class="ttc" id="group__memory__i_html_gaed653b4838032a2c5ce8960421c8cfd7"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a></div><div class="ttdeci">#define memcpy(d, s, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00050">memory.h:50</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="traffic__selector_8c_html_a66ba09aae4797862904231be831f2eb0"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a66ba09aae4797862904231be831f2eb0">calc_range</a></div><div class="ttdeci">static void calc_range(private_traffic_selector_t *this, u_int8_t netbits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00106">traffic_selector.c:106</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="traffic__selector_8c_html_a33ffa864c84fe38606daac30bff2a0b0"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a33ffa864c84fe38606daac30bff2a0b0">traffic_selector_create</a></div><div class="ttdeci">static private_traffic_selector_t * traffic_selector_create(u_int8_t protocol, ts_type_t type, u_int16_t from_port, u_int16_t to_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00964">traffic_selector.c:964</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00040">traffic_selector.c:40</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00053">traffic_selector.h:53</a></div></div>
<div class="ttc" id="ha__message_8c_html_a5acbaa08fc6b62022375929357d3e749"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a></div><div class="ttdeci">u_int16_t from_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00052">ha_message.c:52</a></div></div>
<div class="ttc" id="structhost__t_html_af9703b61f348ea0409dc9cb197b2b788"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">host_t::destroy</a></div><div class="ttdeci">void(* destroy)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00130">host.h:130</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="structhost__t_html_a75956f3fa34ec58543cb717d7a6dbba6"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">host_t::get_family</a></div><div class="ttdeci">int(* get_family)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00079">host.h:79</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_gabbed5b326fa118c23b508ebb34b17543_cgraph.svg" width="363" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_gabbed5b326fa118c23b508ebb34b17543_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga35a2141a376b7568b4fa44b46960bd03"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int8_t traffic_selector_icmp_code </td>
          <td>(</td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>port</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extract the ICMP/ICMPv6 message code from a port in host order</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>port number in host order </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ICMP/ICMPv6 message code </dd></dl>

<p>Definition at line <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00254">254</a> of file <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html">traffic_selector.h</a>.</p>

<p>Referenced by <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00509">create_policy_entry()</a>, <a class="el" href="../../d6/db0/updown__listener_8c_source.html#l00211">get_port()</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00198">print_icmp()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00731">START_TEST()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l00397">ts2condition()</a>, and <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l00729">ts2selector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d0/d72/ha__message_8c.html#a9e26a4afe91a21810290057677a17a11">port</a> &amp; 0xff;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="ttc" id="ha__message_8c_html_a9e26a4afe91a21810290057677a17a11"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a9e26a4afe91a21810290057677a17a11">port</a></div><div class="ttdeci">u_int16_t port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00050">ha_message.c:50</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga35a2141a376b7568b4fa44b46960bd03_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga1d6504665dab286ee80a7f4f34025a45"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int8_t traffic_selector_icmp_type </td>
          <td>(</td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>port</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extract the ICMP/ICMPv6 message type from a port in host order</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">port</td><td>port number in host order </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ICMP/ICMPv6 message type </dd></dl>

<p>Definition at line <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00243">243</a> of file <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html">traffic_selector.h</a>.</p>

<p>Referenced by <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00509">create_policy_entry()</a>, <a class="el" href="../../d6/db0/updown__listener_8c_source.html#l00211">get_port()</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00198">print_icmp()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00731">START_TEST()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l00397">ts2condition()</a>, and <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l00729">ts2selector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;{</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d0/d72/ha__message_8c.html#a9e26a4afe91a21810290057677a17a11">port</a> &gt;&gt; 8;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div>
<div class="ttc" id="ha__message_8c_html_a9e26a4afe91a21810290057677a17a11"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a9e26a4afe91a21810290057677a17a11">port</a></div><div class="ttdeci">u_int16_t port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00050">ha_message.c:50</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga1d6504665dab286ee80a7f4f34025a45_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga21d390799800674b78bc3374f05e4135"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int traffic_selector_printf_hook </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d07/structprintf__hook__data__t.html">printf_hook_data_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d82/structprintf__hook__spec__t.html">printf_hook_spec_t</a> *&#160;</td>
          <td class="paramname"><em>spec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *const *&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>printf hook function for <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>.</p>
<p>Arguments are: <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> <em>ts With the #-specifier, arguments are: <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *list containing <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a></em></p>
<p>Described in header. </p>

<p>Definition at line <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00214">214</a> of file <a class="el" href="../../d3/d58/traffic__selector_8c_source.html">traffic_selector.c</a>.</p>

<p>References <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list_t::create_enumerator</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00054">dynamic</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00198">from</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00052">from_port</a>, <a class="el" href="../../dc/d6a/printf__hook_8h_source.html#l00067">printf_hook_spec_t::hash</a>, <a class="el" href="../../da/d9b/group__windows.html#ga594548614fb23b9e25159c98bdee2065">inet_ntop()</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00190">is_any()</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00182">is_opaque()</a>, <a class="el" href="../../d2/d21/test__linked__list_8c_source.html#l00024">list</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00028">memeq()</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00028">NON_SUBNET_ADDRESS_RANGE</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00198">print_icmp()</a>, <a class="el" href="../../d0/dfb/printf__hook__builtin_8c_source.html#l00114">print_in_hook()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00434">proto</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00051">protocol</a>, <a class="el" href="../../de/d18/test__enumerator_8c_source.html#l00031">sep</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00199">to</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00053">to_port</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00044">TS_IPV4_ADDR_RANGE</a>, and <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00048">type</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d27/library_8c_source.html#l00247">library_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a> *<span class="keyword">this</span> = *((<a class="code" href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a>**)(args[0]));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *<a class="code" href="../../d2/d21/test__linked__list_8c.html#a92188d30f4d71257634d1ea6d960def6">list</a> = *((<a class="code" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a>**)(args[0]));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">char</span> from_str[INET6_ADDRSTRLEN] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">char</span> to_str[INET6_ADDRSTRLEN] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordtype">char</span> *serv_proto = NULL, *<a class="code" href="../../de/d18/test__enumerator_8c.html#a6019aaa7454c03e3d70313c382bf8b54">sep</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordtype">bool</span> has_proto, has_ports;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">size_t</span> written = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    u_int32_t <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a>[4], <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a>[4];</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">this</span> == NULL)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;(null)&quot;</span>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (spec-&gt;<a class="code" href="../../d6/d82/structprintf__hook__spec__t.html#a8c262f60598dc1e009250c0871872147">hash</a>)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        enumerator = list-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">create_enumerator</a>(list);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, (<span class="keywordtype">void</span>**)&amp;<span class="keyword">this</span>))</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;%s%R&quot;</span>, sep, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            sep = <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">return</span> written;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(from, 0, <span class="keyword">sizeof</span>(from));</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(to, 0xFF, <span class="keyword">sizeof</span>(to));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ab0288ab608c09f881121c7fe7dc1d052">dynamic</a> &amp;&amp;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="../../dd/d74/group__memory__i.html#ga46d7935db00fd7092430dbf4f36c2850">memeq</a>(this-&gt;from, from, this-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> == <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a> ? 4 : 16) &amp;&amp;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <a class="code" href="../../dd/d74/group__memory__i.html#ga46d7935db00fd7092430dbf4f36c2850">memeq</a>(this-&gt;to, to, this-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> == <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a> ? 4 : 16))</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;dynamic&quot;</span>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> == <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <a class="code" href="../../da/d9b/group__windows.html#ga594548614fb23b9e25159c98bdee2065">inet_ntop</a>(AF_INET, &amp;this-&gt;from4, from_str, <span class="keyword">sizeof</span>(from_str));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <a class="code" href="../../da/d9b/group__windows.html#ga594548614fb23b9e25159c98bdee2065">inet_ntop</a>(AF_INET6, &amp;this-&gt;from6, from_str, <span class="keyword">sizeof</span>(from_str));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">if</span> (this-&gt;netbits == <a class="code" href="../../d3/d58/traffic__selector_8c.html#a12bed85525f833e5f7057ee00a4876d5">NON_SUBNET_ADDRESS_RANGE</a>)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a> == <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <a class="code" href="../../da/d9b/group__windows.html#ga594548614fb23b9e25159c98bdee2065">inet_ntop</a>(AF_INET, &amp;this-&gt;to4, to_str, <span class="keyword">sizeof</span>(to_str));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <a class="code" href="../../da/d9b/group__windows.html#ga594548614fb23b9e25159c98bdee2065">inet_ntop</a>(AF_INET6, &amp;this-&gt;to6, to_str, <span class="keyword">sizeof</span>(to_str));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;%s..%s&quot;</span>, from_str, to_str);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;%s/%d&quot;</span>, from_str, this-&gt;netbits);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">/* check if we have protocol and/or port selectors */</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    has_proto = this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a> != 0;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    has_ports = !<a class="code" href="../../d3/d58/traffic__selector_8c.html#a054b8e3b6a9c2fdbb5c791cb5bc8e50f">is_any</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (!has_proto &amp;&amp; !has_ports)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">return</span> written;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;[&quot;</span>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">/* build protocol string */</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (has_proto)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keyword">struct </span>protoent *<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a004be5bbd8f260d2abad8f52ab1fc400">proto</a> = getprotobynumber(this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">if</span> (proto)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;%s&quot;</span>, proto-&gt;p_name);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            serv_proto = proto-&gt;p_name;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;%d&quot;</span>, this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (has_proto &amp;&amp; has_ports)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">/* build port string */</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (has_ports)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a> == this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>)</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keyword">struct </span>servent *serv;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a> == IPPROTO_ICMP ||</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a> == IPPROTO_ICMPV6)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                written += <a class="code" href="../../d3/d58/traffic__selector_8c.html#a1b4636f12e77f605f193f255ce0b01df">print_icmp</a>(data, this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                serv = getservbyport(htons(this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>), serv_proto);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                <span class="keywordflow">if</span> (serv)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;%s&quot;</span>, serv-&gt;s_name);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;%d&quot;</span>, this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d58/traffic__selector_8c.html#ab9c0693b63a4d524588c45b1ffa3ba5b">is_opaque</a>(<span class="keyword">this</span>))</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;OPAQUE&quot;</span>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a> == IPPROTO_ICMP ||</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                 this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a> == IPPROTO_ICMPV6)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            written += <a class="code" href="../../d3/d58/traffic__selector_8c.html#a1b4636f12e77f605f193f255ce0b01df">print_icmp</a>(data, this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;-&quot;</span>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            written += <a class="code" href="../../d3/d58/traffic__selector_8c.html#a1b4636f12e77f605f193f255ce0b01df">print_icmp</a>(data, this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;%d-%d&quot;</span>,</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                     this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a>, this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    written += <a class="code" href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a>(data, <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">return</span> written;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="ttc" id="test__linked__list_8c_html_a92188d30f4d71257634d1ea6d960def6"><div class="ttname"><a href="../../d2/d21/test__linked__list_8c.html#a92188d30f4d71257634d1ea6d960def6">list</a></div><div class="ttdeci">static linked_list_t * list</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d21/test__linked__list_8c_source.html#l00024">test_linked_list.c:24</a></div></div>
<div class="ttc" id="ha__message_8c_html_a617f1044052fa90a69727e1b11ff1ce7"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a617f1044052fa90a69727e1b11ff1ce7">to_port</a></div><div class="ttdeci">u_int16_t to_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00053">ha_message.c:53</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a765533dfc643627999c751f7e1514664"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a765533dfc643627999c751f7e1514664">from</a></div><div class="ttdeci">char * from</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00198">test_traffic_selector.c:198</a></div></div>
<div class="ttc" id="group__printf__hook_html_gac652d692cae0531203f286059d6e1749"><div class="ttname"><a href="../../d2/d15/group__printf__hook.html#gac652d692cae0531203f286059d6e1749">print_in_hook</a></div><div class="ttdeci">size_t print_in_hook(printf_hook_data_t *data, char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dfb/printf__hook__builtin_8c_source.html#l00114">printf_hook_builtin.c:114</a></div></div>
<div class="ttc" id="traffic__selector_8c_html_a1b4636f12e77f605f193f255ce0b01df"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a1b4636f12e77f605f193f255ce0b01df">print_icmp</a></div><div class="ttdeci">static int print_icmp(printf_hook_data_t *data, u_int16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00198">traffic_selector.c:198</a></div></div>
<div class="ttc" id="ha__message_8c_html_ad82c402f0fb34c2cbfc1e60d7b6c08a4"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a></div><div class="ttdeci">u_int8_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structlinked__list__t_html_aa079d50cc4028f12d65c75cbb53f8c8a"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">linked_list_t::create_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_enumerator)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list.h:71</a></div></div>
<div class="ttc" id="traffic__selector_8c_html_a12bed85525f833e5f7057ee00a4876d5"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a12bed85525f833e5f7057ee00a4876d5">NON_SUBNET_ADDRESS_RANGE</a></div><div class="ttdeci">#define NON_SUBNET_ADDRESS_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00028">traffic_selector.c:28</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="traffic__selector_8c_html_a054b8e3b6a9c2fdbb5c791cb5bc8e50f"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#a054b8e3b6a9c2fdbb5c791cb5bc8e50f">is_any</a></div><div class="ttdeci">static bool is_any(private_traffic_selector_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00190">traffic_selector.c:190</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a004be5bbd8f260d2abad8f52ab1fc400"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a004be5bbd8f260d2abad8f52ab1fc400">proto</a></div><div class="ttdeci">u_int8_t proto</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00434">test_traffic_selector.c:434</a></div></div>
<div class="ttc" id="group__memory__i_html_ga46d7935db00fd7092430dbf4f36c2850"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga46d7935db00fd7092430dbf4f36c2850">memeq</a></div><div class="ttdeci">static bool memeq(const void *x, const void *y, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00028">memory.h:28</a></div></div>
<div class="ttc" id="structprivate__traffic__selector__t_html"><div class="ttname"><a href="../../d3/dc8/structprivate__traffic__selector__t.html">private_traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00040">traffic_selector.c:40</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a5bafda9519252aa2d0fd038153f77dca"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a5bafda9519252aa2d0fd038153f77dca">to</a></div><div class="ttdeci">char * to</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00199">test_traffic_selector.c:199</a></div></div>
<div class="ttc" id="ha__message_8c_html_a5acbaa08fc6b62022375929357d3e749"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a5acbaa08fc6b62022375929357d3e749">from_port</a></div><div class="ttdeci">u_int16_t from_port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00052">ha_message.c:52</a></div></div>
<div class="ttc" id="test__enumerator_8c_html_a6019aaa7454c03e3d70313c382bf8b54"><div class="ttname"><a href="../../de/d18/test__enumerator_8c.html#a6019aaa7454c03e3d70313c382bf8b54">sep</a></div><div class="ttdeci">char * sep</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d18/test__enumerator_8c_source.html#l00031">test_enumerator.c:31</a></div></div>
<div class="ttc" id="ha__message_8c_html_ab0288ab608c09f881121c7fe7dc1d052"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ab0288ab608c09f881121c7fe7dc1d052">dynamic</a></div><div class="ttdeci">u_int8_t dynamic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00054">ha_message.c:54</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structprintf__hook__spec__t_html_a8c262f60598dc1e009250c0871872147"><div class="ttname"><a href="../../d6/d82/structprintf__hook__spec__t.html#a8c262f60598dc1e009250c0871872147">printf_hook_spec_t::hash</a></div><div class="ttdeci">int hash</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d6a/printf__hook_8h_source.html#l00067">printf_hook.h:67</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_a3cce6e7fc609fa524af48647bd518f51"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#a3cce6e7fc609fa524af48647bd518f51">type</a></div><div class="ttdeci">u_int8_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00048">eap_gtc.c:48</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
<div class="ttc" id="structlinked__list__t_html"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html">linked_list_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00054">linked_list.h:54</a></div></div>
<div class="ttc" id="traffic__selector_8c_html_ab9c0693b63a4d524588c45b1ffa3ba5b"><div class="ttname"><a href="../../d3/d58/traffic__selector_8c.html#ab9c0693b63a4d524588c45b1ffa3ba5b">is_opaque</a></div><div class="ttdeci">static bool is_opaque(private_traffic_selector_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00182">traffic_selector.c:182</a></div></div>
<div class="ttc" id="group__windows_html_ga594548614fb23b9e25159c98bdee2065"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga594548614fb23b9e25159c98bdee2065">inet_ntop</a></div><div class="ttdeci">const char WINAPI * inet_ntop(int af, const void *src, char *dst, socklen_t size)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga21d390799800674b78bc3374f05e4135_cgraph.svg" width="100%" height="556"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dff/group__traffic__selector_ga21d390799800674b78bc3374f05e4135_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ga7a2697e892d4e4b4b7608b490c42775f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d70/structenum__name__t.html">enum_name_t</a>* ts_type_name</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>enum names for ts_type_t </p>

<p>Referenced by <a class="el" href="../../d6/dfd/log__ts_8c_source.html#l00033">METHOD()</a>, and <a class="el" href="../../de/d1d/x509__cert_8c_source.html#l01174">parse_ipAddrBlocks()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:24 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
