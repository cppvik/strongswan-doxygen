<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: cmd_connection.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d7/d9c/cmd__connection_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">cmd_connection.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../d8/da7/cmd__connection_8h_source.html">cmd_connection.h</a>&quot;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../db/d16/debug_8h_source.html">utils/debug.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../db/ddd/callback__job_8h_source.html">processing/jobs/callback_job.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../db/dd5/thread_8h_source.html">threading/thread.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d0/d51/daemon_8h_source.html">daemon.h</a>&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for cmd_connection.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d63/cmd__connection_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="../../d7/d9c/cmd__connection_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af25486fe656b9a68c30f2b1fa976ce0b"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73b">profile_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#af25486fe656b9a68c30f2b1fa976ce0b">profile_t</a></td></tr>
<tr class="separator:af25486fe656b9a68c30f2b1fa976ce0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c1c14db129434e0e7a05ac992a3d45f"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a6c1c14db129434e0e7a05ac992a3d45f">private_cmd_connection_t</a></td></tr>
<tr class="separator:a6c1c14db129434e0e7a05ac992a3d45f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ae05a6a7cf154d891ba73f0d081c5a73b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73b">profile_t</a> { <br/>
&#160;&#160;<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187">PROF_UNDEF</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28">PROF_V2_EAP</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7">PROF_V2_PUB_EAP</a>, 
<br/>
&#160;&#160;<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409">PROF_V1_PUB</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee">PROF_V1_PUB_AM</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78">PROF_V1_XAUTH</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2">PROF_V1_XAUTH_AM</a>, 
<br/>
&#160;&#160;<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222">PROF_V1_XAUTH_PSK</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced">PROF_V1_XAUTH_PSK_AM</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe">PROF_V1_HYBRID</a>, 
<a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a>
<br/>
 }</td></tr>
<tr class="separator:ae05a6a7cf154d891ba73f0d081c5a73b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adad96d1734cd9d987f2ecd3999bca0f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#adad96d1734cd9d987f2ecd3999bca0f0">ENUM</a> (profile_names, <a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a>,&quot;ikev2-<a class="el" href="../../d8/db6/pub_8c.html#a251303441b8fd13c8fe80aab8c4a6ecd">pub</a>&quot;,&quot;<a class="el" href="../../df/dc8/test__hasher_8c.html#affba3105b42bc7a7fb59a7d8e80895d6">ikev2</a>-eap&quot;,&quot;<a class="el" href="../../df/dc8/test__hasher_8c.html#affba3105b42bc7a7fb59a7d8e80895d6">ikev2</a>-<a class="el" href="../../d8/db6/pub_8c.html#a251303441b8fd13c8fe80aab8c4a6ecd">pub</a>-eap&quot;,&quot;ikev1-<a class="el" href="../../d8/db6/pub_8c.html#a251303441b8fd13c8fe80aab8c4a6ecd">pub</a>&quot;,&quot;ikev1-<a class="el" href="../../d8/db6/pub_8c.html#a251303441b8fd13c8fe80aab8c4a6ecd">pub</a>-am&quot;,&quot;ikev1-xauth&quot;,&quot;ikev1-xauth-am&quot;,&quot;ikev1-xauth-psk&quot;,&quot;ikev1-xauth-psk-am&quot;,&quot;ikev1-hybrid&quot;,&quot;ikev1-hybrid-am&quot;,)</td></tr>
<tr class="separator:adad96d1734cd9d987f2ecd3999bca0f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7673aa078775c7307b184332c8d97086"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a7673aa078775c7307b184332c8d97086">terminate</a> (pid_t pid)</td></tr>
<tr class="separator:a7673aa078775c7307b184332c8d97086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad383141d47fae75523014ef65e04c018"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#ad383141d47fae75523014ef65e04c018">create_peer_cfg</a> (<a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this)</td></tr>
<tr class="separator:ad383141d47fae75523014ef65e04c018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7060a5910fc55f3ab1d4c3f6f2d01330"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a> (<a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this, <a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *peer_cfg, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> local, <a class="el" href="../../d0/db5/group__auth__cfg.html#ga8ecd32976ad34d68d91d31c9a27392a1">auth_class_t</a> class)</td></tr>
<tr class="separator:a7060a5910fc55f3ab1d4c3f6f2d01330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a2225da93d04a822cb999d15797b13"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a69a2225da93d04a822cb999d15797b13">add_auth_cfgs</a> (<a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this, <a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *peer_cfg)</td></tr>
<tr class="separator:a69a2225da93d04a822cb999d15797b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f336f506c2809aaa13a8a7dc31b25ff"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d8/dd6/structchild__cfg__t.html">child_cfg_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a1f336f506c2809aaa13a8a7dc31b25ff">create_child_cfg</a> (<a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this, <a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *peer_cfg)</td></tr>
<tr class="separator:a1f336f506c2809aaa13a8a7dc31b25ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ef10a08acb2689e03be939316fb0a76"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d63/structjob__requeue__t.html">job_requeue_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a1ef10a08acb2689e03be939316fb0a76">initiate</a> (<a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this)</td></tr>
<tr class="separator:a1ef10a08acb2689e03be939316fb0a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c16816868ca59c4ad8777749c9a09ae"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a4c16816868ca59c4ad8777749c9a09ae">add_ts</a> (<a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *<a class="el" href="../../d9/d93/stroke_8c.html#ac09beaa605d6b27a417d4f02ed8a841c">list</a>, char *<a class="el" href="../../de/d18/test__enumerator_8c.html#aed1cfb225a5fb77461e7972691e68a72">string</a>)</td></tr>
<tr class="separator:a4c16816868ca59c4ad8777749c9a09ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137d617d75d6918da14eed0010cb05e6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a137d617d75d6918da14eed0010cb05e6">set_profile</a> (<a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this, char *<a class="el" href="../../d7/da0/test__parser_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td></tr>
<tr class="separator:a137d617d75d6918da14eed0010cb05e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7edf100f0c26164ae45b03d4c8b288f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a7edf100f0c26164ae45b03d4c8b288f3">METHOD</a> (<a class="el" href="../../d1/d1e/structcmd__connection__t.html">cmd_connection_t</a>, <a class="el" href="../../d3/d3e/pt__tls__dispatcher_8c.html#ad0237515f79d0401d25882116f10c2a2">handle</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this, <a class="el" href="../../d6/db0/group__cmd__option.html#ga25da2eda5d74124b8e7f7988a1bfb1e8">cmd_option_type_t</a> opt, char *arg)</td></tr>
<tr class="separator:a7edf100f0c26164ae45b03d4c8b288f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39e43018827c0d40b28cde51eccd0c68"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#a39e43018827c0d40b28cde51eccd0c68">METHOD</a> (<a class="el" href="../../d1/d1e/structcmd__connection__t.html">cmd_connection_t</a>, <a class="el" href="../../d4/ddc/windows_2thread_8c.html#a343cd07ea8770e572cfe3a7d39ea8401">destroy</a>, void, <a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *this)</td></tr>
<tr class="separator:a39e43018827c0d40b28cde51eccd0c68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1bbf39b98183c6bab6a662794a6af8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d1e/structcmd__connection__t.html">cmd_connection_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/group__cmd__connection.html#gac1bbf39b98183c6bab6a662794a6af8b">cmd_connection_create</a> ()</td></tr>
<tr class="separator:gac1bbf39b98183c6bab6a662794a6af8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a6c1c14db129434e0e7a05ac992a3d45f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> <a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00030">30</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

</div>
</div>
<a class="anchor" id="af25486fe656b9a68c30f2b1fa976ce0b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73b">profile_t</a> <a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73b">profile_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00029">29</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73b">profile_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Connection profiles we support </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187"></a>PROF_UNDEF</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde"></a>PROF_V2_PUB</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28"></a>PROF_V2_EAP</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7"></a>PROF_V2_PUB_EAP</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409"></a>PROF_V1_PUB</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee"></a>PROF_V1_PUB_AM</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78"></a>PROF_V1_XAUTH</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2"></a>PROF_V1_XAUTH_AM</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222"></a>PROF_V1_XAUTH_PSK</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced"></a>PROF_V1_XAUTH_PSK_AM</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe"></a>PROF_V1_HYBRID</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda"></a>PROF_V1_HYBRID_AM</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00035">35</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;               {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187">PROF_UNDEF</a>,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a>,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28">PROF_V2_EAP</a>,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7">PROF_V2_PUB_EAP</a>,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409">PROF_V1_PUB</a>,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee">PROF_V1_PUB_AM</a>,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78">PROF_V1_XAUTH</a>,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2">PROF_V1_XAUTH_AM</a>,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222">PROF_V1_XAUTH_PSK</a>,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced">PROF_V1_XAUTH_PSK_AM</a>,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe">PROF_V1_HYBRID</a>,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a>,</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;};</div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00047">cmd_connection.c:47</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409">PROF_V1_PUB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00040">cmd_connection.c:40</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78">PROF_V1_XAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00042">cmd_connection.c:42</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00037">cmd_connection.c:37</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced">PROF_V1_XAUTH_PSK_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00045">cmd_connection.c:45</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee">PROF_V1_PUB_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00041">cmd_connection.c:41</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe">PROF_V1_HYBRID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00046">cmd_connection.c:46</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2">PROF_V1_XAUTH_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00043">cmd_connection.c:43</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28">PROF_V2_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00038">cmd_connection.c:38</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7">PROF_V2_PUB_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00039">cmd_connection.c:39</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187">PROF_UNDEF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00036">cmd_connection.c:36</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222">PROF_V1_XAUTH_PSK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00044">cmd_connection.c:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7060a5910fc55f3ab1d4c3f6f2d01330"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_auth_cfg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *&#160;</td>
          <td class="paramname"><em>peer_cfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/db5/group__auth__cfg.html#ga8ecd32976ad34d68d91d31c9a27392a1">auth_class_t</a>&#160;</td>
          <td class="paramname"><em>class</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add a single auth cfg of given class to peer cfg </p>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00206">206</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00182">auth_cfg_t::add</a>, <a class="el" href="../../d7/d2b/peer__cfg_8h_source.html#l00182">peer_cfg_t::add_auth_cfg</a>, <a class="el" href="../../df/d31/auth__cfg_8c_source.html#l01112">auth_cfg_create()</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00044">AUTH_CLASS_EAP</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00046">AUTH_CLASS_XAUTH</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00074">AUTH_RULE_AUTH_CLASS</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00078">AUTH_RULE_EAP_IDENTITY</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00069">AUTH_RULE_IDENTITY</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00072">AUTH_RULE_IDENTITY_LOOSE</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00086">AUTH_RULE_XAUTH_IDENTITY</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">host</a>, <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00051">id</a>, <a class="el" href="../../d6/d2f/identification_8c_source.html#l01042">identification_create_from_string()</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00047">identity</a>, <a class="el" href="../../d9/d8a/sasl__mechanism_8c_source.html#l00025">server</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00253">add_auth_cfgs()</a>, and <a class="el" href="../../d9/db5/peer__cfg_8c_source.html#l00649">peer_cfg_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="code" href="../../d2/d3f/error__notify__msg_8h.html#a3c8b30225958fba291b8905ef960fafb">id</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="../../db/db6/structauth__cfg__t.html">auth_cfg_t</a> *auth;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    auth = <a class="code" href="../../d0/db5/group__auth__cfg.html#ga57b30fedc7ad3f8720f12fc99390cccc">auth_cfg_create</a>();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    auth-&gt;<a class="code" href="../../db/db6/structauth__cfg__t.html#aaa28eceaa1722e2419833a6ad4c909bd">add</a>(auth, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47ea9339f8a539588fa618efe99afae84289">AUTH_RULE_AUTH_CLASS</a>, <span class="keyword">class</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (local)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordtype">id</span> = <a class="code" href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a>(this-&gt;<a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a09930e473fa6e5d72934fa8e0525f09e">identity</a>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (this-&gt;xautheap)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">switch</span> (<span class="keyword">class</span>)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1abd68f7e7a6cf1304252d5e26f593e354">AUTH_CLASS_EAP</a>:</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    auth-&gt;<a class="code" href="../../db/db6/structauth__cfg__t.html#aaa28eceaa1722e2419833a6ad4c909bd">add</a>(auth, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47ea5cc0af89f3e17f9823c7792dd28388c8">AUTH_RULE_EAP_IDENTITY</a>,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                            <a class="code" href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a>(this-&gt;xautheap));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1ad2b4295b0b5d31d7f5e6acc08b6ffc9c">AUTH_CLASS_XAUTH</a>:</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    auth-&gt;<a class="code" href="../../db/db6/structauth__cfg__t.html#aaa28eceaa1722e2419833a6ad4c909bd">add</a>(auth, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47ea8556ce92286375c3f0a3050a63c7ad60">AUTH_RULE_XAUTH_IDENTITY</a>,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                            <a class="code" href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a>(this-&gt;xautheap));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a>)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordtype">id</span> = <a class="code" href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a>(this-&gt;<a class="code" href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordtype">id</span> = <a class="code" href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a>(this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        auth-&gt;<a class="code" href="../../db/db6/structauth__cfg__t.html#aaa28eceaa1722e2419833a6ad4c909bd">add</a>(auth, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47ead980cd596dc58e92ce4600883523f873">AUTH_RULE_IDENTITY_LOOSE</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    auth-&gt;<a class="code" href="../../db/db6/structauth__cfg__t.html#aaa28eceaa1722e2419833a6ad4c909bd">add</a>(auth, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47eacfb5331968b2e05fc5c4a099069ffe0b">AUTH_RULE_IDENTITY</a>, <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    peer_cfg-&gt;<a class="code" href="../../d9/d16/structpeer__cfg__t.html#a14a0071c1b8e45bbd2906b4c7b3a462f">add_auth_cfg</a>(peer_cfg, auth, local);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="ttc" id="test__traffic__selector_8c_html_a1c2046dcb30a629d6d9f45ff8f403f12"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">test_traffic_selector.c:403</a></div></div>
<div class="ttc" id="structidentification__t_html"><div class="ttname"><a href="../../d6/d02/structidentification__t.html">identification_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d5e/identification_8h_source.html#l00197">identification.h:197</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga5c1ce3c28b9258cbd156e37d310fc47ea5cc0af89f3e17f9823c7792dd28388c8"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47ea5cc0af89f3e17f9823c7792dd28388c8">AUTH_RULE_EAP_IDENTITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00078">auth_cfg.h:78</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga8ecd32976ad34d68d91d31c9a27392a1ad2b4295b0b5d31d7f5e6acc08b6ffc9c"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1ad2b4295b0b5d31d7f5e6acc08b6ffc9c">AUTH_CLASS_XAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00046">auth_cfg.h:46</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga5c1ce3c28b9258cbd156e37d310fc47ead980cd596dc58e92ce4600883523f873"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47ead980cd596dc58e92ce4600883523f873">AUTH_RULE_IDENTITY_LOOSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00072">auth_cfg.h:72</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga5c1ce3c28b9258cbd156e37d310fc47ea8556ce92286375c3f0a3050a63c7ad60"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47ea8556ce92286375c3f0a3050a63c7ad60">AUTH_RULE_XAUTH_IDENTITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00086">auth_cfg.h:86</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga8ecd32976ad34d68d91d31c9a27392a1abd68f7e7a6cf1304252d5e26f593e354"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1abd68f7e7a6cf1304252d5e26f593e354">AUTH_CLASS_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00044">auth_cfg.h:44</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a09930e473fa6e5d72934fa8e0525f09e"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a09930e473fa6e5d72934fa8e0525f09e">identity</a></div><div class="ttdeci">char identity[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00047">duplicheck_msg.h:47</a></div></div>
<div class="ttc" id="group__auth__cfg_html_ga57b30fedc7ad3f8720f12fc99390cccc"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#ga57b30fedc7ad3f8720f12fc99390cccc">auth_cfg_create</a></div><div class="ttdeci">auth_cfg_t * auth_cfg_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d31/auth__cfg_8c_source.html#l01112">auth_cfg.c:1112</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga5c1ce3c28b9258cbd156e37d310fc47eacfb5331968b2e05fc5c4a099069ffe0b"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47eacfb5331968b2e05fc5c4a099069ffe0b">AUTH_RULE_IDENTITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00069">auth_cfg.h:69</a></div></div>
<div class="ttc" id="error__notify__msg_8h_html_a3c8b30225958fba291b8905ef960fafb"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#a3c8b30225958fba291b8905ef960fafb">id</a></div><div class="ttdeci">char id[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00051">error_notify_msg.h:51</a></div></div>
<div class="ttc" id="group__identification_html_ga23065d7dd9165080ce47e4c20089761e"><div class="ttname"><a href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a></div><div class="ttdeci">identification_t * identification_create_from_string(char *string)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2f/identification_8c_source.html#l01042">identification.c:1042</a></div></div>
<div class="ttc" id="structauth__cfg__t_html"><div class="ttname"><a href="../../db/db6/structauth__cfg__t.html">auth_cfg_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00167">auth_cfg.h:167</a></div></div>
<div class="ttc" id="sasl__mechanism_8c_html_ae57ae4ecc2c00b47149ec5130bc9c9ef"><div class="ttname"><a href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a></div><div class="ttdeci">bool server</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8a/sasl__mechanism_8c_source.html#l00025">sasl_mechanism.c:25</a></div></div>
<div class="ttc" id="structauth__cfg__t_html_aaa28eceaa1722e2419833a6ad4c909bd"><div class="ttname"><a href="../../db/db6/structauth__cfg__t.html#aaa28eceaa1722e2419833a6ad4c909bd">auth_cfg_t::add</a></div><div class="ttdeci">void(* add)(auth_cfg_t *this, auth_rule_t rule,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00182">auth_cfg.h:182</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga5c1ce3c28b9258cbd156e37d310fc47ea9339f8a539588fa618efe99afae84289"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga5c1ce3c28b9258cbd156e37d310fc47ea9339f8a539588fa618efe99afae84289">AUTH_RULE_AUTH_CLASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00074">auth_cfg.h:74</a></div></div>
<div class="ttc" id="structpeer__cfg__t_html_a14a0071c1b8e45bbd2906b4c7b3a462f"><div class="ttname"><a href="../../d9/d16/structpeer__cfg__t.html#a14a0071c1b8e45bbd2906b4c7b3a462f">peer_cfg_t::add_auth_cfg</a></div><div class="ttdeci">void(* add_auth_cfg)(peer_cfg_t *this, auth_cfg_t *cfg, bool local)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00182">peer_cfg.h:182</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a7060a5910fc55f3ab1d4c3f6f2d01330_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a7060a5910fc55f3ab1d4c3f6f2d01330_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a69a2225da93d04a822cb999d15797b13"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> add_auth_cfgs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *&#160;</td>
          <td class="paramname"><em>peer_cfg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attach authentication configs to peer config </p>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00253">253</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00206">add_auth_cfg()</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00038">AUTH_CLASS_ANY</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00044">AUTH_CLASS_EAP</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00042">AUTH_CLASS_PSK</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00040">AUTH_CLASS_PUBKEY</a>, <a class="el" href="../../d4/d86/auth__cfg_8h_source.html#l00046">AUTH_CLASS_XAUTH</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00046">DBG_CFG</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00036">PROF_UNDEF</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00046">PROF_V1_HYBRID</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00047">PROF_V1_HYBRID_AM</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00040">PROF_V1_PUB</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00041">PROF_V1_PUB_AM</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00042">PROF_V1_XAUTH</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00043">PROF_V1_XAUTH_AM</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00044">PROF_V1_XAUTH_PSK</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00045">PROF_V1_XAUTH_PSK_AM</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00038">PROF_V2_EAP</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00037">PROF_V2_PUB</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00039">PROF_V2_PUB_EAP</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00406">initiate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;{</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (this-&gt;profile == <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187">PROF_UNDEF</a>)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">if</span> (this-&gt;key_seen)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            this-&gt;profile = <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            this-&gt;profile = <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28">PROF_V2_EAP</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">switch</span> (this-&gt;profile)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a>:</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7">PROF_V2_PUB_EAP</a>:</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409">PROF_V1_PUB</a>:</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78">PROF_V1_XAUTH</a>:</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee">PROF_V1_PUB_AM</a>:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2">PROF_V1_XAUTH_AM</a>:</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span> (!this-&gt;key_seen)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a>, <span class="stringliteral">&quot;missing private key for profile %N&quot;</span>,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                     profile_names, this-&gt;profile);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">switch</span> (this-&gt;profile)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a>:</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01">AUTH_CLASS_PUBKEY</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a5e6f179811a02d63db7cd384aa41a831">AUTH_CLASS_ANY</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28">PROF_V2_EAP</a>:</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1abd68f7e7a6cf1304252d5e26f593e354">AUTH_CLASS_EAP</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a5e6f179811a02d63db7cd384aa41a831">AUTH_CLASS_ANY</a>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7">PROF_V2_PUB_EAP</a>:</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01">AUTH_CLASS_PUBKEY</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1abd68f7e7a6cf1304252d5e26f593e354">AUTH_CLASS_EAP</a>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a5e6f179811a02d63db7cd384aa41a831">AUTH_CLASS_ANY</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409">PROF_V1_PUB</a>:</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee">PROF_V1_PUB_AM</a>:</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01">AUTH_CLASS_PUBKEY</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01">AUTH_CLASS_PUBKEY</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78">PROF_V1_XAUTH</a>:</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2">PROF_V1_XAUTH_AM</a>:</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01">AUTH_CLASS_PUBKEY</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1ad2b4295b0b5d31d7f5e6acc08b6ffc9c">AUTH_CLASS_XAUTH</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01">AUTH_CLASS_PUBKEY</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222">PROF_V1_XAUTH_PSK</a>:</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced">PROF_V1_XAUTH_PSK_AM</a>:</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a86bcca92fbe70510dcca39e8dd05321d">AUTH_CLASS_PSK</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1ad2b4295b0b5d31d7f5e6acc08b6ffc9c">AUTH_CLASS_XAUTH</a>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a86bcca92fbe70510dcca39e8dd05321d">AUTH_CLASS_PSK</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe">PROF_V1_HYBRID</a>:</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a>:</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1ad2b4295b0b5d31d7f5e6acc08b6ffc9c">AUTH_CLASS_XAUTH</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a>(<span class="keyword">this</span>, peer_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01">AUTH_CLASS_PUBKEY</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="ttc" id="cmd__connection_8c_html_a7060a5910fc55f3ab1d4c3f6f2d01330"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#a7060a5910fc55f3ab1d4c3f6f2d01330">add_auth_cfg</a></div><div class="ttdeci">static void add_auth_cfg(private_cmd_connection_t *this, peer_cfg_t *peer_cfg, bool local, auth_class_t class)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00206">cmd_connection.c:206</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00047">cmd_connection.c:47</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga8ecd32976ad34d68d91d31c9a27392a1a5e6f179811a02d63db7cd384aa41a831"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a5e6f179811a02d63db7cd384aa41a831">AUTH_CLASS_ANY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00038">auth_cfg.h:38</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga8ecd32976ad34d68d91d31c9a27392a1ad2b4295b0b5d31d7f5e6acc08b6ffc9c"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1ad2b4295b0b5d31d7f5e6acc08b6ffc9c">AUTH_CLASS_XAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00046">auth_cfg.h:46</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga8ecd32976ad34d68d91d31c9a27392a1abd68f7e7a6cf1304252d5e26f593e354"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1abd68f7e7a6cf1304252d5e26f593e354">AUTH_CLASS_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00044">auth_cfg.h:44</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409">PROF_V1_PUB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00040">cmd_connection.c:40</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78">PROF_V1_XAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00042">cmd_connection.c:42</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a4e866764610bb40293d6e7b383551b01">AUTH_CLASS_PUBKEY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00040">auth_cfg.h:40</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00037">cmd_connection.c:37</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced">PROF_V1_XAUTH_PSK_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00045">cmd_connection.c:45</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee">PROF_V1_PUB_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00041">cmd_connection.c:41</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe">PROF_V1_HYBRID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00046">cmd_connection.c:46</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2">PROF_V1_XAUTH_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00043">cmd_connection.c:43</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28">PROF_V2_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00038">cmd_connection.c:38</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7">PROF_V2_PUB_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00039">cmd_connection.c:39</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187">PROF_UNDEF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00036">cmd_connection.c:36</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222">PROF_V1_XAUTH_PSK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00044">cmd_connection.c:44</a></div></div>
<div class="ttc" id="group__auth__cfg_html_gga8ecd32976ad34d68d91d31c9a27392a1a86bcca92fbe70510dcca39e8dd05321d"><div class="ttname"><a href="../../d0/db5/group__auth__cfg.html#gga8ecd32976ad34d68d91d31c9a27392a1a86bcca92fbe70510dcca39e8dd05321d">AUTH_CLASS_PSK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d86/auth__cfg_8h_source.html#l00042">auth_cfg.h:42</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00046">debug.h:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a69a2225da93d04a822cb999d15797b13_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a69a2225da93d04a822cb999d15797b13_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4c16816868ca59c4ad8777749c9a09ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void add_ts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a traffic selector from string, add to list </p>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00447">447</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00046">DBG_CFG</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00147">linked_list_t::insert_last</a>, and <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00928">traffic_selector_create_from_cidr()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00476">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;{</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *ts;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    ts = <a class="code" href="../../d7/dff/group__traffic__selector.html#gac0fac1a12e3cf4220dd2787f4a766a52">traffic_selector_create_from_cidr</a>(<span class="keywordtype">string</span>, 0, 0, 65535);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (!ts)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a>, <span class="stringliteral">&quot;invalid traffic selector: %s&quot;</span>, <span class="keywordtype">string</span>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        exit(1);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    list-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a5150f69ff51c8d6d0ed680fad1120c02">insert_last</a>(list, ts);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;}</div>
<div class="ttc" id="group__traffic__selector_html_gac0fac1a12e3cf4220dd2787f4a766a52"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gac0fac1a12e3cf4220dd2787f4a766a52">traffic_selector_create_from_cidr</a></div><div class="ttdeci">traffic_selector_t * traffic_selector_create_from_cidr(char *string, u_int8_t protocol, u_int16_t from_port, u_int16_t to_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00928">traffic_selector.c:928</a></div></div>
<div class="ttc" id="structtraffic__selector__t_html"><div class="ttname"><a href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00072">traffic_selector.h:72</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="structlinked__list__t_html_a5150f69ff51c8d6d0ed680fad1120c02"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a5150f69ff51c8d6d0ed680fad1120c02">linked_list_t::insert_last</a></div><div class="ttdeci">void(* insert_last)(linked_list_t *this, void *item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00147">linked_list.h:147</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00046">debug.h:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a4c16816868ca59c4ad8777749c9a09ae_cgraph.svg" width="100%" height="575"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a4c16816868ca59c4ad8777749c9a09ae_icgraph.svg" width="200" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1f336f506c2809aaa13a8a7dc31b25ff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d8/dd6/structchild__cfg__t.html">child_cfg_t</a>* create_child_cfg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *&#160;</td>
          <td class="paramname"><em>peer_cfg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attach child config to peer config </p>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00331">331</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../da/d07/child__cfg_8h_source.html#l00040">ACTION_NONE</a>, <a class="el" href="../../d7/d2b/peer__cfg_8h_source.html#l00147">peer_cfg_t::add_child_cfg</a>, <a class="el" href="../../da/d07/child__cfg_8h_source.html#l00081">child_cfg_t::add_proposal</a>, <a class="el" href="../../da/d07/child__cfg_8h_source.html#l00115">child_cfg_t::add_traffic_selector</a>, <a class="el" href="../../d7/d2b/peer__cfg_8h_source.html#l00276">peer_cfg_t::add_virtual_ip</a>, <a class="el" href="../../d7/d1d/child__cfg_8c_source.html#l00561">child_cfg_create()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../da/d07/child__cfg_8h_source.html#l00281">child_cfg_t::get_ref</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00146">traffic_selector_t::get_type</a>, <a class="el" href="../../df/da9/host_8c_source.html#l00418">host_create_from_string()</a>, <a class="el" href="../../d4/dab/ipsec__types_8h_source.html#l00153">lifetime_cfg_t::life</a>, <a class="el" href="../../d4/dab/ipsec__types_8h_source.html#l00044">MODE_TUNNEL</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00650">proposal</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00794">proposal_create_default()</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00833">proposal_create_default_aead()</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00045">PROTO_ESP</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../db/d18/structlifetime__cfg__t.html#a58e75698e51a4d7a53fbb8a5f8a4131b">lifetime_cfg_t::time</a>, <a class="el" href="../../d3/d58/traffic__selector_8c_source.html#l00892">traffic_selector_create_from_string()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00044">TS_IPV4_ADDR_RANGE</a>, and <a class="el" href="../../d1/dfb/traffic__selector_8h_source.html#l00053">TS_IPV6_ADDR_RANGE</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00406">initiate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;{</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="../../d8/dd6/structchild__cfg__t.html">child_cfg_t</a> *child_cfg;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *ts;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">bool</span> has_v4 = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, has_v6 = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="../../db/d18/structlifetime__cfg__t.html">lifetime_cfg_t</a> lifetime = {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        .<a class="code" href="../../db/d18/structlifetime__cfg__t.html#a58e75698e51a4d7a53fbb8a5f8a4131b">time</a> = {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            .<a class="code" href="../../db/d18/structlifetime__cfg__t.html#ad64f70ea54037039986398c3673c665c">life</a> = 10800 <span class="comment">/* 3h */</span>,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            .rekey = 10200 <span class="comment">/* 2h50min */</span>,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            .jitter = 300 <span class="comment">/* 5min */</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    };</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    child_cfg = <a class="code" href="../../de/dc5/group__child__cfg.html#ga890fe7c007e4d598eb602ecd9c695d96">child_cfg_create</a>(<span class="stringliteral">&quot;cmd&quot;</span>, &amp;lifetime,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                 NULL, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../d3/d2d/group__ipsec__types.html#ggaece48cbb898dc0b6b592b3fb645b0eb0afcb6a6b9643f06c3a331ed7d6709560f">MODE_TUNNEL</a>, <span class="comment">/* updown, hostaccess */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                 <a class="code" href="../../de/dc5/group__child__cfg.html#ggaec2532b33d2d66f09e5b30ed3ded35ecabb516226f3df30c332c998da773f56db">ACTION_NONE</a>, <a class="code" href="../../de/dc5/group__child__cfg.html#ggaec2532b33d2d66f09e5b30ed3ded35ecabb516226f3df30c332c998da773f56db">ACTION_NONE</a>, <a class="code" href="../../de/dc5/group__child__cfg.html#ggaec2532b33d2d66f09e5b30ed3ded35ecabb516226f3df30c332c998da773f56db">ACTION_NONE</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                                 0, 0, NULL, NULL, 0);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (this-&gt;child_proposals-&gt;get_count(this-&gt;<a class="code" href="../../d2/d5b/structprivate__cmd__connection__t.html#a1954d41058b622f08f16be356cc70ac0">child_proposals</a>))</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">while</span> (this-&gt;child_proposals-&gt;remove_first(this-&gt;<a class="code" href="../../d2/d5b/structprivate__cmd__connection__t.html#a1954d41058b622f08f16be356cc70ac0">child_proposals</a>,</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                                (<span class="keywordtype">void</span>**)&amp;proposal) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            child_cfg-&gt;<a class="code" href="../../d8/dd6/structchild__cfg__t.html#aa91c99cc3ddf207cda82960d23a9aeb9">add_proposal</a>(child_cfg, proposal);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        child_cfg-&gt;<a class="code" href="../../d8/dd6/structchild__cfg__t.html#aa91c99cc3ddf207cda82960d23a9aeb9">add_proposal</a>(child_cfg, <a class="code" href="../../dd/d64/group__proposal.html#ga92ce9c8faeb31edb2410d7182bf22c86">proposal_create_default</a>(<a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a>));</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        child_cfg-&gt;<a class="code" href="../../d8/dd6/structchild__cfg__t.html#aa91c99cc3ddf207cda82960d23a9aeb9">add_proposal</a>(child_cfg,</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                <a class="code" href="../../dd/d64/group__proposal.html#ga1f322ca715b0c2bd794d031e64c6fc43">proposal_create_default_aead</a>(<a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a>));</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">while</span> (this-&gt;local_ts-&gt;remove_first(this-&gt;<a class="code" href="../../d2/d5b/structprivate__cmd__connection__t.html#a5e4c3a384d123d6cd1b72dac1a7d30de">local_ts</a>, (<span class="keywordtype">void</span>**)&amp;ts) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        child_cfg-&gt;<a class="code" href="../../d8/dd6/structchild__cfg__t.html#a36a95fb825bc3d5ea351455c292b0584">add_traffic_selector</a>(child_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, ts);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">if</span> (this-&gt;remote_ts-&gt;get_count(this-&gt;<a class="code" href="../../d2/d5b/structprivate__cmd__connection__t.html#aa284b76d5db5d9864483b25a85c59916">remote_ts</a>) == 0)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">/* add a 0.0.0.0/0 TS for remote side if none given */</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        ts = <a class="code" href="../../d7/dff/group__traffic__selector.html#gae04e03c03653d99fb1a0900507a16549">traffic_selector_create_from_string</a>(0, <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                    <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 0, <span class="stringliteral">&quot;255.255.255.255&quot;</span>, 65535);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        this-&gt;remote_ts-&gt;insert_last(this-&gt;remote_ts, ts);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        has_v4 = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">while</span> (this-&gt;remote_ts-&gt;remove_first(this-&gt;<a class="code" href="../../d2/d5b/structprivate__cmd__connection__t.html#aa284b76d5db5d9864483b25a85c59916">remote_ts</a>,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                         (<span class="keywordtype">void</span>**)&amp;ts) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">switch</span> (ts-&gt;<a class="code" href="../../d4/d0a/structtraffic__selector__t.html#ad593df2d11c953dcabd99f8ea7451edf">get_type</a>(ts))</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                has_v4 = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a>:</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                has_v6 = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        child_cfg-&gt;<a class="code" href="../../d8/dd6/structchild__cfg__t.html#a36a95fb825bc3d5ea351455c292b0584">add_traffic_selector</a>(child_cfg, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, ts);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (has_v4)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        peer_cfg-&gt;<a class="code" href="../../d9/d16/structpeer__cfg__t.html#a22513f3e1ca30cf49d043790fe775978">add_virtual_ip</a>(peer_cfg, <a class="code" href="../../d7/df1/group__host.html#gad1ee7d1c0d17eee7f6e204e22ea2c206">host_create_from_string</a>(<span class="stringliteral">&quot;0.0.0.0&quot;</span>, 0));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">if</span> (has_v6)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        peer_cfg-&gt;<a class="code" href="../../d9/d16/structpeer__cfg__t.html#a22513f3e1ca30cf49d043790fe775978">add_virtual_ip</a>(peer_cfg, <a class="code" href="../../d7/df1/group__host.html#gad1ee7d1c0d17eee7f6e204e22ea2c206">host_create_from_string</a>(<span class="stringliteral">&quot;::&quot;</span>, 0));</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    peer_cfg-&gt;<a class="code" href="../../d9/d16/structpeer__cfg__t.html#acff817dc6859090bb2e90e31e0a464d6">add_child_cfg</a>(peer_cfg, child_cfg-&gt;<a class="code" href="../../d8/dd6/structchild__cfg__t.html#a9a8bdef2037ac4a78658eb5723420994">get_ref</a>(child_cfg));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">return</span> child_cfg;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
<div class="ttc" id="structchild__cfg__t_html"><div class="ttname"><a href="../../d8/dd6/structchild__cfg__t.html">child_cfg_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d07/child__cfg_8h_source.html#l00063">child_cfg.h:63</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structproposal__t_html"><div class="ttname"><a href="../../df/d06/structproposal__t.html">proposal_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00062">proposal.h:62</a></div></div>
<div class="ttc" id="structpeer__cfg__t_html_a22513f3e1ca30cf49d043790fe775978"><div class="ttname"><a href="../../d9/d16/structpeer__cfg__t.html#a22513f3e1ca30cf49d043790fe775978">peer_cfg_t::add_virtual_ip</a></div><div class="ttdeci">void(* add_virtual_ip)(peer_cfg_t *this, host_t *vip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00276">peer_cfg.h:276</a></div></div>
<div class="ttc" id="group__child__cfg_html_ggaec2532b33d2d66f09e5b30ed3ded35ecabb516226f3df30c332c998da773f56db"><div class="ttname"><a href="../../de/dc5/group__child__cfg.html#ggaec2532b33d2d66f09e5b30ed3ded35ecabb516226f3df30c332c998da773f56db">ACTION_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d07/child__cfg_8h_source.html#l00040">child_cfg.h:40</a></div></div>
<div class="ttc" id="group__child__cfg_html_ga890fe7c007e4d598eb602ecd9c695d96"><div class="ttname"><a href="../../de/dc5/group__child__cfg.html#ga890fe7c007e4d598eb602ecd9c695d96">child_cfg_create</a></div><div class="ttdeci">child_cfg_t * child_cfg_create(char *name, lifetime_cfg_t *lifetime, char *updown, bool hostaccess, ipsec_mode_t mode, action_t start_action, action_t dpd_action, action_t close_action, bool ipcomp, u_int32_t inactivity, u_int32_t reqid, mark_t *mark_in, mark_t *mark_out, u_int32_t tfc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1d/child__cfg_8c_source.html#l00561">child_cfg.c:561</a></div></div>
<div class="ttc" id="structlifetime__cfg__t_html_ad64f70ea54037039986398c3673c665c"><div class="ttname"><a href="../../db/d18/structlifetime__cfg__t.html#ad64f70ea54037039986398c3673c665c">lifetime_cfg_t::life</a></div><div class="ttdeci">u_int64_t life</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dab/ipsec__types_8h_source.html#l00153">ipsec_types.h:153</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gae04e03c03653d99fb1a0900507a16549"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gae04e03c03653d99fb1a0900507a16549">traffic_selector_create_from_string</a></div><div class="ttdeci">traffic_selector_t * traffic_selector_create_from_string(u_int8_t protocol, ts_type_t type, char *from_addr, u_int16_t from_port, char *to_addr, u_int16_t to_port)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d58/traffic__selector_8c_source.html#l00892">traffic_selector.c:892</a></div></div>
<div class="ttc" id="structtraffic__selector__t_html_ad593df2d11c953dcabd99f8ea7451edf"><div class="ttname"><a href="../../d4/d0a/structtraffic__selector__t.html#ad593df2d11c953dcabd99f8ea7451edf">traffic_selector_t::get_type</a></div><div class="ttdeci">ts_type_t(* get_type)(traffic_selector_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00146">traffic_selector.h:146</a></div></div>
<div class="ttc" id="structprivate__cmd__connection__t_html_aa284b76d5db5d9864483b25a85c59916"><div class="ttname"><a href="../../d2/d5b/structprivate__cmd__connection__t.html#aa284b76d5db5d9864483b25a85c59916">private_cmd_connection_t::remote_ts</a></div><div class="ttdeci">linked_list_t * remote_ts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00087">cmd_connection.c:87</a></div></div>
<div class="ttc" id="structtraffic__selector__t_html"><div class="ttname"><a href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00072">traffic_selector.h:72</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structchild__cfg__t_html_a9a8bdef2037ac4a78658eb5723420994"><div class="ttname"><a href="../../d8/dd6/structchild__cfg__t.html#a9a8bdef2037ac4a78658eb5723420994">child_cfg_t::get_ref</a></div><div class="ttdeci">child_cfg_t *(* get_ref)(child_cfg_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d07/child__cfg_8h_source.html#l00281">child_cfg.h:281</a></div></div>
<div class="ttc" id="structchild__cfg__t_html_a36a95fb825bc3d5ea351455c292b0584"><div class="ttname"><a href="../../d8/dd6/structchild__cfg__t.html#a36a95fb825bc3d5ea351455c292b0584">child_cfg_t::add_traffic_selector</a></div><div class="ttdeci">void(* add_traffic_selector)(child_cfg_t *this, bool local, traffic_selector_t *ts)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d07/child__cfg_8h_source.html#l00115">child_cfg.h:115</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa69cf622e6c7d081c0f80d14ae1ca97ae">TS_IPV6_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00053">traffic_selector.h:53</a></div></div>
<div class="ttc" id="structchild__cfg__t_html_aa91c99cc3ddf207cda82960d23a9aeb9"><div class="ttname"><a href="../../d8/dd6/structchild__cfg__t.html#aa91c99cc3ddf207cda82960d23a9aeb9">child_cfg_t::add_proposal</a></div><div class="ttdeci">void(* add_proposal)(child_cfg_t *this, proposal_t *proposal)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d07/child__cfg_8h_source.html#l00081">child_cfg.h:81</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00045">proposal.h:45</a></div></div>
<div class="ttc" id="structpeer__cfg__t_html_acff817dc6859090bb2e90e31e0a464d6"><div class="ttname"><a href="../../d9/d16/structpeer__cfg__t.html#acff817dc6859090bb2e90e31e0a464d6">peer_cfg_t::add_child_cfg</a></div><div class="ttdeci">void(* add_child_cfg)(peer_cfg_t *this, child_cfg_t *child_cfg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00147">peer_cfg.h:147</a></div></div>
<div class="ttc" id="structlifetime__cfg__t_html"><div class="ttname"><a href="../../db/d18/structlifetime__cfg__t.html">lifetime_cfg_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dab/ipsec__types_8h_source.html#l00150">ipsec_types.h:150</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a5372eff556866bada29dd4643e028e02"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a></div><div class="ttdeci">struct sadb_prop * proposal</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00650">kernel_pfkey_ipsec.c:650</a></div></div>
<div class="ttc" id="structprivate__cmd__connection__t_html_a5e4c3a384d123d6cd1b72dac1a7d30de"><div class="ttname"><a href="../../d2/d5b/structprivate__cmd__connection__t.html#a5e4c3a384d123d6cd1b72dac1a7d30de">private_cmd_connection_t::local_ts</a></div><div class="ttdeci">linked_list_t * local_ts</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00082">cmd_connection.c:82</a></div></div>
<div class="ttc" id="group__traffic__selector_html_gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e"><div class="ttname"><a href="../../d7/dff/group__traffic__selector.html#gga626ba88163961e3f06a7032d939b5feaa78d83c341eb24e097dd6ba4a5811e11e">TS_IPV4_ADDR_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00044">traffic_selector.h:44</a></div></div>
<div class="ttc" id="group__host_html_gad1ee7d1c0d17eee7f6e204e22ea2c206"><div class="ttname"><a href="../../d7/df1/group__host.html#gad1ee7d1c0d17eee7f6e204e22ea2c206">host_create_from_string</a></div><div class="ttdeci">host_t * host_create_from_string(char *string, u_int16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/host_8c_source.html#l00418">host.c:418</a></div></div>
<div class="ttc" id="group__ipsec__types_html_ggaece48cbb898dc0b6b592b3fb645b0eb0afcb6a6b9643f06c3a331ed7d6709560f"><div class="ttname"><a href="../../d3/d2d/group__ipsec__types.html#ggaece48cbb898dc0b6b592b3fb645b0eb0afcb6a6b9643f06c3a331ed7d6709560f">MODE_TUNNEL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dab/ipsec__types_8h_source.html#l00044">ipsec_types.h:44</a></div></div>
<div class="ttc" id="structlifetime__cfg__t_html_a58e75698e51a4d7a53fbb8a5f8a4131b"><div class="ttname"><a href="../../db/d18/structlifetime__cfg__t.html#a58e75698e51a4d7a53fbb8a5f8a4131b">lifetime_cfg_t::time</a></div><div class="ttdeci">struct lifetime_cfg_t::@86 time</div></div>
<div class="ttc" id="group__proposal_html_ga92ce9c8faeb31edb2410d7182bf22c86"><div class="ttname"><a href="../../dd/d64/group__proposal.html#ga92ce9c8faeb31edb2410d7182bf22c86">proposal_create_default</a></div><div class="ttdeci">proposal_t * proposal_create_default(protocol_id_t protocol)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00794">proposal.c:794</a></div></div>
<div class="ttc" id="group__proposal_html_ga1f322ca715b0c2bd794d031e64c6fc43"><div class="ttname"><a href="../../dd/d64/group__proposal.html#ga1f322ca715b0c2bd794d031e64c6fc43">proposal_create_default_aead</a></div><div class="ttdeci">proposal_t * proposal_create_default_aead(protocol_id_t protocol)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00833">proposal.c:833</a></div></div>
<div class="ttc" id="structprivate__cmd__connection__t_html_a1954d41058b622f08f16be356cc70ac0"><div class="ttname"><a href="../../d2/d5b/structprivate__cmd__connection__t.html#a1954d41058b622f08f16be356cc70ac0">private_cmd_connection_t::child_proposals</a></div><div class="ttdeci">linked_list_t * child_proposals</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00097">cmd_connection.c:97</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a1f336f506c2809aaa13a8a7dc31b25ff_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a1f336f506c2809aaa13a8a7dc31b25ff_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad383141d47fae75523014ef65e04c018"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a>* create_peer_cfg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create peer config with associated ike config </p>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00141">141</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00156">ike_cfg_t::add_proposal</a>, <a class="el" href="../../d7/d2b/peer__cfg_8h_source.html#l00052">CERT_SEND_IF_ASKED</a>, <a class="el" href="../../dc/d21/daemon_8c_source.html#l00089">charon</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00054">FRAGMENTATION_NO</a>, <a class="el" href="../../d9/d68/socket__manager_8h_source.html#l00061">socket_manager_t::get_port</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">host</a>, <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00042">IKE_ANY</a>, <a class="el" href="../../d4/d7b/ike__cfg_8c_source.html#l00563">ike_cfg_create()</a>, <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00044">IKEV1</a>, <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00046">IKEV2</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00190">IKEV2_NATT_PORT</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00185">IKEV2_UDP_PORT</a>, <a class="el" href="../../d9/db5/peer__cfg_8c_source.html#l00649">peer_cfg_create()</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00036">PROF_UNDEF</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00046">PROF_V1_HYBRID</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00047">PROF_V1_HYBRID_AM</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00040">PROF_V1_PUB</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00041">PROF_V1_PUB_AM</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00042">PROF_V1_XAUTH</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00043">PROF_V1_XAUTH_AM</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00044">PROF_V1_XAUTH_PSK</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00045">PROF_V1_XAUTH_PSK_AM</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00038">PROF_V2_EAP</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00037">PROF_V2_PUB</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00039">PROF_V2_PUB_EAP</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00650">proposal</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00794">proposal_create_default()</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00833">proposal_create_default_aead()</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00043">PROTO_IKE</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00215">daemon_t::socket</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../d7/d2b/peer__cfg_8h_source.html#l00071">UNIQUE_REPLACE</a>, and <a class="el" href="../../de/d09/eap__sim__peer_8c_source.html#l00106">version</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00406">initiate()</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../d6/d8d/structike__cfg__t.html">ike_cfg_t</a> *ike_cfg;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *peer_cfg;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    u_int16_t local_port, remote_port = <a class="code" href="../../d0/db7/group__libcharon.html#ga2d25bf72f679d0f56c02c865d88914b7">IKEV2_UDP_PORT</a>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../dd/d6e/group__ike__cfg.html#gaf1772828c8c0e7d70e61a65f8b7653f2">ike_version_t</a> <a class="code" href="../../de/d09/eap__sim__peer_8c.html#ae000f2bae31d37c237cb739f6d4d4eca">version</a> = <a class="code" href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2a703ad82cee60b33c35dee8299a7b283c">IKE_ANY</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">bool</span> aggressive = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">switch</span> (this-&gt;profile)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187">PROF_UNDEF</a>:</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a>:</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28">PROF_V2_EAP</a>:</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7">PROF_V2_PUB_EAP</a>:</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            version = <a class="code" href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2af0034beba4c2c8c527db1d522ff085e5">IKEV2</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee">PROF_V1_PUB_AM</a>:</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2">PROF_V1_XAUTH_AM</a>:</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced">PROF_V1_XAUTH_PSK_AM</a>:</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a>:</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            aggressive = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="comment">/* FALL */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409">PROF_V1_PUB</a>:</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78">PROF_V1_XAUTH</a>:</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222">PROF_V1_XAUTH_PSK</a>:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe">PROF_V1_HYBRID</a>:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            version = <a class="code" href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    local_port = <a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#af7f0c8e86115893a3f26652a6c85e928">socket</a>-&gt;<a class="code" href="../../d2/de4/structsocket__manager__t.html#a44c3d906436e7e08f2b550171527e854">get_port</a>(<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#af7f0c8e86115893a3f26652a6c85e928">socket</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (local_port != <a class="code" href="../../d0/db7/group__libcharon.html#ga2d25bf72f679d0f56c02c865d88914b7">IKEV2_UDP_PORT</a>)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        remote_port = <a class="code" href="../../d0/db7/group__libcharon.html#gac9b61e9b50e852a351a91201ab52eb0e">IKEV2_NATT_PORT</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    ike_cfg = <a class="code" href="../../dd/d6e/group__ike__cfg.html#gaee966bb5aa578e493a2ab9093ba7daa1">ike_cfg_create</a>(version, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <span class="stringliteral">&quot;0.0.0.0&quot;</span>, local_port,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>, remote_port, <a class="code" href="../../dd/d6e/group__ike__cfg.html#ga81352eac303d5d07a1f139da90ccceebaa55ab62b1792225587b3048a500af9f2">FRAGMENTATION_NO</a>, 0);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (this-&gt;ike_proposals-&gt;get_count(this-&gt;<a class="code" href="../../d2/d5b/structprivate__cmd__connection__t.html#a820539a895e7dcbf3935fefe12266b86">ike_proposals</a>))</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">while</span> (this-&gt;ike_proposals-&gt;remove_first(this-&gt;<a class="code" href="../../d2/d5b/structprivate__cmd__connection__t.html#a820539a895e7dcbf3935fefe12266b86">ike_proposals</a>,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                                 (<span class="keywordtype">void</span>**)&amp;proposal) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            ike_cfg-&gt;<a class="code" href="../../d6/d8d/structike__cfg__t.html#aecada4d6f3a61fb63b4406a15371f198">add_proposal</a>(ike_cfg, proposal);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        ike_cfg-&gt;<a class="code" href="../../d6/d8d/structike__cfg__t.html#aecada4d6f3a61fb63b4406a15371f198">add_proposal</a>(ike_cfg, <a class="code" href="../../dd/d64/group__proposal.html#ga92ce9c8faeb31edb2410d7182bf22c86">proposal_create_default</a>(<a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a>));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        ike_cfg-&gt;<a class="code" href="../../d6/d8d/structike__cfg__t.html#aecada4d6f3a61fb63b4406a15371f198">add_proposal</a>(ike_cfg, <a class="code" href="../../dd/d64/group__proposal.html#ga1f322ca715b0c2bd794d031e64c6fc43">proposal_create_default_aead</a>(<a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a>));</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    peer_cfg = <a class="code" href="../../db/d07/group__peer__cfg.html#ga6c9fa5c7aa3d701f979c28d6766e7742">peer_cfg_create</a>(<span class="stringliteral">&quot;cmd&quot;</span>, ike_cfg,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    <a class="code" href="../../db/d07/group__peer__cfg.html#ggabddffecc0df0e11e4dd5c51b73853f1dadb2c93cb7b18b1c03eb6bdbb3525778f">CERT_SEND_IF_ASKED</a>, <a class="code" href="../../db/d07/group__peer__cfg.html#ggaa6f5d997fe087adb1580d42eeea33cbca040b9ae5a545f2f8a529751dda2cbc79">UNIQUE_REPLACE</a>, 1, <span class="comment">/* keyingtries */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    36000, 0, <span class="comment">/* rekey 10h, reauth none */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    600, 600, <span class="comment">/* jitter, over 10min */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, aggressive, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="comment">/* mobike, aggressive, pull */</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    30, 0, <span class="comment">/* DPD delay, timeout */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, NULL, NULL); <span class="comment">/* mediation */</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> peer_cfg;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
<div class="ttc" id="test__traffic__selector_8c_html_a1c2046dcb30a629d6d9f45ff8f403f12"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">test_traffic_selector.c:403</a></div></div>
<div class="ttc" id="structprivate__cmd__connection__t_html_a820539a895e7dcbf3935fefe12266b86"><div class="ttname"><a href="../../d2/d5b/structprivate__cmd__connection__t.html#a820539a895e7dcbf3935fefe12266b86">private_cmd_connection_t::ike_proposals</a></div><div class="ttdeci">linked_list_t * ike_proposals</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00092">cmd_connection.c:92</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00047">cmd_connection.c:47</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structproposal__t_html"><div class="ttname"><a href="../../df/d06/structproposal__t.html">proposal_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00062">proposal.h:62</a></div></div>
<div class="ttc" id="group__ike__cfg_html_ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00044">ike_cfg.h:44</a></div></div>
<div class="ttc" id="eap__sim__peer_8c_html_ae000f2bae31d37c237cb739f6d4d4eca"><div class="ttname"><a href="../../de/d09/eap__sim__peer_8c.html#ae000f2bae31d37c237cb739f6d4d4eca">version</a></div><div class="ttdeci">static chunk_t version</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d09/eap__sim__peer_8c_source.html#l00106">eap_sim_peer.c:106</a></div></div>
<div class="ttc" id="group__ike__cfg_html_ggaf1772828c8c0e7d70e61a65f8b7653f2a703ad82cee60b33c35dee8299a7b283c"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2a703ad82cee60b33c35dee8299a7b283c">IKE_ANY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00042">ike_cfg.h:42</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6e5a57d6aee36cd9d4981ff0fa99c409">PROF_V1_PUB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00040">cmd_connection.c:40</a></div></div>
<div class="ttc" id="group__libcharon_html_gac9b61e9b50e852a351a91201ab52eb0e"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#gac9b61e9b50e852a351a91201ab52eb0e">IKEV2_NATT_PORT</a></div><div class="ttdeci">#define IKEV2_NATT_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00190">daemon.h:190</a></div></div>
<div class="ttc" id="group__ike__cfg_html_ga81352eac303d5d07a1f139da90ccceebaa55ab62b1792225587b3048a500af9f2"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#ga81352eac303d5d07a1f139da90ccceebaa55ab62b1792225587b3048a500af9f2">FRAGMENTATION_NO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00054">ike_cfg.h:54</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba02fa2262f5d03c93ce4a29510af04b78">PROF_V1_XAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00042">cmd_connection.c:42</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00037">cmd_connection.c:37</a></div></div>
<div class="ttc" id="group__libcharon_html_ga3f85ddc91855d7d74beeb2f21fb74dbb"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a></div><div class="ttdeci">daemon_t * charon</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00089">daemon.c:89</a></div></div>
<div class="ttc" id="structdaemon__t_html_af7f0c8e86115893a3f26652a6c85e928"><div class="ttname"><a href="../../d0/def/structdaemon__t.html#af7f0c8e86115893a3f26652a6c85e928">daemon_t::socket</a></div><div class="ttdeci">socket_manager_t * socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00215">daemon.h:215</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba1c6535948c6f68334dd7c7d18a04bced">PROF_V1_XAUTH_PSK_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00045">cmd_connection.c:45</a></div></div>
<div class="ttc" id="group__ike__cfg_html_ggaf1772828c8c0e7d70e61a65f8b7653f2af0034beba4c2c8c527db1d522ff085e5"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2af0034beba4c2c8c527db1d522ff085e5">IKEV2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00046">ike_cfg.h:46</a></div></div>
<div class="ttc" id="group__ike__cfg_html_gaee966bb5aa578e493a2ab9093ba7daa1"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#gaee966bb5aa578e493a2ab9093ba7daa1">ike_cfg_create</a></div><div class="ttdeci">ike_cfg_t * ike_cfg_create(ike_version_t version, bool certreq, bool force_encap, char *me, u_int16_t my_port, char *other, u_int16_t other_port, fragmentation_t fragmentation, u_int8_t dscp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d7b/ike__cfg_8c_source.html#l00563">ike_cfg.c:563</a></div></div>
<div class="ttc" id="group__peer__cfg_html_ggaa6f5d997fe087adb1580d42eeea33cbca040b9ae5a545f2f8a529751dda2cbc79"><div class="ttname"><a href="../../db/d07/group__peer__cfg.html#ggaa6f5d997fe087adb1580d42eeea33cbca040b9ae5a545f2f8a529751dda2cbc79">UNIQUE_REPLACE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00071">peer_cfg.h:71</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba8a0e5cad8e97599f97568c4dc0746aee">PROF_V1_PUB_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00041">cmd_connection.c:41</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__peer__cfg_html_ggabddffecc0df0e11e4dd5c51b73853f1dadb2c93cb7b18b1c03eb6bdbb3525778f"><div class="ttname"><a href="../../db/d07/group__peer__cfg.html#ggabddffecc0df0e11e4dd5c51b73853f1dadb2c93cb7b18b1c03eb6bdbb3525778f">CERT_SEND_IF_ASKED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00052">peer_cfg.h:52</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9c20f795a9d88f81daa3844d049076fe">PROF_V1_HYBRID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00046">cmd_connection.c:46</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba6c3fbb49b530d5f42a45364ca1ae13f2">PROF_V1_XAUTH_AM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00043">cmd_connection.c:43</a></div></div>
<div class="ttc" id="structike__cfg__t_html_aecada4d6f3a61fb63b4406a15371f198"><div class="ttname"><a href="../../d6/d8d/structike__cfg__t.html#aecada4d6f3a61fb63b4406a15371f198">ike_cfg_t::add_proposal</a></div><div class="ttdeci">void(* add_proposal)(ike_cfg_t *this, proposal_t *proposal)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00156">ike_cfg.h:156</a></div></div>
<div class="ttc" id="group__ike__cfg_html_gaf1772828c8c0e7d70e61a65f8b7653f2"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#gaf1772828c8c0e7d70e61a65f8b7653f2">ike_version_t</a></div><div class="ttdeci">ike_version_t</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00040">ike_cfg.h:40</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a5372eff556866bada29dd4643e028e02"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a></div><div class="ttdeci">struct sadb_prop * proposal</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00650">kernel_pfkey_ipsec.c:650</a></div></div>
<div class="ttc" id="structike__cfg__t_html"><div class="ttname"><a href="../../d6/d8d/structike__cfg__t.html">ike_cfg_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00071">ike_cfg.h:71</a></div></div>
<div class="ttc" id="structsocket__manager__t_html_a44c3d906436e7e08f2b550171527e854"><div class="ttname"><a href="../../d2/de4/structsocket__manager__t.html#a44c3d906436e7e08f2b550171527e854">socket_manager_t::get_port</a></div><div class="ttdeci">u_int16_t(* get_port)(socket_manager_t *this, bool nat_t)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d68/socket__manager_8h_source.html#l00061">socket_manager.h:61</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73baec314e5f1d8b61dd1128badc0e27ee28">PROF_V2_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00038">cmd_connection.c:38</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba13081bb05eec2d9ad01550fa1a7ba6c7">PROF_V2_PUB_EAP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00039">cmd_connection.c:39</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba48c8788d0afb142a0218b4fff30d8187">PROF_UNDEF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00036">cmd_connection.c:36</a></div></div>
<div class="ttc" id="group__libcharon_html_ga2d25bf72f679d0f56c02c865d88914b7"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga2d25bf72f679d0f56c02c865d88914b7">IKEV2_UDP_PORT</a></div><div class="ttdeci">#define IKEV2_UDP_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00185">daemon.h:185</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00043">proposal.h:43</a></div></div>
<div class="ttc" id="group__proposal_html_ga92ce9c8faeb31edb2410d7182bf22c86"><div class="ttname"><a href="../../dd/d64/group__proposal.html#ga92ce9c8faeb31edb2410d7182bf22c86">proposal_create_default</a></div><div class="ttdeci">proposal_t * proposal_create_default(protocol_id_t protocol)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00794">proposal.c:794</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba7a1c524428e77d58a1cca9db527f2222">PROF_V1_XAUTH_PSK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00044">cmd_connection.c:44</a></div></div>
<div class="ttc" id="group__peer__cfg_html_ga6c9fa5c7aa3d701f979c28d6766e7742"><div class="ttname"><a href="../../db/d07/group__peer__cfg.html#ga6c9fa5c7aa3d701f979c28d6766e7742">peer_cfg_create</a></div><div class="ttdeci">peer_cfg_t * peer_cfg_create(char *name, ike_cfg_t *ike_cfg, cert_policy_t cert_policy, unique_policy_t unique, u_int32_t keyingtries, u_int32_t rekey_time, u_int32_t reauth_time, u_int32_t jitter_time, u_int32_t over_time, bool mobike, bool aggressive, bool pull_mode, u_int32_t dpd, u_int32_t dpd_timeout, bool mediation, peer_cfg_t *mediated_by, identification_t *peer_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db5/peer__cfg_8c_source.html#l00649">peer_cfg.c:649</a></div></div>
<div class="ttc" id="group__proposal_html_ga1f322ca715b0c2bd794d031e64c6fc43"><div class="ttname"><a href="../../dd/d64/group__proposal.html#ga1f322ca715b0c2bd794d031e64c6fc43">proposal_create_default_aead</a></div><div class="ttdeci">proposal_t * proposal_create_default_aead(protocol_id_t protocol)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00833">proposal.c:833</a></div></div>
<div class="ttc" id="structpeer__cfg__t_html"><div class="ttname"><a href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00117">peer_cfg.h:117</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_ad383141d47fae75523014ef65e04c018_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_ad383141d47fae75523014ef65e04c018_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="adad96d1734cd9d987f2ecd3999bca0f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENUM </td>
          <td>(</td>
          <td class="paramtype">profile_names&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73ba9875dcd76dade61e00db38db03effdde">PROF_V2_PUB</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73bae4fcae6c829f521ca618e4357b3aadda">PROF_V1_HYBRID_AM</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev2-<a class="el" href="../../d8/db6/pub_8c.html#a251303441b8fd13c8fe80aab8c4a6ecd">pub</a>&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev2-eap&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev2-<a class="el" href="../../d8/db6/pub_8c.html#a251303441b8fd13c8fe80aab8c4a6ecd">pub</a>-eap&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev1-<a class="el" href="../../d8/db6/pub_8c.html#a251303441b8fd13c8fe80aab8c4a6ecd">pub</a>&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev1-<a class="el" href="../../d8/db6/pub_8c.html#a251303441b8fd13c8fe80aab8c4a6ecd">pub</a>-am&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev1-xauth&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev1-xauth-am&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev1-xauth-psk&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev1-xauth-psk-am&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev1-hybrid&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;ikev1-hybrid-am&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1ef10a08acb2689e03be939316fb0a76"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d63/structjob__requeue__t.html">job_requeue_t</a> initiate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initiate the configured connection </p>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00406">406</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00253">add_auth_cfgs()</a>, <a class="el" href="../../dc/d21/daemon_8c_source.html#l00089">charon</a>, <a class="el" href="../../d0/d51/daemon_8h_source.html#l00265">daemon_t::controller</a>, <a class="el" href="../../d1/d75/controller_8c_source.html#l00686">controller_cb_empty()</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00331">create_child_cfg()</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00141">create_peer_cfg()</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00046">DBG_CFG</a>, <a class="el" href="../../d7/d2b/peer__cfg_8h_source.html#l00352">peer_cfg_t::destroy</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">host</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00047">identity</a>, <a class="el" href="../../d2/dd9/controller_8h_source.html#l00093">controller_t::initiate</a>, <a class="el" href="../../d3/d6a/job_8h_source.html#l00108">JOB_REQUEUE_NONE</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, and <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00133">terminate()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d65/task__manager__v1_8c_source.html#l00710">build_response()</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00557">cmd_connection_create()</a>, <a class="el" href="../../d9/d93/stroke_8c_source.html#l00182">del_connection()</a>, <a class="el" href="../../d9/d93/stroke_8c_source.html#l00191">initiate_connection()</a>, <a class="el" href="../../d8/dcf/vici__control_8c_source.html#l00479">manage_commands()</a>, <a class="el" href="../../dc/dcd/eap__dynamic_8c_source.html#l00170">METHOD()</a>, <a class="el" href="../../df/d1c/eap__sim__server_8c_source.html#l00215">process_reauthentication()</a>, <a class="el" href="../../dd/d65/task__manager__v1_8c_source.html#l00962">process_request()</a>, <a class="el" href="../../dd/d65/task__manager__v1_8c_source.html#l01127">process_response()</a>, <a class="el" href="../../df/d1c/eap__sim__server_8c_source.html#l00276">process_start()</a>, <a class="el" href="../../d1/de8/starterstroke_8c_source.html#l00310">starter_stroke_initiate_conn()</a>, and <a class="el" href="../../d9/d93/stroke_8c_source.html#l00200">terminate_connection()</a>.</p>
<div class="fragment"><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;{</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a> *peer_cfg;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="../../d8/dd6/structchild__cfg__t.html">child_cfg_t</a> *child_cfg;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    pid_t pid = this-&gt;pid;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a>, <span class="stringliteral">&quot;unable to initiate, missing --host option&quot;</span>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7673aa078775c7307b184332c8d97086">terminate</a>(pid);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a09930e473fa6e5d72934fa8e0525f09e">identity</a>)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a>, <span class="stringliteral">&quot;unable to initiate, missing --identity option&quot;</span>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7673aa078775c7307b184332c8d97086">terminate</a>(pid);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    peer_cfg = <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ad383141d47fae75523014ef65e04c018">create_peer_cfg</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d9c/cmd__connection_8c.html#a69a2225da93d04a822cb999d15797b13">add_auth_cfgs</a>(<span class="keyword">this</span>, peer_cfg))</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        peer_cfg-&gt;<a class="code" href="../../d9/d16/structpeer__cfg__t.html#a81470fce40475d12dcf74dc49f44e972">destroy</a>(peer_cfg);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7673aa078775c7307b184332c8d97086">terminate</a>(pid);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    child_cfg = <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a1f336f506c2809aaa13a8a7dc31b25ff">create_child_cfg</a>(<span class="keyword">this</span>, peer_cfg);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#ab3050ecc050b4f24d2b63cf1369690a5">controller</a>-&gt;<a class="code" href="../../d4/d06/structcontroller__t.html#ac2e579fe8cc6ce4d744ffbd2ce36dc1c">initiate</a>(<a class="code" href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a>-&gt;<a class="code" href="../../d0/def/structdaemon__t.html#ab3050ecc050b4f24d2b63cf1369690a5">controller</a>, peer_cfg, child_cfg,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                <a class="code" href="../../d6/d29/group__controller__i.html#ga398ce0ca01023bf1e6d115ff666f1509">controller_cb_empty</a>, NULL, 0, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a7673aa078775c7307b184332c8d97086">terminate</a>(pid);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div>
<div class="ttc" id="cmd__connection_8c_html_a1f336f506c2809aaa13a8a7dc31b25ff"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#a1f336f506c2809aaa13a8a7dc31b25ff">create_child_cfg</a></div><div class="ttdeci">static child_cfg_t * create_child_cfg(private_cmd_connection_t *this, peer_cfg_t *peer_cfg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00331">cmd_connection.c:331</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a1c2046dcb30a629d6d9f45ff8f403f12"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">test_traffic_selector.c:403</a></div></div>
<div class="ttc" id="structchild__cfg__t_html"><div class="ttname"><a href="../../d8/dd6/structchild__cfg__t.html">child_cfg_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d07/child__cfg_8h_source.html#l00063">child_cfg.h:63</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structpeer__cfg__t_html_a81470fce40475d12dcf74dc49f44e972"><div class="ttname"><a href="../../d9/d16/structpeer__cfg__t.html#a81470fce40475d12dcf74dc49f44e972">peer_cfg_t::destroy</a></div><div class="ttdeci">void(* destroy)(peer_cfg_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00352">peer_cfg.h:352</a></div></div>
<div class="ttc" id="group__job_html_ga7a4d84fe5043983e82b3e0bbf80218e9"><div class="ttname"><a href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a></div><div class="ttdeci">#define JOB_REQUEUE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6a/job_8h_source.html#l00108">job.h:108</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a09930e473fa6e5d72934fa8e0525f09e"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a09930e473fa6e5d72934fa8e0525f09e">identity</a></div><div class="ttdeci">char identity[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00047">duplicheck_msg.h:47</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ad383141d47fae75523014ef65e04c018"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ad383141d47fae75523014ef65e04c018">create_peer_cfg</a></div><div class="ttdeci">static peer_cfg_t * create_peer_cfg(private_cmd_connection_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00141">cmd_connection.c:141</a></div></div>
<div class="ttc" id="structdaemon__t_html_ab3050ecc050b4f24d2b63cf1369690a5"><div class="ttname"><a href="../../d0/def/structdaemon__t.html#ab3050ecc050b4f24d2b63cf1369690a5">daemon_t::controller</a></div><div class="ttdeci">controller_t * controller</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/daemon_8h_source.html#l00265">daemon.h:265</a></div></div>
<div class="ttc" id="group__libcharon_html_ga3f85ddc91855d7d74beeb2f21fb74dbb"><div class="ttname"><a href="../../d0/db7/group__libcharon.html#ga3f85ddc91855d7d74beeb2f21fb74dbb">charon</a></div><div class="ttdeci">daemon_t * charon</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00089">daemon.c:89</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_a7673aa078775c7307b184332c8d97086"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#a7673aa078775c7307b184332c8d97086">terminate</a></div><div class="ttdeci">static void terminate(pid_t pid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00133">cmd_connection.c:133</a></div></div>
<div class="ttc" id="group__controller__i_html_ga398ce0ca01023bf1e6d115ff666f1509"><div class="ttname"><a href="../../d6/d29/group__controller__i.html#ga398ce0ca01023bf1e6d115ff666f1509">controller_cb_empty</a></div><div class="ttdeci">bool controller_cb_empty(void *param, debug_t group, level_t level, ike_sa_t *ike_sa, const char *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d75/controller_8c_source.html#l00686">controller.c:686</a></div></div>
<div class="ttc" id="structcontroller__t_html_ac2e579fe8cc6ce4d744ffbd2ce36dc1c"><div class="ttname"><a href="../../d4/d06/structcontroller__t.html#ac2e579fe8cc6ce4d744ffbd2ce36dc1c">controller_t::initiate</a></div><div class="ttdeci">status_t(* initiate)(controller_t *this, peer_cfg_t *peer_cfg, child_cfg_t *child_cfg, controller_cb_t callback, void *param, u_int timeout, bool limits)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd9/controller_8h_source.html#l00093">controller.h:93</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_a69a2225da93d04a822cb999d15797b13"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#a69a2225da93d04a822cb999d15797b13">add_auth_cfgs</a></div><div class="ttdeci">static bool add_auth_cfgs(private_cmd_connection_t *this, peer_cfg_t *peer_cfg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00253">cmd_connection.c:253</a></div></div>
<div class="ttc" id="structpeer__cfg__t_html"><div class="ttname"><a href="../../d9/d16/structpeer__cfg__t.html">peer_cfg_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d2b/peer__cfg_8h_source.html#l00117">peer_cfg.h:117</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00046">debug.h:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a1ef10a08acb2689e03be939316fb0a76_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a1ef10a08acb2689e03be939316fb0a76_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7edf100f0c26164ae45b03d4c8b288f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d1e/structcmd__connection__t.html">cmd_connection_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d3e/pt__tls__dispatcher_8c.html#ad0237515f79d0401d25882116f10c2a2">handle</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/db0/group__cmd__option.html#ga25da2eda5d74124b8e7f7988a1bfb1e8">cmd_option_type_t</a>&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00476">476</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00447">add_ts()</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00045">CMD_OPT_AGENT</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00049">CMD_OPT_AH_PROPOSAL</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00039">CMD_OPT_EAP_IDENTITY</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00050">CMD_OPT_ESP_PROPOSAL</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00037">CMD_OPT_HOST</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00038">CMD_OPT_IDENTITY</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00048">CMD_OPT_IKE_PROPOSAL</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00046">CMD_OPT_LOCAL_TS</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00044">CMD_OPT_PKCS12</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00051">CMD_OPT_PROFILE</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00041">CMD_OPT_REMOTE_IDENTITY</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00047">CMD_OPT_REMOTE_TS</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00043">CMD_OPT_RSA</a>, <a class="el" href="../../db/da4/cmd__options_8h_source.html#l00040">CMD_OPT_XAUTH_USER</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">host</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00047">identity</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00650">proposal</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00860">proposal_create_from_string()</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00044">PROTO_AH</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00045">PROTO_ESP</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00043">PROTO_IKE</a>, <a class="el" href="../../d9/d8a/sasl__mechanism_8c_source.html#l00025">server</a>, <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00464">set_profile()</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;{</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">switch</span> (opt)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a9e721a93778d2c3367e1ef2420790088">CMD_OPT_HOST</a>:</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            this-&gt;<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a> = arg;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a02d22b6a5f958c987d42efd678a0d93e">CMD_OPT_REMOTE_IDENTITY</a>:</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            this-&gt;<a class="code" href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a> = arg;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8ab059dd008b1be734ac2b986f76a29069">CMD_OPT_IDENTITY</a>:</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            this-&gt;<a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a09930e473fa6e5d72934fa8e0525f09e">identity</a> = arg;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8acccb94470b2e4f716fccae57558b64fc">CMD_OPT_EAP_IDENTITY</a>:</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a74ef269c4bc6dc1cdd3a1278704538db">CMD_OPT_XAUTH_USER</a>:</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            this-&gt;xautheap = arg;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a81979815a986787a5a7374a7f3283dd4">CMD_OPT_RSA</a>:</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a594903fd2e4ca077f57da863d43a1d3d">CMD_OPT_AGENT</a>:</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a478e5bd8cd5db5cfa2ad439dae9407e8">CMD_OPT_PKCS12</a>:</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            this-&gt;key_seen = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8af6cb8a1b7623fbf6861b3a5e01c154e0">CMD_OPT_LOCAL_TS</a>:</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a4c16816868ca59c4ad8777749c9a09ae">add_ts</a>(<span class="keyword">this</span>, this-&gt;local_ts, arg);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8aa97e15c2d8558d309b5f4c0a25b1b379">CMD_OPT_REMOTE_TS</a>:</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a4c16816868ca59c4ad8777749c9a09ae">add_ts</a>(<span class="keyword">this</span>, this-&gt;remote_ts, arg);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a453f3d4ac56d5f3b6ceeda4d4baa59d7">CMD_OPT_IKE_PROPOSAL</a>:</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            proposal = <a class="code" href="../../dd/d64/group__proposal.html#gaac9f868bffd2fe8b15b3de8f89f24b41">proposal_create_from_string</a>(<a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a>, arg);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">if</span> (!proposal)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                exit(1);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            this-&gt;ike_proposals-&gt;insert_last(this-&gt;ike_proposals, proposal);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8ae966d760cb3a81d9ae41c53d0faca08b">CMD_OPT_ESP_PROPOSAL</a>:</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            proposal = <a class="code" href="../../dd/d64/group__proposal.html#gaac9f868bffd2fe8b15b3de8f89f24b41">proposal_create_from_string</a>(<a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a>, arg);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">if</span> (!proposal)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                exit(1);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            this-&gt;child_proposals-&gt;insert_last(this-&gt;child_proposals, proposal);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a6db37c24f843fb753fc4b3b2c641b08a">CMD_OPT_AH_PROPOSAL</a>:</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            proposal = <a class="code" href="../../dd/d64/group__proposal.html#gaac9f868bffd2fe8b15b3de8f89f24b41">proposal_create_from_string</a>(<a class="code" href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f">PROTO_AH</a>, arg);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordflow">if</span> (!proposal)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                exit(1);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            this-&gt;child_proposals-&gt;insert_last(this-&gt;child_proposals, proposal);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a1cb89d195e5046fcd9c83ce468fc340c">CMD_OPT_PROFILE</a>:</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <a class="code" href="../../d7/d9c/cmd__connection_8c.html#a137d617d75d6918da14eed0010cb05e6">set_profile</a>(<span class="keyword">this</span>, arg);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div>
<div class="ttc" id="test__traffic__selector_8c_html_a1c2046dcb30a629d6d9f45ff8f403f12"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">test_traffic_selector.c:403</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a9e721a93778d2c3367e1ef2420790088"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a9e721a93778d2c3367e1ef2420790088">CMD_OPT_HOST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00037">cmd_options.h:37</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structproposal__t_html"><div class="ttname"><a href="../../df/d06/structproposal__t.html">proposal_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00062">proposal.h:62</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8ab059dd008b1be734ac2b986f76a29069"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8ab059dd008b1be734ac2b986f76a29069">CMD_OPT_IDENTITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00038">cmd_options.h:38</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a74ef269c4bc6dc1cdd3a1278704538db"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a74ef269c4bc6dc1cdd3a1278704538db">CMD_OPT_XAUTH_USER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00040">cmd_options.h:40</a></div></div>
<div class="ttc" id="group__proposal_html_gaac9f868bffd2fe8b15b3de8f89f24b41"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gaac9f868bffd2fe8b15b3de8f89f24b41">proposal_create_from_string</a></div><div class="ttdeci">proposal_t * proposal_create_from_string(protocol_id_t protocol, const char *algs)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00860">proposal.c:860</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a09930e473fa6e5d72934fa8e0525f09e"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a09930e473fa6e5d72934fa8e0525f09e">identity</a></div><div class="ttdeci">char identity[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00047">duplicheck_msg.h:47</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8af6cb8a1b7623fbf6861b3a5e01c154e0"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8af6cb8a1b7623fbf6861b3a5e01c154e0">CMD_OPT_LOCAL_TS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00046">cmd_options.h:46</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a478e5bd8cd5db5cfa2ad439dae9407e8"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a478e5bd8cd5db5cfa2ad439dae9407e8">CMD_OPT_PKCS12</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00044">cmd_options.h:44</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a02d22b6a5f958c987d42efd678a0d93e"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a02d22b6a5f958c987d42efd678a0d93e">CMD_OPT_REMOTE_IDENTITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00041">cmd_options.h:41</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8aa97e15c2d8558d309b5f4c0a25b1b379"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8aa97e15c2d8558d309b5f4c0a25b1b379">CMD_OPT_REMOTE_TS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00047">cmd_options.h:47</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_a137d617d75d6918da14eed0010cb05e6"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#a137d617d75d6918da14eed0010cb05e6">set_profile</a></div><div class="ttdeci">static void set_profile(private_cmd_connection_t *this, char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00464">cmd_connection.c:464</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8acccb94470b2e4f716fccae57558b64fc"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8acccb94470b2e4f716fccae57558b64fc">CMD_OPT_EAP_IDENTITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00039">cmd_options.h:39</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_a4c16816868ca59c4ad8777749c9a09ae"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#a4c16816868ca59c4ad8777749c9a09ae">add_ts</a></div><div class="ttdeci">static void add_ts(private_cmd_connection_t *this, linked_list_t *list, char *string)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00447">cmd_connection.c:447</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a6db37c24f843fb753fc4b3b2c641b08a"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a6db37c24f843fb753fc4b3b2c641b08a">CMD_OPT_AH_PROPOSAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00049">cmd_options.h:49</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda4c6ceeab09704b977b4f9b5c9d5b205b">PROTO_ESP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00045">proposal.h:45</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a5372eff556866bada29dd4643e028e02"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a></div><div class="ttdeci">struct sadb_prop * proposal</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00650">kernel_pfkey_ipsec.c:650</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cda02eb4be1ed84e3e2dda1730de551378f">PROTO_AH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00044">proposal.h:44</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a453f3d4ac56d5f3b6ceeda4d4baa59d7"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a453f3d4ac56d5f3b6ceeda4d4baa59d7">CMD_OPT_IKE_PROPOSAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00048">cmd_options.h:48</a></div></div>
<div class="ttc" id="sasl__mechanism_8c_html_ae57ae4ecc2c00b47149ec5130bc9c9ef"><div class="ttname"><a href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a></div><div class="ttdeci">bool server</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8a/sasl__mechanism_8c_source.html#l00025">sasl_mechanism.c:25</a></div></div>
<div class="ttc" id="group__proposal_html_gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec"><div class="ttname"><a href="../../dd/d64/group__proposal.html#gga9d38b4dd5d473db346d2cabd0cf441cdad6ef0da96c23a1cbd5ed1eec29a3eaec">PROTO_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00043">proposal.h:43</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a81979815a986787a5a7374a7f3283dd4"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a81979815a986787a5a7374a7f3283dd4">CMD_OPT_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00043">cmd_options.h:43</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8ae966d760cb3a81d9ae41c53d0faca08b"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8ae966d760cb3a81d9ae41c53d0faca08b">CMD_OPT_ESP_PROPOSAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00050">cmd_options.h:50</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a1cb89d195e5046fcd9c83ce468fc340c"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a1cb89d195e5046fcd9c83ce468fc340c">CMD_OPT_PROFILE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00051">cmd_options.h:51</a></div></div>
<div class="ttc" id="group__cmd__option_html_gga25da2eda5d74124b8e7f7988a1bfb1e8a594903fd2e4ca077f57da863d43a1d3d"><div class="ttname"><a href="../../d6/db0/group__cmd__option.html#gga25da2eda5d74124b8e7f7988a1bfb1e8a594903fd2e4ca077f57da863d43a1d3d">CMD_OPT_AGENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/da4/cmd__options_8h_source.html#l00045">cmd_options.h:45</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a7edf100f0c26164ae45b03d4c8b288f3_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a39e43018827c0d40b28cde51eccd0c68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d1e/structcmd__connection__t.html">cmd_connection_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/ddc/windows_2thread_8c.html#a343cd07ea8770e572cfe3a7d39ea8401">destroy</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00540">540</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../dc/d21/daemon_8c_source.html#l00452">destroy()</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;{</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    this-&gt;ike_proposals-&gt;destroy_offset(this-&gt;ike_proposals,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                offsetof(<a class="code" href="../../df/d06/structproposal__t.html">proposal_t</a>, <a class="code" href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a>));</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    this-&gt;child_proposals-&gt;destroy_offset(this-&gt;child_proposals,</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                offsetof(<a class="code" href="../../df/d06/structproposal__t.html">proposal_t</a>, <a class="code" href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a>));</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    this-&gt;local_ts-&gt;destroy_offset(this-&gt;local_ts,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                offsetof(<a class="code" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>, <a class="code" href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a>));</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    this-&gt;remote_ts-&gt;destroy_offset(this-&gt;remote_ts,</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                offsetof(<a class="code" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a>, <a class="code" href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a>));</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;}</div>
<div class="ttc" id="structproposal__t_html"><div class="ttname"><a href="../../df/d06/structproposal__t.html">proposal_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00062">proposal.h:62</a></div></div>
<div class="ttc" id="daemon_8c_html_a1e824dfeaa337e709772cb0c8e6c8dcc"><div class="ttname"><a href="../../dc/d21/daemon_8c.html#a1e824dfeaa337e709772cb0c8e6c8dcc">destroy</a></div><div class="ttdeci">static void destroy(private_daemon_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d21/daemon_8c_source.html#l00452">daemon.c:452</a></div></div>
<div class="ttc" id="structtraffic__selector__t_html"><div class="ttname"><a href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfb/traffic__selector_8h_source.html#l00072">traffic_selector.h:72</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a39e43018827c0d40b28cde51eccd0c68_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a137d617d75d6918da14eed0010cb05e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_profile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d5b/structprivate__cmd__connection__t.html">private_cmd_connection_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parse profile name identifier </p>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00464">464</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00046">DBG_CFG</a>, and <a class="el" href="../../d0/d9b/enum_8h_source.html#l00148">enum_from_name</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00476">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73b">profile_t</a> profile;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d11/group__enum.html#gab685e29115dfda9bbef2270d6eefac97">enum_from_name</a>(profile_names, <a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>, &amp;profile))</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a>, <span class="stringliteral">&quot;unknown connection profile: %s&quot;</span>, <a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        exit(1);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    this-&gt;profile = profile;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}</div>
<div class="ttc" id="group__enum_html_gab685e29115dfda9bbef2270d6eefac97"><div class="ttname"><a href="../../d9/d11/group__enum.html#gab685e29115dfda9bbef2270d6eefac97">enum_from_name</a></div><div class="ttdeci">#define enum_from_name(e, name, valp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00148">enum.h:148</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="cmd__connection_8c_html_ae05a6a7cf154d891ba73f0d081c5a73b"><div class="ttname"><a href="../../d7/d9c/cmd__connection_8c.html#ae05a6a7cf154d891ba73f0d081c5a73b">profile_t</a></div><div class="ttdeci">profile_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9c/cmd__connection_8c_source.html#l00035">cmd_connection.c:35</a></div></div>
<div class="ttc" id="dh__speed_8c_html_a1317e52dffbcbe14fbfd1bd5ac61fff9"><div class="ttname"><a href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d1a/dh__speed_8c_source.html#l00030">dh_speed.c:30</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa4770f7afd7581ab660556655dc9d7276">DBG_CFG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00046">debug.h:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a137d617d75d6918da14eed0010cb05e6_icgraph.svg" width="222" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7673aa078775c7307b184332c8d97086"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void terminate </td>
          <td>(</td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>pid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Shut down application </p>

<p>Definition at line <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00133">133</a> of file <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html">cmd_connection.c</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d9c/cmd__connection_8c_source.html#l00406">initiate()</a>, <a class="el" href="../../d8/dcf/vici__control_8c_source.html#l00479">manage_commands()</a>, <a class="el" href="../../d6/d34/tnc__imc_8c_source.html#l00411">tnc_imc_create_from_functions()</a>, and <a class="el" href="../../d3/dbe/tnc__imv_8c_source.html#l00408">tnc_imv_create_from_functions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;{</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    kill(pid, SIGUSR1);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d9c/cmd__connection_8c_a7673aa078775c7307b184332c8d97086_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_9944fe0f9e1f2f45a4d7b6f7260b38df.html">charon-cmd</a></li><li class="navelem"><a class="el" href="../../dir_6f4a0401f02167f2a995841d744ca135.html">cmd</a></li><li class="navelem"><a class="el" href="../../d7/d9c/cmd__connection_8c.html">cmd_connection.c</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:03:35 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
