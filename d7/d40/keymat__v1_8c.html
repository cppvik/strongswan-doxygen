<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: keymat_v1.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d7/d40/keymat__v1_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">keymat_v1.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../de/da7/keymat__v1_8h_source.html">keymat_v1.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="../../d0/d51/daemon_8h_source.html">daemon.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d8/df4/generator_8h_source.html">encoding/generator.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d4/d49/nonce__payload_8h_source.html">encoding/payloads/nonce_payload.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d1/d4a/linked__list_8h_source.html">collections/linked_list.h</a>&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for keymat_v1.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d1/d25/keymat__v1_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="../../d7/d40/keymat__v1_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d55/structiv__data__t.html">iv_data_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/dcf/structqm__data__t.html">qm_data_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab6e8f635db7db7c9355f6a6ed27020e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#ab6e8f635db7db7c9355f6a6ed27020e2">MAX_EXCHANGES_DEFAULT</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ab6e8f635db7db7c9355f6a6ed27020e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a8afdbfdd680b284403981a33907811e2"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a8afdbfdd680b284403981a33907811e2">private_keymat_v1_t</a></td></tr>
<tr class="separator:a8afdbfdd680b284403981a33907811e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afe094700cf566dcd7c1d12883874e1e6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#afe094700cf566dcd7c1d12883874e1e6">iv_data_destroy</a> (<a class="el" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *this)</td></tr>
<tr class="separator:afe094700cf566dcd7c1d12883874e1e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6b2166164c7e1d3af19de6c8d6ed253"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#ab6b2166164c7e1d3af19de6c8d6ed253">qm_data_destroy</a> (<a class="el" href="../../da/dcf/structqm__data__t.html">qm_data_t</a> *this)</td></tr>
<tr class="separator:ab6b2166164c7e1d3af19de6c8d6ed253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae083f22e344d62567db127475c50c7cd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#ae083f22e344d62567db127475c50c7cd">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, <a class="el" href="../../d2/da7/pkcs7_8c.html#a2c48115da6e8d8b77bbe4a1d50d8e329">encrypt</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> plain, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> assoc, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> iv, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encrypted)</td></tr>
<tr class="separator:ae083f22e344d62567db127475c50c7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a198deff362868318635e80df1e08f122"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a198deff362868318635e80df1e08f122">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, <a class="el" href="../../db/d5d/load__creds_8c.html#a1873eb038b74c2a08385fbd0e6d7a59a">decrypt</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> encrypted, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> assoc, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> iv, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *plain)</td></tr>
<tr class="separator:a198deff362868318635e80df1e08f122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae73f2e449d4e055688cfb59deeec914c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#ae73f2e449d4e055688cfb59deeec914c">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, get_block_size, size_t, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this)</td></tr>
<tr class="separator:ae73f2e449d4e055688cfb59deeec914c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d688a77827270504dd9f0b64084bb3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a51d688a77827270504dd9f0b64084bb3">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, get_icv_size, size_t, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this)</td></tr>
<tr class="separator:a51d688a77827270504dd9f0b64084bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a688debfa1c96fdae0d14b35248004b19"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a688debfa1c96fdae0d14b35248004b19">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, get_iv_size, size_t, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this)</td></tr>
<tr class="separator:a688debfa1c96fdae0d14b35248004b19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93fa38cebe5eab30fae8292c7ba54ae6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a93fa38cebe5eab30fae8292c7ba54ae6">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, get_iv_gen, <a class="el" href="../../db/d66/structiv__gen__t.html">iv_gen_t</a> *, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this)</td></tr>
<tr class="separator:a93fa38cebe5eab30fae8292c7ba54ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa45a210a6c3783f945dc74a7375bd744"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#aa45a210a6c3783f945dc74a7375bd744">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, get_key_size, size_t, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this)</td></tr>
<tr class="separator:aa45a210a6c3783f945dc74a7375bd744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5026cc86e7055972be5b942baa62152"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#ad5026cc86e7055972be5b942baa62152">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, set_key, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../db/dba/help_8cs.html#a77bc93c6696a758930babfcb6cc8495b">key</a>)</td></tr>
<tr class="separator:ad5026cc86e7055972be5b942baa62152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096e34fed72ec9c5ada5a0ba20b74515"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a096e34fed72ec9c5ada5a0ba20b74515">METHOD</a> (<a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>, aead_destroy, void, <a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *this)</td></tr>
<tr class="separator:a096e34fed72ec9c5ada5a0ba20b74515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a816dbd8e98d9727f32413c4f491f07ed"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a816dbd8e98d9727f32413c4f491f07ed">expand_skeyid_e</a> (<a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> skeyid_e, size_t <a class="el" href="../../d8/d1b/test__ecdsa_8c.html#a0f3084a1981fbadcba999d0bd8744c80">key_size</a>, <a class="el" href="../../df/d5f/structprf__t.html">prf_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#a16eb4ff2fcab94258628b0da0436ec27">prf</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *ka)</td></tr>
<tr class="separator:a816dbd8e98d9727f32413c4f491f07ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54e5b5dd4f7d72c9d4a3ee0403c899dd"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a54e5b5dd4f7d72c9d4a3ee0403c899dd">create_aead</a> (<a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../df/d5f/structprf__t.html">prf_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#a16eb4ff2fcab94258628b0da0436ec27">prf</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> skeyid_e)</td></tr>
<tr class="separator:a54e5b5dd4f7d72c9d4a3ee0403c899dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c555548623565605406836f0d338864"><td class="memItemLeft" align="right" valign="top">static u_int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a2c555548623565605406836f0d338864">auth_to_prf</a> (u_int16_t <a class="el" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>)</td></tr>
<tr class="separator:a2c555548623565605406836f0d338864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab396dafd1db9c1c3d8a26b61a08e53d6"><td class="memItemLeft" align="right" valign="top">static u_int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#ab396dafd1db9c1c3d8a26b61a08e53d6">auth_to_hash</a> (u_int16_t <a class="el" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>)</td></tr>
<tr class="separator:ab396dafd1db9c1c3d8a26b61a08e53d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e75003d6c32bcf616b964d47ef4ac32"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a3e75003d6c32bcf616b964d47ef4ac32">adjust_keylen</a> (u_int16_t <a class="el" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../db/dba/help_8cs.html#a77bc93c6696a758930babfcb6cc8495b">key</a>)</td></tr>
<tr class="separator:a3e75003d6c32bcf616b964d47ef4ac32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a96c477976ba2a8f1847b170cdf07a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a1a96c477976ba2a8f1847b170cdf07a6">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, derive_ike_keys, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dh_other, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, <a class="el" href="../../da/d5b/group__authenticator.html#ga8071dc90e8e461c4be73b26588aead90">auth_method_t</a> auth, <a class="el" href="../../d7/d7c/structshared__key__t.html">shared_key_t</a> *shared_key)</td></tr>
<tr class="separator:a1a96c477976ba2a8f1847b170cdf07a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a984d4be5b42587865e64ebcf78b08d01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a984d4be5b42587865e64ebcf78b08d01">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, derive_child_keys, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, u_int32_t spi_i, u_int32_t spi_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_r)</td></tr>
<tr class="separator:a984d4be5b42587865e64ebcf78b08d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4afb8c14b3281a244ab23dca53dd2d8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a4afb8c14b3281a244ab23dca53dd2d8e">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, create_hasher, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>)</td></tr>
<tr class="separator:a4afb8c14b3281a244ab23dca53dd2d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad0e56aef102bd6ba3b2ffcca8ad3d1e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#aad0e56aef102bd6ba3b2ffcca8ad3d1e">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, get_hasher, <a class="el" href="../../d4/d72/structhasher__t.html">hasher_t</a> *, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this)</td></tr>
<tr class="separator:aad0e56aef102bd6ba3b2ffcca8ad3d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f2104dcdcbd7514baf8c3d6b2ec4286"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a3f2104dcdcbd7514baf8c3d6b2ec4286">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, get_hash, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dh_other, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *ike_sa_id, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> sa_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td></tr>
<tr class="separator:a3f2104dcdcbd7514baf8c3d6b2ec4286"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82035235fa4fecaba085ef1869910853"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a82035235fa4fecaba085ef1869910853">get_nonce</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d05cf6aa68b03e254d70afbe869e305">n</a>)</td></tr>
<tr class="separator:a82035235fa4fecaba085ef1869910853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84a4d4c4aaa5e44bb2071bf98f050452"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a84a4d4c4aaa5e44bb2071bf98f050452">get_message_data</a> (<a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message, <a class="el" href="../../d0/d70/structgenerator__t.html">generator_t</a> *generator)</td></tr>
<tr class="separator:a84a4d4c4aaa5e44bb2071bf98f050452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa170aeaf1f891c2939206c5087bf8d3f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../da/dcf/structqm__data__t.html">qm_data_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#aa170aeaf1f891c2939206c5087bf8d3f">lookup_quick_mode</a> (<a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, u_int32_t mid)</td></tr>
<tr class="separator:aa170aeaf1f891c2939206c5087bf8d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79408dd38cda9b8225547e574a42995d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a79408dd38cda9b8225547e574a42995d">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, get_hash_phase2, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, <a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *message, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td></tr>
<tr class="separator:a79408dd38cda9b8225547e574a42995d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1505b0f5a6dc3af207c42b48ea9e1803"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a1505b0f5a6dc3af207c42b48ea9e1803">generate_iv</a> (<a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, <a class="el" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *iv)</td></tr>
<tr class="separator:a1505b0f5a6dc3af207c42b48ea9e1803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf3f4b53c3b8091b4cda09d194182665"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#acf3f4b53c3b8091b4cda09d194182665">lookup_iv</a> (<a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, u_int32_t mid)</td></tr>
<tr class="separator:acf3f4b53c3b8091b4cda09d194182665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ed76dfd9b85274b26c0c53123ac11e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a9ed76dfd9b85274b26c0c53123ac11e9">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, get_iv, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, u_int32_t mid, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a392d7ef877b6258e64850ce3a2647dae">out</a>)</td></tr>
<tr class="separator:a9ed76dfd9b85274b26c0c53123ac11e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab650ebd4314dc5c5edf6af462bffac94"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#ab650ebd4314dc5c5edf6af462bffac94">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, update_iv, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, u_int32_t mid, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> last_block)</td></tr>
<tr class="separator:ab650ebd4314dc5c5edf6af462bffac94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ee8bdf3b81a74e15a52a899b53907f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a1ee8bdf3b81a74e15a52a899b53907f0">METHOD</a> (<a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>, confirm_iv, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, u_int32_t mid)</td></tr>
<tr class="separator:a1ee8bdf3b81a74e15a52a899b53907f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84b298e352f7bee8db9d571128ddedc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a84b298e352f7bee8db9d571128ddedc0">METHOD</a> (<a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>, get_version, <a class="el" href="../../dd/d6e/group__ike__cfg.html#gaf1772828c8c0e7d70e61a65f8b7653f2">ike_version_t</a>, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this)</td></tr>
<tr class="separator:a84b298e352f7bee8db9d571128ddedc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a233389e78f7b07c666b7b52b98942"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a01a233389e78f7b07c666b7b52b98942">METHOD</a> (<a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>, create_dh, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, <a class="el" href="../../de/d95/group__diffie__hellman.html#ga44a1c1057dd7d5cb746be20cf128c743">diffie_hellman_group_t</a> <a class="el" href="../../d4/d58/tls__crypto_8c.html#a28f6c53e49dfa08e24017d893fc83524">group</a>)</td></tr>
<tr class="separator:a01a233389e78f7b07c666b7b52b98942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a9f1efb26f484e2b34e6a162efc3940"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a4a9f1efb26f484e2b34e6a162efc3940">METHOD</a> (<a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>, create_nonce_gen, <a class="el" href="../../dc/d1a/structnonce__gen__t.html">nonce_gen_t</a> *, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this)</td></tr>
<tr class="separator:a4a9f1efb26f484e2b34e6a162efc3940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e51a9be4839746306c68bdbe4738eeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a3e51a9be4839746306c68bdbe4738eeb">METHOD</a> (<a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>, get_aead, <a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a> *, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d9/dbe/test__utils_8c.html#af64a0227ac124692942e0d1f7bdc6e00">in</a>)</td></tr>
<tr class="separator:a3e51a9be4839746306c68bdbe4738eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a429b3d881ff01cbc8506b56ad22e529e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a429b3d881ff01cbc8506b56ad22e529e">METHOD</a> (<a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>, <a class="el" href="../../d4/ddc/windows_2thread_8c.html#a343cd07ea8770e572cfe3a7d39ea8401">destroy</a>, void, <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *this)</td></tr>
<tr class="separator:a429b3d881ff01cbc8506b56ad22e529e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5245b2b0748a388786261f663bb7ad5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d4c/group__keymat__v1.html#gab5245b2b0748a388786261f663bb7ad5">keymat_v1_create</a> (<a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>)</td></tr>
<tr class="separator:gab5245b2b0748a388786261f663bb7ad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a497b5fdd9da714ef02eed7792d7130f9"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a497b5fdd9da714ef02eed7792d7130f9">octet_0</a> = <a class="el" href="../../d4/d87/group__chunk.html#ga4e840ddd09136bdd6995ef664a52f8f1">chunk_from_chars</a>(0x00)</td></tr>
<tr class="separator:a497b5fdd9da714ef02eed7792d7130f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668140d391d9a28ec257ac5fd9b1a8ca"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a668140d391d9a28ec257ac5fd9b1a8ca">octet_1</a> = <a class="el" href="../../d4/d87/group__chunk.html#ga4e840ddd09136bdd6995ef664a52f8f1">chunk_from_chars</a>(0x01)</td></tr>
<tr class="separator:a668140d391d9a28ec257ac5fd9b1a8ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a348490e6e1dad0ee07485fa18c45aa63"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d40/keymat__v1_8c.html#a348490e6e1dad0ee07485fa18c45aa63">octet_2</a> = <a class="el" href="../../d4/d87/group__chunk.html#ga4e840ddd09136bdd6995ef664a52f8f1">chunk_from_chars</a>(0x02)</td></tr>
<tr class="separator:a348490e6e1dad0ee07485fa18c45aa63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ab6e8f635db7db7c9355f6a6ed27020e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_EXCHANGES_DEFAULT&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Max. number of IVs/QMs to track. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00028">28</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01140">keymat_v1_create()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a8afdbfdd680b284403981a33907811e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> <a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00023">23</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a3e75003d6c32bcf616b964d47ef4ac32"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void adjust_keylen </td>
          <td>(</td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adjust the key length for PRF algorithms that expect a fixed key length. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00373">373</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d1/ddf/align_8h_source.html#l00036">min</a>, and <a class="el" href="../../dc/d91/prf_8h_source.html#l00044">PRF_AES128_XCBC</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00389">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;{</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4abe30dde51979c49acb00f463f47d27fa">PRF_AES128_XCBC</a>:</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="comment">/* while rfc4434 defines variable keys for AES-XCBC, rfc3664 does</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">             * not and therefore fixed key semantics apply to XCBC for key</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">             * derivation. */</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            key-&gt;<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = <a class="code" href="../../da/dbd/group__align__i.html#gabb702d8b501669a23aa0ab3b281b9384">min</a>(key-&gt;<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>, 16);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="comment">/* all other algorithms use variable key length */</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4abe30dde51979c49acb00f463f47d27fa"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4abe30dde51979c49acb00f463f47d27fa">PRF_AES128_XCBC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00044">prf.h:44</a></div></div>
<div class="ttc" id="test__ntru_8c_html_a84a3aa4b7b5103ec0c08b032954762f7"><div class="ttname"><a href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a></div><div class="ttdeci">ntru_trits_t size_t hash_algorithm_t alg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/test__ntru_8c_source.html#l00030">test_ntru.c:30</a></div></div>
<div class="ttc" id="group__align__i_html_gabb702d8b501669a23aa0ab3b281b9384"><div class="ttname"><a href="../../da/dbd/group__align__i.html#gabb702d8b501669a23aa0ab3b281b9384">min</a></div><div class="ttdeci">#define min(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/ddf/align_8h_source.html#l00036">align.h:36</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a3e75003d6c32bcf616b964d47ef4ac32_icgraph.svg" width="243" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab396dafd1db9c1c3d8a26b61a08e53d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int16_t auth_to_hash </td>
          <td>(</td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>alg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Converts integrity algorithm to hash algorithm </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00351">351</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d6/d6b/signer_8h_source.html#l00038">AUTH_HMAC_MD5_96</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00040">AUTH_HMAC_SHA1_96</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00060">AUTH_HMAC_SHA2_256_128</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00062">AUTH_HMAC_SHA2_384_192</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00064">AUTH_HMAC_SHA2_512_256</a>, <a class="el" href="../../df/d23/hasher_8h_source.html#l00046">HASH_MD5</a>, <a class="el" href="../../df/d23/hasher_8h_source.html#l00038">HASH_SHA1</a>, <a class="el" href="../../df/d23/hasher_8h_source.html#l00039">HASH_SHA256</a>, <a class="el" href="../../df/d23/hasher_8h_source.html#l00040">HASH_SHA384</a>, <a class="el" href="../../df/d23/hasher_8h_source.html#l00041">HASH_SHA512</a>, and <a class="el" href="../../df/d23/hasher_8h_source.html#l00043">HASH_UNKNOWN</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00725">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a7be5ebd756e3220636e9e37a2743504d">AUTH_HMAC_SHA1_96</a>:</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea25c481ea5e9f16f9b40fe773528aef03">HASH_SHA1</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a0bc7fcafc3a5d39bc5a655a03196dcd1">AUTH_HMAC_SHA2_256_128</a>:</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea3690b7a5bf11282bcdaa199c11408dd3">HASH_SHA256</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a8b3110d80a37c30e3eaa6a91a42e011f">AUTH_HMAC_SHA2_384_192</a>:</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebeabb45ce56a912f1175c413afcb3e1f970">HASH_SHA384</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14ada813c27342769b8df2b65a1af3533d7">AUTH_HMAC_SHA2_512_256</a>:</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea6d06d1ec4dbf3aa876fda6ca1c5b0f66">HASH_SHA512</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14aefc97df8562a33032cebdad44ca30f0b">AUTH_HMAC_MD5_96</a>:</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea45c78681038e51d5f54554130b0b79ab">HASH_MD5</a>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea9b8e99ea2698fbaabf3976784e7b5d16">HASH_UNKNOWN</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div>
<div class="ttc" id="test__ntru_8c_html_a84a3aa4b7b5103ec0c08b032954762f7"><div class="ttname"><a href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a></div><div class="ttdeci">ntru_trits_t size_t hash_algorithm_t alg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/test__ntru_8c_source.html#l00030">test_ntru.c:30</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14a7be5ebd756e3220636e9e37a2743504d"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a7be5ebd756e3220636e9e37a2743504d">AUTH_HMAC_SHA1_96</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00040">signer.h:40</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14a8b3110d80a37c30e3eaa6a91a42e011f"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a8b3110d80a37c30e3eaa6a91a42e011f">AUTH_HMAC_SHA2_384_192</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00062">signer.h:62</a></div></div>
<div class="ttc" id="group__hasher_html_ggad4fa8b947395725abf0510e387204ebea9b8e99ea2698fbaabf3976784e7b5d16"><div class="ttname"><a href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea9b8e99ea2698fbaabf3976784e7b5d16">HASH_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d23/hasher_8h_source.html#l00043">hasher.h:43</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14ada813c27342769b8df2b65a1af3533d7"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14ada813c27342769b8df2b65a1af3533d7">AUTH_HMAC_SHA2_512_256</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00064">signer.h:64</a></div></div>
<div class="ttc" id="group__hasher_html_ggad4fa8b947395725abf0510e387204ebea25c481ea5e9f16f9b40fe773528aef03"><div class="ttname"><a href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea25c481ea5e9f16f9b40fe773528aef03">HASH_SHA1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d23/hasher_8h_source.html#l00038">hasher.h:38</a></div></div>
<div class="ttc" id="group__hasher_html_ggad4fa8b947395725abf0510e387204ebeabb45ce56a912f1175c413afcb3e1f970"><div class="ttname"><a href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebeabb45ce56a912f1175c413afcb3e1f970">HASH_SHA384</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d23/hasher_8h_source.html#l00040">hasher.h:40</a></div></div>
<div class="ttc" id="group__hasher_html_ggad4fa8b947395725abf0510e387204ebea3690b7a5bf11282bcdaa199c11408dd3"><div class="ttname"><a href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea3690b7a5bf11282bcdaa199c11408dd3">HASH_SHA256</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d23/hasher_8h_source.html#l00039">hasher.h:39</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14aefc97df8562a33032cebdad44ca30f0b"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14aefc97df8562a33032cebdad44ca30f0b">AUTH_HMAC_MD5_96</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00038">signer.h:38</a></div></div>
<div class="ttc" id="group__hasher_html_ggad4fa8b947395725abf0510e387204ebea6d06d1ec4dbf3aa876fda6ca1c5b0f66"><div class="ttname"><a href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea6d06d1ec4dbf3aa876fda6ca1c5b0f66">HASH_SHA512</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d23/hasher_8h_source.html#l00041">hasher.h:41</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14a0bc7fcafc3a5d39bc5a655a03196dcd1"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a0bc7fcafc3a5d39bc5a655a03196dcd1">AUTH_HMAC_SHA2_256_128</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00060">signer.h:60</a></div></div>
<div class="ttc" id="group__hasher_html_ggad4fa8b947395725abf0510e387204ebea45c78681038e51d5f54554130b0b79ab"><div class="ttname"><a href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea45c78681038e51d5f54554130b0b79ab">HASH_MD5</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d23/hasher_8h_source.html#l00046">hasher.h:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_ab396dafd1db9c1c3d8a26b61a08e53d6_icgraph.svg" width="240" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2c555548623565605406836f0d338864"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int16_t auth_to_prf </td>
          <td>(</td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>alg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Converts integrity algorithm to PRF algorithm </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00327">327</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d6/d6b/signer_8h_source.html#l00046">AUTH_AES_XCBC_96</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00038">AUTH_HMAC_MD5_96</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00040">AUTH_HMAC_SHA1_96</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00060">AUTH_HMAC_SHA2_256_128</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00062">AUTH_HMAC_SHA2_384_192</a>, <a class="el" href="../../d6/d6b/signer_8h_source.html#l00064">AUTH_HMAC_SHA2_512_256</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00044">PRF_AES128_XCBC</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00038">PRF_HMAC_MD5</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00040">PRF_HMAC_SHA1</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00046">PRF_HMAC_SHA2_256</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00048">PRF_HMAC_SHA2_384</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00050">PRF_HMAC_SHA2_512</a>, and <a class="el" href="../../dc/d91/prf_8h_source.html#l00036">PRF_UNDEFINED</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00389">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a7be5ebd756e3220636e9e37a2743504d">AUTH_HMAC_SHA1_96</a>:</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4adc4e13a043d560fd4cc57fa8c0a843db">PRF_HMAC_SHA1</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a0bc7fcafc3a5d39bc5a655a03196dcd1">AUTH_HMAC_SHA2_256_128</a>:</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a49e4fdb8e8f64c1adb8d0e600450bad9">PRF_HMAC_SHA2_256</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a8b3110d80a37c30e3eaa6a91a42e011f">AUTH_HMAC_SHA2_384_192</a>:</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a374578f25f7b76d75029bc81628f20be">PRF_HMAC_SHA2_384</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14ada813c27342769b8df2b65a1af3533d7">AUTH_HMAC_SHA2_512_256</a>:</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4aec9df4f8e31029dfc194ea4a8a93ae45">PRF_HMAC_SHA2_512</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14aefc97df8562a33032cebdad44ca30f0b">AUTH_HMAC_MD5_96</a>:</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4ad2faec42c34cdc41ccb88e8e244160a5">PRF_HMAC_MD5</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a32210d341c4dcebd7157f3d005fd8207">AUTH_AES_XCBC_96</a>:</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4abe30dde51979c49acb00f463f47d27fa">PRF_AES128_XCBC</a>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a40d0cd75116f68a7f2716afcc11f2f0c">PRF_UNDEFINED</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4abe30dde51979c49acb00f463f47d27fa"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4abe30dde51979c49acb00f463f47d27fa">PRF_AES128_XCBC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00044">prf.h:44</a></div></div>
<div class="ttc" id="test__ntru_8c_html_a84a3aa4b7b5103ec0c08b032954762f7"><div class="ttname"><a href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a></div><div class="ttdeci">ntru_trits_t size_t hash_algorithm_t alg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/test__ntru_8c_source.html#l00030">test_ntru.c:30</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14a7be5ebd756e3220636e9e37a2743504d"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a7be5ebd756e3220636e9e37a2743504d">AUTH_HMAC_SHA1_96</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00040">signer.h:40</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4adc4e13a043d560fd4cc57fa8c0a843db"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4adc4e13a043d560fd4cc57fa8c0a843db">PRF_HMAC_SHA1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00040">prf.h:40</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14a8b3110d80a37c30e3eaa6a91a42e011f"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a8b3110d80a37c30e3eaa6a91a42e011f">AUTH_HMAC_SHA2_384_192</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00062">signer.h:62</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4ad2faec42c34cdc41ccb88e8e244160a5"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4ad2faec42c34cdc41ccb88e8e244160a5">PRF_HMAC_MD5</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00038">prf.h:38</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4aec9df4f8e31029dfc194ea4a8a93ae45"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4aec9df4f8e31029dfc194ea4a8a93ae45">PRF_HMAC_SHA2_512</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00050">prf.h:50</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14ada813c27342769b8df2b65a1af3533d7"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14ada813c27342769b8df2b65a1af3533d7">AUTH_HMAC_SHA2_512_256</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00064">signer.h:64</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14aefc97df8562a33032cebdad44ca30f0b"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14aefc97df8562a33032cebdad44ca30f0b">AUTH_HMAC_MD5_96</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00038">signer.h:38</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4a374578f25f7b76d75029bc81628f20be"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a374578f25f7b76d75029bc81628f20be">PRF_HMAC_SHA2_384</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00048">prf.h:48</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4a40d0cd75116f68a7f2716afcc11f2f0c"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a40d0cd75116f68a7f2716afcc11f2f0c">PRF_UNDEFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00036">prf.h:36</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4a49e4fdb8e8f64c1adb8d0e600450bad9"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a49e4fdb8e8f64c1adb8d0e600450bad9">PRF_HMAC_SHA2_256</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00046">prf.h:46</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14a0bc7fcafc3a5d39bc5a655a03196dcd1"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a0bc7fcafc3a5d39bc5a655a03196dcd1">AUTH_HMAC_SHA2_256_128</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00060">signer.h:60</a></div></div>
<div class="ttc" id="group__signer_html_gga04895917ddad497277ae3179dd4c6f14a32210d341c4dcebd7157f3d005fd8207"><div class="ttname"><a href="../../de/dfc/group__signer.html#gga04895917ddad497277ae3179dd4c6f14a32210d341c4dcebd7157f3d005fd8207">AUTH_AES_XCBC_96</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d6b/signer_8h_source.html#l00046">signer.h:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a2c555548623565605406836f0d338864_icgraph.svg" width="227" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a54e5b5dd4f7d72c9d4a3ee0403c899dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>* create_aead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *&#160;</td>
          <td class="paramname"><em>proposal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d5f/structprf__t.html">prf_t</a> *&#160;</td>
          <td class="paramname"><em>prf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>skeyid_e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a simple implementation of the <a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a> interface which only encrypts or decrypts data. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00272">272</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../d1/d99/test__ntru_8c_source.html#l00030">alg</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00214">chunk_clear()</a>, <a class="el" href="../../d4/d1b/crypto__factory_8h_source.html#l00095">crypto_factory_t::create_crypter</a>, <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">crypter</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00175">library_t::crypto</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00062">DBG4</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00040">DBG_IKE</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00054">aead_t::encrypt</a>, <a class="el" href="../../d2/d80/transform_8h_source.html#l00037">ENCRYPTION_ALGORITHM</a>, <a class="el" href="../../d9/dc7/group__crypter.html#ga1f793f538b45c8126012219e21d332f0">encryption_algorithm_names</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00229">expand_skeyid_e()</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00101">proposal_t::get_algorithm</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00152">crypter_t::get_key_size</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d4/d30/af__alg__crypter_8c_source.html#l00060">key_size</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00399">prf</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00162">crypter_t::set_key</a>, and <a class="el" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00389">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    u_int16_t <a class="code" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>, <a class="code" href="../../d4/d30/af__alg__crypter_8c.html#ae102c01788a1617aa7af9c5c25a92be5">key_size</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="../../d9/d7b/structcrypter__t.html">crypter_t</a> *<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> ka;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (!proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">get_algorithm</a>(proposal, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a4b9161a6fc3dc335f20693a1d6ac6f25">ENCRYPTION_ALGORITHM</a>, &amp;alg,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                 &amp;key_size))</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;no %N selected&quot;</span>,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;             <a class="code" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a4b9161a6fc3dc335f20693a1d6ac6f25">ENCRYPTION_ALGORITHM</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    crypter = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>-&gt;<a class="code" href="../../dc/d84/structcrypto__factory__t.html#a1eea6c2be19922c0bf774c6016d5207d">create_crypter</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>, alg, key_size / 8);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (!crypter)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;%N %N (key size %d) not supported!&quot;</span>,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;             <a class="code" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a4b9161a6fc3dc335f20693a1d6ac6f25">ENCRYPTION_ALGORITHM</a>,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;             <a class="code" href="../../d9/dc7/group__crypter.html#ga1f793f538b45c8126012219e21d332f0">encryption_algorithm_names</a>, alg, key_size);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    key_size = crypter-&gt;<a class="code" href="../../d9/d7b/structcrypter__t.html#ad4c9cd32d2e7881655ab00fbbc0c0cf6">get_key_size</a>(crypter);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d40/keymat__v1_8c.html#a816dbd8e98d9727f32413c4f491f07ed">expand_skeyid_e</a>(skeyid_e, crypter-&gt;<a class="code" href="../../d9/d7b/structcrypter__t.html#ad4c9cd32d2e7881655ab00fbbc0c0cf6">get_key_size</a>(crypter), <a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>, &amp;ka))</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;encryption key Ka %B&quot;</span>, &amp;ka);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (!crypter-&gt;<a class="code" href="../../d9/d7b/structcrypter__t.html#a52d29c3f5b685d1b4e72bc8f069bc046">set_key</a>(crypter, ka))</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;ka);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;ka);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(<span class="keyword">this</span>,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        .<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a> = {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            .<a class="code" href="../../d7/d7d/structaead__t.html#ae6de1483b2ea5548b0560e726b7e17f7">encrypt</a> = _encrypt,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            .decrypt = _decrypt,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            .get_block_size = _get_block_size,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            .get_icv_size = _get_icv_size,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            .get_iv_size = _get_iv_size,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            .get_iv_gen = _get_iv_gen,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            .get_key_size = _get_key_size,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            .set_key = _set_key,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            .destroy = _aead_destroy,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        },</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        .crypter = <a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    );</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">return</span> &amp;this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
<div class="ttc" id="structcrypter__t_html_ad4c9cd32d2e7881655ab00fbbc0c0cf6"><div class="ttname"><a href="../../d9/d7b/structcrypter__t.html#ad4c9cd32d2e7881655ab00fbbc0c0cf6">crypter_t::get_key_size</a></div><div class="ttdeci">size_t(* get_key_size)(crypter_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00152">crypter.h:152</a></div></div>
<div class="ttc" id="test__ntru_8c_html_a84a3aa4b7b5103ec0c08b032954762f7"><div class="ttname"><a href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a></div><div class="ttdeci">ntru_trits_t size_t hash_algorithm_t alg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/test__ntru_8c_source.html#l00030">test_ntru.c:30</a></div></div>
<div class="ttc" id="af__alg__crypter_8c_html_ae102c01788a1617aa7af9c5c25a92be5"><div class="ttname"><a href="../../d4/d30/af__alg__crypter_8c.html#ae102c01788a1617aa7af9c5c25a92be5">key_size</a></div><div class="ttdeci">size_t key_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d30/af__alg__crypter_8c_source.html#l00060">af_alg_crypter.c:60</a></div></div>
<div class="ttc" id="structcrypto__factory__t_html_a1eea6c2be19922c0bf774c6016d5207d"><div class="ttname"><a href="../../dc/d84/structcrypto__factory__t.html#a1eea6c2be19922c0bf774c6016d5207d">crypto_factory_t::create_crypter</a></div><div class="ttdeci">crypter_t *(* create_crypter)(crypto_factory_t *this, encryption_algorithm_t algo, size_t key_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/crypto__factory_8h_source.html#l00095">crypto_factory.h:95</a></div></div>
<div class="ttc" id="group__bus_html_gac40b89ec47e2bdcb2975e5c39cf88ae2"><div class="ttname"><a href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a></div><div class="ttdeci">#define DBG4(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00062">bus.h:62</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="group__transforms_html_ggaf335c7940ad619e477cffde4ffb66378a4b9161a6fc3dc335f20693a1d6ac6f25"><div class="ttname"><a href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a4b9161a6fc3dc335f20693a1d6ac6f25">ENCRYPTION_ALGORITHM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/transform_8h_source.html#l00037">transform.h:37</a></div></div>
<div class="ttc" id="proposal_8c_html_ada5439c5fb09c27a3e238beaafc7b4aa"><div class="ttname"><a href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a></div><div class="ttdeci">pseudo_random_function_t prf</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00399">proposal.c:399</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00040">debug.h:40</a></div></div>
<div class="ttc" id="structlibrary__t_html_a5a2856cda49e43c861c78afef49170f4"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">library_t::crypto</a></div><div class="ttdeci">crypto_factory_t * crypto</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00175">library.h:175</a></div></div>
<div class="ttc" id="group__transforms_html_gaec05291e1bb587c914675a506e7646cf"><div class="ttname"><a href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a></div><div class="ttdeci">enum_name_t * transform_type_names</div></div>
<div class="ttc" id="structproposal__t_html_af57106973fbeb17aec8819da876280b3"><div class="ttname"><a href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">proposal_t::get_algorithm</a></div><div class="ttdeci">bool(* get_algorithm)(proposal_t *this, transform_type_t type, u_int16_t *alg, u_int16_t *key_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00101">proposal.h:101</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a816dbd8e98d9727f32413c4f491f07ed"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a816dbd8e98d9727f32413c4f491f07ed">expand_skeyid_e</a></div><div class="ttdeci">static bool expand_skeyid_e(chunk_t skeyid_e, size_t key_size, prf_t *prf, chunk_t *ka)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00229">keymat_v1.c:229</a></div></div>
<div class="ttc" id="group__chunk_html_gaaa5a9811df1bd2ae5e331748f7fbaf75"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a></div><div class="ttdeci">static void chunk_clear(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00214">chunk.h:214</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structcrypter__t_html"><div class="ttname"><a href="../../d9/d7b/structcrypter__t.html">crypter_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00093">crypter.h:93</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="test__vectors__plugin_8c_html_a4b2bd9f7f0c714298079749a4b3d29c4"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a></div><div class="ttdeci">static crypter_test_vector_t * crypter[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">test_vectors_plugin.c:51</a></div></div>
<div class="ttc" id="structcrypter__t_html_a52d29c3f5b685d1b4e72bc8f069bc046"><div class="ttname"><a href="../../d9/d7b/structcrypter__t.html#a52d29c3f5b685d1b4e72bc8f069bc046">crypter_t::set_key</a></div><div class="ttdeci">bool(* set_key)(crypter_t *this, chunk_t key) __attribute__((warn_unused_result))</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00162">crypter.h:162</a></div></div>
<div class="ttc" id="structaead__t_html_ae6de1483b2ea5548b0560e726b7e17f7"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#ae6de1483b2ea5548b0560e726b7e17f7">aead_t::encrypt</a></div><div class="ttdeci">bool(* encrypt)(aead_t *this, chunk_t plain, chunk_t assoc, chunk_t iv, chunk_t *encrypted) __attribute__((warn_unused_result))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00054">aead.h:54</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structprivate__aead__t_html"><div class="ttname"><a href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00158">keymat_v1.c:158</a></div></div>
<div class="ttc" id="group__crypter_html_ga1f793f538b45c8126012219e21d332f0"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ga1f793f538b45c8126012219e21d332f0">encryption_algorithm_names</a></div><div class="ttdeci">enum_name_t * encryption_algorithm_names</div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a54e5b5dd4f7d72c9d4a3ee0403c899dd_cgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a54e5b5dd4f7d72c9d4a3ee0403c899dd_icgraph.svg" width="232" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a816dbd8e98d9727f32413c4f491f07ed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> expand_skeyid_e </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>skeyid_e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d5f/structprf__t.html">prf_t</a> *&#160;</td>
          <td class="paramname"><em>prf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>ka</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Expand SKEYID_e according to Appendix B in RFC 2409. TODO-IKEv1: verify keys (e.g. for weak keys, see Appendix B) </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00229">229</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d4/d30/af__alg__crypter_8c_source.html#l00058">block_size</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00241">chunk_alloc</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00214">chunk_clear()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00057">chunk_create()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00100">prf_t::get_block_size</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00082">prf_t::get_bytes</a>, <a class="el" href="../../d4/d30/af__alg__crypter_8c_source.html#l00060">key_size</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00151">octet_0</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00118">prf_t::set_key</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00272">create_aead()</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d4/d30/af__alg__crypter_8c.html#ad7524613c3881d09bda0d270ede83779">block_size</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> seed;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (skeyid_e.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> &gt;= <a class="code" href="../../d4/d30/af__alg__crypter_8c.html#ae102c01788a1617aa7af9c5c25a92be5">key_size</a>)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {   <span class="comment">/* no expansion required, reduce to key_size */</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        skeyid_e.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = <a class="code" href="../../d4/d30/af__alg__crypter_8c.html#ae102c01788a1617aa7af9c5c25a92be5">key_size</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        *ka = skeyid_e;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    block_size = prf-&gt;<a class="code" href="../../df/d5f/structprf__t.html#adf7ca1150984f3b4762ac37ff1fa6f27">get_block_size</a>(prf);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    *ka = <a class="code" href="../../d4/d87/group__chunk.html#gadb352c484053489ed07a6303b6bb33a4">chunk_alloc</a>((<a class="code" href="../../d4/d30/af__alg__crypter_8c.html#ae102c01788a1617aa7af9c5c25a92be5">key_size</a> / block_size + 1) * block_size);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    ka-&gt;<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = <a class="code" href="../../d4/d30/af__alg__crypter_8c.html#ae102c01788a1617aa7af9c5c25a92be5">key_size</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">/* Ka = K1 | K2 | ..., K1 = prf(SKEYID_e, 0), K2 = prf(SKEYID_e, K1) ... */</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (!prf-&gt;<a class="code" href="../../df/d5f/structprf__t.html#a27077dae1a8dd0ad49de601a954bd07b">set_key</a>(prf, skeyid_e))</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(ka);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;skeyid_e);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    seed = <a class="code" href="../../d7/d40/keymat__v1_8c.html#a497b5fdd9da714ef02eed7792d7130f9">octet_0</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d4/d30/af__alg__crypter_8c.html#ae102c01788a1617aa7af9c5c25a92be5">key_size</a>; i += <a class="code" href="../../d4/d30/af__alg__crypter_8c.html#ad7524613c3881d09bda0d270ede83779">block_size</a>)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">if</span> (!prf-&gt;<a class="code" href="../../df/d5f/structprf__t.html#a71c5f4e86e174ab537085a61a6b677f1">get_bytes</a>(prf, seed, ka-&gt;<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> + i))</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(ka);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;skeyid_e);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        seed = <a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(ka-&gt;<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> + i, block_size);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;skeyid_e);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
<div class="ttc" id="af__alg__crypter_8c_html_ae102c01788a1617aa7af9c5c25a92be5"><div class="ttname"><a href="../../d4/d30/af__alg__crypter_8c.html#ae102c01788a1617aa7af9c5c25a92be5">key_size</a></div><div class="ttdeci">size_t key_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d30/af__alg__crypter_8c_source.html#l00060">af_alg_crypter.c:60</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a497b5fdd9da714ef02eed7792d7130f9"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a497b5fdd9da714ef02eed7792d7130f9">octet_0</a></div><div class="ttdeci">static const chunk_t octet_0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00151">keymat_v1.c:151</a></div></div>
<div class="ttc" id="group__chunk_html_gaaa5a9811df1bd2ae5e331748f7fbaf75"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a></div><div class="ttdeci">static void chunk_clear(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00214">chunk.h:214</a></div></div>
<div class="ttc" id="group__chunk_html_gad94ca029616a107e89eaa618408fd7b6"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a></div><div class="ttdeci">static chunk_t chunk_create(u_char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00057">chunk.h:57</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structprf__t_html_adf7ca1150984f3b4762ac37ff1fa6f27"><div class="ttname"><a href="../../df/d5f/structprf__t.html#adf7ca1150984f3b4762ac37ff1fa6f27">prf_t::get_block_size</a></div><div class="ttdeci">size_t(* get_block_size)(prf_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00100">prf.h:100</a></div></div>
<div class="ttc" id="structprf__t_html_a27077dae1a8dd0ad49de601a954bd07b"><div class="ttname"><a href="../../df/d5f/structprf__t.html#a27077dae1a8dd0ad49de601a954bd07b">prf_t::set_key</a></div><div class="ttdeci">bool(* set_key)(prf_t *this, chunk_t key) __attribute__((warn_unused_result))</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00118">prf.h:118</a></div></div>
<div class="ttc" id="group__chunk_html_gadb352c484053489ed07a6303b6bb33a4"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gadb352c484053489ed07a6303b6bb33a4">chunk_alloc</a></div><div class="ttdeci">#define chunk_alloc(bytes)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00241">chunk.h:241</a></div></div>
<div class="ttc" id="structprf__t_html_a71c5f4e86e174ab537085a61a6b677f1"><div class="ttname"><a href="../../df/d5f/structprf__t.html#a71c5f4e86e174ab537085a61a6b677f1">prf_t::get_bytes</a></div><div class="ttdeci">bool(* get_bytes)(prf_t *this, chunk_t seed, u_int8_t *buffer) __attribute__((warn_unused_result))</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00082">prf.h:82</a></div></div>
<div class="ttc" id="af__alg__crypter_8c_html_ad7524613c3881d09bda0d270ede83779"><div class="ttname"><a href="../../d4/d30/af__alg__crypter_8c.html#ad7524613c3881d09bda0d270ede83779">block_size</a></div><div class="ttdeci">size_t block_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d30/af__alg__crypter_8c_source.html#l00058">af_alg_crypter.c:58</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a816dbd8e98d9727f32413c4f491f07ed_cgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a816dbd8e98d9727f32413c4f491f07ed_icgraph.svg" width="403" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1505b0f5a6dc3af207c42b48ea9e1803"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> generate_iv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generate an IV </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00985">985</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00266">chunk_cata</a>, <a class="el" href="../../d8/d39/chunk_8c_source.html#l00035">chunk_empty</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00062">DBG4</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00040">DBG_IKE</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00079">aead_t::get_block_size</a>, <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">hasher</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00037">iv_data_t::iv</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00039">iv_data_t::last_block</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00035">iv_data_t::mid</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00103">net</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01017">lookup_iv()</a>, and <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01086">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;{</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">if</span> (iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#aa83de1568a8714babced641c0de1f02e">mid</a> == 0 || iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a>.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    {   <span class="comment">/* use last block of previous encrypted message */</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a>);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a> = iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ae512793306fb33fadb34862fefbfb920">last_block</a>;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ae512793306fb33fadb34862fefbfb920">last_block</a> = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="comment">/* initial phase 2 IV = hash(last_phase1_block | mid) */</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        u_int32_t <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a2f13c35b1fa3de2bd8c668d4a0d52706">net</a>;;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        net = htonl(iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#aa83de1568a8714babced641c0de1f02e">mid</a>);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        data = <a class="code" href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a>(<span class="stringliteral">&quot;cc&quot;</span>, this-&gt;phase1_iv.iv, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(net));</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a>-&gt;allocate_hash(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7b80ec38f8b8d69011997f019187be32">hasher</a>, data, &amp;iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a>))</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">if</span> (iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a>.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> &gt; this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#ad0d873809abc655af8c1edfe99607e91">aead</a>-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">get_block_size</a>(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#ad0d873809abc655af8c1edfe99607e91">aead</a>))</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a>.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">get_block_size</a>(this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;next IV for MID %u %B&quot;</span>, iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#aa83de1568a8714babced641c0de1f02e">mid</a>, &amp;iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="group__chunk_html_gac9858e0c37c9bf6c0706d0a6e3b6453d"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a></div><div class="ttdeci">chunk_t chunk_empty</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00035">chunk.c:35</a></div></div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="group__bus_html_gac40b89ec47e2bdcb2975e5c39cf88ae2"><div class="ttname"><a href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a></div><div class="ttdeci">#define DBG4(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00062">bus.h:62</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00040">debug.h:40</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a2f13c35b1fa3de2bd8c668d4a0d52706"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a2f13c35b1fa3de2bd8c668d4a0d52706">net</a></div><div class="ttdeci">char * net</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00103">test_traffic_selector.c:103</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structaead__t_html_ae6004b22fa9415839f9c0b6e16e48ae6"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">aead_t::get_block_size</a></div><div class="ttdeci">size_t(* get_block_size)(aead_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00079">aead.h:79</a></div></div>
<div class="ttc" id="structiv__data__t_html_ae512793306fb33fadb34862fefbfb920"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html#ae512793306fb33fadb34862fefbfb920">iv_data_t::last_block</a></div><div class="ttdeci">chunk_t last_block</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00039">keymat_v1.c:39</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structiv__data__t_html_aa83de1568a8714babced641c0de1f02e"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html#aa83de1568a8714babced641c0de1f02e">iv_data_t::mid</a></div><div class="ttdeci">u_int32_t mid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00035">keymat_v1.c:35</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_ad0d873809abc655af8c1edfe99607e91"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#ad0d873809abc655af8c1edfe99607e91">private_keymat_v1_t::aead</a></div><div class="ttdeci">aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00070">keymat_v1.c:70</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a7b80ec38f8b8d69011997f019187be32"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a7b80ec38f8b8d69011997f019187be32">private_keymat_v1_t::hasher</a></div><div class="ttdeci">hasher_t * hasher</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00075">keymat_v1.c:75</a></div></div>
<div class="ttc" id="test__vectors__plugin_8c_html_ae7573e55432c43da12a6f6722230496a"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a></div><div class="ttdeci">static hasher_test_vector_t * hasher[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">test_vectors_plugin.c:75</a></div></div>
<div class="ttc" id="structiv__data__t_html_ac89b1703237fdc6a687ee5bd293d5999"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv_data_t::iv</a></div><div class="ttdeci">chunk_t iv</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00037">keymat_v1.c:37</a></div></div>
<div class="ttc" id="group__chunk_html_ga8336eaa6a6255475fca1b09ec41ebb2e"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a></div><div class="ttdeci">#define chunk_cata(mode,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00266">chunk.h:266</a></div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a1505b0f5a6dc3af207c42b48ea9e1803_cgraph.svg" width="331" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a1505b0f5a6dc3af207c42b48ea9e1803_icgraph.svg" width="358" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a84a4d4c4aaa5e44bb2071bf98f050452"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> get_message_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d70/structgenerator__t.html">generator_t</a> *&#160;</td>
          <td class="paramname"><em>generator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generate the message data in order to generate the hashes. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00809">809</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d2/d0d/message_8h_source.html#l00359">message_t::create_payload_enumerator</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00049">generator_t::generate_payload</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00060">generator_t::get_chunk</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00361">payload_t::get_type</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00265">message_t::is_encoded</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00110">next</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00048">PL_NONE</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00088">PLV1_HASH</a>, and <a class="el" href="../../d4/d8b/payload_8h_source.html#l00375">payload_t::set_next_type</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00885">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;{</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <a class="code" href="../../d7/d2f/structpayload__t.html">payload_t</a> *payload, *<a class="code" href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    u_int32_t *lenpos;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">if</span> (message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#aa88d4f5110684e2ec2c7d755972f2d27">is_encoded</a>(message))</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    {   <span class="comment">/* inbound, although the message is generated, we cannot access the</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">         * cleartext message data, so generate it anyway */</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        enumerator = message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a3416f25289258d2993aec831125da6fd">create_payload_enumerator</a>(message);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordflow">if</span> (payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(payload) == <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a>)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generate_payload</a>(generator, payload);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="comment">/* outbound, generate the payloads (there is no HASH payload yet) */</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        enumerator = message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a3416f25289258d2993aec831125da6fd">create_payload_enumerator</a>(message);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">if</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;payload))</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;next))</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>(payload, next-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">get_type</a>(next));</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generate_payload</a>(generator, payload);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                payload = <a class="code" href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            payload-&gt;<a class="code" href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">set_next_type</a>(payload, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generate_payload</a>(generator, payload);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">return</span> generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#a90f85582f88eead65677e5ac095740b2">get_chunk</a>(generator, &amp;lenpos);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eead48cae1f3c82174d9f9e72aa15daaa54">PLV1_HASH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00088">payload.h:88</a></div></div>
<div class="ttc" id="structpayload__t_html"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html">payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00339">payload.h:339</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structmessage__t_html_aa88d4f5110684e2ec2c7d755972f2d27"><div class="ttname"><a href="../../df/d23/structmessage__t.html#aa88d4f5110684e2ec2c7d755972f2d27">message_t::is_encoded</a></div><div class="ttdeci">bool(* is_encoded)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00265">message.h:265</a></div></div>
<div class="ttc" id="structpayload__t_html_a080809f324fbb7037d2aafed2a4f8fcc"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#a080809f324fbb7037d2aafed2a4f8fcc">payload_t::set_next_type</a></div><div class="ttdeci">void(* set_next_type)(payload_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00375">payload.h:375</a></div></div>
<div class="ttc" id="structpayload__t_html_ab2340628b53b694635661403bca8d94e"><div class="ttname"><a href="../../d7/d2f/structpayload__t.html#ab2340628b53b694635661403bca8d94e">payload_t::get_type</a></div><div class="ttdeci">payload_type_t(* get_type)(payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00361">payload.h:361</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="structgenerator__t_html_a90f85582f88eead65677e5ac095740b2"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#a90f85582f88eead65677e5ac095740b2">generator_t::get_chunk</a></div><div class="ttdeci">chunk_t(* get_chunk)(generator_t *this, u_int32_t **lenpos)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00060">generator.h:60</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a8ad91963e97959c834d908f0ac9cca66"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a8ad91963e97959c834d908f0ac9cca66">next</a></div><div class="ttdeci">memory_header_t * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00110">leak_detective.c:110</a></div></div>
<div class="ttc" id="structgenerator__t_html_a8867b5316e300d9b7d2291c5a69be143"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#a8867b5316e300d9b7d2291c5a69be143">generator_t::generate_payload</a></div><div class="ttdeci">void(* generate_payload)(generator_t *this, payload_t *payload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00049">generator.h:49</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structmessage__t_html_a3416f25289258d2993aec831125da6fd"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a3416f25289258d2993aec831125da6fd">message_t::create_payload_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_payload_enumerator)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00359">message.h:359</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea8f8368df28c91ba1e51b3977a7ea8ac8">PL_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00048">payload.h:48</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a84a4d4c4aaa5e44bb2071bf98f050452_icgraph.svg" width="272" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a82035235fa4fecaba085ef1869910853"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> get_nonce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the nonce value found in the given message. Returns FALSE if none is found. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00794">794</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d4/d49/nonce__payload_8h_source.html#l00056">nonce_payload_t::get_nonce</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00376">message_t::get_payload</a>, <a class="el" href="../../d4/d8b/payload_8h_source.html#l00098">PLV1_NONCE</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00885">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;{</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="../../da/d6b/structnonce__payload__t.html">nonce_payload_t</a> *nonce;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    nonce = (<a class="code" href="../../da/d6b/structnonce__payload__t.html">nonce_payload_t</a>*)message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#adb93ba87d076213556e0b16efe62db1e">get_payload</a>(message, <a class="code" href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea89b1a51325b53a43d55b7ae36f9a8343">PLV1_NONCE</a>);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (nonce)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        *n = nonce-&gt;<a class="code" href="../../da/d6b/structnonce__payload__t.html#a1e47329b91a50a194cd7ae6ae3603279">get_nonce</a>(nonce);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structnonce__payload__t_html"><div class="ttname"><a href="../../da/d6b/structnonce__payload__t.html">nonce_payload_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d49/nonce__payload_8h_source.html#l00038">nonce_payload.h:38</a></div></div>
<div class="ttc" id="group__payload_html_gga910814947f5e241c851b42e95e8586eea89b1a51325b53a43d55b7ae36f9a8343"><div class="ttname"><a href="../../d0/d90/group__payload.html#gga910814947f5e241c851b42e95e8586eea89b1a51325b53a43d55b7ae36f9a8343">PLV1_NONCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/payload_8h_source.html#l00098">payload.h:98</a></div></div>
<div class="ttc" id="structmessage__t_html_adb93ba87d076213556e0b16efe62db1e"><div class="ttname"><a href="../../df/d23/structmessage__t.html#adb93ba87d076213556e0b16efe62db1e">message_t::get_payload</a></div><div class="ttdeci">payload_t *(* get_payload)(message_t *this, payload_type_t type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00376">message.h:376</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structnonce__payload__t_html_a1e47329b91a50a194cd7ae6ae3603279"><div class="ttname"><a href="../../da/d6b/structnonce__payload__t.html#a1e47329b91a50a194cd7ae6ae3603279">nonce_payload_t::get_nonce</a></div><div class="ttdeci">chunk_t(* get_nonce)(nonce_payload_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d49/nonce__payload_8h_source.html#l00056">nonce_payload.h:56</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a82035235fa4fecaba085ef1869910853_icgraph.svg" width="222" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="afe094700cf566dcd7c1d12883874e1e6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iv_data_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destroy an <a class="el" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> object. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00119">119</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01017">lookup_iv()</a>, and <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01121">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;this-&gt;last_block);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;this-&gt;iv);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_afe094700cf566dcd7c1d12883874e1e6_cgraph.svg" width="355" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_afe094700cf566dcd7c1d12883874e1e6_icgraph.svg" width="382" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="acf3f4b53c3b8091b4cda09d194182665"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d4/d55/structiv__data__t.html">iv_data_t</a>* lookup_iv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>mid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Try to find an IV for the given message ID, if not found, generate it. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01017">1017</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../da/dfc/test__enum_8c_source.html#l00156">found</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00985">generate_iv()</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00119">iv_data_destroy()</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00035">iv_data_t::mid</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01059">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;{</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <a class="code" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *iv, *<a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a> = NULL;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordflow">if</span> (mid == 0)</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        <span class="keywordflow">return</span> &amp;this-&gt;phase1_iv;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    enumerator = this-&gt;ivs-&gt;create_enumerator(this-&gt;ivs);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;iv))</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">if</span> (iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#aa83de1568a8714babced641c0de1f02e">mid</a> == mid)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        {   <span class="comment">/* IV gets moved to the front of the list */</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            this-&gt;ivs-&gt;remove_at(this-&gt;ivs, enumerator);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            found = iv;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">if</span> (!found)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(found,</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;            .mid = mid,</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        );</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d40/keymat__v1_8c.html#a1505b0f5a6dc3af207c42b48ea9e1803">generate_iv</a>(<span class="keyword">this</span>, found))</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            <a class="code" href="../../d7/d40/keymat__v1_8c.html#afe094700cf566dcd7c1d12883874e1e6">iv_data_destroy</a>(found);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    this-&gt;ivs-&gt;insert_first(this-&gt;ivs, found);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">/* remove least recently used IV if maximum reached */</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">if</span> (this-&gt;ivs-&gt;get_count(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a79440ad9970af9d302b09e60dcd26476">ivs</a>) &gt; this-&gt;max_exchanges &amp;&amp;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        this-&gt;ivs-&gt;remove_last(this-&gt;ivs, (<span class="keywordtype">void</span>**)&amp;iv) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <a class="code" href="../../d7/d40/keymat__v1_8c.html#afe094700cf566dcd7c1d12883874e1e6">iv_data_destroy</a>(iv);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;}</div>
<div class="ttc" id="test__enum_8c_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/test__enum_8c_source.html#l00156">test_enum.c:156</a></div></div>
<div class="ttc" id="structiv__data__t_html"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html">iv_data_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00033">keymat_v1.c:33</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_afe094700cf566dcd7c1d12883874e1e6"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#afe094700cf566dcd7c1d12883874e1e6">iv_data_destroy</a></div><div class="ttdeci">static void iv_data_destroy(iv_data_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00119">keymat_v1.c:119</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a1505b0f5a6dc3af207c42b48ea9e1803"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a1505b0f5a6dc3af207c42b48ea9e1803">generate_iv</a></div><div class="ttdeci">static bool generate_iv(private_keymat_v1_t *this, iv_data_t *iv)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00985">keymat_v1.c:985</a></div></div>
<div class="ttc" id="structiv__data__t_html_aa83de1568a8714babced641c0de1f02e"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html#aa83de1568a8714babced641c0de1f02e">iv_data_t::mid</a></div><div class="ttdeci">u_int32_t mid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00035">keymat_v1.c:35</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a79440ad9970af9d302b09e60dcd26476"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a79440ad9970af9d302b09e60dcd26476">private_keymat_v1_t::ivs</a></div><div class="ttdeci">linked_list_t * ivs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00101">keymat_v1.c:101</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_acf3f4b53c3b8091b4cda09d194182665_cgraph.svg" width="480" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_acf3f4b53c3b8091b4cda09d194182665_icgraph.svg" width="216" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa170aeaf1f891c2939206c5087bf8d3f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../da/dcf/structqm__data__t.html">qm_data_t</a>* lookup_quick_mode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>mid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Try to find data about a Quick Mode with the given message ID, if none is found, state is generated. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00853">853</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../da/dfc/test__enum_8c_source.html#l00156">found</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00131">qm_data_t::mid</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00141">qm_data_destroy()</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00885">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;{</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="../../da/dcf/structqm__data__t.html">qm_data_t</a> *qm, *<a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a> = NULL;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    enumerator = this-&gt;qms-&gt;create_enumerator(this-&gt;qms);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;qm))</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordflow">if</span> (qm-&gt;<a class="code" href="../../da/dcf/structqm__data__t.html#a6ee52f9b8ea837a7159aa4d3c4ec14e5">mid</a> == mid)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        {   <span class="comment">/* state gets moved to the front of the list */</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            this-&gt;qms-&gt;remove_at(this-&gt;qms, enumerator);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            found = qm;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">if</span> (!found)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(found,</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            .mid = mid,</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        );</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    this-&gt;qms-&gt;insert_first(this-&gt;qms, found);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="comment">/* remove least recently used state if maximum reached */</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="keywordflow">if</span> (this-&gt;qms-&gt;get_count(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a00aa332ccf3c4a519f0e643b04591c35">qms</a>) &gt; this-&gt;max_exchanges &amp;&amp;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        this-&gt;qms-&gt;remove_last(this-&gt;qms, (<span class="keywordtype">void</span>**)&amp;qm) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <a class="code" href="../../d7/d40/keymat__v1_8c.html#ab6b2166164c7e1d3af19de6c8d6ed253">qm_data_destroy</a>(qm);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div>
<div class="ttc" id="test__enum_8c_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/test__enum_8c_source.html#l00156">test_enum.c:156</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a00aa332ccf3c4a519f0e643b04591c35"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a00aa332ccf3c4a519f0e643b04591c35">private_keymat_v1_t::qms</a></div><div class="ttdeci">linked_list_t * qms</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00107">keymat_v1.c:107</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structqm__data__t_html"><div class="ttname"><a href="../../da/dcf/structqm__data__t.html">qm_data_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00129">keymat_v1.c:129</a></div></div>
<div class="ttc" id="structqm__data__t_html_a6ee52f9b8ea837a7159aa4d3c4ec14e5"><div class="ttname"><a href="../../da/dcf/structqm__data__t.html#a6ee52f9b8ea837a7159aa4d3c4ec14e5">qm_data_t::mid</a></div><div class="ttdeci">u_int32_t mid</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00131">keymat_v1.c:131</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_ab6b2166164c7e1d3af19de6c8d6ed253"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#ab6b2166164c7e1d3af19de6c8d6ed253">qm_data_destroy</a></div><div class="ttdeci">static void qm_data_destroy(qm_data_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00141">keymat_v1.c:141</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_aa170aeaf1f891c2939206c5087bf8d3f_cgraph.svg" width="550" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_aa170aeaf1f891c2939206c5087bf8d3f_icgraph.svg" width="278" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae083f22e344d62567db127475c50c7cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/da7/pkcs7_8c.html#a2c48115da6e8d8b77bbe4a1d50d8e329">encrypt</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>plain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>encrypted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00166">166</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">crypter</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>-&gt;encrypt(this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>, plain, iv, encrypted);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
<div class="ttc" id="test__vectors__plugin_8c_html_a4b2bd9f7f0c714298079749a4b3d29c4"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a></div><div class="ttdeci">static crypter_test_vector_t * crypter[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">test_vectors_plugin.c:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a198deff362868318635e80df1e08f122"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d5d/load__creds_8c.html#a1873eb038b74c2a08385fbd0e6d7a59a">decrypt</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>encrypted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>assoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>plain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00173">173</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">crypter</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>-&gt;decrypt(this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>, encrypted, iv, plain);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="ttc" id="test__vectors__plugin_8c_html_a4b2bd9f7f0c714298079749a4b3d29c4"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a></div><div class="ttdeci">static crypter_test_vector_t * crypter[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">test_vectors_plugin.c:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae73f2e449d4e055688cfb59deeec914c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_block_size&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00180">180</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">crypter</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>-&gt;get_block_size(this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="ttc" id="test__vectors__plugin_8c_html_a4b2bd9f7f0c714298079749a4b3d29c4"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a></div><div class="ttdeci">static crypter_test_vector_t * crypter[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">test_vectors_plugin.c:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51d688a77827270504dd9f0b64084bb3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_icv_size&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00186">186</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a688debfa1c96fdae0d14b35248004b19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_iv_size&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00192">192</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">/* in order to create the messages properly we return 0 here */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a93fa38cebe5eab30fae8292c7ba54ae6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_iv_gen&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d66/structiv__gen__t.html">iv_gen_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00199">199</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">/* IVs are retrieved via keymat_v1.get_iv() */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa45a210a6c3783f945dc74a7375bd744"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_key_size&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00206">206</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">crypter</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>-&gt;get_key_size(this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="ttc" id="test__vectors__plugin_8c_html_a4b2bd9f7f0c714298079749a4b3d29c4"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a></div><div class="ttdeci">static crypter_test_vector_t * crypter[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">test_vectors_plugin.c:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad5026cc86e7055972be5b942baa62152"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">set_key&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00212">212</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">crypter</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>-&gt;set_key(this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>, key);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="ttc" id="test__vectors__plugin_8c_html_a4b2bd9f7f0c714298079749a4b3d29c4"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a></div><div class="ttdeci">static crypter_test_vector_t * crypter[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">test_vectors_plugin.c:51</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a096e34fed72ec9c5ada5a0ba20b74515"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">aead_destroy&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d1b/structprivate__aead__t.html">private_aead_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00218">218</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">crypter</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>-&gt;destroy(this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="test__vectors__plugin_8c_html_a4b2bd9f7f0c714298079749a4b3d29c4"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#a4b2bd9f7f0c714298079749a4b3d29c4">crypter</a></div><div class="ttdeci">static crypter_test_vector_t * crypter[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00051">test_vectors_plugin.c:51</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a096e34fed72ec9c5ada5a0ba20b74515_cgraph.svg" width="184" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1a96c477976ba2a8f1847b170cdf07a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">derive_ike_keys&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *&#160;</td>
          <td class="paramname"><em>proposal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *&#160;</td>
          <td class="paramname"><em>dh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>dh_other</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>nonce_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>nonce_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5b/group__authenticator.html#ga8071dc90e8e461c4be73b26588aead90">auth_method_t</a>&#160;</td>
          <td class="paramname"><em>auth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d7c/structshared__key__t.html">shared_key_t</a> *&#160;</td>
          <td class="paramname"><em>shared_key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00389">389</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00373">adjust_keylen()</a>, <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../d1/d99/test__ntru_8c_source.html#l00030">alg</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00065">AUTH_ECDSA_256</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00070">AUTH_ECDSA_384</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00075">AUTH_ECDSA_521</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00115">AUTH_HYBRID_INIT_RSA</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00120">AUTH_HYBRID_RESP_RSA</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00054">AUTH_PSK</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00047">AUTH_RSA</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00327">auth_to_prf()</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00095">AUTH_XAUTH_INIT_PSK</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00105">AUTH_XAUTH_INIT_RSA</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00100">AUTH_XAUTH_RESP_PSK</a>, <a class="el" href="../../d8/d06/authenticator_8h_source.html#l00110">AUTH_XAUTH_RESP_RSA</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00246">chunk_alloca</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00261">chunk_cat</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00266">chunk_cata</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00214">chunk_clear()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00272">create_aead()</a>, <a class="el" href="../../d4/d1b/crypto__factory_8h_source.html#l00133">crypto_factory_t::create_prf</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00175">library_t::crypto</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00062">DBG4</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00040">DBG_IKE</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00101">proposal_t::get_algorithm</a>, <a class="el" href="../../de/dcf/aead_8h_source.html#l00079">aead_t::get_block_size</a>, <a class="el" href="../../d8/ddd/shared__key_8h_source.html#l00073">shared_key_t::get_key</a>, <a class="el" href="../../d7/dfb/diffie__hellman_8h_source.html#l00116">diffie_hellman_t::get_my_public_value</a>, <a class="el" href="../../d7/dfb/diffie__hellman_8h_source.html#l00094">diffie_hellman_t::get_shared_secret</a>, <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">hasher</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00053">initiator</a>, <a class="el" href="../../d2/d80/transform_8h_source.html#l00039">INTEGRITY_ALGORITHM</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00399">prf</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00046">PRF_HMAC_SHA2_256</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00048">PRF_HMAC_SHA2_384</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00050">PRF_HMAC_SHA2_512</a>, <a class="el" href="../../dc/d91/prf_8h_source.html#l00036">PRF_UNDEFINED</a>, <a class="el" href="../../d2/d80/transform_8h_source.html#l00038">PSEUDO_RANDOM_FUNCTION</a>, <a class="el" href="../../d4/d49/group__prf.html#gaa7922db646019a93c38251d20573802c">pseudo_random_function_names</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> g_xy, g_xi, g_xr, dh_me, spi_i, spi_r, nonces, <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>, skeyid_e;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> skeyid;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    u_int16_t <a class="code" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    spi_i = <a class="code" href="../../d4/d87/group__chunk.html#ga18018c843b9db59f3e74e052e9eb95ae">chunk_alloca</a>(<span class="keyword">sizeof</span>(u_int64_t));</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    spi_r = <a class="code" href="../../d4/d87/group__chunk.html#ga18018c843b9db59f3e74e052e9eb95ae">chunk_alloca</a>(<span class="keyword">sizeof</span>(u_int64_t));</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> (!proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">get_algorithm</a>(proposal, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a9567bdabdbada3ce18a1f8a66772a517">PSEUDO_RANDOM_FUNCTION</a>, &amp;alg, NULL))</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    {   <span class="comment">/* no PRF negotiated, use HMAC version of integrity algorithm instead */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">if</span> (!proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">get_algorithm</a>(proposal, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54">INTEGRITY_ALGORITHM</a>, &amp;alg, NULL)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            || (alg = <a class="code" href="../../d7/d40/keymat__v1_8c.html#a2c555548623565605406836f0d338864">auth_to_prf</a>(alg)) == <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a40d0cd75116f68a7f2716afcc11f2f0c">PRF_UNDEFINED</a>)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;no %N selected&quot;</span>,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                 <a class="code" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a9567bdabdbada3ce18a1f8a66772a517">PSEUDO_RANDOM_FUNCTION</a>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a> = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>-&gt;<a class="code" href="../../dc/d84/structcrypto__factory__t.html#a550fe0f090adb63620bb9e2e1279355b">create_prf</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>, alg);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;%N %N not supported!&quot;</span>,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;             <a class="code" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a9567bdabdbada3ce18a1f8a66772a517">PSEUDO_RANDOM_FUNCTION</a>,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;             <a class="code" href="../../d4/d49/group__prf.html#gaa7922db646019a93c38251d20573802c">pseudo_random_function_names</a>, alg);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;get_block_size(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>) &lt;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;get_key_size(this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>))</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    {   <span class="comment">/* TODO-IKEv1: support PRF output expansion (RFC 2409, Appendix B) */</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;expansion of %N %N output not supported!&quot;</span>,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;             <a class="code" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a9567bdabdbada3ce18a1f8a66772a517">PSEUDO_RANDOM_FUNCTION</a>,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;             <a class="code" href="../../d4/d49/group__prf.html#gaa7922db646019a93c38251d20573802c">pseudo_random_function_names</a>, alg);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (!dh-&gt;<a class="code" href="../../d1/dd3/structdiffie__hellman__t.html#a3437ff996a19791fad70b48ff5b8bc6a">get_shared_secret</a>(dh, &amp;g_xy))</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;shared Diffie Hellman secret %B&quot;</span>, &amp;g_xy);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    *((u_int64_t*)spi_i.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>) = <span class="keywordtype">id</span>-&gt;get_initiator_spi(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    *((u_int64_t*)spi_r.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>) = <span class="keywordtype">id</span>-&gt;get_responder_spi(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    nonces = <a class="code" href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a>(<span class="stringliteral">&quot;cc&quot;</span>, nonce_i, nonce_r);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">switch</span> (auth)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a839bb197fc5e86e7415409d81096dd4b">AUTH_PSK</a>:</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ad927eba4e2ea6523aacf43005c0cc7d5">AUTH_XAUTH_INIT_PSK</a>:</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90aeb0ed86ca621bbeb0e844ba07f1cd5d8">AUTH_XAUTH_RESP_PSK</a>:</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        {   <span class="comment">/* SKEYID = prf(pre-shared-key, Ni_b | Nr_b) */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> psk;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">if</span> (!shared_key)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;g_xy);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            psk = shared_key-&gt;<a class="code" href="../../d7/d7c/structshared__key__t.html#a92c645b5f252d01c94e6f45def57bddc">get_key</a>(shared_key);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <a class="code" href="../../d7/d40/keymat__v1_8c.html#a3e75003d6c32bcf616b964d47ef4ac32">adjust_keylen</a>(alg, &amp;psk);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;set_key(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, psk) ||</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                !this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;allocate_bytes(this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>, nonces, &amp;skeyid))</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;g_xy);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a0e5f2e6eab39c2b2c26744c5b1e03001">AUTH_RSA</a>:</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a73d600a6358950a491ac663f9bebeaa5">AUTH_ECDSA_256</a>:</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ab0f8ea54fc58273db704e4f659332d5e">AUTH_ECDSA_384</a>:</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a58f2195538455c7f2cd21fdd8f24d344">AUTH_ECDSA_521</a>:</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a26990cf70271f7c90735d59224104541">AUTH_XAUTH_INIT_RSA</a>:</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ae54a20cfe956325ebfbb96b9e6284888">AUTH_XAUTH_RESP_RSA</a>:</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ac3065f02195548ca710bd3c981cc59a8">AUTH_HYBRID_INIT_RSA</a>:</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a6c049cfd056e8bd778969bd6e04d85bc">AUTH_HYBRID_RESP_RSA</a>:</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;set_key(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, nonces) ||</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                !this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;allocate_bytes(this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>, g_xy, &amp;skeyid))</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;g_xy);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="comment">/* TODO-IKEv1: implement key derivation for other schemes */</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="comment">/* authentication class not supported */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;g_xy);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="../../d7/d40/keymat__v1_8c.html#a3e75003d6c32bcf616b964d47ef4ac32">adjust_keylen</a>(alg, &amp;skeyid);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;SKEYID %B&quot;</span>, &amp;skeyid);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">/* SKEYID_d = prf(SKEYID, g^xy | CKY-I | CKY-R | 0) */</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    data = <a class="code" href="../../d4/d87/group__chunk.html#gad723f169b8d64447e1574a9fab914d4f">chunk_cat</a>(<span class="stringliteral">&quot;cccc&quot;</span>, g_xy, spi_i, spi_r, <a class="code" href="../../d7/d40/keymat__v1_8c.html#a497b5fdd9da714ef02eed7792d7130f9">octet_0</a>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;set_key(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, skeyid) ||</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        !this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;allocate_bytes(this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>, data, &amp;this-&gt;skeyid_d))</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;g_xy);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;data);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;data);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;SKEYID_d %B&quot;</span>, &amp;this-&gt;skeyid_d);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">/* SKEYID_a = prf(SKEYID, SKEYID_d | g^xy | CKY-I | CKY-R | 1) */</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    data = <a class="code" href="../../d4/d87/group__chunk.html#gad723f169b8d64447e1574a9fab914d4f">chunk_cat</a>(<span class="stringliteral">&quot;ccccc&quot;</span>, this-&gt;skeyid_d, g_xy, spi_i, spi_r, <a class="code" href="../../d7/d40/keymat__v1_8c.html#a668140d391d9a28ec257ac5fd9b1a8ca">octet_1</a>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;allocate_bytes(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, data, &amp;this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#af39c980ecad01e1467f24f084c448cf2">skeyid_a</a>))</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;g_xy);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;data);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;data);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;SKEYID_a %B&quot;</span>, &amp;this-&gt;skeyid_a);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">/* SKEYID_e = prf(SKEYID, SKEYID_a | g^xy | CKY-I | CKY-R | 2) */</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    data = <a class="code" href="../../d4/d87/group__chunk.html#gad723f169b8d64447e1574a9fab914d4f">chunk_cat</a>(<span class="stringliteral">&quot;ccccc&quot;</span>, this-&gt;skeyid_a, g_xy, spi_i, spi_r, <a class="code" href="../../d7/d40/keymat__v1_8c.html#a348490e6e1dad0ee07485fa18c45aa63">octet_2</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;allocate_bytes(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, data, &amp;skeyid_e))</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;g_xy);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;data);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;data);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;SKEYID_e %B&quot;</span>, &amp;skeyid_e);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;g_xy);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">switch</span> (auth)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a73d600a6358950a491ac663f9bebeaa5">AUTH_ECDSA_256</a>:</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            alg = <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a49e4fdb8e8f64c1adb8d0e600450bad9">PRF_HMAC_SHA2_256</a>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ab0f8ea54fc58273db704e4f659332d5e">AUTH_ECDSA_384</a>:</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            alg =  <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a374578f25f7b76d75029bc81628f20be">PRF_HMAC_SHA2_384</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a58f2195538455c7f2cd21fdd8f24d344">AUTH_ECDSA_521</a>:</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            alg = <a class="code" href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4aec9df4f8e31029dfc194ea4a8a93ae45">PRF_HMAC_SHA2_512</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="comment">/* use proposal algorithm */</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    this-&gt;prf_auth = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>-&gt;<a class="code" href="../../dc/d84/structcrypto__factory__t.html#a550fe0f090adb63620bb9e2e1279355b">create_prf</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>, alg);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;prf_auth)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;%N %N not supported!&quot;</span>,</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;             <a class="code" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a9567bdabdbada3ce18a1f8a66772a517">PSEUDO_RANDOM_FUNCTION</a>,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;             <a class="code" href="../../d4/d49/group__prf.html#gaa7922db646019a93c38251d20573802c">pseudo_random_function_names</a>, alg);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;skeyid);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;prf_auth-&gt;set_key(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7f0b5e538dce4b19db09e9e624e4bfd3">prf_auth</a>, skeyid))</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;skeyid);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;skeyid);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a> = <a class="code" href="../../d7/d40/keymat__v1_8c.html#a54e5b5dd4f7d72c9d4a3ee0403c899dd">create_aead</a>(proposal, this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>, skeyid_e);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a> &amp;&amp; !this-&gt;<span class="keyword">public</span>.create_hasher(&amp;this-&gt;<span class="keyword">public</span>, proposal))</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">if</span> (!dh-&gt;<a class="code" href="../../d1/dd3/structdiffie__hellman__t.html#a8ed33608c6299c14774597bf1ff77d37">get_my_public_value</a>(dh, &amp;dh_me))</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    g_xi = this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a> ? dh_me : dh_other;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    g_xr = this-&gt;<a class="code" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a> ? dh_other : dh_me;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">/* initial IV = hash(g^xi | g^xr) */</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    data = <a class="code" href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a>(<span class="stringliteral">&quot;cc&quot;</span>, g_xi, g_xr);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;dh_me);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a>-&gt;allocate_hash(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7b80ec38f8b8d69011997f019187be32">hasher</a>, data, &amp;this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a09184860a4160c3277842fe386b7a38c">phase1_iv</a>.<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a>))</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">if</span> (this-&gt;phase1_iv.iv.len &gt; this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#ad0d873809abc655af8c1edfe99607e91">aead</a>-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">get_block_size</a>(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#ad0d873809abc655af8c1edfe99607e91">aead</a>))</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        this-&gt;phase1_iv.iv.len = this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>-&gt;<a class="code" href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">get_block_size</a>(this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;initial IV %B&quot;</span>, &amp;this-&gt;phase1_iv.iv);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
<div class="ttc" id="test__ntru_8c_html_a84a3aa4b7b5103ec0c08b032954762f7"><div class="ttname"><a href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a></div><div class="ttdeci">ntru_trits_t size_t hash_algorithm_t alg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/test__ntru_8c_source.html#l00030">test_ntru.c:30</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a7f0b5e538dce4b19db09e9e624e4bfd3"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a7f0b5e538dce4b19db09e9e624e4bfd3">private_keymat_v1_t::prf_auth</a></div><div class="ttdeci">prf_t * prf_auth</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00065">keymat_v1.c:65</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90ab0f8ea54fc58273db704e4f659332d5e"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ab0f8ea54fc58273db704e4f659332d5e">AUTH_ECDSA_384</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00070">authenticator.h:70</a></div></div>
<div class="ttc" id="group__transforms_html_ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54"><div class="ttname"><a href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54">INTEGRITY_ALGORITHM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/transform_8h_source.html#l00039">transform.h:39</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a54e5b5dd4f7d72c9d4a3ee0403c899dd"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a54e5b5dd4f7d72c9d4a3ee0403c899dd">create_aead</a></div><div class="ttdeci">static aead_t * create_aead(proposal_t *proposal, prf_t *prf, chunk_t skeyid_e)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00272">keymat_v1.c:272</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a2c555548623565605406836f0d338864"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a2c555548623565605406836f0d338864">auth_to_prf</a></div><div class="ttdeci">static u_int16_t auth_to_prf(u_int16_t alg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00327">keymat_v1.c:327</a></div></div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="group__bus_html_gac40b89ec47e2bdcb2975e5c39cf88ae2"><div class="ttname"><a href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a></div><div class="ttdeci">#define DBG4(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00062">bus.h:62</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_af39c980ecad01e1467f24f084c448cf2"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#af39c980ecad01e1467f24f084c448cf2">private_keymat_v1_t::skeyid_a</a></div><div class="ttdeci">chunk_t skeyid_a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00090">keymat_v1.c:90</a></div></div>
<div class="ttc" id="proposal_8c_html_ada5439c5fb09c27a3e238beaafc7b4aa"><div class="ttname"><a href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a></div><div class="ttdeci">pseudo_random_function_t prf</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00399">proposal.c:399</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00040">debug.h:40</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a668140d391d9a28ec257ac5fd9b1a8ca"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a668140d391d9a28ec257ac5fd9b1a8ca">octet_1</a></div><div class="ttdeci">static const chunk_t octet_1</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00152">keymat_v1.c:152</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4aec9df4f8e31029dfc194ea4a8a93ae45"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4aec9df4f8e31029dfc194ea4a8a93ae45">PRF_HMAC_SHA2_512</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00050">prf.h:50</a></div></div>
<div class="ttc" id="structlibrary__t_html_a5a2856cda49e43c861c78afef49170f4"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">library_t::crypto</a></div><div class="ttdeci">crypto_factory_t * crypto</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00175">library.h:175</a></div></div>
<div class="ttc" id="group__transforms_html_gaec05291e1bb587c914675a506e7646cf"><div class="ttname"><a href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a></div><div class="ttdeci">enum_name_t * transform_type_names</div></div>
<div class="ttc" id="structproposal__t_html_af57106973fbeb17aec8819da876280b3"><div class="ttname"><a href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">proposal_t::get_algorithm</a></div><div class="ttdeci">bool(* get_algorithm)(proposal_t *this, transform_type_t type, u_int16_t *alg, u_int16_t *key_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00101">proposal.h:101</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a497b5fdd9da714ef02eed7792d7130f9"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a497b5fdd9da714ef02eed7792d7130f9">octet_0</a></div><div class="ttdeci">static const chunk_t octet_0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00151">keymat_v1.c:151</a></div></div>
<div class="ttc" id="group__chunk_html_gaaa5a9811df1bd2ae5e331748f7fbaf75"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a></div><div class="ttdeci">static void chunk_clear(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00214">chunk.h:214</a></div></div>
<div class="ttc" id="group__chunk_html_gad723f169b8d64447e1574a9fab914d4f"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad723f169b8d64447e1574a9fab914d4f">chunk_cat</a></div><div class="ttdeci">#define chunk_cat(mode,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00261">chunk.h:261</a></div></div>
<div class="ttc" id="structshared__key__t_html_a92c645b5f252d01c94e6f45def57bddc"><div class="ttname"><a href="../../d7/d7c/structshared__key__t.html#a92c645b5f252d01c94e6f45def57bddc">shared_key_t::get_key</a></div><div class="ttdeci">chunk_t(* get_key)(shared_key_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddd/shared__key_8h_source.html#l00073">shared_key.h:73</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structaead__t_html_ae6004b22fa9415839f9c0b6e16e48ae6"><div class="ttname"><a href="../../d7/d7d/structaead__t.html#ae6004b22fa9415839f9c0b6e16e48ae6">aead_t::get_block_size</a></div><div class="ttdeci">size_t(* get_block_size)(aead_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcf/aead_8h_source.html#l00079">aead.h:79</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="structdiffie__hellman__t_html_a3437ff996a19791fad70b48ff5b8bc6a"><div class="ttname"><a href="../../d1/dd3/structdiffie__hellman__t.html#a3437ff996a19791fad70b48ff5b8bc6a">diffie_hellman_t::get_shared_secret</a></div><div class="ttdeci">bool(* get_shared_secret)(diffie_hellman_t *this, chunk_t *secret) __attribute__((warn_unused_result))</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dfb/diffie__hellman_8h_source.html#l00094">diffie_hellman.h:94</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90a73d600a6358950a491ac663f9bebeaa5"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a73d600a6358950a491ac663f9bebeaa5">AUTH_ECDSA_256</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00065">authenticator.h:65</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90a26990cf70271f7c90735d59224104541"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a26990cf70271f7c90735d59224104541">AUTH_XAUTH_INIT_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00105">authenticator.h:105</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90a58f2195538455c7f2cd21fdd8f24d344"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a58f2195538455c7f2cd21fdd8f24d344">AUTH_ECDSA_521</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00075">authenticator.h:75</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90ae54a20cfe956325ebfbb96b9e6284888"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ae54a20cfe956325ebfbb96b9e6284888">AUTH_XAUTH_RESP_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00110">authenticator.h:110</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a3e75003d6c32bcf616b964d47ef4ac32"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a3e75003d6c32bcf616b964d47ef4ac32">adjust_keylen</a></div><div class="ttdeci">static void adjust_keylen(u_int16_t alg, chunk_t *key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00373">keymat_v1.c:373</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a09184860a4160c3277842fe386b7a38c"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a09184860a4160c3277842fe386b7a38c">private_keymat_v1_t::phase1_iv</a></div><div class="ttdeci">iv_data_t phase1_iv</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00095">keymat_v1.c:95</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90ad927eba4e2ea6523aacf43005c0cc7d5"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ad927eba4e2ea6523aacf43005c0cc7d5">AUTH_XAUTH_INIT_PSK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00095">authenticator.h:95</a></div></div>
<div class="ttc" id="structcrypto__factory__t_html_a550fe0f090adb63620bb9e2e1279355b"><div class="ttname"><a href="../../dc/d84/structcrypto__factory__t.html#a550fe0f090adb63620bb9e2e1279355b">crypto_factory_t::create_prf</a></div><div class="ttdeci">prf_t *(* create_prf)(crypto_factory_t *this, pseudo_random_function_t algo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/crypto__factory_8h_source.html#l00133">crypto_factory.h:133</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4a374578f25f7b76d75029bc81628f20be"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a374578f25f7b76d75029bc81628f20be">PRF_HMAC_SHA2_384</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00048">prf.h:48</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4a40d0cd75116f68a7f2716afcc11f2f0c"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a40d0cd75116f68a7f2716afcc11f2f0c">PRF_UNDEFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00036">prf.h:36</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90a0e5f2e6eab39c2b2c26744c5b1e03001"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a0e5f2e6eab39c2b2c26744c5b1e03001">AUTH_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00047">authenticator.h:47</a></div></div>
<div class="ttc" id="group__prf_html_gga44165ddd081f606d3a926685dd4aa5f4a49e4fdb8e8f64c1adb8d0e600450bad9"><div class="ttname"><a href="../../d4/d49/group__prf.html#gga44165ddd081f606d3a926685dd4aa5f4a49e4fdb8e8f64c1adb8d0e600450bad9">PRF_HMAC_SHA2_256</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d91/prf_8h_source.html#l00046">prf.h:46</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_ad0d873809abc655af8c1edfe99607e91"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#ad0d873809abc655af8c1edfe99607e91">private_keymat_v1_t::aead</a></div><div class="ttdeci">aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00070">keymat_v1.c:70</a></div></div>
<div class="ttc" id="group__chunk_html_ga18018c843b9db59f3e74e052e9eb95ae"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga18018c843b9db59f3e74e052e9eb95ae">chunk_alloca</a></div><div class="ttdeci">#define chunk_alloca(bytes)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00246">chunk.h:246</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90a6c049cfd056e8bd778969bd6e04d85bc"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a6c049cfd056e8bd778969bd6e04d85bc">AUTH_HYBRID_RESP_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00120">authenticator.h:120</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a348490e6e1dad0ee07485fa18c45aa63"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a348490e6e1dad0ee07485fa18c45aa63">octet_2</a></div><div class="ttdeci">static const chunk_t octet_2</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00153">keymat_v1.c:153</a></div></div>
<div class="ttc" id="ha__message_8c_html_a4345dfbca89c2653de8f69f577b25168"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a></div><div class="ttdeci">u_int8_t initiator</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00053">ha_message.c:53</a></div></div>
<div class="ttc" id="structdiffie__hellman__t_html_a8ed33608c6299c14774597bf1ff77d37"><div class="ttname"><a href="../../d1/dd3/structdiffie__hellman__t.html#a8ed33608c6299c14774597bf1ff77d37">diffie_hellman_t::get_my_public_value</a></div><div class="ttdeci">bool(* get_my_public_value)(diffie_hellman_t *this, chunk_t *value) __attribute__((warn_unused_result))</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dfb/diffie__hellman_8h_source.html#l00116">diffie_hellman.h:116</a></div></div>
<div class="ttc" id="group__transforms_html_ggaf335c7940ad619e477cffde4ffb66378a9567bdabdbada3ce18a1f8a66772a517"><div class="ttname"><a href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a9567bdabdbada3ce18a1f8a66772a517">PSEUDO_RANDOM_FUNCTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/transform_8h_source.html#l00038">transform.h:38</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a7ea23d0321fbb4a90fd434a26547c31b"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">private_keymat_v1_t::prf</a></div><div class="ttdeci">prf_t * prf</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00060">keymat_v1.c:60</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90aeb0ed86ca621bbeb0e844ba07f1cd5d8"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90aeb0ed86ca621bbeb0e844ba07f1cd5d8">AUTH_XAUTH_RESP_PSK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00100">authenticator.h:100</a></div></div>
<div class="ttc" id="group__prf_html_gaa7922db646019a93c38251d20573802c"><div class="ttname"><a href="../../d4/d49/group__prf.html#gaa7922db646019a93c38251d20573802c">pseudo_random_function_names</a></div><div class="ttdeci">enum_name_t * pseudo_random_function_names</div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a7b80ec38f8b8d69011997f019187be32"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a7b80ec38f8b8d69011997f019187be32">private_keymat_v1_t::hasher</a></div><div class="ttdeci">hasher_t * hasher</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00075">keymat_v1.c:75</a></div></div>
<div class="ttc" id="test__vectors__plugin_8c_html_ae7573e55432c43da12a6f6722230496a"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a></div><div class="ttdeci">static hasher_test_vector_t * hasher[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">test_vectors_plugin.c:75</a></div></div>
<div class="ttc" id="structiv__data__t_html_ac89b1703237fdc6a687ee5bd293d5999"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv_data_t::iv</a></div><div class="ttdeci">chunk_t iv</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00037">keymat_v1.c:37</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90a839bb197fc5e86e7415409d81096dd4b"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90a839bb197fc5e86e7415409d81096dd4b">AUTH_PSK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00054">authenticator.h:54</a></div></div>
<div class="ttc" id="group__authenticator_html_gga8071dc90e8e461c4be73b26588aead90ac3065f02195548ca710bd3c981cc59a8"><div class="ttname"><a href="../../da/d5b/group__authenticator.html#gga8071dc90e8e461c4be73b26588aead90ac3065f02195548ca710bd3c981cc59a8">AUTH_HYBRID_INIT_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d06/authenticator_8h_source.html#l00115">authenticator.h:115</a></div></div>
<div class="ttc" id="group__chunk_html_ga8336eaa6a6255475fca1b09ec41ebb2e"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a></div><div class="ttdeci">#define chunk_cata(mode,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00266">chunk.h:266</a></div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a1a96c477976ba2a8f1847b170cdf07a6_cgraph.svg" width="100%" height="518"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a984d4be5b42587865e64ebcf78b08d01"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">derive_child_keys&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *&#160;</td>
          <td class="paramname"><em>proposal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *&#160;</td>
          <td class="paramname"><em>dh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>spi_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>spi_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>nonce_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>nonce_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>encr_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>integ_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>encr_r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>integ_r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00586">586</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d9/d46/prf__plus_8h_source.html#l00051">prf_plus_t::allocate_bytes</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00266">chunk_cata</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00214">chunk_clear()</a>, <a class="el" href="../../d8/d39/chunk_8c_source.html#l00035">chunk_empty</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00062">DBG4</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00042">DBG_CHD</a>, <a class="el" href="../../d9/d46/prf__plus_8h_source.html#l00057">prf_plus_t::destroy</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00048">ENCR_AES_CCM_ICV12</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00049">ENCR_AES_CCM_ICV16</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00047">ENCR_AES_CCM_ICV8</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00046">ENCR_AES_CTR</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00051">ENCR_AES_GCM_ICV12</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00052">ENCR_AES_GCM_ICV16</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00050">ENCR_AES_GCM_ICV8</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00058">ENCR_CAMELLIA_CCM_ICV12</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00059">ENCR_CAMELLIA_CCM_ICV16</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00057">ENCR_CAMELLIA_CCM_ICV8</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00043">ENCR_NULL</a>, <a class="el" href="../../df/d1f/crypter_8h_source.html#l00053">ENCR_NULL_AUTH_AES_GMAC</a>, <a class="el" href="../../d2/d80/transform_8h_source.html#l00037">ENCRYPTION_ALGORITHM</a>, <a class="el" href="../../d9/dc7/group__crypter.html#ga1f793f538b45c8126012219e21d332f0">encryption_algorithm_names</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00101">proposal_t::get_algorithm</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00137">proposal_t::get_protocol</a>, <a class="el" href="../../d7/dfb/diffie__hellman_8h_source.html#l00094">diffie_hellman_t::get_shared_secret</a>, <a class="el" href="../../d2/d80/transform_8h_source.html#l00039">INTEGRITY_ALGORITHM</a>, <a class="el" href="../../de/dfc/group__signer.html#gac6f2a944da6f8eb29e5e2b116b160d59">integrity_algorithm_names</a>, <a class="el" href="../../db/d9e/keymat_8c_source.html#l00063">keymat_get_keylen_encr()</a>, <a class="el" href="../../db/d9e/keymat_8c_source.html#l00084">keymat_get_keylen_integ()</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00399">prf</a>, <a class="el" href="../../d2/df2/prf__plus_8c_source.html#l00126">prf_plus_create()</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00051">protocol</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;{</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    u_int16_t enc_alg, int_alg, enc_size = 0, int_size = 0;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    u_int8_t <a class="code" href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="../../d3/d2e/structprf__plus__t.html">prf_plus_t</a> *prf_plus;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> seed, secret = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">bool</span> success = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">get_algorithm</a>(proposal, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a4b9161a6fc3dc335f20693a1d6ac6f25">ENCRYPTION_ALGORITHM</a>,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                &amp;enc_alg, &amp;enc_size))</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;  using %N for encryption&quot;</span>,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;             <a class="code" href="../../d9/dc7/group__crypter.html#ga1f793f538b45c8126012219e21d332f0">encryption_algorithm_names</a>, enc_alg);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">if</span> (!enc_size)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            enc_size = <a class="code" href="../../d0/d36/group__keymat.html#ga05ae4f2c33e097e842edaf0702e90f1b">keymat_get_keylen_encr</a>(enc_alg);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">if</span> (enc_alg != <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a176409eef9265a5979bffffc4aafc51d">ENCR_NULL</a> &amp;&amp; !enc_size)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;no keylength defined for %N&quot;</span>,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                 <a class="code" href="../../d9/dc7/group__crypter.html#ga1f793f538b45c8126012219e21d332f0">encryption_algorithm_names</a>, enc_alg);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">/* to bytes */</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        enc_size /= 8;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">/* CCM/GCM/CTR/GMAC needs additional bytes */</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">switch</span> (enc_alg)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a8f9a70f1926895cf141e2b8efef2e7ac">ENCR_AES_CCM_ICV8</a>:</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a7f178b219b8ac85d09b62e17fbf35d43">ENCR_AES_CCM_ICV12</a>:</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a6d182449ed40134d753869d452100393">ENCR_AES_CCM_ICV16</a>:</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a51883e9daa35e736fb5d9ea5d541981f">ENCR_CAMELLIA_CCM_ICV8</a>:</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a2e427a4bb014e0cae017b8194101f75c">ENCR_CAMELLIA_CCM_ICV12</a>:</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9aa8cb05edf58656ed046ff498e01b5182">ENCR_CAMELLIA_CCM_ICV16</a>:</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                enc_size += 3;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9af2c70838e683814c510513ea9029e975">ENCR_AES_GCM_ICV8</a>:</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a9bc1dd0400975be049bc46c09a4d0cf3">ENCR_AES_GCM_ICV12</a>:</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9ac1e15c244f5ec1821ff7a1de36b581e4">ENCR_AES_GCM_ICV16</a>:</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9abd81cda784c48eddd7575ae6d8e63fbf">ENCR_AES_CTR</a>:</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a04496ee51a7396b25d18e149bbabb4ea">ENCR_NULL_AUTH_AES_GMAC</a>:</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                enc_size += 4;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">if</span> (proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">get_algorithm</a>(proposal, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54">INTEGRITY_ALGORITHM</a>,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                &amp;int_alg, &amp;int_size))</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;  using %N for integrity&quot;</span>,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;             <a class="code" href="../../de/dfc/group__signer.html#gac6f2a944da6f8eb29e5e2b116b160d59">integrity_algorithm_names</a>, int_alg);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">if</span> (!int_size)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            int_size = <a class="code" href="../../d0/d36/group__keymat.html#gadbc7243847bc6d2afa1c90c325979e9a">keymat_get_keylen_integ</a>(int_alg);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">if</span> (!int_size)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;no keylength defined for %N&quot;</span>,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                 <a class="code" href="../../de/dfc/group__signer.html#gac6f2a944da6f8eb29e5e2b116b160d59">integrity_algorithm_names</a>, int_alg);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="comment">/* to bytes */</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        int_size /= 8;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">/* KEYMAT = prf+(SKEYID_d, [ g(qm)^xy | ] protocol | SPI | Ni_b | Nr_b) */</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;set_key(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a0d74fca1a3292dd0a7fd78fdaee549bd">skeyid_d</a>))</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    protocol = proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#afe4ae5935443bca7d998525b2e0954db">get_protocol</a>(proposal);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">if</span> (dh)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordflow">if</span> (!dh-&gt;<a class="code" href="../../d1/dd3/structdiffie__hellman__t.html#a3437ff996a19791fad70b48ff5b8bc6a">get_shared_secret</a>(dh, &amp;secret))</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;DH secret %B&quot;</span>, &amp;secret);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    *encr_r = *integ_r = *encr_i = *integ_i = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    seed = <a class="code" href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a>(<span class="stringliteral">&quot;ccccc&quot;</span>, secret, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(protocol),</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                      <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(spi_r), nonce_i, nonce_r);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;initiator SA seed %B&quot;</span>, &amp;seed);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    prf_plus = <a class="code" href="../../d1/dc4/group__prf__plus.html#gaee2c5965b76abc01a1b2fc5b39659253">prf_plus_create</a>(this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, seed);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">if</span> (!prf_plus ||</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        !prf_plus-&gt;<a class="code" href="../../d3/d2e/structprf__plus__t.html#af08ed1c86221b998c5c7325e9594c8a8">allocate_bytes</a>(prf_plus, enc_size, encr_i) ||</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        !prf_plus-&gt;<a class="code" href="../../d3/d2e/structprf__plus__t.html#af08ed1c86221b998c5c7325e9594c8a8">allocate_bytes</a>(prf_plus, int_size, integ_i))</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">goto</span> failure;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    seed = <a class="code" href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a>(<span class="stringliteral">&quot;ccccc&quot;</span>, secret, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(protocol),</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                      <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(spi_i), nonce_i, nonce_r);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;responder SA seed %B&quot;</span>, &amp;seed);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    prf_plus-&gt;<a class="code" href="../../d3/d2e/structprf__plus__t.html#ace2a87a4332d0d6c3322c7af6dad64c1">destroy</a>(prf_plus);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    prf_plus = <a class="code" href="../../d1/dc4/group__prf__plus.html#gaee2c5965b76abc01a1b2fc5b39659253">prf_plus_create</a>(this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, seed);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span> (!prf_plus ||</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        !prf_plus-&gt;<a class="code" href="../../d3/d2e/structprf__plus__t.html#af08ed1c86221b998c5c7325e9594c8a8">allocate_bytes</a>(prf_plus, enc_size, encr_r) ||</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        !prf_plus-&gt;<a class="code" href="../../d3/d2e/structprf__plus__t.html#af08ed1c86221b998c5c7325e9594c8a8">allocate_bytes</a>(prf_plus, int_size, integ_r))</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">goto</span> failure;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> (enc_size)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;encryption initiator key %B&quot;</span>, encr_i);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;encryption responder key %B&quot;</span>, encr_r);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (int_size)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;integrity initiator key %B&quot;</span>, integ_i);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a>, <span class="stringliteral">&quot;integrity responder key %B&quot;</span>, integ_r);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    success = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;failure:</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">if</span> (!success)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(encr_i);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(integ_i);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(encr_r);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(integ_r);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(prf_plus);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;secret);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">return</span> success;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a6d182449ed40134d753869d452100393"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a6d182449ed40134d753869d452100393">ENCR_AES_CCM_ICV16</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00049">crypter.h:49</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structprf__plus__t_html"><div class="ttname"><a href="../../d3/d2e/structprf__plus__t.html">prf_plus_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d46/prf__plus_8h_source.html#l00032">prf_plus.h:32</a></div></div>
<div class="ttc" id="group__transforms_html_ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54"><div class="ttname"><a href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54">INTEGRITY_ALGORITHM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/transform_8h_source.html#l00039">transform.h:39</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a04496ee51a7396b25d18e149bbabb4ea"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a04496ee51a7396b25d18e149bbabb4ea">ENCR_NULL_AUTH_AES_GMAC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00053">crypter.h:53</a></div></div>
<div class="ttc" id="ha__message_8c_html_ad82c402f0fb34c2cbfc1e60d7b6c08a4"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a></div><div class="ttdeci">u_int8_t protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="group__chunk_html_gac9858e0c37c9bf6c0706d0a6e3b6453d"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a></div><div class="ttdeci">chunk_t chunk_empty</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00035">chunk.c:35</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9aa8cb05edf58656ed046ff498e01b5182"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9aa8cb05edf58656ed046ff498e01b5182">ENCR_CAMELLIA_CCM_ICV16</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00059">crypter.h:59</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa2997f4195114195b764cd7e36f046b51">DBG_CHD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00042">debug.h:42</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a0d74fca1a3292dd0a7fd78fdaee549bd"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a0d74fca1a3292dd0a7fd78fdaee549bd">private_keymat_v1_t::skeyid_d</a></div><div class="ttdeci">chunk_t skeyid_d</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00085">keymat_v1.c:85</a></div></div>
<div class="ttc" id="structprf__plus__t_html_af08ed1c86221b998c5c7325e9594c8a8"><div class="ttname"><a href="../../d3/d2e/structprf__plus__t.html#af08ed1c86221b998c5c7325e9594c8a8">prf_plus_t::allocate_bytes</a></div><div class="ttdeci">bool(* allocate_bytes)(prf_plus_t *this, size_t length, chunk_t *chunk) __attribute__((warn_unused_result))</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d46/prf__plus_8h_source.html#l00051">prf_plus.h:51</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9af2c70838e683814c510513ea9029e975"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9af2c70838e683814c510513ea9029e975">ENCR_AES_GCM_ICV8</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00050">crypter.h:50</a></div></div>
<div class="ttc" id="group__bus_html_gac40b89ec47e2bdcb2975e5c39cf88ae2"><div class="ttname"><a href="../../de/d50/group__bus.html#gac40b89ec47e2bdcb2975e5c39cf88ae2">DBG4</a></div><div class="ttdeci">#define DBG4(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00062">bus.h:62</a></div></div>
<div class="ttc" id="group__transforms_html_ggaf335c7940ad619e477cffde4ffb66378a4b9161a6fc3dc335f20693a1d6ac6f25"><div class="ttname"><a href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a4b9161a6fc3dc335f20693a1d6ac6f25">ENCRYPTION_ALGORITHM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/transform_8h_source.html#l00037">transform.h:37</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="proposal_8c_html_ada5439c5fb09c27a3e238beaafc7b4aa"><div class="ttname"><a href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a></div><div class="ttdeci">pseudo_random_function_t prf</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00399">proposal.c:399</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a51883e9daa35e736fb5d9ea5d541981f"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a51883e9daa35e736fb5d9ea5d541981f">ENCR_CAMELLIA_CCM_ICV8</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00057">crypter.h:57</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="structproposal__t_html_af57106973fbeb17aec8819da876280b3"><div class="ttname"><a href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">proposal_t::get_algorithm</a></div><div class="ttdeci">bool(* get_algorithm)(proposal_t *this, transform_type_t type, u_int16_t *alg, u_int16_t *key_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00101">proposal.h:101</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a9bc1dd0400975be049bc46c09a4d0cf3"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a9bc1dd0400975be049bc46c09a4d0cf3">ENCR_AES_GCM_ICV12</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00051">crypter.h:51</a></div></div>
<div class="ttc" id="group__chunk_html_gaaa5a9811df1bd2ae5e331748f7fbaf75"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a></div><div class="ttdeci">static void chunk_clear(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00214">chunk.h:214</a></div></div>
<div class="ttc" id="group__keymat_html_gadbc7243847bc6d2afa1c90c325979e9a"><div class="ttname"><a href="../../d0/d36/group__keymat.html#gadbc7243847bc6d2afa1c90c325979e9a">keymat_get_keylen_integ</a></div><div class="ttdeci">int keymat_get_keylen_integ(integrity_algorithm_t alg)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d9e/keymat_8c_source.html#l00084">keymat.c:84</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a176409eef9265a5979bffffc4aafc51d"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a176409eef9265a5979bffffc4aafc51d">ENCR_NULL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00043">crypter.h:43</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9abd81cda784c48eddd7575ae6d8e63fbf"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9abd81cda784c48eddd7575ae6d8e63fbf">ENCR_AES_CTR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00046">crypter.h:46</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="structdiffie__hellman__t_html_a3437ff996a19791fad70b48ff5b8bc6a"><div class="ttname"><a href="../../d1/dd3/structdiffie__hellman__t.html#a3437ff996a19791fad70b48ff5b8bc6a">diffie_hellman_t::get_shared_secret</a></div><div class="ttdeci">bool(* get_shared_secret)(diffie_hellman_t *this, chunk_t *secret) __attribute__((warn_unused_result))</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dfb/diffie__hellman_8h_source.html#l00094">diffie_hellman.h:94</a></div></div>
<div class="ttc" id="group__keymat_html_ga05ae4f2c33e097e842edaf0702e90f1b"><div class="ttname"><a href="../../d0/d36/group__keymat.html#ga05ae4f2c33e097e842edaf0702e90f1b">keymat_get_keylen_encr</a></div><div class="ttdeci">int keymat_get_keylen_encr(encryption_algorithm_t alg)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d9e/keymat_8c_source.html#l00063">keymat.c:63</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a7f178b219b8ac85d09b62e17fbf35d43"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a7f178b219b8ac85d09b62e17fbf35d43">ENCR_AES_CCM_ICV12</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00048">crypter.h:48</a></div></div>
<div class="ttc" id="group__signer_html_gac6f2a944da6f8eb29e5e2b116b160d59"><div class="ttname"><a href="../../de/dfc/group__signer.html#gac6f2a944da6f8eb29e5e2b116b160d59">integrity_algorithm_names</a></div><div class="ttdeci">enum_name_t * integrity_algorithm_names</div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a2e427a4bb014e0cae017b8194101f75c"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a2e427a4bb014e0cae017b8194101f75c">ENCR_CAMELLIA_CCM_ICV12</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00058">crypter.h:58</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structprf__plus__t_html_ace2a87a4332d0d6c3322c7af6dad64c1"><div class="ttname"><a href="../../d3/d2e/structprf__plus__t.html#ace2a87a4332d0d6c3322c7af6dad64c1">prf_plus_t::destroy</a></div><div class="ttdeci">void(* destroy)(prf_plus_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d46/prf__plus_8h_source.html#l00057">prf_plus.h:57</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a8f9a70f1926895cf141e2b8efef2e7ac"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9a8f9a70f1926895cf141e2b8efef2e7ac">ENCR_AES_CCM_ICV8</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00047">crypter.h:47</a></div></div>
<div class="ttc" id="group__crypter_html_ggadb6b5cb3c8fc2ba0d9a64b297e384ba9ac1e15c244f5ec1821ff7a1de36b581e4"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ggadb6b5cb3c8fc2ba0d9a64b297e384ba9ac1e15c244f5ec1821ff7a1de36b581e4">ENCR_AES_GCM_ICV16</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d1f/crypter_8h_source.html#l00052">crypter.h:52</a></div></div>
<div class="ttc" id="structproposal__t_html_afe4ae5935443bca7d998525b2e0954db"><div class="ttname"><a href="../../df/d06/structproposal__t.html#afe4ae5935443bca7d998525b2e0954db">proposal_t::get_protocol</a></div><div class="ttdeci">protocol_id_t(* get_protocol)(proposal_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00137">proposal.h:137</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a7ea23d0321fbb4a90fd434a26547c31b"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">private_keymat_v1_t::prf</a></div><div class="ttdeci">prf_t * prf</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00060">keymat_v1.c:60</a></div></div>
<div class="ttc" id="group__crypter_html_ga1f793f538b45c8126012219e21d332f0"><div class="ttname"><a href="../../d9/dc7/group__crypter.html#ga1f793f538b45c8126012219e21d332f0">encryption_algorithm_names</a></div><div class="ttdeci">enum_name_t * encryption_algorithm_names</div></div>
<div class="ttc" id="group__prf__plus_html_gaee2c5965b76abc01a1b2fc5b39659253"><div class="ttname"><a href="../../d1/dc4/group__prf__plus.html#gaee2c5965b76abc01a1b2fc5b39659253">prf_plus_create</a></div><div class="ttdeci">prf_plus_t * prf_plus_create(prf_t *prf, bool counter, chunk_t seed)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/df2/prf__plus_8c_source.html#l00126">prf_plus.c:126</a></div></div>
<div class="ttc" id="group__chunk_html_ga8336eaa6a6255475fca1b09ec41ebb2e"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a></div><div class="ttdeci">#define chunk_cata(mode,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00266">chunk.h:266</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a984d4be5b42587865e64ebcf78b08d01_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4afb8c14b3281a244ab23dca53dd2d8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">create_hasher&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *&#160;</td>
          <td class="paramname"><em>proposal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00725">725</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d1/d99/test__ntru_8c_source.html#l00030">alg</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00351">auth_to_hash()</a>, <a class="el" href="../../d4/d1b/crypto__factory_8h_source.html#l00125">crypto_factory_t::create_hasher</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00175">library_t::crypto</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00040">DBG_IKE</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d1/d41/proposal_8h_source.html#l00101">proposal_t::get_algorithm</a>, <a class="el" href="../../d2/d80/transform_8h_source.html#l00033">HASH_ALGORITHM</a>, <a class="el" href="../../dd/d1c/group__hasher.html#ga4dadd8132287b7b58cb80453dc00d888">hash_algorithm_names</a>, <a class="el" href="../../df/d23/hasher_8h_source.html#l00043">HASH_UNKNOWN</a>, <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">hasher</a>, <a class="el" href="../../d2/d80/transform_8h_source.html#l00039">INTEGRITY_ALGORITHM</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;{</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    u_int16_t <a class="code" href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">if</span> (!proposal-&gt;<a class="code" href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">get_algorithm</a>(proposal, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54">INTEGRITY_ALGORITHM</a>, &amp;alg, NULL) ||</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        (alg = <a class="code" href="../../d7/d40/keymat__v1_8c.html#ab396dafd1db9c1c3d8a26b61a08e53d6">auth_to_hash</a>(alg)) == <a class="code" href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea9b8e99ea2698fbaabf3976784e7b5d16">HASH_UNKNOWN</a>)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;no %N selected&quot;</span>, <a class="code" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a151876b8a8658e59340679b066689f56">HASH_ALGORITHM</a>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    }</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a> = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>-&gt;<a class="code" href="../../dc/d84/structcrypto__factory__t.html#af80e586daaea69ec63f864828021037b">create_hasher</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>, alg);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a>)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;%N %N not supported!&quot;</span>,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;             <a class="code" href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a>, <a class="code" href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a151876b8a8658e59340679b066689f56">HASH_ALGORITHM</a>,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;             <a class="code" href="../../dd/d1c/group__hasher.html#ga4dadd8132287b7b58cb80453dc00d888">hash_algorithm_names</a>, alg);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;}</div>
<div class="ttc" id="test__ntru_8c_html_a84a3aa4b7b5103ec0c08b032954762f7"><div class="ttname"><a href="../../d1/d99/test__ntru_8c.html#a84a3aa4b7b5103ec0c08b032954762f7">alg</a></div><div class="ttdeci">ntru_trits_t size_t hash_algorithm_t alg</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/test__ntru_8c_source.html#l00030">test_ntru.c:30</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__hasher_html_ga4dadd8132287b7b58cb80453dc00d888"><div class="ttname"><a href="../../dd/d1c/group__hasher.html#ga4dadd8132287b7b58cb80453dc00d888">hash_algorithm_names</a></div><div class="ttdeci">enum_name_t * hash_algorithm_names</div></div>
<div class="ttc" id="group__transforms_html_ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54"><div class="ttname"><a href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378ae3074947bbe39b4f6b8726a361972b54">INTEGRITY_ALGORITHM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/transform_8h_source.html#l00039">transform.h:39</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="group__hasher_html_ggad4fa8b947395725abf0510e387204ebea9b8e99ea2698fbaabf3976784e7b5d16"><div class="ttname"><a href="../../dd/d1c/group__hasher.html#ggad4fa8b947395725abf0510e387204ebea9b8e99ea2698fbaabf3976784e7b5d16">HASH_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d23/hasher_8h_source.html#l00043">hasher.h:43</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00040">debug.h:40</a></div></div>
<div class="ttc" id="group__transforms_html_ggaf335c7940ad619e477cffde4ffb66378a151876b8a8658e59340679b066689f56"><div class="ttname"><a href="../../d0/d04/group__transforms.html#ggaf335c7940ad619e477cffde4ffb66378a151876b8a8658e59340679b066689f56">HASH_ALGORITHM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/transform_8h_source.html#l00033">transform.h:33</a></div></div>
<div class="ttc" id="structlibrary__t_html_a5a2856cda49e43c861c78afef49170f4"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">library_t::crypto</a></div><div class="ttdeci">crypto_factory_t * crypto</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00175">library.h:175</a></div></div>
<div class="ttc" id="group__transforms_html_gaec05291e1bb587c914675a506e7646cf"><div class="ttname"><a href="../../d0/d04/group__transforms.html#gaec05291e1bb587c914675a506e7646cf">transform_type_names</a></div><div class="ttdeci">enum_name_t * transform_type_names</div></div>
<div class="ttc" id="structproposal__t_html_af57106973fbeb17aec8819da876280b3"><div class="ttname"><a href="../../df/d06/structproposal__t.html#af57106973fbeb17aec8819da876280b3">proposal_t::get_algorithm</a></div><div class="ttdeci">bool(* get_algorithm)(proposal_t *this, transform_type_t type, u_int16_t *alg, u_int16_t *key_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d41/proposal_8h_source.html#l00101">proposal.h:101</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="test__vectors__plugin_8c_html_ae7573e55432c43da12a6f6722230496a"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a></div><div class="ttdeci">static hasher_test_vector_t * hasher[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">test_vectors_plugin.c:75</a></div></div>
<div class="ttc" id="structcrypto__factory__t_html_af80e586daaea69ec63f864828021037b"><div class="ttname"><a href="../../dc/d84/structcrypto__factory__t.html#af80e586daaea69ec63f864828021037b">crypto_factory_t::create_hasher</a></div><div class="ttdeci">hasher_t *(* create_hasher)(crypto_factory_t *this, hash_algorithm_t algo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/crypto__factory_8h_source.html#l00125">crypto_factory.h:125</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_ab396dafd1db9c1c3d8a26b61a08e53d6"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#ab396dafd1db9c1c3d8a26b61a08e53d6">auth_to_hash</a></div><div class="ttdeci">static u_int16_t auth_to_hash(u_int16_t alg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00351">keymat_v1.c:351</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a4afb8c14b3281a244ab23dca53dd2d8e_cgraph.svg" width="240" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aad0e56aef102bd6ba3b2ffcca8ad3d1e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_hasher&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d72/structhasher__t.html">hasher_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00746">746</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">hasher</a>.</p>
<div class="fragment"><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;{</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;}</div>
<div class="ttc" id="test__vectors__plugin_8c_html_ae7573e55432c43da12a6f6722230496a"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a></div><div class="ttdeci">static hasher_test_vector_t * hasher[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">test_vectors_plugin.c:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3f2104dcdcbd7514baf8c3d6b2ec4286"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_hash&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>initiator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>dh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>dh_other</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *&#160;</td>
          <td class="paramname"><em>ike_sa_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>sa_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00752">752</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00261">chunk_cat</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00059">DBG3</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00040">DBG_IKE</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../d4/db2/ike__sa__id_8h_source.html#l00067">ike_sa_id_t::get_initiator_spi</a>, <a class="el" href="../../d4/db2/ike__sa__id_8h_source.html#l00074">ike_sa_id_t::get_responder_spi</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;{</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    u_int64_t spi, spi_other;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">/* HASH_I = prf(SKEYID, g^xi | g^xr | CKY-I | CKY-R | SAi_b | IDii_b )</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">     * HASH_R = prf(SKEYID, g^xr | g^xi | CKY-R | CKY-I | SAi_b | IDir_b )</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        spi = ike_sa_id-&gt;<a class="code" href="../../dc/da6/structike__sa__id__t.html#a81713109e3b848bd68600d58430c4a3c">get_initiator_spi</a>(ike_sa_id);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        spi_other = ike_sa_id-&gt;<a class="code" href="../../dc/da6/structike__sa__id__t.html#a1b04ee11efde4afdb7e13a3b4dee95b0">get_responder_spi</a>(ike_sa_id);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        spi_other = ike_sa_id-&gt;<a class="code" href="../../dc/da6/structike__sa__id__t.html#a81713109e3b848bd68600d58430c4a3c">get_initiator_spi</a>(ike_sa_id);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        spi = ike_sa_id-&gt;<a class="code" href="../../dc/da6/structike__sa__id__t.html#a1b04ee11efde4afdb7e13a3b4dee95b0">get_responder_spi</a>(ike_sa_id);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    data = <a class="code" href="../../d4/d87/group__chunk.html#gad723f169b8d64447e1574a9fab914d4f">chunk_cat</a>(<span class="stringliteral">&quot;cccccc&quot;</span>, dh, dh_other,</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                     <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(spi), <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(spi_other),</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                     sa_i, <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gae1a8fc8c690a2b5690bd1dad92492367">DBG3</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;HASH_%c data %B&quot;</span>, <a class="code" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a> ? <span class="charliteral">&#39;I&#39;</span> : <span class="charliteral">&#39;R&#39;</span>, &amp;data);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;prf_auth-&gt;allocate_bytes(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7f0b5e538dce4b19db09e9e624e4bfd3">prf_auth</a>, data, hash))</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(data.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gae1a8fc8c690a2b5690bd1dad92492367">DBG3</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;HASH_%c %B&quot;</span>, <a class="code" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a> ? <span class="charliteral">&#39;I&#39;</span> : <span class="charliteral">&#39;R&#39;</span>, hash);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(data.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;}</div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a7f0b5e538dce4b19db09e9e624e4bfd3"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a7f0b5e538dce4b19db09e9e624e4bfd3">private_keymat_v1_t::prf_auth</a></div><div class="ttdeci">prf_t * prf_auth</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00065">keymat_v1.c:65</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="structike__sa__id__t_html_a81713109e3b848bd68600d58430c4a3c"><div class="ttname"><a href="../../dc/da6/structike__sa__id__t.html#a81713109e3b848bd68600d58430c4a3c">ike_sa_id_t::get_initiator_spi</a></div><div class="ttdeci">u_int64_t(* get_initiator_spi)(ike_sa_id_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/db2/ike__sa__id_8h_source.html#l00067">ike_sa_id.h:67</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00040">debug.h:40</a></div></div>
<div class="ttc" id="structike__sa__id__t_html_a1b04ee11efde4afdb7e13a3b4dee95b0"><div class="ttname"><a href="../../dc/da6/structike__sa__id__t.html#a1b04ee11efde4afdb7e13a3b4dee95b0">ike_sa_id_t::get_responder_spi</a></div><div class="ttdeci">u_int64_t(* get_responder_spi)(ike_sa_id_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/db2/ike__sa__id_8h_source.html#l00074">ike_sa_id.h:74</a></div></div>
<div class="ttc" id="group__chunk_html_gad723f169b8d64447e1574a9fab914d4f"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad723f169b8d64447e1574a9fab914d4f">chunk_cat</a></div><div class="ttdeci">#define chunk_cat(mode,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00261">chunk.h:261</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__bus_html_gae1a8fc8c690a2b5690bd1dad92492367"><div class="ttname"><a href="../../de/d50/group__bus.html#gae1a8fc8c690a2b5690bd1dad92492367">DBG3</a></div><div class="ttdeci">#define DBG3(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00059">bus.h:59</a></div></div>
<div class="ttc" id="ha__message_8c_html_a4345dfbca89c2653de8f69f577b25168"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a></div><div class="ttdeci">u_int8_t initiator</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00053">ha_message.c:53</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a3f2104dcdcbd7514baf8c3d6b2ec4286_cgraph.svg" width="184" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a79408dd38cda9b8225547e574a42995d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_hash_phase2&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d23/structmessage__t.html">message_t</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00885">885</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00266">chunk_cata</a>, <a class="el" href="../../d8/d39/chunk_8c_source.html#l00035">chunk_empty</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00059">DBG3</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00040">DBG_IKE</a>, <a class="el" href="../../d8/df4/generator_8h_source.html#l00065">generator_t::destroy</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d3/d52/generator_8c_source.html#l00605">generator_create_no_dbg()</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00133">message_t::get_exchange_type</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00809">get_message_data()</a>, <a class="el" href="../../d2/d0d/message_8h_source.html#l00087">message_t::get_message_id</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00794">get_nonce()</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00082">INFORMATIONAL_V1</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00853">lookup_quick_mode()</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00133">qm_data_t::n_i</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00135">qm_data_t::n_r</a>, <a class="el" href="../../d6/d1a/dh__speed_8c_source.html#l00030">name</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00399">prf</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00141">qm_data_destroy()</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00092">QUICK_MODE</a>, <a class="el" href="../../d8/d56/ike__header_8h_source.html#l00087">TRANSACTION</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;{</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    u_int32_t mid, mid_n;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a> = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordtype">bool</span> add_message = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a> = <span class="stringliteral">&quot;Hash&quot;</span>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    {   <span class="comment">/* no keys derived yet */</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    mid = message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a43c37f5c6b09cca4c19d84f18dae9db3">get_message_id</a>(message);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    mid_n = htonl(mid);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="comment">/* Hashes are simple for most exchanges in Phase 2:</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">     *   Hash = prf(SKEYID_a, M-ID | Complete message after HASH payload)</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">     * For Quick Mode there are three hashes:</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">     *   Hash(1) = same as above</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">     *   Hash(2) = prf(SKEYID_a, M-ID | Ni_b | Message after HASH payload)</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">     *   Hash(3) = prf(SKEYID_a, 0 | M-ID | Ni_b | Nr_b)</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">     * So, for Quick Mode we keep track of the nonce values.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">switch</span> (message-&gt;<a class="code" href="../../df/d23/structmessage__t.html#a0ea92cf6668475ceb72353622c967ecd">get_exchange_type</a>(message))</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba362ccf37f10f051b4e1666a377b59b59">QUICK_MODE</a>:</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <a class="code" href="../../da/dcf/structqm__data__t.html">qm_data_t</a> *qm = <a class="code" href="../../d7/d40/keymat__v1_8c.html#aa170aeaf1f891c2939206c5087bf8d3f">lookup_quick_mode</a>(<span class="keyword">this</span>, mid);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="keywordflow">if</span> (!qm-&gt;<a class="code" href="../../da/dcf/structqm__data__t.html#a05d68b1a16986a4236256549d221e362">n_i</a>.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            {   <span class="comment">/* Hash(1) = prf(SKEYID_a, M-ID | Message after HASH payload) */</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                name = <span class="stringliteral">&quot;Hash(1)&quot;</span>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d40/keymat__v1_8c.html#a82035235fa4fecaba085ef1869910853">get_nonce</a>(message, &amp;qm-&gt;<a class="code" href="../../da/dcf/structqm__data__t.html#a05d68b1a16986a4236256549d221e362">n_i</a>))</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                data = <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(mid_n);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!qm-&gt;<a class="code" href="../../da/dcf/structqm__data__t.html#a6209230d67032adc4d5653de1488554e">n_r</a>.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            {   <span class="comment">/* Hash(2) = prf(SKEYID_a, M-ID | Ni_b | Message after HASH) */</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                name = <span class="stringliteral">&quot;Hash(2)&quot;</span>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d40/keymat__v1_8c.html#a82035235fa4fecaba085ef1869910853">get_nonce</a>(message, &amp;qm-&gt;<a class="code" href="../../da/dcf/structqm__data__t.html#a6209230d67032adc4d5653de1488554e">n_r</a>))</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                }</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                data = <a class="code" href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a>(<span class="stringliteral">&quot;cc&quot;</span>, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(mid_n), qm-&gt;<a class="code" href="../../da/dcf/structqm__data__t.html#a05d68b1a16986a4236256549d221e362">n_i</a>);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            {   <span class="comment">/* Hash(3) = prf(SKEYID_a, 0 | M-ID | Ni_b | Nr_b) */</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                name = <span class="stringliteral">&quot;Hash(3)&quot;</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                data = <a class="code" href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a>(<span class="stringliteral">&quot;cccc&quot;</span>, <a class="code" href="../../d7/d40/keymat__v1_8c.html#a497b5fdd9da714ef02eed7792d7130f9">octet_0</a>, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(mid_n),</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                  qm-&gt;<a class="code" href="../../da/dcf/structqm__data__t.html#a05d68b1a16986a4236256549d221e362">n_i</a>, qm-&gt;<a class="code" href="../../da/dcf/structqm__data__t.html#a6209230d67032adc4d5653de1488554e">n_r</a>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                add_message = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                <span class="comment">/* we don&#39;t need the state anymore */</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                this-&gt;qms-&gt;remove(this-&gt;qms, qm, NULL);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <a class="code" href="../../d7/d40/keymat__v1_8c.html#ab6b2166164c7e1d3af19de6c8d6ed253">qm_data_destroy</a>(qm);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2238345c21cd115d2eaee8097508d9d7">TRANSACTION</a>:</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a>:</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="comment">/* Hash = prf(SKEYID_a, M-ID | Message after HASH payload) */</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            data = <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(mid_n);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;set_key(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#af39c980ecad01e1467f24f084c448cf2">skeyid_a</a>))</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">if</span> (add_message)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <a class="code" href="../../d0/d70/structgenerator__t.html">generator_t</a> *generator;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        generator = <a class="code" href="../../dc/d21/group__generator.html#ga9eda05f909e101ccdf5165fa763eb4c1">generator_create_no_dbg</a>();</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        msg = <a class="code" href="../../d7/d40/keymat__v1_8c.html#a84a4d4c4aaa5e44bb2071bf98f050452">get_message_data</a>(message, generator);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;allocate_bytes(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, data, NULL) ||</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            !this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;allocate_bytes(this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>, msg, hash))</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">destroy</a>(generator);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        generator-&gt;<a class="code" href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">destroy</a>(generator);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>-&gt;allocate_bytes(this-&gt;<a class="code" href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">prf</a>, data, hash))</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gae1a8fc8c690a2b5690bd1dad92492367">DBG3</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a>, <span class="stringliteral">&quot;%s %B&quot;</span>, name, hash);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="group__chunk_html_gac9858e0c37c9bf6c0706d0a6e3b6453d"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a></div><div class="ttdeci">chunk_t chunk_empty</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00035">chunk.c:35</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a84a4d4c4aaa5e44bb2071bf98f050452"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a84a4d4c4aaa5e44bb2071bf98f050452">get_message_data</a></div><div class="ttdeci">static chunk_t get_message_data(message_t *message, generator_t *generator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00809">keymat_v1.c:809</a></div></div>
<div class="ttc" id="group__generator_html_ga9eda05f909e101ccdf5165fa763eb4c1"><div class="ttname"><a href="../../dc/d21/group__generator.html#ga9eda05f909e101ccdf5165fa763eb4c1">generator_create_no_dbg</a></div><div class="ttdeci">generator_t * generator_create_no_dbg()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d52/generator_8c_source.html#l00605">generator.c:605</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_af39c980ecad01e1467f24f084c448cf2"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#af39c980ecad01e1467f24f084c448cf2">private_keymat_v1_t::skeyid_a</a></div><div class="ttdeci">chunk_t skeyid_a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00090">keymat_v1.c:90</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffa0dee1efcca13f75ee9dcef72e9856fd7">DBG_IKE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00040">debug.h:40</a></div></div>
<div class="ttc" id="proposal_8c_html_ada5439c5fb09c27a3e238beaafc7b4aa"><div class="ttname"><a href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a></div><div class="ttdeci">pseudo_random_function_t prf</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00399">proposal.c:399</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba362ccf37f10f051b4e1666a377b59b59"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba362ccf37f10f051b4e1666a377b59b59">QUICK_MODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00092">ike_header.h:92</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2d0aa54144b8cc0c9699d3cf5f1e0011">INFORMATIONAL_V1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00082">ike_header.h:82</a></div></div>
<div class="ttc" id="structgenerator__t_html_aabd82edcd3cf7286b7e8a1ce7a2e8158"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html#aabd82edcd3cf7286b7e8a1ce7a2e8158">generator_t::destroy</a></div><div class="ttdeci">void(* destroy)(generator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00065">generator.h:65</a></div></div>
<div class="ttc" id="structqm__data__t_html_a6209230d67032adc4d5653de1488554e"><div class="ttname"><a href="../../da/dcf/structqm__data__t.html#a6209230d67032adc4d5653de1488554e">qm_data_t::n_r</a></div><div class="ttdeci">chunk_t n_r</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00135">keymat_v1.c:135</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a497b5fdd9da714ef02eed7792d7130f9"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a497b5fdd9da714ef02eed7792d7130f9">octet_0</a></div><div class="ttdeci">static const chunk_t octet_0</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00151">keymat_v1.c:151</a></div></div>
<div class="ttc" id="structqm__data__t_html_a05d68b1a16986a4236256549d221e362"><div class="ttname"><a href="../../da/dcf/structqm__data__t.html#a05d68b1a16986a4236256549d221e362">qm_data_t::n_i</a></div><div class="ttdeci">chunk_t n_i</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00133">keymat_v1.c:133</a></div></div>
<div class="ttc" id="structmessage__t_html_a0ea92cf6668475ceb72353622c967ecd"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a0ea92cf6668475ceb72353622c967ecd">message_t::get_exchange_type</a></div><div class="ttdeci">exchange_type_t(* get_exchange_type)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00133">message.h:133</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structqm__data__t_html"><div class="ttname"><a href="../../da/dcf/structqm__data__t.html">qm_data_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00129">keymat_v1.c:129</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="structmessage__t_html_a43c37f5c6b09cca4c19d84f18dae9db3"><div class="ttname"><a href="../../df/d23/structmessage__t.html#a43c37f5c6b09cca4c19d84f18dae9db3">message_t::get_message_id</a></div><div class="ttdeci">u_int32_t(* get_message_id)(message_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00087">message.h:87</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__bus_html_gae1a8fc8c690a2b5690bd1dad92492367"><div class="ttname"><a href="../../de/d50/group__bus.html#gae1a8fc8c690a2b5690bd1dad92492367">DBG3</a></div><div class="ttdeci">#define DBG3(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00059">bus.h:59</a></div></div>
<div class="ttc" id="structgenerator__t_html"><div class="ttname"><a href="../../d0/d70/structgenerator__t.html">generator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df4/generator_8h_source.html#l00042">generator.h:42</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_aa170aeaf1f891c2939206c5087bf8d3f"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#aa170aeaf1f891c2939206c5087bf8d3f">lookup_quick_mode</a></div><div class="ttdeci">static qm_data_t * lookup_quick_mode(private_keymat_v1_t *this, u_int32_t mid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00853">keymat_v1.c:853</a></div></div>
<div class="ttc" id="structprivate__keymat__v1__t_html_a7ea23d0321fbb4a90fd434a26547c31b"><div class="ttname"><a href="../../d3/d50/structprivate__keymat__v1__t.html#a7ea23d0321fbb4a90fd434a26547c31b">private_keymat_v1_t::prf</a></div><div class="ttdeci">prf_t * prf</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00060">keymat_v1.c:60</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a82035235fa4fecaba085ef1869910853"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a82035235fa4fecaba085ef1869910853">get_nonce</a></div><div class="ttdeci">static bool get_nonce(message_t *message, chunk_t *n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00794">keymat_v1.c:794</a></div></div>
<div class="ttc" id="dh__speed_8c_html_a1317e52dffbcbe14fbfd1bd5ac61fff9"><div class="ttname"><a href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d1a/dh__speed_8c_source.html#l00030">dh_speed.c:30</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_ab6b2166164c7e1d3af19de6c8d6ed253"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#ab6b2166164c7e1d3af19de6c8d6ed253">qm_data_destroy</a></div><div class="ttdeci">static void qm_data_destroy(qm_data_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00141">keymat_v1.c:141</a></div></div>
<div class="ttc" id="group__ike__header_html_gga7ac65c9d137f83d2cc8d0177749d3aaba2238345c21cd115d2eaee8097508d9d7"><div class="ttname"><a href="../../d3/d63/group__ike__header.html#gga7ac65c9d137f83d2cc8d0177749d3aaba2238345c21cd115d2eaee8097508d9d7">TRANSACTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/ike__header_8h_source.html#l00087">ike_header.h:87</a></div></div>
<div class="ttc" id="group__chunk_html_ga8336eaa6a6255475fca1b09ec41ebb2e"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga8336eaa6a6255475fca1b09ec41ebb2e">chunk_cata</a></div><div class="ttdeci">#define chunk_cata(mode,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00266">chunk.h:266</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a79408dd38cda9b8225547e574a42995d_cgraph.svg" width="100%" height="466"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9ed76dfd9b85274b26c0c53123ac11e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_iv&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>mid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01059">1059</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00037">iv_data_t::iv</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01017">lookup_iv()</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;{</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <a class="code" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *iv;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    iv = <a class="code" href="../../d7/d40/keymat__v1_8c.html#acf3f4b53c3b8091b4cda09d194182665">lookup_iv</a>(<span class="keyword">this</span>, mid);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">if</span> (iv)</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        *out = iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv</a>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structiv__data__t_html"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html">iv_data_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00033">keymat_v1.c:33</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_acf3f4b53c3b8091b4cda09d194182665"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#acf3f4b53c3b8091b4cda09d194182665">lookup_iv</a></div><div class="ttdeci">static iv_data_t * lookup_iv(private_keymat_v1_t *this, u_int32_t mid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l01017">keymat_v1.c:1017</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structiv__data__t_html_ac89b1703237fdc6a687ee5bd293d5999"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html#ac89b1703237fdc6a687ee5bd293d5999">iv_data_t::iv</a></div><div class="ttdeci">chunk_t iv</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00037">keymat_v1.c:37</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a9ed76dfd9b85274b26c0c53123ac11e9_cgraph.svg" width="608" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab650ebd4314dc5c5edf6af462bffac94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">update_iv&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>mid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>last_block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01073">1073</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00251">chunk_clone</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00039">iv_data_t::last_block</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01017">lookup_iv()</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;{</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <a class="code" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *iv = <a class="code" href="../../d7/d40/keymat__v1_8c.html#acf3f4b53c3b8091b4cda09d194182665">lookup_iv</a>(<span class="keyword">this</span>, mid);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="keywordflow">if</span> (iv)</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    {   <span class="comment">/* update last block */</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ae512793306fb33fadb34862fefbfb920">last_block</a>);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        iv-&gt;<a class="code" href="../../d4/d55/structiv__data__t.html#ae512793306fb33fadb34862fefbfb920">last_block</a> = <a class="code" href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a>(last_block);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structiv__data__t_html"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html">iv_data_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00033">keymat_v1.c:33</a></div></div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_acf3f4b53c3b8091b4cda09d194182665"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#acf3f4b53c3b8091b4cda09d194182665">lookup_iv</a></div><div class="ttdeci">static iv_data_t * lookup_iv(private_keymat_v1_t *this, u_int32_t mid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l01017">keymat_v1.c:1017</a></div></div>
<div class="ttc" id="structiv__data__t_html_ae512793306fb33fadb34862fefbfb920"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html#ae512793306fb33fadb34862fefbfb920">iv_data_t::last_block</a></div><div class="ttdeci">chunk_t last_block</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00039">keymat_v1.c:39</a></div></div>
<div class="ttc" id="group__chunk_html_gac7a055a5fa92106988cddbc641899871"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a></div><div class="ttdeci">#define chunk_clone(chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00251">chunk.h:251</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_ab650ebd4314dc5c5edf6af462bffac94_cgraph.svg" width="608" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1ee8bdf3b81a74e15a52a899b53907f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dce/structkeymat__v1__t.html">keymat_v1_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">confirm_iv&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>mid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01086">1086</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00985">generate_iv()</a>, and <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01017">lookup_iv()</a>.</p>
<div class="fragment"><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="../../d4/d55/structiv__data__t.html">iv_data_t</a> *iv = <a class="code" href="../../d7/d40/keymat__v1_8c.html#acf3f4b53c3b8091b4cda09d194182665">lookup_iv</a>(<span class="keyword">this</span>, mid);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">if</span> (iv)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d7/d40/keymat__v1_8c.html#a1505b0f5a6dc3af207c42b48ea9e1803">generate_iv</a>(<span class="keyword">this</span>, iv);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structiv__data__t_html"><div class="ttname"><a href="../../d4/d55/structiv__data__t.html">iv_data_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00033">keymat_v1.c:33</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_acf3f4b53c3b8091b4cda09d194182665"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#acf3f4b53c3b8091b4cda09d194182665">lookup_iv</a></div><div class="ttdeci">static iv_data_t * lookup_iv(private_keymat_v1_t *this, u_int32_t mid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l01017">keymat_v1.c:1017</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_a1505b0f5a6dc3af207c42b48ea9e1803"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#a1505b0f5a6dc3af207c42b48ea9e1803">generate_iv</a></div><div class="ttdeci">static bool generate_iv(private_keymat_v1_t *this, iv_data_t *iv)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00985">keymat_v1.c:985</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a1ee8bdf3b81a74e15a52a899b53907f0_cgraph.svg" width="608" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a84b298e352f7bee8db9d571128ddedc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_version&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d6e/group__ike__cfg.html#gaf1772828c8c0e7d70e61a65f8b7653f2">ike_version_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01097">1097</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../dc/d97/ike__cfg_8h_source.html#l00044">IKEV1</a>.</p>
<div class="fragment"><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;{</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;}</div>
<div class="ttc" id="group__ike__cfg_html_ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab"><div class="ttname"><a href="../../dd/d6e/group__ike__cfg.html#ggaf1772828c8c0e7d70e61a65f8b7653f2aff983e382e03991ed223942550b25eab">IKEV1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d97/ike__cfg_8h_source.html#l00044">ike_cfg.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a01a233389e78f7b07c666b7b52b98942"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">create_dh&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/d95/group__diffie__hellman.html#ga44a1c1057dd7d5cb746be20cf128c743">diffie_hellman_group_t</a>&#160;</td>
          <td class="paramname"><em>group</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01103">1103</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d4/d1b/crypto__factory_8h_source.html#l00158">crypto_factory_t::create_dh</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00175">library_t::crypto</a>, and <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>.</p>
<div class="fragment"><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;{</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>-&gt;<a class="code" href="../../dc/d84/structcrypto__factory__t.html#af7b00d5ca8f643dafb9a557e7df8a580">create_dh</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>, <a class="code" href="../../d6/d1a/dh__speed_8c.html#a28f6c53e49dfa08e24017d893fc83524">group</a>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;}</div>
<div class="ttc" id="dh__speed_8c_html_a28f6c53e49dfa08e24017d893fc83524"><div class="ttname"><a href="../../d6/d1a/dh__speed_8c.html#a28f6c53e49dfa08e24017d893fc83524">group</a></div><div class="ttdeci">diffie_hellman_group_t group</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d1a/dh__speed_8c_source.html#l00031">dh_speed.c:31</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="structcrypto__factory__t_html_af7b00d5ca8f643dafb9a557e7df8a580"><div class="ttname"><a href="../../dc/d84/structcrypto__factory__t.html#af7b00d5ca8f643dafb9a557e7df8a580">crypto_factory_t::create_dh</a></div><div class="ttdeci">diffie_hellman_t *(* create_dh)(crypto_factory_t *this, diffie_hellman_group_t group,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/crypto__factory_8h_source.html#l00158">crypto_factory.h:158</a></div></div>
<div class="ttc" id="structlibrary__t_html_a5a2856cda49e43c861c78afef49170f4"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">library_t::crypto</a></div><div class="ttdeci">crypto_factory_t * crypto</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00175">library.h:175</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4a9f1efb26f484e2b34e6a162efc3940"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">create_nonce_gen&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d1a/structnonce__gen__t.html">nonce_gen_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01109">1109</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../d4/d1b/crypto__factory_8h_source.html#l00148">crypto_factory_t::create_nonce_gen</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00175">library_t::crypto</a>, and <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>.</p>
<div class="fragment"><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;{</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>-&gt;<a class="code" href="../../dc/d84/structcrypto__factory__t.html#aeac640857930f8d50685b813d35127e0">create_nonce_gen</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">crypto</a>);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;}</div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="structlibrary__t_html_a5a2856cda49e43c861c78afef49170f4"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a5a2856cda49e43c861c78afef49170f4">library_t::crypto</a></div><div class="ttdeci">crypto_factory_t * crypto</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00175">library.h:175</a></div></div>
<div class="ttc" id="structcrypto__factory__t_html_aeac640857930f8d50685b813d35127e0"><div class="ttname"><a href="../../dc/d84/structcrypto__factory__t.html#aeac640857930f8d50685b813d35127e0">crypto_factory_t::create_nonce_gen</a></div><div class="ttdeci">nonce_gen_t *(* create_nonce_gen)(crypto_factory_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/crypto__factory_8h_source.html#l00148">crypto_factory.h:148</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e51a9be4839746306c68bdbe4738eeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_aead&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d7d/structaead__t.html">aead_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01115">1115</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>.</p>
<div class="fragment"><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;{</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;}</div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a429b3d881ff01cbc8506b56ad22e529e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/ddc/windows_2thread_8c.html#a343cd07ea8770e572cfe3a7d39ea8401">destroy</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d50/structprivate__keymat__v1__t.html">private_keymat_v1_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l01121">1121</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../db/d47/test__message__chapoly_8c_source.html#l00020">aead</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00214">chunk_clear()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">hasher</a>, <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00119">iv_data_destroy()</a>, <a class="el" href="../../dd/d31/proposal_8c_source.html#l00399">prf</a>, and <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00141">qm_data_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;{</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;<a class="code" href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a>);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;prf_auth);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;<a class="code" href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;<a class="code" href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a>);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;this-&gt;skeyid_d);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a>(&amp;this-&gt;skeyid_a);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;this-&gt;phase1_iv.iv);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;this-&gt;phase1_iv.last_block);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    this-&gt;ivs-&gt;destroy_function(this-&gt;ivs, (<span class="keywordtype">void</span>*)<a class="code" href="../../d7/d40/keymat__v1_8c.html#afe094700cf566dcd7c1d12883874e1e6">iv_data_destroy</a>);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    this-&gt;qms-&gt;destroy_function(this-&gt;qms, (<span class="keywordtype">void</span>*)<a class="code" href="../../d7/d40/keymat__v1_8c.html#ab6b2166164c7e1d3af19de6c8d6ed253">qm_data_destroy</a>);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;}</div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="proposal_8c_html_ada5439c5fb09c27a3e238beaafc7b4aa"><div class="ttname"><a href="../../dd/d31/proposal_8c.html#ada5439c5fb09c27a3e238beaafc7b4aa">prf</a></div><div class="ttdeci">pseudo_random_function_t prf</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d31/proposal_8c_source.html#l00399">proposal.c:399</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_afe094700cf566dcd7c1d12883874e1e6"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#afe094700cf566dcd7c1d12883874e1e6">iv_data_destroy</a></div><div class="ttdeci">static void iv_data_destroy(iv_data_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00119">keymat_v1.c:119</a></div></div>
<div class="ttc" id="group__chunk_html_gaaa5a9811df1bd2ae5e331748f7fbaf75"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaaa5a9811df1bd2ae5e331748f7fbaf75">chunk_clear</a></div><div class="ttdeci">static void chunk_clear(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00214">chunk.h:214</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="test__vectors__plugin_8c_html_ae7573e55432c43da12a6f6722230496a"><div class="ttname"><a href="../../d8/dfe/test__vectors__plugin_8c.html#ae7573e55432c43da12a6f6722230496a">hasher</a></div><div class="ttdeci">static hasher_test_vector_t * hasher[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dfe/test__vectors__plugin_8c_source.html#l00075">test_vectors_plugin.c:75</a></div></div>
<div class="ttc" id="keymat__v1_8c_html_ab6b2166164c7e1d3af19de6c8d6ed253"><div class="ttname"><a href="../../d7/d40/keymat__v1_8c.html#ab6b2166164c7e1d3af19de6c8d6ed253">qm_data_destroy</a></div><div class="ttdeci">static void qm_data_destroy(qm_data_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d40/keymat__v1_8c_source.html#l00141">keymat_v1.c:141</a></div></div>
<div class="ttc" id="test__message__chapoly_8c_html_ac7ec2dfaf5f9247d0ecb019b928dad2b"><div class="ttname"><a href="../../db/d47/test__message__chapoly_8c.html#ac7ec2dfaf5f9247d0ecb019b928dad2b">aead</a></div><div class="ttdeci">static aead_t * aead</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d47/test__message__chapoly_8c_source.html#l00020">test_message_chapoly.c:20</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_a429b3d881ff01cbc8506b56ad22e529e_cgraph.svg" width="100%" height="480"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab6b2166164c7e1d3af19de6c8d6ed253"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void qm_data_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/dcf/structqm__data__t.html">qm_data_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destroy a <a class="el" href="../../da/dcf/structqm__data__t.html">qm_data_t</a> object. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00141">141</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00853">lookup_quick_mode()</a>, and <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00885">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;this-&gt;n_i);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;this-&gt;n_r);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_ab6b2166164c7e1d3af19de6c8d6ed253_cgraph.svg" width="363" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d7/d40/keymat__v1_8c_ab6b2166164c7e1d3af19de6c8d6ed253_icgraph.svg" width="448" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a497b5fdd9da714ef02eed7792d7130f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> octet_0 = <a class="el" href="../../d4/d87/group__chunk.html#ga4e840ddd09136bdd6995ef664a52f8f1">chunk_from_chars</a>(0x00)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constants used in key derivation. </p>

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00151">151</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00229">expand_skeyid_e()</a>.</p>

</div>
</div>
<a class="anchor" id="a668140d391d9a28ec257ac5fd9b1a8ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> octet_1 = <a class="el" href="../../d4/d87/group__chunk.html#ga4e840ddd09136bdd6995ef664a52f8f1">chunk_from_chars</a>(0x01)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00152">152</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

</div>
</div>
<a class="anchor" id="a348490e6e1dad0ee07485fa18c45aa63"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> octet_2 = <a class="el" href="../../d4/d87/group__chunk.html#ga4e840ddd09136bdd6995ef664a52f8f1">chunk_from_chars</a>(0x02)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d7/d40/keymat__v1_8c_source.html#l00153">153</a> of file <a class="el" href="../../d7/d40/keymat__v1_8c_source.html">keymat_v1.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_6f5ceac4aae5af0cdf8d7537278832cd.html">libcharon</a></li><li class="navelem"><a class="el" href="../../dir_969456d8bdfa9adca7af79bd87eb5a35.html">sa</a></li><li class="navelem"><a class="el" href="../../dir_8be7a53e666038d70d013a38566b5ac7.html">ikev1</a></li><li class="navelem"><a class="el" href="../../d7/d40/keymat__v1_8c.html">keymat_v1.c</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:03:49 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
