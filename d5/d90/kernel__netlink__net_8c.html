<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: kernel_netlink_net.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d5/d90/kernel__netlink__net_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">kernel_netlink_net.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;sys/utsname.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../de/d4c/netlink_8h_source.html">linux/netlink.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d9/d06/rtnetlink_8h_source.html">linux/rtnetlink.h</a>&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;net/if.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="../../dd/da7/kernel__netlink__net_8h_source.html">kernel_netlink_net.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d6/d2b/kernel__netlink__shared_8h_source.html">kernel_netlink_shared.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="../../dc/d63/hydra_8h_source.html">hydra.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../db/d16/debug_8h_source.html">utils/debug.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d0/df8/mutex_8h_source.html">threading/mutex.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d7/d1d/rwlock_8h_source.html">threading/rwlock.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d2/d17/rwlock__condvar_8h_source.html">threading/rwlock_condvar.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../df/d63/spinlock_8h_source.html">threading/spinlock.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../dd/d16/hashtable_8h_source.html">collections/hashtable.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d1/d4a/linked__list_8h_source.html">collections/linked_list.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../db/ddd/callback__job_8h_source.html">processing/jobs/callback_job.h</a>&gt;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for kernel_netlink_net.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d7/dce/kernel__netlink__net_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="../../d5/d90/kernel__netlink__net_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad23bc7e9d28fa00f264e8690b810a710"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#ad23bc7e9d28fa00f264e8690b810a710">ROAM_DELAY</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:ad23bc7e9d28fa00f264e8690b810a710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96f22cfbf0c80c9849f9fc765f9bd2c5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a96f22cfbf0c80c9849f9fc765f9bd2c5">ROUTE_DELAY</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:a96f22cfbf0c80c9849f9fc765f9bd2c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a714d288372018cf438e388ab2c7f28e1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a714d288372018cf438e388ab2c7f28e1">MAX_ROUTE_RECURSION</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a714d288372018cf438e388ab2c7f28e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c34f80b185c2938954b01f86edc6c2d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a1c34f80b185c2938954b01f86edc6c2d">ROUTING_TABLE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a1c34f80b185c2938954b01f86edc6c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36428db8194c045b590bc51ee65fe21f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a36428db8194c045b590bc51ee65fe21f">ROUTING_TABLE_PRIO</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a36428db8194c045b590bc51ee65fe21f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a12f4dbcfab5b7ff0d7eeccc09aa13867"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a12f4dbcfab5b7ff0d7eeccc09aa13867">addr_entry_t</a></td></tr>
<tr class="separator:a12f4dbcfab5b7ff0d7eeccc09aa13867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bf4287633637937da98dffc1fddfc00"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a7bf4287633637937da98dffc1fddfc00">iface_entry_t</a></td></tr>
<tr class="separator:a7bf4287633637937da98dffc1fddfc00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2b72998ab4dad78e3454872e3545f4"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#aaa2b72998ab4dad78e3454872e3545f4">addr_map_entry_t</a></td></tr>
<tr class="separator:aaa2b72998ab4dad78e3454872e3545f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf17c1b6357daefe087749686144d1f2"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#aaf17c1b6357daefe087749686144d1f2">route_entry_t</a></td></tr>
<tr class="separator:aaf17c1b6357daefe087749686144d1f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f0bfb65267408d28739506f392b14af"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a7f0bfb65267408d28739506f392b14af">net_change_t</a></td></tr>
<tr class="separator:a7f0bfb65267408d28739506f392b14af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4991f5af31fff798e7c0c823f57346e3"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a4991f5af31fff798e7c0c823f57346e3">private_kernel_netlink_net_t</a></td></tr>
<tr class="separator:a4991f5af31fff798e7c0c823f57346e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad5ca5f5912654c64aa0beb1031091ca2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#ad5ca5f5912654c64aa0beb1031091ca2">ENUM</a> (rt_msg_names, <a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9">RTM_NEWLINK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a7cc9e49292861264c277336cf9c7b4d4">RTM_GETRULE</a>,&quot;RTM_NEWLINK&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aab751ce80fc2805f9803dda4726ddaf2">RTM_DELLINK</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ae4ad73febaabbbf1d9fcebe85ab130a4">RTM_GETLINK</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a6743d20938aa4acc249fc24f37f22e0c">RTM_SETLINK</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f">RTM_DELADDR</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a98404fda6f7cf17c4826b7e39e78ccea">RTM_GETADDR</a>&quot;,&quot;31&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471">RTM_DELROUTE</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a4c11427cfab6a651efdfe67ff4c6bb42">RTM_GETROUTE</a>&quot;,&quot;35&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aedca41f88742889c70e6439f68cc6b8b">RTM_NEWNEIGH</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a1d3cda2e5dc9fa63e6a723a64c9866b2">RTM_DELNEIGH</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a32fb49ab50c5404d840178c667d51afa">RTM_GETNEIGH</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ae566f28280c97c9e2ea5917a5c5da85d">RTM_NEWRULE</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a176648d155f27bef64928203100263ee">RTM_DELRULE</a>&quot;,&quot;<a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a7cc9e49292861264c277336cf9c7b4d4">RTM_GETRULE</a>&quot;,)</td></tr>
<tr class="separator:ad5ca5f5912654c64aa0beb1031091ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7235c174351cbc6544dad599e0cb03d1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a7235c174351cbc6544dad599e0cb03d1">addr_entry_destroy</a> (<a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *this)</td></tr>
<tr class="separator:a7235c174351cbc6544dad599e0cb03d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21cd8aae9699bfaca9118243ceda91df"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a21cd8aae9699bfaca9118243ceda91df">iface_entry_destroy</a> (<a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *this)</td></tr>
<tr class="separator:a21cd8aae9699bfaca9118243ceda91df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a28287a4812f8e8101770a3cc94b87"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a> (<a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *this, int *ifindex)</td></tr>
<tr class="separator:a44a28287a4812f8e8101770a3cc94b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0faeb03bf086f0d08fbfaf8faef65a16"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a0faeb03bf086f0d08fbfaf8faef65a16">iface_entry_by_name</a> (<a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *this, char *ifname)</td></tr>
<tr class="separator:a0faeb03bf086f0d08fbfaf8faef65a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b3597e6b5433acae9d22f4efa612d4b"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a4b3597e6b5433acae9d22f4efa612d4b">iface_entry_up</a> (<a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface)</td></tr>
<tr class="separator:a4b3597e6b5433acae9d22f4efa612d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1db8c558ca19629f217439383b872e11"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a1db8c558ca19629f217439383b872e11">iface_entry_up_and_usable</a> (<a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface)</td></tr>
<tr class="separator:a1db8c558ca19629f217439383b872e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c781f50f72bded96214271be28b551"><td class="memItemLeft" align="right" valign="top">static u_int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a82c781f50f72bded96214271be28b551">addr_map_entry_hash</a> (<a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *this)</td></tr>
<tr class="separator:a82c781f50f72bded96214271be28b551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60f280b2e2a089842a6db7670de5c2c9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a60f280b2e2a089842a6db7670de5c2c9">addr_map_entry_equals</a> (<a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>)</td></tr>
<tr class="separator:a60f280b2e2a089842a6db7670de5c2c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29ddd9c2b58f1a5d0bf38ed6ac2b718"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#af29ddd9c2b58f1a5d0bf38ed6ac2b718">addr_map_entry_match_up_and_usable</a> (<a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>)</td></tr>
<tr class="separator:af29ddd9c2b58f1a5d0bf38ed6ac2b718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52f2cdfb0ddf0864d2808f1e96af8f6"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#aa52f2cdfb0ddf0864d2808f1e96af8f6">addr_map_entry_match_up</a> (<a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>)</td></tr>
<tr class="separator:aa52f2cdfb0ddf0864d2808f1e96af8f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3374d9d8f49b40648171e449a059bb"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a> (<a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>)</td></tr>
<tr class="separator:acd3374d9d8f49b40648171e449a059bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50ff6b3b73afc5e4e1e327c997d2c7de"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a50ff6b3b73afc5e4e1e327c997d2c7de">route_entry_clone</a> (<a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *this)</td></tr>
<tr class="separator:a50ff6b3b73afc5e4e1e327c997d2c7de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c52872ecaf51327953d6549e19fcd9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a16c52872ecaf51327953d6549e19fcd9">route_entry_destroy</a> (<a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *this)</td></tr>
<tr class="separator:a16c52872ecaf51327953d6549e19fcd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db2b3799d8a71b78f774ff07a5dae00"><td class="memItemLeft" align="right" valign="top">static u_int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a2db2b3799d8a71b78f774ff07a5dae00">route_entry_hash</a> (<a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *this)</td></tr>
<tr class="separator:a2db2b3799d8a71b78f774ff07a5dae00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6292b2ef17d9eb62070af2a8af54dcf3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a6292b2ef17d9eb62070af2a8af54dcf3">route_entry_equals</a> (<a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>)</td></tr>
<tr class="separator:a6292b2ef17d9eb62070af2a8af54dcf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a31ce09ddc60d87a5b04e50ca3de67"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a56a31ce09ddc60d87a5b04e50ca3de67">net_change_destroy</a> (<a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *this)</td></tr>
<tr class="separator:a56a31ce09ddc60d87a5b04e50ca3de67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42a9217a43385132ed195727fdae32c9"><td class="memItemLeft" align="right" valign="top">static u_int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a42a9217a43385132ed195727fdae32c9">net_change_hash</a> (<a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *this)</td></tr>
<tr class="separator:a42a9217a43385132ed195727fdae32c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f2fc1a51aba0dc778bd148f650550ff"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a0f2fc1a51aba0dc778bd148f650550ff">net_change_equals</a> (<a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>)</td></tr>
<tr class="separator:a0f2fc1a51aba0dc778bd148f650550ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb4225c5228122371f3ef9fe600c523"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, int nlmsg_type, int <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#a9ee1a422c42e31a1f1638ac614822623">flags</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dst_net, u_int8_t prefixlen, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *gateway, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *src_ip, char *if_name)</td></tr>
<tr class="separator:a0fb4225c5228122371f3ef9fe600c523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad005c300e70718321d1b8550ccb476af"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#ad005c300e70718321d1b8550ccb476af">net_changes_clear</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this)</td></tr>
<tr class="separator:ad005c300e70718321d1b8550ccb476af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3cebb1319733db373466a7b44f0aebf"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d63/structjob__requeue__t.html">job_requeue_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#af3cebb1319733db373466a7b44f0aebf">reinstall_routes</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this)</td></tr>
<tr class="separator:af3cebb1319733db373466a7b44f0aebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f4d312f2e3ae7e2ef669ff35e21bee8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a0f4d312f2e3ae7e2ef669ff35e21bee8">queue_route_reinstall</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, char *if_name)</td></tr>
<tr class="separator:a0f4d312f2e3ae7e2ef669ff35e21bee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ac3e70878acb3963e1064a4964e26f0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a4ac3e70878acb3963e1064a4964e26f0">is_vip_installed_or_gone</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>, <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> **entry)</td></tr>
<tr class="separator:a4ac3e70878acb3963e1064a4964e26f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34793bb5a8a46b632833c292910b1f81"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a34793bb5a8a46b632833c292910b1f81">is_known_vip</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>)</td></tr>
<tr class="separator:a34793bb5a8a46b632833c292910b1f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32fc094777315d46304963b5a6a7e631"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a32fc094777315d46304963b5a6a7e631">addr_map_entry_add</a> (<a class="el" href="../../dd/d49/structhashtable__t.html">hashtable_t</a> *map, <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="el" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>, <a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface)</td></tr>
<tr class="separator:a32fc094777315d46304963b5a6a7e631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b62cb29d42de4ef8ef3a436a0cbde5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#ae2b62cb29d42de4ef8ef3a436a0cbde5">addr_map_entry_remove</a> (<a class="el" href="../../dd/d49/structhashtable__t.html">hashtable_t</a> *map, <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="el" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>, <a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface)</td></tr>
<tr class="separator:ae2b62cb29d42de4ef8ef3a436a0cbde5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f7980c4116904644f96e2d8fcfa8109"><td class="memItemLeft" align="right" valign="top">static u_char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a3f7980c4116904644f96e2d8fcfa8109">get_scope</a> (<a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>)</td></tr>
<tr class="separator:a3f7980c4116904644f96e2d8fcfa8109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a648efa40917556769449756994bdf492"><td class="memItemLeft" align="right" valign="top">static u_char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a648efa40917556769449756994bdf492">common_prefix</a> (<a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>)</td></tr>
<tr class="separator:a648efa40917556769449756994bdf492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46555f8629f621bd40ace28fe474457f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a46555f8629f621bd40ace28fe474457f">is_address_better</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a4439515889e6355c6e31915b6423d562">a</a>, <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="el" href="../../d9/dbe/test__utils_8c.html#a3d7c23b9993b08b9f774b22762fa685f">b</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *d)</td></tr>
<tr class="separator:a46555f8629f621bd40ace28fe474457f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1bf8d0ca6eaf4ea6e8d04d791f73987"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#af1bf8d0ca6eaf4ea6e8d04d791f73987">get_interface_address</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, int ifindex, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d2b/ip__packet_8c.html#aef6af1f03450c0582fd9489a8166aa61">dest</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *candidate)</td></tr>
<tr class="separator:af1bf8d0ca6eaf4ea6e8d04d791f73987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6845422ba132bb780bdc513b2c846d64"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d63/structjob__requeue__t.html">job_requeue_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a6845422ba132bb780bdc513b2c846d64">roam_event</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this)</td></tr>
<tr class="separator:a6845422ba132bb780bdc513b2c846d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c5e768dcc201c5dbfcbed72326396da"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a0c5e768dcc201c5dbfcbed72326396da">fire_roam_event</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> address)</td></tr>
<tr class="separator:a0c5e768dcc201c5dbfcbed72326396da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5380f306f77b51da4bb8012386d5920e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a5380f306f77b51da4bb8012386d5920e">is_interface_up_and_usable</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, int index)</td></tr>
<tr class="separator:a5380f306f77b51da4bb8012386d5920e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed5d0408522c487f320dcb1bc620d80"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#aaed5d0408522c487f320dcb1bc620d80">addr_entry_unregister</a> (<a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="el" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>, <a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this)</td></tr>
<tr class="separator:aaed5d0408522c487f320dcb1bc620d80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f87b0e61837c8bde853f9eda9756613"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a0f87b0e61837c8bde853f9eda9756613">process_link</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>)</td></tr>
<tr class="separator:a0f87b0e61837c8bde853f9eda9756613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a524a440e79bfb8f59290902a14bb30e8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a524a440e79bfb8f59290902a14bb30e8">process_addr</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>)</td></tr>
<tr class="separator:a524a440e79bfb8f59290902a14bb30e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ee1f950fc5de3ab43335aebf95aeed"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#aa4ee1f950fc5de3ab43335aebf95aeed">process_route</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr)</td></tr>
<tr class="separator:aa4ee1f950fc5de3ab43335aebf95aeed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadc72ac0ee4c3eee050dcde86c5230d6"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#aadc72ac0ee4c3eee050dcde86c5230d6">receive_events</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, int fd, <a class="el" href="../../d3/d2f/group__watcher.html#ga0ef1a504b06dd8f3ab0d73f0ee8d8a13">watcher_event_t</a> <a class="el" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>)</td></tr>
<tr class="separator:aadc72ac0ee4c3eee050dcde86c5230d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fac900724f973c30540ca9e015a31c6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a9fac900724f973c30540ca9e015a31c6">address_enumerator_destroy</a> (<a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *<a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>)</td></tr>
<tr class="separator:a9fac900724f973c30540ca9e015a31c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c9211dfde703e3fab766d8ac1d27c8e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a3c9211dfde703e3fab766d8ac1d27c8e">filter_addresses</a> (<a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *<a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>, <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> **<a class="el" href="../../d9/dbe/test__utils_8c.html#af64a0227ac124692942e0d1f7bdc6e00">in</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> **<a class="el" href="../../d9/dbe/test__utils_8c.html#a392d7ef877b6258e64850ce3a2647dae">out</a>)</td></tr>
<tr class="separator:a3c9211dfde703e3fab766d8ac1d27c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef4b9f456462ecc582f49f38cc474f9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a3ef4b9f456462ecc582f49f38cc474f9">create_iface_enumerator</a> (<a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface, <a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *<a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>)</td></tr>
<tr class="separator:a3ef4b9f456462ecc582f49f38cc474f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb8c440516a9849b9d93dc315c164053"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#adb8c440516a9849b9d93dc315c164053">filter_interfaces</a> (<a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *<a class="el" href="../../d1/d99/test__ntru_8c.html#a13a10b1ab8ef1bc239e141f5dadc067b">data</a>, <a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> **<a class="el" href="../../d9/dbe/test__utils_8c.html#af64a0227ac124692942e0d1f7bdc6e00">in</a>, <a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> **<a class="el" href="../../d9/dbe/test__utils_8c.html#a392d7ef877b6258e64850ce3a2647dae">out</a>)</td></tr>
<tr class="separator:adb8c440516a9849b9d93dc315c164053"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a797d4b497f63d4cc78aa56fea04cc5a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a797d4b497f63d4cc78aa56fea04cc5a6">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, create_address_enumerator, <a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d0/d22/group__kernel__net.html#gaec0f8396984f98ff469cb1f5fac1c7b5">kernel_address_type_t</a> which)</td></tr>
<tr class="separator:a797d4b497f63d4cc78aa56fea04cc5a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18c40e636c29feb4db892474af62edb0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a18c40e636c29feb4db892474af62edb0">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, get_interface_name, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>, char **<a class="el" href="../../d7/da0/test__parser_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td></tr>
<tr class="separator:a18c40e636c29feb4db892474af62edb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19d8672f22f597f18a131d57efd33ec"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#af19d8672f22f597f18a131d57efd33ec">get_interface_index</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, char *<a class="el" href="../../d7/da0/test__parser_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td></tr>
<tr class="separator:af19d8672f22f597f18a131d57efd33ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a670963494309b27c57c9941608631f1d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a670963494309b27c57c9941608631f1d">addr_in_subnet</a> (<a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a2f13c35b1fa3de2bd8c668d4a0d52706">net</a>, int net_len)</td></tr>
<tr class="separator:a670963494309b27c57c9941608631f1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8fd81b195f159d61c21e5b82eb1a8fd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#af8fd81b195f159d61c21e5b82eb1a8fd">rt_entry_destroy</a> (<a class="el" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a> *this)</td></tr>
<tr class="separator:af8fd81b195f159d61c21e5b82eb1a8fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab49cfa5833bc6a05cc7058bd45aed9aa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#ab49cfa5833bc6a05cc7058bd45aed9aa">route_usable</a> (struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr)</td></tr>
<tr class="separator:ab49cfa5833bc6a05cc7058bd45aed9aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a815ab18f327d4cb1d05deca255373"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#ae6a815ab18f327d4cb1d05deca255373">parse_route</a> (struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr, <a class="el" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a> *route)</td></tr>
<tr class="separator:ae6a815ab18f327d4cb1d05deca255373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add8ea34240fa67be8682f623e7b61891"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#add8ea34240fa67be8682f623e7b61891">get_route</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d2b/ip__packet_8c.html#aef6af1f03450c0582fd9489a8166aa61">dest</a>, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> nexthop, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *candidate, u_int recursion)</td></tr>
<tr class="separator:add8ea34240fa67be8682f623e7b61891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a427a6e01d6e9699d3396211dabe5fdbb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a427a6e01d6e9699d3396211dabe5fdbb">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, get_source_addr, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d2b/ip__packet_8c.html#aef6af1f03450c0582fd9489a8166aa61">dest</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>)</td></tr>
<tr class="separator:a427a6e01d6e9699d3396211dabe5fdbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8055d717fc5d95acfd6fadf9eb073c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#ae8055d717fc5d95acfd6fadf9eb073c4">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, get_nexthop, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d2b/ip__packet_8c.html#aef6af1f03450c0582fd9489a8166aa61">dest</a>, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>)</td></tr>
<tr class="separator:ae8055d717fc5d95acfd6fadf9eb073c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1160788a04132956fb9fcd0ab0552ba4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a1160788a04132956fb9fcd0ab0552ba4">manage_ipaddr</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, int nlmsg_type, int <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#a9ee1a422c42e31a1f1638ac614822623">flags</a>, int if_index, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>)</td></tr>
<tr class="separator:a1160788a04132956fb9fcd0ab0552ba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeca4a8be4eca27916eee69fadda9b886"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#aeca4a8be4eca27916eee69fadda9b886">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, add_ip, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *virtual_ip, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, char *iface_name)</td></tr>
<tr class="separator:aeca4a8be4eca27916eee69fadda9b886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace07348130970cc5fbd634f755f6230f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#ace07348130970cc5fbd634f755f6230f">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, del_ip, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *virtual_ip, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> wait)</td></tr>
<tr class="separator:ace07348130970cc5fbd634f755f6230f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6518ff90e8fda63a800cc1f01d138520"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a6518ff90e8fda63a800cc1f01d138520">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, add_route, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dst_net, u_int8_t prefixlen, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *gateway, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *src_ip, char *if_name)</td></tr>
<tr class="separator:a6518ff90e8fda63a800cc1f01d138520"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f3f1ce8f8dde7cdab3e054848d5895b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a5f3f1ce8f8dde7cdab3e054848d5895b">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, del_route, <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dst_net, u_int8_t prefixlen, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *gateway, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *src_ip, char *if_name)</td></tr>
<tr class="separator:a5f3f1ce8f8dde7cdab3e054848d5895b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6171ad9e6cb4f8e8abc248a8e14182ca"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a6171ad9e6cb4f8e8abc248a8e14182ca">init_address_list</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this)</td></tr>
<tr class="separator:a6171ad9e6cb4f8e8abc248a8e14182ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fc64fdc22a19e137870e17197ed5cc2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a2fc64fdc22a19e137870e17197ed5cc2">manage_rule</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this, int nlmsg_type, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>, u_int32_t table, u_int32_t prio)</td></tr>
<tr class="separator:a2fc64fdc22a19e137870e17197ed5cc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f0e2e6315fb2afcb7dac4c5f0c85f13"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a9f0e2e6315fb2afcb7dac4c5f0c85f13">check_kernel_features</a> (<a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this)</td></tr>
<tr class="separator:a9f0e2e6315fb2afcb7dac4c5f0c85f13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e22541bb38cf5d3072adad93e2b0767"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#a8e22541bb38cf5d3072adad93e2b0767">addr_map_destroy</a> (<a class="el" href="../../dd/d49/structhashtable__t.html">hashtable_t</a> *map)</td></tr>
<tr class="separator:a8e22541bb38cf5d3072adad93e2b0767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf60c75dd18e7081cecee6bc166bcebf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#acf60c75dd18e7081cecee6bc166bcebf">METHOD</a> (<a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>, <a class="el" href="../../d4/ddc/windows_2thread_8c.html#a343cd07ea8770e572cfe3a7d39ea8401">destroy</a>, void, <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *this)</td></tr>
<tr class="separator:acf60c75dd18e7081cecee6bc166bcebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga085e463746e0ef5b2537f94dee888bb3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d59/structkernel__netlink__net__t.html">kernel_netlink_net_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dbb/group__kernel__netlink__net__i.html#ga085e463746e0ef5b2537f94dee888bb3">kernel_netlink_net_create</a> ()</td></tr>
<tr class="separator:ga085e463746e0ef5b2537f94dee888bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a714d288372018cf438e388ab2c7f28e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_ROUTE_RECURSION&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>maximum recursion when searching for addresses in <a class="el" href="../../d5/d90/kernel__netlink__net_8c.html#add8ea34240fa67be8682f623e7b61891">get_route()</a> </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00071">71</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>.</p>

</div>
</div>
<a class="anchor" id="ad23bc7e9d28fa00f264e8690b810a710"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROAM_DELAY&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>delay before firing roam events (ms) </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00065">65</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">fire_roam_event()</a>.</p>

</div>
</div>
<a class="anchor" id="a96f22cfbf0c80c9849f9fc765f9bd2c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROUTE_DELAY&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>delay before reinstalling routes (ms) </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00068">68</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">queue_route_reinstall()</a>.</p>

</div>
</div>
<a class="anchor" id="a1c34f80b185c2938954b01f86edc6c2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROUTING_TABLE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00074">74</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a36428db8194c045b590bc51ee65fe21f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROUTING_TABLE_PRIO&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00078">78</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a12f4dbcfab5b7ff0d7eeccc09aa13867"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00102">102</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

</div>
</div>
<a class="anchor" id="aaa2b72998ab4dad78e3454872e3545f4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00198">198</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7bf4287633637937da98dffc1fddfc00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> <a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00134">134</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7f0bfb65267408d28739506f392b14af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> <a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00337">337</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4991f5af31fff798e7c0c823f57346e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> <a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00372">372</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

</div>
</div>
<a class="anchor" id="aaf17c1b6357daefe087749686144d1f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00262">262</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7235c174351cbc6544dad599e0cb03d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void addr_entry_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>destroy a <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> object </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00128">128</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, and <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">ip</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00160">iface_entry_destroy()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">process_addr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    this-&gt;<a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a>-&gt;destroy(this-&gt;<a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="ttc" id="error__notify__msg_8h_html_abcc82b944bf2a158e29a4042043185a5"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a></div><div class="ttdeci">char ip[60]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">error_notify_msg.h:53</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a7235c174351cbc6544dad599e0cb03d1_cgraph.svg" width="238" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a7235c174351cbc6544dad599e0cb03d1_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaed5d0408522c487f320dcb1bc620d80"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void addr_entry_unregister </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>iface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>unregister the current <a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> from the hashtable it is stored in</p>
<p>this-&gt;lock must be locked when calling this function </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00954">954</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00691">addr_map_entry_remove()</a>, <a class="el" href="../../d0/d40/condvar_8h_source.html#l00079">condvar_t::broadcast</a>, <a class="el" href="../../d4/ded/test__threading_8c_source.html#l00117">condvar</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00119">addr_entry_t::refcount</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">process_link()</a>.</p>
<div class="fragment"><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;{</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">refcount</a>)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ae2b62cb29d42de4ef8ef3a436a0cbde5">addr_map_entry_remove</a>(this-&gt;vips, addr, iface);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>-&gt;<a class="code" href="../../d7/dab/structcondvar__t.html#a74176965ac6053fdd34f191671d46c62">broadcast</a>(this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ae2b62cb29d42de4ef8ef3a436a0cbde5">addr_map_entry_remove</a>(this-&gt;addrs, addr, iface);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div>
<div class="ttc" id="test__threading_8c_html_a14975442a555aea5d1676fab41b7c4f0"><div class="ttname"><a href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a></div><div class="ttdeci">static condvar_t * condvar</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ded/test__threading_8c_source.html#l00117">test_threading.c:117</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a056cb96f14fa76d54b1a36eaf765ae75"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">addr_entry_t::refcount</a></div><div class="ttdeci">u_int refcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00119">kernel_netlink_net.c:119</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_ae2b62cb29d42de4ef8ef3a436a0cbde5"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#ae2b62cb29d42de4ef8ef3a436a0cbde5">addr_map_entry_remove</a></div><div class="ttdeci">static void addr_map_entry_remove(hashtable_t *map, addr_entry_t *addr, iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00691">kernel_netlink_net.c:691</a></div></div>
<div class="ttc" id="structcondvar__t_html_a74176965ac6053fdd34f191671d46c62"><div class="ttname"><a href="../../d7/dab/structcondvar__t.html#a74176965ac6053fdd34f191671d46c62">condvar_t::broadcast</a></div><div class="ttdeci">void(* broadcast)(condvar_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d40/condvar_8h_source.html#l00079">condvar.h:79</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aaed5d0408522c487f320dcb1bc620d80_cgraph.svg" width="464" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aaed5d0408522c487f320dcb1bc620d80_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a670963494309b27c57c9941608631f1d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> addr_in_subnet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>net_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>check if an address or net (addr with prefix net bits) is in subnet (net with net_len net bits) </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01507">1507</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00201">mask</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;{</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> u_char <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a09630634038e3c15c486ba89893b8301">mask</a>[] = { 0x00, 0x80, 0xc0, 0xe0, 0xf0, 0xf8, 0xfc, 0xfe };</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordtype">int</span> byte = 0;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="keywordflow">if</span> (net_len == 0)</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    {   <span class="comment">/* any address matches a /0 network */</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span> (addr.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> != net.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> || net_len &gt; 8 * net.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> || <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a> &lt; net_len)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">/* scan through all bytes in network order */</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">while</span> (net_len &gt; 0)</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordflow">if</span> (net_len &lt; 8)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keywordflow">return</span> (mask[net_len] &amp; addr.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[byte]) == (mask[net_len] &amp; net.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[byte]);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        }</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            <span class="keywordflow">if</span> (addr.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[byte] != net.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[byte])</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            byte++;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            net_len -= 8;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a09630634038e3c15c486ba89893b8301"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a09630634038e3c15c486ba89893b8301">mask</a></div><div class="ttdeci">u_int8_t mask</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00201">test_traffic_selector.c:201</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="test__utils_8c_html_a0a7083cd7ae62f5c50d6abd5cdd491ab"><div class="ttname"><a href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a></div><div class="ttdeci">bool prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbe/test__utils_8c_source.html#l00206">test_utils.c:206</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a670963494309b27c57c9941608631f1d_icgraph.svg" width="376" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8e22541bb38cf5d3072adad93e2b0767"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void addr_map_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d49/structhashtable__t.html">hashtable_t</a> *&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destroy an address to iface map </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02482">2482</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../dd/d16/hashtable_8h_source.html#l00091">hashtable_t::create_enumerator</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../dd/d16/hashtable_8h_source.html#l00158">hashtable_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02496">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;{</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    enumerator = map-&gt;<a class="code" href="../../dd/d49/structhashtable__t.html#ae00ba04883eb1d599035c3e556597ad3">create_enumerator</a>(map);</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, NULL, (<span class="keywordtype">void</span>**)&amp;addr))</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(addr);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    }</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    map-&gt;<a class="code" href="../../dd/d49/structhashtable__t.html#ae4d87a7c0d52c6c274881f801ecdc8fe">destroy</a>(map);</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;}</div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="structhashtable__t_html_ae00ba04883eb1d599035c3e556597ad3"><div class="ttname"><a href="../../dd/d49/structhashtable__t.html#ae00ba04883eb1d599035c3e556597ad3">hashtable_t::create_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_enumerator)(hashtable_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/hashtable_8h_source.html#l00091">hashtable.h:91</a></div></div>
<div class="ttc" id="structhashtable__t_html_ae4d87a7c0d52c6c274881f801ecdc8fe"><div class="ttname"><a href="../../dd/d49/structhashtable__t.html#ae4d87a7c0d52c6c274881f801ecdc8fe">hashtable_t::destroy</a></div><div class="ttdeci">void(* destroy)(hashtable_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/hashtable_8h_source.html#l00158">hashtable.h:158</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a8e22541bb38cf5d3072adad93e2b0767_cgraph.svg" width="235" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a8e22541bb38cf5d3072adad93e2b0767_icgraph.svg" width="270" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a32fc094777315d46304963b5a6a7e631"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void addr_map_entry_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d49/structhashtable__t.html">hashtable_t</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>iface</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Add an address map entry </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00674">674</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">ip</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">addr_entry_t::ip</a>, and <a class="el" href="../../dd/d16/hashtable_8h_source.html#l00103">hashtable_t::put</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01970">METHOD()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">process_addr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;{</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *entry;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(entry,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        .<a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a> = addr-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        .addr = addr,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        .iface = iface,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    );</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    entry = map-&gt;<a class="code" href="../../dd/d49/structhashtable__t.html#a6c0b82fd1646659745ced58f6f404d04">put</a>(map, entry, entry);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(entry);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;}</div>
<div class="ttc" id="error__notify__msg_8h_html_abcc82b944bf2a158e29a4042043185a5"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a></div><div class="ttdeci">char ip[60]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">error_notify_msg.h:53</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structhashtable__t_html_a6c0b82fd1646659745ced58f6f404d04"><div class="ttname"><a href="../../dd/d49/structhashtable__t.html#a6c0b82fd1646659745ced58f6f404d04">hashtable_t::put</a></div><div class="ttdeci">void *(* put)(hashtable_t *this, const void *key, void *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/hashtable_8h_source.html#l00103">hashtable.h:103</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a9fecb8edaffa35df931c847d9e95a091"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">addr_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">kernel_netlink_net.c:110</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a32fc094777315d46304963b5a6a7e631_cgraph.svg" width="248" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a32fc094777315d46304963b5a6a7e631_icgraph.svg" width="100%" height="385"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a60f280b2e2a089842a6db7670de5c2c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> addr_map_entry_equals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compare two <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> objects, two entries are equal if they are installed on the same interface </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00227">227</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">addr_map_entry_t::iface</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">iface_entry_t::ifindex</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">addr_map_entry_t::ip</a>, and <a class="el" href="../../df/ded/host_8h_source.html#l00117">host_t::ip_equals</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">return</span> a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">ifindex</a> == b-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">ifindex</a> &amp;&amp;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;           a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>, b-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
<div class="ttc" id="structhost__t_html_a7c1454eaeb7aeadd449616181c14f620"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">host_t::ip_equals</a></div><div class="ttdeci">bool(* ip_equals)(host_t *this, host_t *other)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00117">host.h:117</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a2b7c25110232f9e43068d0216e1c90f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">addr_map_entry_t::iface</a></div><div class="ttdeci">iface_entry_t * iface</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">kernel_netlink_net.c:211</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a1a08a8af40b92ca44f2e05c06dd601f4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">iface_entry_t::ifindex</a></div><div class="ttdeci">int ifindex</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">kernel_netlink_net.c:142</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a33ffe1ca297efc6d8b4cdb4a2b1416f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">addr_map_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">kernel_netlink_net.c:205</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a60f280b2e2a089842a6db7670de5c2c9_icgraph.svg" width="475" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a82c781f50f72bded96214271be28b551"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int addr_map_entry_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Hash a <a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> object, all entries with the same IP address are stored in the same bucket </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00218">218</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d8/d39/chunk_8c_source.html#l00969">chunk_hash()</a>, and <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">ip</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;{</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d87/group__chunk.html#ga714bd1cb9e1f743523c2a58a49f1b6a4">chunk_hash</a>(this-&gt;<a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a>-&gt;get_address(this-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
<div class="ttc" id="group__chunk_html_ga714bd1cb9e1f743523c2a58a49f1b6a4"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga714bd1cb9e1f743523c2a58a49f1b6a4">chunk_hash</a></div><div class="ttdeci">u_int32_t chunk_hash(chunk_t chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00969">chunk.c:969</a></div></div>
<div class="ttc" id="error__notify__msg_8h_html_abcc82b944bf2a158e29a4042043185a5"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a></div><div class="ttdeci">char ip[60]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">error_notify_msg.h:53</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a33ffe1ca297efc6d8b4cdb4a2b1416f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">addr_map_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">kernel_netlink_net.c:205</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a82c781f50f72bded96214271be28b551_cgraph.svg" width="100%" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a82c781f50f72bded96214271be28b551_icgraph.svg" width="467" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="acd3374d9d8f49b40648171e449a059bb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> addr_map_entry_match </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Used with get_match this finds an address entry if it is installed on any local interface </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">257</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">addr_map_entry_t::ip</a>, and <a class="el" href="../../df/ded/host_8h_source.html#l00117">host_t::ip_equals</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00661">is_known_vip()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00640">is_vip_installed_or_gone()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01970">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;{</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">return</span> a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>, b-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div>
<div class="ttc" id="structhost__t_html_a7c1454eaeb7aeadd449616181c14f620"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">host_t::ip_equals</a></div><div class="ttdeci">bool(* ip_equals)(host_t *this, host_t *other)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00117">host.h:117</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a33ffe1ca297efc6d8b4cdb4a2b1416f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">addr_map_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">kernel_netlink_net.c:205</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_acd3374d9d8f49b40648171e449a059bb_icgraph.svg" width="100%" height="447"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa52f2cdfb0ddf0864d2808f1e96af8f6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> addr_map_entry_match_up </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Used with get_match this finds an address entry if it is installed on any active local interface </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00248">248</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">addr_map_entry_t::iface</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00185">iface_entry_up()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">addr_map_entry_t::ip</a>, and <a class="el" href="../../df/ded/host_8h_source.html#l00117">host_t::ip_equals</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01429">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;{</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a4b3597e6b5433acae9d22f4efa612d4b">iface_entry_up</a>(b-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>) &amp;&amp; a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>, b-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
<div class="ttc" id="structhost__t_html_a7c1454eaeb7aeadd449616181c14f620"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">host_t::ip_equals</a></div><div class="ttdeci">bool(* ip_equals)(host_t *this, host_t *other)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00117">host.h:117</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a4b3597e6b5433acae9d22f4efa612d4b"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a4b3597e6b5433acae9d22f4efa612d4b">iface_entry_up</a></div><div class="ttdeci">static bool iface_entry_up(iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00185">kernel_netlink_net.c:185</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a2b7c25110232f9e43068d0216e1c90f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">addr_map_entry_t::iface</a></div><div class="ttdeci">iface_entry_t * iface</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">kernel_netlink_net.c:211</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a33ffe1ca297efc6d8b4cdb4a2b1416f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">addr_map_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">kernel_netlink_net.c:205</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aa52f2cdfb0ddf0864d2808f1e96af8f6_cgraph.svg" width="344" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aa52f2cdfb0ddf0864d2808f1e96af8f6_icgraph.svg" width="318" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="af29ddd9c2b58f1a5d0bf38ed6ac2b718"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> addr_map_entry_match_up_and_usable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Used with get_match this finds an address entry if it is installed on an up and usable interface </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00237">237</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">addr_map_entry_t::iface</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00193">iface_entry_up_and_usable()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">addr_map_entry_t::ip</a>, and <a class="el" href="../../df/ded/host_8h_source.html#l00117">host_t::ip_equals</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01429">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a1db8c558ca19629f217439383b872e11">iface_entry_up_and_usable</a>(b-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>) &amp;&amp;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;           a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(a-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>, b-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">ip</a>);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="ttc" id="structhost__t_html_a7c1454eaeb7aeadd449616181c14f620"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">host_t::ip_equals</a></div><div class="ttdeci">bool(* ip_equals)(host_t *this, host_t *other)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00117">host.h:117</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a2b7c25110232f9e43068d0216e1c90f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">addr_map_entry_t::iface</a></div><div class="ttdeci">iface_entry_t * iface</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">kernel_netlink_net.c:211</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a33ffe1ca297efc6d8b4cdb4a2b1416f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a33ffe1ca297efc6d8b4cdb4a2b1416f5">addr_map_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00205">kernel_netlink_net.c:205</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a1db8c558ca19629f217439383b872e11"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a1db8c558ca19629f217439383b872e11">iface_entry_up_and_usable</a></div><div class="ttdeci">static bool iface_entry_up_and_usable(iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00193">kernel_netlink_net.c:193</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af29ddd9c2b58f1a5d0bf38ed6ac2b718_cgraph.svg" width="510" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af29ddd9c2b58f1a5d0bf38ed6ac2b718_icgraph.svg" width="299" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae2b62cb29d42de4ef8ef3a436a0cbde5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void addr_map_entry_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d49/structhashtable__t.html">hashtable_t</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>iface</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Remove an address map entry </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00691">691</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">addr_entry_t::ip</a>, <a class="el" href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">lookup</a>, and <a class="el" href="../../dd/d16/hashtable_8h_source.html#l00138">hashtable_t::remove</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00954">addr_entry_unregister()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">process_addr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;{</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *entry, <a class="code" href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a> = {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        .ip = addr-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>,</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        .addr = <a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>,</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        .iface = iface,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    };</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    entry = map-&gt;<a class="code" href="../../dd/d49/structhashtable__t.html#a7282e92923b5c74ea71d5b43b424b3c1">remove</a>(map, &amp;lookup);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(entry);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="proposal__keywords__static_8c_html_a85d2eea012c83b4dd2615d97bddbffc8"><div class="ttname"><a href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a></div><div class="ttdeci">static const short lookup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">proposal_keywords_static.c:288</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="structhashtable__t_html_a7282e92923b5c74ea71d5b43b424b3c1"><div class="ttname"><a href="../../dd/d49/structhashtable__t.html#a7282e92923b5c74ea71d5b43b424b3c1">hashtable_t::remove</a></div><div class="ttdeci">void *(* remove)(hashtable_t *this, const void *key)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/hashtable_8h_source.html#l00138">hashtable.h:138</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a9fecb8edaffa35df931c847d9e95a091"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">addr_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">kernel_netlink_net.c:110</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ae2b62cb29d42de4ef8ef3a436a0cbde5_cgraph.svg" width="270" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ae2b62cb29d42de4ef8ef3a436a0cbde5_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9fac900724f973c30540ca9e015a31c6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void address_enumerator_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>cleanup function for address enumerator </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01349">1349</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00386">private_kernel_netlink_net_t::lock</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01341">address_enumerator_t::this</a>, and <a class="el" href="../../d7/d1d/rwlock_8h_source.html#l00063">rwlock_t::unlock</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01410">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;{</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    data-&gt;<a class="code" href="../../da/d71/structaddress__enumerator__t.html#a90d2d0a778e06f67b06d7e6af8372d0c">this</a>-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#ac1e18271a3ea8176afdd72b71c6c69b3">lock</a>-&gt;<a class="code" href="../../db/d86/structrwlock__t.html#af7795d1222e09f15a7974cd6b02a447d">unlock</a>(data-&gt;<a class="code" href="../../da/d71/structaddress__enumerator__t.html#a90d2d0a778e06f67b06d7e6af8372d0c">this</a>-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#ac1e18271a3ea8176afdd72b71c6c69b3">lock</a>);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(data);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;}</div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_ac1e18271a3ea8176afdd72b71c6c69b3"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#ac1e18271a3ea8176afdd72b71c6c69b3">private_kernel_netlink_net_t::lock</a></div><div class="ttdeci">rwlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00386">kernel_netlink_net.c:386</a></div></div>
<div class="ttc" id="structrwlock__t_html_af7795d1222e09f15a7974cd6b02a447d"><div class="ttname"><a href="../../db/d86/structrwlock__t.html#af7795d1222e09f15a7974cd6b02a447d">rwlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(rwlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1d/rwlock_8h_source.html#l00063">rwlock.h:63</a></div></div>
<div class="ttc" id="structaddress__enumerator__t_html_a90d2d0a778e06f67b06d7e6af8372d0c"><div class="ttname"><a href="../../da/d71/structaddress__enumerator__t.html#a90d2d0a778e06f67b06d7e6af8372d0c">address_enumerator_t::this</a></div><div class="ttdeci">private_kernel_netlink_net_t * this</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01341">kernel_netlink_net.c:1341</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a9fac900724f973c30540ca9e015a31c6_cgraph.svg" width="246" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a9fac900724f973c30540ca9e015a31c6_icgraph.svg" width="280" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9f0e2e6315fb2afcb7dac4c5f0c85f13"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void check_kernel_features </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>check for kernel features (currently only via version number) </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02447">2447</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d0/d79/eap__aka__3gpp2__functions_8c_source.html#l00066">a</a>, <a class="el" href="../../d0/d79/eap__aka__3gpp2__functions_8c_source.html#l00075">b</a>, <a class="el" href="../../d4/da3/test__identification_8c_source.html#l00120">c</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;{</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="keyword">struct </span>utsname utsname;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d0/d79/eap__aka__3gpp2__functions_8c.html#a9723524f0aac120ec0a4cb7f61c3ec69">a</a>, <a class="code" href="../../d0/d79/eap__aka__3gpp2__functions_8c.html#a3647b13ff7cca2d3263befc32b63ddf2">b</a>, <a class="code" href="../../d4/da3/test__identification_8c.html#aaacb3381d883ddbd89fc5f5bbaa8ac40">c</a>;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <span class="keywordflow">if</span> (uname(&amp;utsname) == 0)</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    {</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        <span class="keywordflow">switch</span>(sscanf(utsname.release, <span class="stringliteral">&quot;%d.%d.%d&quot;</span>, &amp;a, &amp;b, &amp;c))</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        {</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;            <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                <span class="keywordflow">if</span> (a == 2)</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                    <span class="keywordflow">if</span> (b == 6 &amp;&amp; c &gt;= 36)</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                    {</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                        this-&gt;rta_mark = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                    }</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;detected Linux %d.%d.%d, no support for &quot;</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                         <span class="stringliteral">&quot;RTA_PREFSRC for IPv6 routes&quot;</span>, a, b, c);</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                }</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                <span class="comment">/* fall-through */</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;            <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                <span class="comment">/* only 3.x+ uses two part version numbers */</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                this-&gt;rta_prefsrc_for_ipv6 = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                this-&gt;rta_mark = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        }</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    }</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="eap__aka__3gpp2__functions_8c_html_a9723524f0aac120ec0a4cb7f61c3ec69"><div class="ttname"><a href="../../d0/d79/eap__aka__3gpp2__functions_8c.html#a9723524f0aac120ec0a4cb7f61c3ec69">a</a></div><div class="ttdeci">static u_int8_t a[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/eap__aka__3gpp2__functions_8c_source.html#l00066">eap_aka_3gpp2_functions.c:66</a></div></div>
<div class="ttc" id="eap__aka__3gpp2__functions_8c_html_a3647b13ff7cca2d3263befc32b63ddf2"><div class="ttname"><a href="../../d0/d79/eap__aka__3gpp2__functions_8c.html#a3647b13ff7cca2d3263befc32b63ddf2">b</a></div><div class="ttdeci">static u_int8_t b[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/eap__aka__3gpp2__functions_8c_source.html#l00075">eap_aka_3gpp2_functions.c:75</a></div></div>
<div class="ttc" id="test__identification_8c_html_aaacb3381d883ddbd89fc5f5bbaa8ac40"><div class="ttname"><a href="../../d4/da3/test__identification_8c.html#aaacb3381d883ddbd89fc5f5bbaa8ac40">c</a></div><div class="ttdeci">chunk_t c</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/test__identification_8c_source.html#l00120">test_identification.c:120</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a9f0e2e6315fb2afcb7dac4c5f0c85f13_icgraph.svg" width="470" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a648efa40917556769449756994bdf492"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_char common_prefix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the length of the common prefix in bits up to the length of a's prefix, defined by RFC 6724 as the portion of the address not including the interface ID, which is 64-bit for most unicast addresses (see RFC 4291). </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00754">754</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../da/d41/test__bliss__bitpacker_8c_source.html#l00020">bits</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00095">host_t::get_address</a>, <a class="el" href="../../d4/d7b/ike__cfg_8c_source.html#l00189">match()</a>, and <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00781">is_address_better()</a>.</p>
<div class="fragment"><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;{</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> aa, ba;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    u_char byte, <a class="code" href="../../da/d41/test__bliss__bitpacker_8c.html#a7afe643191c861f57d5852578e86dd56">bits</a> = 0, <a class="code" href="../../d4/d7b/ike__cfg_8c.html#afd2ad039e594563627520b9a6908b6c5">match</a>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    aa = a-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(a);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    ba = b-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(b);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">for</span> (byte = 0; byte &lt; 8; byte++)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">if</span> (aa.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[byte] != ba.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[byte])</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <a class="code" href="../../d4/d7b/ike__cfg_8c.html#afd2ad039e594563627520b9a6908b6c5">match</a> = aa.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[byte] ^ ba.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[byte];</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">for</span> (bits = 8; <a class="code" href="../../d4/d7b/ike__cfg_8c.html#afd2ad039e594563627520b9a6908b6c5">match</a>; <a class="code" href="../../d4/d7b/ike__cfg_8c.html#afd2ad039e594563627520b9a6908b6c5">match</a> &gt;&gt;= 1)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                bits--;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">return</span> byte * 8 + <a class="code" href="../../da/d41/test__bliss__bitpacker_8c.html#a7afe643191c861f57d5852578e86dd56">bits</a>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div>
<div class="ttc" id="test__bliss__bitpacker_8c_html_a7afe643191c861f57d5852578e86dd56"><div class="ttname"><a href="../../da/d41/test__bliss__bitpacker_8c.html#a7afe643191c861f57d5852578e86dd56">bits</a></div><div class="ttdeci">static uint32_t bits[]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d41/test__bliss__bitpacker_8c_source.html#l00020">test_bliss_bitpacker.c:20</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="ike__cfg_8c_html_afd2ad039e594563627520b9a6908b6c5"><div class="ttname"><a href="../../d4/d7b/ike__cfg_8c.html#afd2ad039e594563627520b9a6908b6c5">match</a></div><div class="ttdeci">static u_int match(linked_list_t *hosts, linked_list_t *ranges, host_t *cand)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d7b/ike__cfg_8c_source.html#l00189">ike_cfg.c:189</a></div></div>
<div class="ttc" id="structhost__t_html_aa3493ae67869e4cd9b4dbe98226650fb"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">host_t::get_address</a></div><div class="ttdeci">chunk_t(* get_address)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00095">host.h:95</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a648efa40917556769449756994bdf492_cgraph.svg" width="100%" height="474"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a648efa40917556769449756994bdf492_icgraph.svg" width="100%" height="371"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3ef4b9f456462ecc582f49f38cc474f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a>* create_iface_enumerator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>iface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>enumerator constructor for interfaces </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01380">1380</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">iface_entry_t::addrs</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list_t::create_enumerator</a>, <a class="el" href="../../de/d46/enumerator_8c_source.html#l00536">enumerator_create_filter()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01358">filter_addresses()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01410">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;{</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/de6/group__enumerator.html#ga7e32271ea79eb88b576ca6eb1c582751">enumerator_create_filter</a>(</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">create_enumerator</a>(iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>),</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a3c9211dfde703e3fab766d8ac1d27c8e">filter_addresses</a>, data, NULL);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;}</div>
<div class="ttc" id="kernel__netlink__net_8c_html_a3c9211dfde703e3fab766d8ac1d27c8e"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a3c9211dfde703e3fab766d8ac1d27c8e">filter_addresses</a></div><div class="ttdeci">static bool filter_addresses(address_enumerator_t *data, addr_entry_t **in, host_t **out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01358">kernel_netlink_net.c:1358</a></div></div>
<div class="ttc" id="structlinked__list__t_html_aa079d50cc4028f12d65c75cbb53f8c8a"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">linked_list_t::create_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_enumerator)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list.h:71</a></div></div>
<div class="ttc" id="group__enumerator_html_ga7e32271ea79eb88b576ca6eb1c582751"><div class="ttname"><a href="../../d3/de6/group__enumerator.html#ga7e32271ea79eb88b576ca6eb1c582751">enumerator_create_filter</a></div><div class="ttdeci">enumerator_t * enumerator_create_filter(enumerator_t *unfiltered, bool(*filter)(void *data,...), void *data, void(*destructor)(void *data))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d46/enumerator_8c_source.html#l00536">enumerator.c:536</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a074ce3bd111ba07ab802a6c74063a5a2"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">iface_entry_t::addrs</a></div><div class="ttdeci">linked_list_t * addrs</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">kernel_netlink_net.c:151</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a3ef4b9f456462ecc582f49f38cc474f9_cgraph.svg" width="646" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a3ef4b9f456462ecc582f49f38cc474f9_icgraph.svg" width="304" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad5ca5f5912654c64aa0beb1031091ca2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ENUM </td>
          <td>(</td>
          <td class="paramtype">rt_msg_names&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9">RTM_NEWLINK</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a7cc9e49292861264c277336cf9c7b4d4">RTM_GETRULE</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_NEWLINK&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_DELLINK&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_GETLINK&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_SETLINK&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_NEWADDR&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_DELADDR&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_GETADDR&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;31&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_NEWROUTE&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_DELROUTE&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_GETROUTE&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;35&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_NEWNEIGH&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_DELNEIGH&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_GETNEIGH&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_NEWRULE&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_DELRULE&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;RTM_GETRULE&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3c9211dfde703e3fab766d8ac1d27c8e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> filter_addresses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> **&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> **&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>filter for addresses </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01358">1358</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d9/df7/kernel__net_8h_source.html#l00038">ADDR_TYPE_REGULAR</a>, <a class="el" href="../../d9/df7/kernel__net_8h_source.html#l00046">ADDR_TYPE_VIRTUAL</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00261">RT_SCOPE_LINK</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01343">address_enumerator_t::which</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01380">create_iface_enumerator()</a>.</p>
<div class="fragment"><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;{</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">if</span> (!(data-&gt;<a class="code" href="../../da/d71/structaddress__enumerator__t.html#abb8292897ee6e03248e1e76013b47f06">which</a> &amp; <a class="code" href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5a7da83630180526ac60b90f66ab1aae9e">ADDR_TYPE_VIRTUAL</a>) &amp;&amp; (*in)-&gt;refcount)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    {   <span class="comment">/* skip virtual interfaces added by us */</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span> (!(data-&gt;<a class="code" href="../../da/d71/structaddress__enumerator__t.html#abb8292897ee6e03248e1e76013b47f06">which</a> &amp; <a class="code" href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5af7b8ccec659ac86b73f22c8f2daf7102">ADDR_TYPE_REGULAR</a>) &amp;&amp; !(*in)-&gt;refcount)</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    {   <span class="comment">/* address is regular, but not requested */</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keywordflow">if</span> ((*in)-&gt;scope &gt;= <a class="code" href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a582ca6b7707500588754319e5880efd9">RT_SCOPE_LINK</a>)</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    {   <span class="comment">/* skip addresses with a unusable scope */</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    }</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    *out = (*in)-&gt;ip;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a0a24f857b720ea82629522e1f5bd3cf5a582ca6b7707500588754319e5880efd9"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a582ca6b7707500588754319e5880efd9">RT_SCOPE_LINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00261">rtnetlink.h:261</a></div></div>
<div class="ttc" id="structaddress__enumerator__t_html_abb8292897ee6e03248e1e76013b47f06"><div class="ttname"><a href="../../da/d71/structaddress__enumerator__t.html#abb8292897ee6e03248e1e76013b47f06">address_enumerator_t::which</a></div><div class="ttdeci">kernel_address_type_t which</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01343">kernel_netlink_net.c:1343</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__kernel__net_html_ggaec0f8396984f98ff469cb1f5fac1c7b5af7b8ccec659ac86b73f22c8f2daf7102"><div class="ttname"><a href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5af7b8ccec659ac86b73f22c8f2daf7102">ADDR_TYPE_REGULAR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/kernel__net_8h_source.html#l00038">kernel_net.h:38</a></div></div>
<div class="ttc" id="group__kernel__net_html_ggaec0f8396984f98ff469cb1f5fac1c7b5a7da83630180526ac60b90f66ab1aae9e"><div class="ttname"><a href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5a7da83630180526ac60b90f66ab1aae9e">ADDR_TYPE_VIRTUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/kernel__net_8h_source.html#l00046">kernel_net.h:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a3c9211dfde703e3fab766d8ac1d27c8e_icgraph.svg" width="467" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="adb8c440516a9849b9d93dc315c164053"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> filter_interfaces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> **&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> **&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>filter for interfaces </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01391">1391</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d9/df7/kernel__net_8h_source.html#l00040">ADDR_TYPE_DOWN</a>, <a class="el" href="../../d9/df7/kernel__net_8h_source.html#l00042">ADDR_TYPE_IGNORED</a>, <a class="el" href="../../d9/df7/kernel__net_8h_source.html#l00044">ADDR_TYPE_LOOPBACK</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dd/dd5/aes-test_8c_source.html#l00034">in</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01343">address_enumerator_t::which</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01410">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;{</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">if</span> (!(data-&gt;<a class="code" href="../../da/d71/structaddress__enumerator__t.html#abb8292897ee6e03248e1e76013b47f06">which</a> &amp; <a class="code" href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5acc8310a1e4e7053fff2da408287cb986">ADDR_TYPE_IGNORED</a>) &amp;&amp; !(*in)-&gt;usable)</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    {   <span class="comment">/* skip interfaces excluded by config */</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="keywordflow">if</span> (!(data-&gt;<a class="code" href="../../da/d71/structaddress__enumerator__t.html#abb8292897ee6e03248e1e76013b47f06">which</a> &amp; <a class="code" href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5a3e5d45cad50425f9f617d34cbddc7378">ADDR_TYPE_LOOPBACK</a>) &amp;&amp; ((*in)-&gt;flags &amp; IFF_LOOPBACK))</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    {   <span class="comment">/* ignore loopback devices */</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">if</span> (!(data-&gt;<a class="code" href="../../da/d71/structaddress__enumerator__t.html#abb8292897ee6e03248e1e76013b47f06">which</a> &amp; <a class="code" href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5a935d53feb95c9e7417d96bf863f516fa">ADDR_TYPE_DOWN</a>) &amp;&amp; !((*in)-&gt;flags &amp; IFF_UP))</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    {   <span class="comment">/* skip interfaces not up */</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    *out = *<a class="code" href="../../dd/dd5/aes-test_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="aes-test_8c_html_aca392a8d3941cd0740aef3ad92545d67"><div class="ttname"><a href="../../dd/dd5/aes-test_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a></div><div class="ttdeci">FILE * in</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/aes-test_8c_source.html#l00034">aes-test.c:34</a></div></div>
<div class="ttc" id="group__kernel__net_html_ggaec0f8396984f98ff469cb1f5fac1c7b5a935d53feb95c9e7417d96bf863f516fa"><div class="ttname"><a href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5a935d53feb95c9e7417d96bf863f516fa">ADDR_TYPE_DOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/kernel__net_8h_source.html#l00040">kernel_net.h:40</a></div></div>
<div class="ttc" id="group__kernel__net_html_ggaec0f8396984f98ff469cb1f5fac1c7b5a3e5d45cad50425f9f617d34cbddc7378"><div class="ttname"><a href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5a3e5d45cad50425f9f617d34cbddc7378">ADDR_TYPE_LOOPBACK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/kernel__net_8h_source.html#l00044">kernel_net.h:44</a></div></div>
<div class="ttc" id="structaddress__enumerator__t_html_abb8292897ee6e03248e1e76013b47f06"><div class="ttname"><a href="../../da/d71/structaddress__enumerator__t.html#abb8292897ee6e03248e1e76013b47f06">address_enumerator_t::which</a></div><div class="ttdeci">kernel_address_type_t which</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01343">kernel_netlink_net.c:1343</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__kernel__net_html_ggaec0f8396984f98ff469cb1f5fac1c7b5acc8310a1e4e7053fff2da408287cb986"><div class="ttname"><a href="../../d0/d22/group__kernel__net.html#ggaec0f8396984f98ff469cb1f5fac1c7b5acc8310a1e4e7053fff2da408287cb986">ADDR_TYPE_IGNORED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df7/kernel__net_8h_source.html#l00042">kernel_net.h:42</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_adb8c440516a9849b9d93dc315c164053_icgraph.svg" width="251" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0c5e768dcc201c5dbfcbed72326396da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fire_roam_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>address</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>fire a roaming event. we delay it for a bit and fire only one event for multiple calls. otherwise we would create too many events. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">904</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d84/callback__job_8c_source.html#l00127">callback_job_create()</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00065">ROAM_DELAY</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00888">roam_event()</a>, <a class="el" href="../../d2/dd8/scheduler_8h_source.html#l00097">scheduler_t::schedule_job_ms</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00220">library_t::scheduler</a>, <a class="el" href="../../df/d73/time_8c_source.html#l00031">time_monotonic()</a>, and <a class="el" href="../../de/df7/time_8h_source.html#l00063">timeval_add_ms()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">process_addr()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">process_link()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01215">process_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;{</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="../../d9/df9/group__time__i.html#gaeba0d8f51eb0a83c2b01ecf27e0b3260">timeval_t</a> now;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <a class="code" href="../../d2/d68/structjob__t.html">job_t</a> *job;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;roam_events)</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="../../d9/df9/group__time__i.html#gafa0e4f2038e67e1bb455fb3730f59a1e">time_monotonic</a>(&amp;now);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    this-&gt;roam_lock-&gt;lock(this-&gt;roam_lock);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    this-&gt;roam_address |= address;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="keywordflow">if</span> (!timercmp(&amp;now, &amp;this-&gt;next_roam, &gt;))</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        this-&gt;roam_lock-&gt;unlock(this-&gt;roam_lock);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <a class="code" href="../../d9/df9/group__time__i.html#gae899a18c6fe769db669751008f13e360">timeval_add_ms</a>(&amp;now, <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ad23bc7e9d28fa00f264e8690b810a710">ROAM_DELAY</a>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    this-&gt;next_roam = now;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    this-&gt;roam_lock-&gt;unlock(this-&gt;roam_lock);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    job = (<a class="code" href="../../d2/d68/structjob__t.html">job_t</a>*)<a class="code" href="../../d0/d8f/group__callback__job.html#ga6934f856d27d82413610263e27a5cfa1">callback_job_create</a>((<a class="code" href="../../d0/d8f/group__callback__job.html#ga8f3d8c9efd643a62a07bd0709aa45f08">callback_job_cb_t</a>)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a6845422ba132bb780bdc513b2c846d64">roam_event</a>,</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                      <span class="keyword">this</span>, NULL, NULL);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a4a3d65df74a3b5aa043fd799cc776bee">scheduler</a>-&gt;<a class="code" href="../../d2/d3c/structscheduler__t.html#ac98edbbabf818fb9a38040ca99eac8a9">schedule_job_ms</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a4a3d65df74a3b5aa043fd799cc776bee">scheduler</a>, job, <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ad23bc7e9d28fa00f264e8690b810a710">ROAM_DELAY</a>);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;}</div>
<div class="ttc" id="group__time__i_html_gafa0e4f2038e67e1bb455fb3730f59a1e"><div class="ttname"><a href="../../d9/df9/group__time__i.html#gafa0e4f2038e67e1bb455fb3730f59a1e">time_monotonic</a></div><div class="ttdeci">time_t time_monotonic(timeval_t *tv)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d73/time_8c_source.html#l00031">time.c:31</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a6845422ba132bb780bdc513b2c846d64"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a6845422ba132bb780bdc513b2c846d64">roam_event</a></div><div class="ttdeci">static job_requeue_t roam_event(private_kernel_netlink_net_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00888">kernel_netlink_net.c:888</a></div></div>
<div class="ttc" id="structlibrary__t_html_a4a3d65df74a3b5aa043fd799cc776bee"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a4a3d65df74a3b5aa043fd799cc776bee">library_t::scheduler</a></div><div class="ttdeci">scheduler_t * scheduler</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00220">library.h:220</a></div></div>
<div class="ttc" id="structscheduler__t_html_ac98edbbabf818fb9a38040ca99eac8a9"><div class="ttname"><a href="../../d2/d3c/structscheduler__t.html#ac98edbbabf818fb9a38040ca99eac8a9">scheduler_t::schedule_job_ms</a></div><div class="ttdeci">void(* schedule_job_ms)(scheduler_t *this, job_t *job, u_int32_t ms)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd8/scheduler_8h_source.html#l00097">scheduler.h:97</a></div></div>
<div class="ttc" id="group__callback__job_html_ga8f3d8c9efd643a62a07bd0709aa45f08"><div class="ttname"><a href="../../d0/d8f/group__callback__job.html#ga8f3d8c9efd643a62a07bd0709aa45f08">callback_job_cb_t</a></div><div class="ttdeci">job_requeue_t(* callback_job_cb_t)(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddd/callback__job_8h_source.html#l00040">callback_job.h:40</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_ad23bc7e9d28fa00f264e8690b810a710"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#ad23bc7e9d28fa00f264e8690b810a710">ROAM_DELAY</a></div><div class="ttdeci">#define ROAM_DELAY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00065">kernel_netlink_net.c:65</a></div></div>
<div class="ttc" id="group__time__i_html_gae899a18c6fe769db669751008f13e360"><div class="ttname"><a href="../../d9/df9/group__time__i.html#gae899a18c6fe769db669751008f13e360">timeval_add_ms</a></div><div class="ttdeci">static void timeval_add_ms(timeval_t *tv, u_int ms)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00063">time.h:63</a></div></div>
<div class="ttc" id="structjob__t_html"><div class="ttname"><a href="../../d2/d68/structjob__t.html">job_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6a/job_8h_source.html#l00119">job.h:119</a></div></div>
<div class="ttc" id="group__time__i_html_gaeba0d8f51eb0a83c2b01ecf27e0b3260"><div class="ttname"><a href="../../d9/df9/group__time__i.html#gaeba0d8f51eb0a83c2b01ecf27e0b3260">timeval_t</a></div><div class="ttdeci">struct timeval timeval_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00038">time.h:38</a></div></div>
<div class="ttc" id="group__callback__job_html_ga6934f856d27d82413610263e27a5cfa1"><div class="ttname"><a href="../../d0/d8f/group__callback__job.html#ga6934f856d27d82413610263e27a5cfa1">callback_job_create</a></div><div class="ttdeci">callback_job_t * callback_job_create(callback_job_cb_t cb, void *data, callback_job_cleanup_t cleanup, callback_job_cancel_t cancel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d84/callback__job_8c_source.html#l00127">callback_job.c:127</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0c5e768dcc201c5dbfcbed72326396da_cgraph.svg" width="608" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-30" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0c5e768dcc201c5dbfcbed72326396da_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="af1bf8d0ca6eaf4ea6e8d04d791f73987"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a>* get_interface_address </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ifindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>family</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>candidate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a non-virtual IP address on the given interface.</p>
<p>If a candidate address is given, we first search for that address and if not found return the address as above. Returned host is a clone, has to be freed by caller.</p>
<p>this-&gt;lock must be held when calling this function. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00848">848</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">iface_entry_t::addrs</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00050">host_t::clone</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list_t::create_enumerator</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00051">family</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00079">host_t::get_family</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">iface_entry_by_index()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">addr_entry_t::ip</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00117">host_t::ip_equals</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00781">is_address_better()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00119">addr_entry_t::refcount</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00154">iface_entry_t::usable</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01215">process_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;{</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <a class="code" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *addrs;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>, *best = NULL;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span> (this-&gt;ifaces-&gt;find_first(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">ifaces</a>, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a>,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                                 (<span class="keywordtype">void</span>**)&amp;iface, &amp;ifindex) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">usable</a>)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        {   <span class="comment">/* only use interfaces not excluded by config */</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            addrs = iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">create_enumerator</a>(iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="keywordflow">while</span> (addrs-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(addrs, &amp;addr))</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">refcount</a> ||</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                    addr-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(addr-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>) != <a class="code" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                {   <span class="comment">/* ignore virtual IP addresses and ensure family matches */</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <span class="keywordflow">if</span> (candidate &amp;&amp; candidate-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(candidate, addr-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>))</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                {   <span class="comment">/* stop if we find the candidate */</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    best = <a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!best || <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a46555f8629f621bd40ace28fe474457f">is_address_better</a>(<span class="keyword">this</span>, best, addr, dest))</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                    best = <a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            addrs-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(addrs);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">return</span> best ? best-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(best-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>) : NULL;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="structhost__t_html_a7c1454eaeb7aeadd449616181c14f620"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">host_t::ip_equals</a></div><div class="ttdeci">bool(* ip_equals)(host_t *this, host_t *other)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00117">host.h:117</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a33d3a0bd02d90b6a9940413cdc7b2b8b"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">iface_entry_t::usable</a></div><div class="ttdeci">bool usable</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00154">kernel_netlink_net.c:154</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a44a28287a4812f8e8101770a3cc94b87"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a></div><div class="ttdeci">static bool iface_entry_by_index(iface_entry_t *this, int *ifindex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">kernel_netlink_net.c:169</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structiface__entry__t_html"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00139">kernel_netlink_net.c:139</a></div></div>
<div class="ttc" id="structhost__t_html_aebe9cd9ffd665b04e223c5e8b6ce7114"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">host_t::clone</a></div><div class="ttdeci">host_t *(* clone)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00050">host.h:50</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a056cb96f14fa76d54b1a36eaf765ae75"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">addr_entry_t::refcount</a></div><div class="ttdeci">u_int refcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00119">kernel_netlink_net.c:119</a></div></div>
<div class="ttc" id="ha__message_8c_html_a6494da1d0747e053505497a35ebccbba"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a></div><div class="ttdeci">u_int8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="structlinked__list__t_html_aa079d50cc4028f12d65c75cbb53f8c8a"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">linked_list_t::create_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_enumerator)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list.h:71</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a46555f8629f621bd40ace28fe474457f"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a46555f8629f621bd40ace28fe474457f">is_address_better</a></div><div class="ttdeci">static bool is_address_better(private_kernel_netlink_net_t *this, addr_entry_t *a, addr_entry_t *b, host_t *d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00781">kernel_netlink_net.c:781</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a388b18d13f3b29682afae599da369527"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">private_kernel_netlink_net_t::ifaces</a></div><div class="ttdeci">linked_list_t * ifaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00396">kernel_netlink_net.c:396</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a074ce3bd111ba07ab802a6c74063a5a2"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">iface_entry_t::addrs</a></div><div class="ttdeci">linked_list_t * addrs</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">kernel_netlink_net.c:151</a></div></div>
<div class="ttc" id="structaddr__entry__t_html"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00107">kernel_netlink_net.c:107</a></div></div>
<div class="ttc" id="structhost__t_html_a75956f3fa34ec58543cb717d7a6dbba6"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">host_t::get_family</a></div><div class="ttdeci">int(* get_family)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00079">host.h:79</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a9fecb8edaffa35df931c847d9e95a091"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">addr_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">kernel_netlink_net.c:110</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-31" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af1bf8d0ca6eaf4ea6e8d04d791f73987_cgraph.svg" width="100%" height="474"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-32" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af1bf8d0ca6eaf4ea6e8d04d791f73987_icgraph.svg" width="100%" height="371"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="af19d8672f22f597f18a131d57efd33ec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int get_interface_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>get the index of an interface by name </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01481">1481</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00177">iface_entry_by_name()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">iface_entry_t::ifindex</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, and <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">manage_srcroute()</a>.</p>
<div class="fragment"><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;{</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <a class="code" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordtype">int</span> ifindex = 0;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;getting iface index for %s&quot;</span>, <a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;read_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">if</span> (this-&gt;ifaces-&gt;find_first(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">ifaces</a>, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0faeb03bf086f0d08fbfaf8faef65a16">iface_entry_by_name</a>,</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                                (<span class="keywordtype">void</span>**)&amp;iface, <a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    {</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        ifindex = iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">ifindex</a>;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> (ifindex == 0)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;unable to get interface index for %s&quot;</span>, <a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    }</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">return</span> ifindex;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="structiface__entry__t_html"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00139">kernel_netlink_net.c:139</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a1a08a8af40b92ca44f2e05c06dd601f4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">iface_entry_t::ifindex</a></div><div class="ttdeci">int ifindex</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">kernel_netlink_net.c:142</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0faeb03bf086f0d08fbfaf8faef65a16"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0faeb03bf086f0d08fbfaf8faef65a16">iface_entry_by_name</a></div><div class="ttdeci">static bool iface_entry_by_name(iface_entry_t *this, char *ifname)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00177">kernel_netlink_net.c:177</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a388b18d13f3b29682afae599da369527"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">private_kernel_netlink_net_t::ifaces</a></div><div class="ttdeci">linked_list_t * ifaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00396">kernel_netlink_net.c:396</a></div></div>
<div class="ttc" id="dh__speed_8c_html_a1317e52dffbcbe14fbfd1bd5ac61fff9"><div class="ttname"><a href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d1a/dh__speed_8c_source.html#l00030">dh_speed.c:30</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-33" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af19d8672f22f597f18a131d57efd33ec_cgraph.svg" width="440" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-34" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af19d8672f22f597f18a131d57efd33ec_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="add8ea34240fa67be8682f623e7b61891"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a>* get_route </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>nexthop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>candidate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>recursion</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a route: If "nexthop", the nexthop is returned. source addr otherwise. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">1659</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01507">addr_in_subnet()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00050">host_t::clone</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list_t::create_enumerator</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00130">host_t::destroy</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00247">linked_list_t::destroy_function</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01546">rt_entry_t::dst</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01548">rt_entry_t::dst_len</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00051">family</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00095">host_t::get_address</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00079">host_t::get_family</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00140">linked_list_t::get_first</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00848">get_interface_address()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01544">rt_entry_t::gtw</a>, <a class="el" href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">netlink_buf_t::hdr</a>, <a class="el" href="../../df/da9/host_8c_source.html#l00477">host_create_from_chunk()</a>, <a class="el" href="../../d9/d7b/settings__lexer_8c_source.html#l00957">if()</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00108">linked_list_t::insert_before</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00117">host_t::ip_equals</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00936">is_interface_up_and_usable()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00661">is_known_vip()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">len</a>, <a class="el" href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list_create()</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00071">MAX_ROUTE_RECURSION</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../d1/ddf/align_8h_source.html#l00036">min</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../d1/dfe/kernel__netlink__shared_8c_source.html#l00618">netlink_add_attribute()</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00062">NLM_F_DUMP</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00052">NLM_F_REQUEST</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00094">NLMSG_DONE</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00045">nlmsghdr::nlmsg_flags</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00043">nlmsghdr::nlmsg_len</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00082">NLMSG_LENGTH</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00085">NLMSG_NEXT</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00087">NLMSG_OK</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00044">nlmsghdr::nlmsg_type</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01550">rt_entry_t::oif</a>, <a class="el" href="../../dd/dd5/aes-test_8c_source.html#l00036">out</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01589">parse_route()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01551">rt_entry_t::priority</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../df/d12/mconsole_8c_source.html#l00091">request()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01566">route_usable()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01557">rt_entry_destroy()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00290">RTA_DST</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00305">RTA_MARK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00296">RTA_PREFSRC</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00182">rtmsg::rtm_family</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00046">RTM_GETROUTE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00042">RTM_NEWROUTE</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00328">socket</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00642">src</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01545">rt_entry_t::src</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01547">rt_entry_t::src_host</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01549">rt_entry_t::table</a>, and <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01914">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;{</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <a class="code" href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a> <a class="code" href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a>;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr, *<a class="code" href="../../dd/dd5/aes-test_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>, *current;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a> *<a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> chunk;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <a class="code" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *routes;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <a class="code" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a> *route = NULL, *best = NULL;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a> = NULL;</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordtype">bool</span> match_net;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">if</span> (recursion &gt; <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a714d288372018cf438e388ab2c7f28e1">MAX_ROUTE_RECURSION</a>)</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    chunk = dest-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(dest);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    len = chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> * 8;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a> = <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a> &lt; 0 ? len : <a class="code" href="../../da/dbd/group__align__i.html#gabb702d8b501669a23aa0ab3b281b9384">min</a>(<a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, len);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    match_net = <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a> != <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(&amp;request, 0, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    family = dest-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(dest);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    hdr = &amp;request.<a class="code" href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">hdr</a>;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsg_flags</a> = <a class="code" href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a>;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a4c11427cfab6a651efdfe67ff4c6bb42">RTM_GETROUTE</a>;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsg_len</a> = <a class="code" href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a>));</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    msg = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a> = <a class="code" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keywordflow">if</span> (!match_net &amp;&amp; this-&gt;rta_mark &amp;&amp; this-&gt;routing_mark.value)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="comment">/* if our routing rule excludes packets with a certain mark we can</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment">         * get the preferred route without having to dump all routes */</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        chunk = <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(this-&gt;routing_mark.value);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173aa24a1250e67611bbb3204cf128059459">RTA_MARK</a>, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (family == AF_INET || this-&gt;rta_prefsrc_for_ipv6 ||</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;             this-&gt;routing_table || match_net)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    {   <span class="comment">/* kernels prior to 3.0 do not support RTA_PREFSRC for IPv6 routes.</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">         * as we want to ignore routes with virtual IPs we cannot use DUMP</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">         * if these routes are not installed in a separate table */</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsg_flags</a> |= <a class="code" href="../../de/d4c/netlink_8h.html#a8d4fb2458c013decb6673f41c52c07b1">NLM_F_DUMP</a>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="keywordflow">if</span> (candidate)</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        chunk = candidate-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(candidate);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561">RTA_PREFSRC</a>, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordflow">if</span> (!match_net)</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        chunk = dest-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(dest);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a">RTA_DST</a>, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>-&gt;send(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a6755d5a6461a641020a34e5ce0f14deb">socket</a>, hdr, &amp;out, &amp;len) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;getting %s to reach %H/%d failed&quot;</span>,</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;             nexthop ? <span class="stringliteral">&quot;nexthop&quot;</span> : <span class="stringliteral">&quot;address&quot;</span>, dest, <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    }</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    routes = <a class="code" href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a>();</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;read_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="keywordflow">for</span> (current = out; <a class="code" href="../../de/d4c/netlink_8h.html#a2e67cb7b703696efae9909fbeba5616d">NLMSG_OK</a>(current, len);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;         current = <a class="code" href="../../de/d4c/netlink_8h.html#a533f12f954dec43e08cfaff6dcf9c751">NLMSG_NEXT</a>(current, len))</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="keywordflow">switch</span> (current-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a>)</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../de/d4c/netlink_8h.html#a151b98bf01f462dbc5d3c69e6396e064">NLMSG_DONE</a>:</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a>:</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                <a class="code" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a> *other;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;                uintptr_t table;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ab49cfa5833bc6a05cc7058bd45aed9aa">route_usable</a>(current))</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                route = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ae6a815ab18f327d4cb1d05deca255373">parse_route</a>(current, route);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                table = (uintptr_t)route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a22d1e96680c09a1f5872ba4da8ca011e">table</a>;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                <a class="code" href="../../d9/d7b/settings__lexer_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a> (this-&gt;rt_exclude-&gt;find_first(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a6c7d2d60a16a587efe7d87ea2ccddc66">rt_exclude</a>, NULL,</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;                                                 (<span class="keywordtype">void</span>**)&amp;table) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                {   <span class="comment">/* route is from an excluded routing table */</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                <span class="keywordflow">if</span> (this-&gt;routing_table != 0 &amp;&amp;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                    route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a22d1e96680c09a1f5872ba4da8ca011e">table</a> == this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a38e23f48e64d16e25a382402819ea77c">routing_table</a>)</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                {   <span class="comment">/* route is from our own ipsec routing table */</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a> &amp;&amp; !<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a5380f306f77b51da4bb8012386d5920e">is_interface_up_and_usable</a>(<span class="keyword">this</span>, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a>))</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                {   <span class="comment">/* interface is down */</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                }</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a670963494309b27c57c9941608631f1d">addr_in_subnet</a>(chunk, <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#af4daf9e6221e77c9915cc0c2843793ec">dst</a>, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#ab32d86e023a9cc3af2cc2a10ff07c5bc">dst_len</a>))</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                {   <span class="comment">/* route destination does not contain dest */</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a63635790d84015ed086636e270b35b4d">src</a>.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>)</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                {   <span class="comment">/* verify source address, if any */</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a> = <a class="code" href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a>(msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a>,</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                                         route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a63635790d84015ed086636e270b35b4d">src</a>, 0);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                    <span class="keywordflow">if</span> (src &amp;&amp; <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a34793bb5a8a46b632833c292910b1f81">is_known_vip</a>(<span class="keyword">this</span>, src))</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                    {   <span class="comment">/* ignore routes installed by us */</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                        src-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(src);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                    }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                    route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a> = <a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a>;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                }</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                <span class="comment">/* insert route, sorted by priority and network prefix */</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                enumerator = routes-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">create_enumerator</a>(routes);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;other))</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                    <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">priority</a> &lt; other-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">priority</a>)</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                    {</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                    }</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                    <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">priority</a> == other-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">priority</a> &amp;&amp;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                        route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#ab32d86e023a9cc3af2cc2a10ff07c5bc">dst_len</a> &gt; other-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#ab32d86e023a9cc3af2cc2a10ff07c5bc">dst_len</a>)</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                    {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                    }</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                routes-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aac4d7989c91be71d9c7630079a1a9700">insert_before</a>(routes, enumerator, route);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                route = NULL;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        }</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    }</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">if</span> (route)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af8fd81b195f159d61c21e5b82eb1a8fd">rt_entry_destroy</a>(route);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="comment">/* now we have a list of routes matching dest, sorted by net prefix.</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment">     * we will look for source addresses for these routes and select the one</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment">     * with the preferred source address, if possible */</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    enumerator = routes-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">create_enumerator</a>(routes);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;route))</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    {</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a>)</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        {   <span class="comment">/* got a source address with the route, if no preferred source</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment">             * is given or it matches we are done, as this is the best route */</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            <span class="keywordflow">if</span> (!candidate || candidate-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(candidate, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a>))</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            {</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                best = route;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            }</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a>)</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            {   <span class="comment">/* no match yet, maybe it is assigned to the same interface */</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *src = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af1bf8d0ca6eaf4ea6e8d04d791f73987">get_interface_address</a>(<span class="keyword">this</span>, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a>,</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                                            msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a>, dest, candidate);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                <span class="keywordflow">if</span> (src &amp;&amp; src-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(src, candidate))</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                    route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a>);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;                    route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a> = <a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a>;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                    best = route;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                }</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(src);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            <span class="comment">/* no luck yet with the source address. if this is the best (first)</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment">             * route we store it as fallback in case we don&#39;t find a route with</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment">             * the preferred source */</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            best = best ?: route;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a>)</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        {   <span class="comment">/* no src, but an interface - get address from it */</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a> = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af1bf8d0ca6eaf4ea6e8d04d791f73987">get_interface_address</a>(<span class="keyword">this</span>, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a>,</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                                            msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a>, dest, candidate);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a>)</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            {   <span class="comment">/* we handle this address the same as the one above */</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                <span class="keywordflow">if</span> (!candidate ||</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                     candidate-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(candidate, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a>))</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                    best = route;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                best = best ?: route;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#ac61adb8cd44995ddbe4ab35d2ca5b1d5">gtw</a>.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>)</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        {   <span class="comment">/* no src, no iface, but a gateway - lookup src to reach gtw */</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;            <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *gtw;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            gtw = <a class="code" href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a>(msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a>, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#ac61adb8cd44995ddbe4ab35d2ca5b1d5">gtw</a>, 0);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;            <span class="keywordflow">if</span> (gtw &amp;&amp; !gtw-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(gtw, dest))</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a> = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#add8ea34240fa67be8682f623e7b61891">get_route</a>(<span class="keyword">this</span>, gtw, -1, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, candidate,</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                                            recursion + 1);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;            }</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;            <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(gtw);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;            <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a>)</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            {   <span class="comment">/* more of the same */</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                <span class="keywordflow">if</span> (!candidate ||</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                     candidate-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(candidate, route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">src_host</a>))</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                {</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                    best = route;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;                best = best ?: route;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            }</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordflow">if</span> (nexthop)</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    {   <span class="comment">/* nexthop lookup, return gateway if any */</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <span class="keywordflow">if</span> (best || routes-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#af6b44d5e3fae5d2f4d8404e79d2e0cc6">get_first</a>(routes, (<span class="keywordtype">void</span>**)&amp;best) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            addr = <a class="code" href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a>(msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a>, best-&gt;gtw, 0);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        }</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keywordflow">if</span> (!addr &amp;&amp; !match_net)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        {   <span class="comment">/* fallback to destination address */</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            addr = dest-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(dest);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    }</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <span class="keywordflow">if</span> (best)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        {</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            addr = best-&gt;src_host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(best-&gt;src_host);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        }</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    routes-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a6fd4ac1426ce08b8853888a2e4be4e33">destroy_function</a>(routes, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af8fd81b195f159d61c21e5b82eb1a8fd">rt_entry_destroy</a>);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(out);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">if</span> (addr)</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    {</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;using %H as %s to reach %H/%d&quot;</span>, addr,</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;             nexthop ? <span class="stringliteral">&quot;nexthop&quot;</span> : <span class="stringliteral">&quot;address&quot;</span>, dest, <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    }</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!recursion)</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    {</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;no %s found to reach %H/%d&quot;</span>,</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;             nexthop ? <span class="stringliteral">&quot;nexthop&quot;</span> : <span class="stringliteral">&quot;address&quot;</span>, dest, <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    }</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="structlinked__list__t_html_aac4d7989c91be71d9c7630079a1a9700"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#aac4d7989c91be71d9c7630079a1a9700">linked_list_t::insert_before</a></div><div class="ttdeci">void(* insert_before)(linked_list_t *this, enumerator_t *enumerator, void *item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00108">linked_list.h:108</a></div></div>
<div class="ttc" id="netlink_8h_html_a456954d27b8adedd78136a9511f13160"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a></div><div class="ttdeci">#define NLM_F_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00052">netlink.h:52</a></div></div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="structlinked__list__t_html_af6b44d5e3fae5d2f4d8404e79d2e0cc6"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#af6b44d5e3fae5d2f4d8404e79d2e0cc6">linked_list_t::get_first</a></div><div class="ttdeci">status_t(* get_first)(linked_list_t *this, void **item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00140">linked_list.h:140</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_af8fd81b195f159d61c21e5b82eb1a8fd"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#af8fd81b195f159d61c21e5b82eb1a8fd">rt_entry_destroy</a></div><div class="ttdeci">static void rt_entry_destroy(rt_entry_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01557">kernel_netlink_net.c:1557</a></div></div>
<div class="ttc" id="structhost__t_html_a7c1454eaeb7aeadd449616181c14f620"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">host_t::ip_equals</a></div><div class="ttdeci">bool(* ip_equals)(host_t *this, host_t *other)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00117">host.h:117</a></div></div>
<div class="ttc" id="group__align__i_html_gabb702d8b501669a23aa0ab3b281b9384"><div class="ttname"><a href="../../da/dbd/group__align__i.html#gabb702d8b501669a23aa0ab3b281b9384">min</a></div><div class="ttdeci">#define min(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/ddf/align_8h_source.html#l00036">align.h:36</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__windows_html_gaa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00328">windows.h:328</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_af1bf8d0ca6eaf4ea6e8d04d791f73987"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#af1bf8d0ca6eaf4ea6e8d04d791f73987">get_interface_address</a></div><div class="ttdeci">static host_t * get_interface_address(private_kernel_netlink_net_t *this, int ifindex, int family, host_t *dest, host_t *candidate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00848">kernel_netlink_net.c:848</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="group__host_html_gaf40fcca3c58e789ff4f82bbf875727e4"><div class="ttname"><a href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a></div><div class="ttdeci">host_t * host_create_from_chunk(int family, chunk_t address, u_int16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/host_8c_source.html#l00477">host.c:477</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="structrt__entry__t_html_aca95e189d026b46db1df62d06ed772a2"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">rt_entry_t::priority</a></div><div class="ttdeci">u_int32_t priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01551">kernel_netlink_net.c:1551</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html_a8d2a4634689d1535c752284f28528b69"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">netlink_buf_t::hdr</a></div><div class="ttdeci">struct nlmsghdr hdr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">kernel_netlink_shared.h:30</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_ab49cfa5833bc6a05cc7058bd45aed9aa"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#ab49cfa5833bc6a05cc7058bd45aed9aa">route_usable</a></div><div class="ttdeci">static bool route_usable(struct nlmsghdr *hdr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01566">kernel_netlink_net.c:1566</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="netlink_8h_html_a8d4fb2458c013decb6673f41c52c07b1"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a8d4fb2458c013decb6673f41c52c07b1">NLM_F_DUMP</a></div><div class="ttdeci">#define NLM_F_DUMP</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00062">netlink.h:62</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structrt__entry__t_html_a63635790d84015ed086636e270b35b4d"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#a63635790d84015ed086636e270b35b4d">rt_entry_t::src</a></div><div class="ttdeci">chunk_t src</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01545">kernel_netlink_net.c:1545</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a38e23f48e64d16e25a382402819ea77c"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a38e23f48e64d16e25a382402819ea77c">private_kernel_netlink_net_t::routing_table</a></div><div class="ttdeci">int routing_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00436">kernel_netlink_net.c:436</a></div></div>
<div class="ttc" id="structnlmsghdr_html"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html">nlmsghdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00042">netlink.h:42</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561">RTA_PREFSRC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00296">rtnetlink.h:296</a></div></div>
<div class="ttc" id="structhost__t_html_aebe9cd9ffd665b04e223c5e8b6ce7114"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">host_t::clone</a></div><div class="ttdeci">host_t *(* clone)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00050">host.h:50</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a714d288372018cf438e388ab2c7f28e1"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a714d288372018cf438e388ab2c7f28e1">MAX_ROUTE_RECURSION</a></div><div class="ttdeci">#define MAX_ROUTE_RECURSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00071">kernel_netlink_net.c:71</a></div></div>
<div class="ttc" id="netlink_8h_html_ab6857a80029b18e3c1058ddfca5e6b6b"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a></div><div class="ttdeci">#define NLMSG_LENGTH(len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00082">netlink.h:82</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structnlmsghdr_html_abc588d6bfd91bcbf100709e57b7877df"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsghdr::nlmsg_type</a></div><div class="ttdeci">__u16 nlmsg_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00044">netlink.h:44</a></div></div>
<div class="ttc" id="group__linked__list_html_ga15bb4333e53dbef32d196e4388f43fdf"><div class="ttname"><a href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a></div><div class="ttdeci">linked_list_t * linked_list_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list.c:484</a></div></div>
<div class="ttc" id="netlink_8h_html_a533f12f954dec43e08cfaff6dcf9c751"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a533f12f954dec43e08cfaff6dcf9c751">NLMSG_NEXT</a></div><div class="ttdeci">#define NLMSG_NEXT(nlh, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00085">netlink.h:85</a></div></div>
<div class="ttc" id="structrt__entry__t_html_ab32d86e023a9cc3af2cc2a10ff07c5bc"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#ab32d86e023a9cc3af2cc2a10ff07c5bc">rt_entry_t::dst_len</a></div><div class="ttdeci">u_int8_t dst_len</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01548">kernel_netlink_net.c:1548</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00042">rtnetlink.h:42</a></div></div>
<div class="ttc" id="structhost__t_html_aa3493ae67869e4cd9b4dbe98226650fb"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">host_t::get_address</a></div><div class="ttdeci">chunk_t(* get_address)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00095">host.h:95</a></div></div>
<div class="ttc" id="ha__message_8c_html_a6494da1d0747e053505497a35ebccbba"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a></div><div class="ttdeci">u_int8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="test__utils_8c_html_a0a7083cd7ae62f5c50d6abd5cdd491ab"><div class="ttname"><a href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a></div><div class="ttdeci">bool prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbe/test__utils_8c_source.html#l00206">test_utils.c:206</a></div></div>
<div class="ttc" id="structlinked__list__t_html_aa079d50cc4028f12d65c75cbb53f8c8a"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">linked_list_t::create_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_enumerator)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list.h:71</a></div></div>
<div class="ttc" id="structrtmsg_html_a2295e2054ab275a89be3c681a630a8e9"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtmsg::rtm_family</a></div><div class="ttdeci">unsigned char rtm_family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00182">rtnetlink.h:182</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structrt__entry__t_html_ac61adb8cd44995ddbe4ab35d2ca5b1d5"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#ac61adb8cd44995ddbe4ab35d2ca5b1d5">rt_entry_t::gtw</a></div><div class="ttdeci">chunk_t gtw</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01544">kernel_netlink_net.c:1544</a></div></div>
<div class="ttc" id="structrt__entry__t_html"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01543">kernel_netlink_net.c:1543</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a670963494309b27c57c9941608631f1d"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a670963494309b27c57c9941608631f1d">addr_in_subnet</a></div><div class="ttdeci">static bool addr_in_subnet(chunk_t addr, int prefix, chunk_t net, int net_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01507">kernel_netlink_net.c:1507</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="structlinked__list__t_html_a6fd4ac1426ce08b8853888a2e4be4e33"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a6fd4ac1426ce08b8853888a2e4be4e33">linked_list_t::destroy_function</a></div><div class="ttdeci">void(* destroy_function)(linked_list_t *this, void(*)(void *))</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00247">linked_list.h:247</a></div></div>
<div class="ttc" id="structrt__entry__t_html_a2800d1ae173df5f63352480fbb8efa43"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">rt_entry_t::oif</a></div><div class="ttdeci">u_int32_t oif</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01550">kernel_netlink_net.c:1550</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a">RTA_DST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00290">rtnetlink.h:290</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a6c7d2d60a16a587efe7d87ea2ccddc66"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a6c7d2d60a16a587efe7d87ea2ccddc66">private_kernel_netlink_net_t::rt_exclude</a></div><div class="ttdeci">linked_list_t * rt_exclude</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00511">kernel_netlink_net.c:511</a></div></div>
<div class="ttc" id="structrt__entry__t_html_a8e0edfd7eaffc404b66de03256c0a599"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#a8e0edfd7eaffc404b66de03256c0a599">rt_entry_t::src_host</a></div><div class="ttdeci">host_t * src_host</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01547">kernel_netlink_net.c:1547</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="netlink_8h_html_a151b98bf01f462dbc5d3c69e6396e064"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a151b98bf01f462dbc5d3c69e6396e064">NLMSG_DONE</a></div><div class="ttdeci">#define NLMSG_DONE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00094">netlink.h:94</a></div></div>
<div class="ttc" id="structnlmsghdr_html_ad697397e7366eb442db4bb4e963f79f7"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsghdr::nlmsg_flags</a></div><div class="ttdeci">__u16 nlmsg_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00045">netlink.h:45</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00029">kernel_netlink_shared.h:29</a></div></div>
<div class="ttc" id="netlink_8h_html_a2e67cb7b703696efae9909fbeba5616d"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a2e67cb7b703696efae9909fbeba5616d">NLMSG_OK</a></div><div class="ttdeci">#define NLMSG_OK(nlh, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00087">netlink.h:87</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a2b341e3994bfbc0aa8d680205abbd28b"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a></div><div class="ttdeci">u_int16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">duplicheck_msg.h:45</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a34793bb5a8a46b632833c292910b1f81"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a34793bb5a8a46b632833c292910b1f81">is_known_vip</a></div><div class="ttdeci">static bool is_known_vip(private_kernel_netlink_net_t *this, host_t *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00661">kernel_netlink_net.c:661</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a6755d5a6461a641020a34e5ce0f14deb"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a6755d5a6461a641020a34e5ce0f14deb">private_kernel_netlink_net_t::socket</a></div><div class="ttdeci">netlink_socket_t * socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00411">kernel_netlink_net.c:411</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600a4c11427cfab6a651efdfe67ff4c6bb42"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a4c11427cfab6a651efdfe67ff4c6bb42">RTM_GETROUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00046">rtnetlink.h:46</a></div></div>
<div class="ttc" id="structrtmsg_html"><div class="ttname"><a href="../../da/d53/structrtmsg.html">rtmsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00181">rtnetlink.h:181</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_ae6a815ab18f327d4cb1d05deca255373"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#ae6a815ab18f327d4cb1d05deca255373">parse_route</a></div><div class="ttdeci">static rt_entry_t * parse_route(struct nlmsghdr *hdr, rt_entry_t *route)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01589">kernel_netlink_net.c:1589</a></div></div>
<div class="ttc" id="aes-test_8c_html_a1277960b5f2b37137fe9b0b5a1ea0beb"><div class="ttname"><a href="../../dd/dd5/aes-test_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/aes-test_8c_source.html#l00036">aes-test.c:36</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="structhost__t_html_af9703b61f348ea0409dc9cb197b2b788"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">host_t::destroy</a></div><div class="ttdeci">void(* destroy)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00130">host.h:130</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structnlmsghdr_html_a75261bc7443b0c646c49dd8313f4a66a"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsghdr::nlmsg_len</a></div><div class="ttdeci">__u32 nlmsg_len</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00043">netlink.h:43</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
<div class="ttc" id="structrt__entry__t_html_af4daf9e6221e77c9915cc0c2843793ec"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#af4daf9e6221e77c9915cc0c2843793ec">rt_entry_t::dst</a></div><div class="ttdeci">chunk_t dst</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01546">kernel_netlink_net.c:1546</a></div></div>
<div class="ttc" id="structrt__entry__t_html_a22d1e96680c09a1f5872ba4da8ca011e"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#a22d1e96680c09a1f5872ba4da8ca011e">rt_entry_t::table</a></div><div class="ttdeci">u_int32_t table</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01549">kernel_netlink_net.c:1549</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
<div class="ttc" id="kernel__netlink__shared_8c_html_a202b8086fb6f849f0a33d96de2849705"><div class="ttname"><a href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a></div><div class="ttdeci">void netlink_add_attribute(struct nlmsghdr *hdr, int rta_type, chunk_t data, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfe/kernel__netlink__shared_8c_source.html#l00618">kernel_netlink_shared.c:618</a></div></div>
<div class="ttc" id="settings__lexer_8c_html_a33e91cd0cef6786e9e3a27ac67707207"><div class="ttname"><a href="../../d9/d7b/settings__lexer_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a></div><div class="ttdeci">if(!yyg-&gt;yy_init)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7b/settings__lexer_8c_source.html#l00957">settings_lexer.c:957</a></div></div>
<div class="ttc" id="structlinked__list__t_html"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html">linked_list_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00054">linked_list.h:54</a></div></div>
<div class="ttc" id="structhost__t_html_a75956f3fa34ec58543cb717d7a6dbba6"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">host_t::get_family</a></div><div class="ttdeci">int(* get_family)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00079">host.h:79</a></div></div>
<div class="ttc" id="mconsole_8c_html_a251c32cfa402f283bd6349486d9caac0"><div class="ttname"><a href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a></div><div class="ttdeci">static int request(private_mconsole_t *this, void(*cb)(void *, char *, size_t), void *data, char *command,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d12/mconsole_8c_source.html#l00091">mconsole.c:91</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a5380f306f77b51da4bb8012386d5920e"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a5380f306f77b51da4bb8012386d5920e">is_interface_up_and_usable</a></div><div class="ttdeci">static bool is_interface_up_and_usable(private_kernel_netlink_net_t *this, int index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00936">kernel_netlink_net.c:936</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173aa24a1250e67611bbb3204cf128059459"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173aa24a1250e67611bbb3204cf128059459">RTA_MARK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00305">rtnetlink.h:305</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a680c29c0890886d7c4130a706b5a97a0"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a680c29c0890886d7c4130a706b5a97a0">src</a></div><div class="ttdeci">struct sadb_address * src</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00642">kernel_pfkey_ipsec.c:642</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_add8ea34240fa67be8682f623e7b61891"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#add8ea34240fa67be8682f623e7b61891">get_route</a></div><div class="ttdeci">static host_t * get_route(private_kernel_netlink_net_t *this, host_t *dest, int prefix, bool nexthop, host_t *candidate, u_int recursion)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">kernel_netlink_net.c:1659</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-35" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_add8ea34240fa67be8682f623e7b61891_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-36" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_add8ea34240fa67be8682f623e7b61891_icgraph.svg" width="216" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3f7980c4116904644f96e2d8fcfa8109"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_char get_scope </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Determine the type or scope of the given unicast IP address. This is not the same thing returned in rtm_scope/ifa_scope.</p>
<p>We use return values as defined in RFC 6724 (referring to RFC 4291). </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00710">710</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00095">host_t::get_address</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, and <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00781">is_address_better()</a>.</p>
<div class="fragment"><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;{</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> <a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    addr = ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(ip);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">switch</span> (addr.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>)</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="comment">/* we use the mapping defined in RFC 6724, 3.2 */</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordflow">if</span> (addr.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[0] == 127)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            {   <span class="comment">/* link-local, same as the IPv6 loopback address */</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="keywordflow">if</span> (addr.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[0] == 169 &amp;&amp; addr.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[1] == 254)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            {   <span class="comment">/* link-local */</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="keywordflow">if</span> (IN6_IS_ADDR_LOOPBACK((<span class="keyword">struct</span> in6_addr*)addr.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>))</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            {   <span class="comment">/* link-local, according to RFC 4291, 2.5.3 */</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">if</span> (IN6_IS_ADDR_LINKLOCAL((<span class="keyword">struct</span> in6_addr*)addr.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>))</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordflow">if</span> (IN6_IS_ADDR_SITELOCAL((<span class="keyword">struct</span> in6_addr*)addr.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>))</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            {   <span class="comment">/* deprecated, according to RFC 4291, 2.5.7 */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <span class="keywordflow">return</span> 5;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">/* global */</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">return</span> 14;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;}</div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structhost__t_html_aa3493ae67869e4cd9b4dbe98226650fb"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">host_t::get_address</a></div><div class="ttdeci">chunk_t(* get_address)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00095">host.h:95</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-37" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a3f7980c4116904644f96e2d8fcfa8109_icgraph.svg" width="100%" height="371"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a44a28287a4812f8e8101770a3cc94b87"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> iface_entry_by_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ifindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>find an interface entry by index </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">169</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00848">get_interface_address()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00936">is_interface_up_and_usable()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">process_addr()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">process_link()</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;{</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> this-&gt;ifindex == *ifindex;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
</div><!-- fragment -->
<p><div id="dynsection-38" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a44a28287a4812f8e8101770a3cc94b87_icgraph.svg" width="100%" height="453"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0faeb03bf086f0d08fbfaf8faef65a16"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> iface_entry_by_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>ifname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>find an interface entry by name </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00177">177</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../da/d66/string_8h_source.html#l00028">streq()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01481">get_interface_index()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01970">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/group__string__i.html#ga65c3d08890165aaa4663c72d07f93bb7">streq</a>(this-&gt;ifname, ifname);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div>
<div class="ttc" id="group__string__i_html_ga65c3d08890165aaa4663c72d07f93bb7"><div class="ttname"><a href="../../d4/d40/group__string__i.html#ga65c3d08890165aaa4663c72d07f93bb7">streq</a></div><div class="ttdeci">static bool streq(const char *x, const char *y)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d66/string_8h_source.html#l00028">string.h:28</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-39" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0faeb03bf086f0d08fbfaf8faef65a16_cgraph.svg" width="256" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-40" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0faeb03bf086f0d08fbfaf8faef65a16_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a21cd8aae9699bfaca9118243ceda91df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iface_entry_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>destroy an interface entry </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00160">160</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00128">addr_entry_destroy()</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02496">METHOD()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">process_link()</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    this-&gt;addrs-&gt;destroy_function(this-&gt;addrs, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a7235c174351cbc6544dad599e0cb03d1">addr_entry_destroy</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a7235c174351cbc6544dad599e0cb03d1"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a7235c174351cbc6544dad599e0cb03d1">addr_entry_destroy</a></div><div class="ttdeci">static void addr_entry_destroy(addr_entry_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00128">kernel_netlink_net.c:128</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-41" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-41-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-41-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-41-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a21cd8aae9699bfaca9118243ceda91df_cgraph.svg" width="422" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-42" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-42-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-42-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-42-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a21cd8aae9699bfaca9118243ceda91df_icgraph.svg" width="100%" height="385"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b3597e6b5433acae9d22f4efa612d4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> iface_entry_up </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>iface</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>check if an interface is up </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00185">185</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00148">iface_entry_t::flags</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00248">addr_map_entry_match_up()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00193">iface_entry_up_and_usable()</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> (iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#abfcdafd79963dfa36b5703427c625048">flags</a> &amp; IFF_UP) == IFF_UP;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="ttc" id="structiface__entry__t_html_abfcdafd79963dfa36b5703427c625048"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#abfcdafd79963dfa36b5703427c625048">iface_entry_t::flags</a></div><div class="ttdeci">u_int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00148">kernel_netlink_net.c:148</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-43" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-43-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-43-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-43-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a4b3597e6b5433acae9d22f4efa612d4b_icgraph.svg" width="100%" height="453"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1db8c558ca19629f217439383b872e11"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> iface_entry_up_and_usable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *&#160;</td>
          <td class="paramname"><em>iface</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>check if an interface is up and usable </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00193">193</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00185">iface_entry_up()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00154">iface_entry_t::usable</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00237">addr_map_entry_match_up_and_usable()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02294">init_address_list()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00936">is_interface_up_and_usable()</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">usable</a> &amp;&amp; <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a4b3597e6b5433acae9d22f4efa612d4b">iface_entry_up</a>(iface);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
<div class="ttc" id="kernel__netlink__net_8c_html_a4b3597e6b5433acae9d22f4efa612d4b"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a4b3597e6b5433acae9d22f4efa612d4b">iface_entry_up</a></div><div class="ttdeci">static bool iface_entry_up(iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00185">kernel_netlink_net.c:185</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a33d3a0bd02d90b6a9940413cdc7b2b8b"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">iface_entry_t::usable</a></div><div class="ttdeci">bool usable</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00154">kernel_netlink_net.c:154</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-44" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-44-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-44-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-44-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a1db8c558ca19629f217439383b872e11_cgraph.svg" width="302" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-45" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-45-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-45-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-45-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a1db8c558ca19629f217439383b872e11_icgraph.svg" width="100%" height="453"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6171ad9e6cb4f8e8abc248a8e14182ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> init_address_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize a list of local addresses. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02294">2294</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">iface_entry_t::addrs</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list_t::create_enumerator</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">netlink_buf_t::hdr</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00193">iface_entry_up_and_usable()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">iface_entry_t::ifname</a>, <a class="el" href="../../dd/dd5/aes-test_8c_source.html#l00034">in</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">addr_entry_t::ip</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">len</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00060">NLM_F_MATCH</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00052">NLM_F_REQUEST</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00059">NLM_F_ROOT</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00094">NLMSG_DONE</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00045">nlmsghdr::nlmsg_flags</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00043">nlmsghdr::nlmsg_len</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00082">NLMSG_LENGTH</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00085">NLMSG_NEXT</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00087">NLMSG_OK</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00044">nlmsghdr::nlmsg_type</a>, <a class="el" href="../../dd/dd5/aes-test_8c_source.html#l00036">out</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">process_addr()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">process_link()</a>, <a class="el" href="../../df/d12/mconsole_8c_source.html#l00091">request()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00455">rtgenmsg::rtgen_family</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00039">RTM_GETADDR</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00030">RTM_GETLINK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00035">RTM_NEWADDR</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00026">RTM_NEWLINK</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00328">socket</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, and <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;{</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    <a class="code" href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a> <a class="code" href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a>;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *<a class="code" href="../../dd/dd5/aes-test_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>, *current, *<a class="code" href="../../dd/dd5/aes-test_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a>;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d4/d2e/structrtgenmsg.html">rtgenmsg</a> *<a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *ifaces, *addrs;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    <a class="code" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <a class="code" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;known interfaces and IP addresses:&quot;</span>);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(&amp;request, 0, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    in = &amp;request.<a class="code" href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">hdr</a>;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    in-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsg_len</a> = <a class="code" href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d4/d2e/structrtgenmsg.html">rtgenmsg</a>));</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    in-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsg_flags</a> = <a class="code" href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a49bcfe3ce8471f372dcd17f6f989cd88">NLM_F_MATCH</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a9b2c023dd75018e29e84c0ac8df20720">NLM_F_ROOT</a>;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    msg = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(in);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    msg-&gt;<a class="code" href="../../d4/d2e/structrtgenmsg.html#aea659b9733bbd3ba0d63fad3adef59af">rtgen_family</a> = AF_UNSPEC;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="comment">/* get all links */</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    in-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ae4ad73febaabbbf1d9fcebe85ab130a4">RTM_GETLINK</a>;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>-&gt;send(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a6755d5a6461a641020a34e5ce0f14deb">socket</a>, in, &amp;out, &amp;len) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    {</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    }</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    current = <a class="code" href="../../dd/dd5/aes-test_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../de/d4c/netlink_8h.html#a2e67cb7b703696efae9909fbeba5616d">NLMSG_OK</a>(current, len))</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    {</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="keywordflow">switch</span> (current-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a>)</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;        {</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../de/d4c/netlink_8h.html#a151b98bf01f462dbc5d3c69e6396e064">NLMSG_DONE</a>:</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9">RTM_NEWLINK</a>:</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0f87b0e61837c8bde853f9eda9756613">process_link</a>(<span class="keyword">this</span>, current, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                <span class="comment">/* fall through */</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                current = <a class="code" href="../../de/d4c/netlink_8h.html#a533f12f954dec43e08cfaff6dcf9c751">NLMSG_NEXT</a>(current, len);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(out);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="comment">/* get all interface addresses */</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    in-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a98404fda6f7cf17c4826b7e39e78ccea">RTM_GETADDR</a>;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>-&gt;send(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a6755d5a6461a641020a34e5ce0f14deb">socket</a>, in, &amp;out, &amp;len) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    current = <a class="code" href="../../dd/dd5/aes-test_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a>;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../de/d4c/netlink_8h.html#a2e67cb7b703696efae9909fbeba5616d">NLMSG_OK</a>(current, len))</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    {</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <span class="keywordflow">switch</span> (current-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a>)</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        {</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../de/d4c/netlink_8h.html#a151b98bf01f462dbc5d3c69e6396e064">NLMSG_DONE</a>:</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a>:</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a524a440e79bfb8f59290902a14bb30e8">process_addr</a>(<span class="keyword">this</span>, current, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                <span class="comment">/* fall through */</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                current = <a class="code" href="../../de/d4c/netlink_8h.html#a533f12f954dec43e08cfaff6dcf9c751">NLMSG_NEXT</a>(current, len);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        }</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    }</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(out);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;read_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    ifaces = this-&gt;ifaces-&gt;create_enumerator(this-&gt;ifaces);</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="keywordflow">while</span> (ifaces-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(ifaces, &amp;iface))</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    {</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a1db8c558ca19629f217439383b872e11">iface_entry_up_and_usable</a>(iface))</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;  %s&quot;</span>, iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            addrs = iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">create_enumerator</a>(iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>);</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            <span class="keywordflow">while</span> (addrs-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(addrs, (<span class="keywordtype">void</span>**)&amp;addr))</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;            {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;    %H&quot;</span>, addr-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            }</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            addrs-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(addrs);</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        }</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    ifaces-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(ifaces);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="netlink_8h_html_a456954d27b8adedd78136a9511f13160"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a></div><div class="ttdeci">#define NLM_F_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00052">netlink.h:52</a></div></div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__windows_html_gaa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00328">windows.h:328</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html_a8d2a4634689d1535c752284f28528b69"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">netlink_buf_t::hdr</a></div><div class="ttdeci">struct nlmsghdr hdr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">kernel_netlink_shared.h:30</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="structiface__entry__t_html_af77daca88bd8077974e87a298418e1b4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">iface_entry_t::ifname</a></div><div class="ttdeci">char ifname[IFNAMSIZ]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">kernel_netlink_net.c:145</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a524a440e79bfb8f59290902a14bb30e8"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a524a440e79bfb8f59290902a14bb30e8">process_addr</a></div><div class="ttdeci">static void process_addr(private_kernel_netlink_net_t *this, struct nlmsghdr *hdr, bool event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">kernel_netlink_net.c:1071</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="aes-test_8c_html_aca392a8d3941cd0740aef3ad92545d67"><div class="ttname"><a href="../../dd/dd5/aes-test_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a></div><div class="ttdeci">FILE * in</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/aes-test_8c_source.html#l00034">aes-test.c:34</a></div></div>
<div class="ttc" id="structnlmsghdr_html"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html">nlmsghdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00042">netlink.h:42</a></div></div>
<div class="ttc" id="structiface__entry__t_html"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00139">kernel_netlink_net.c:139</a></div></div>
<div class="ttc" id="netlink_8h_html_ab6857a80029b18e3c1058ddfca5e6b6b"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a></div><div class="ttdeci">#define NLMSG_LENGTH(len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00082">netlink.h:82</a></div></div>
<div class="ttc" id="structnlmsghdr_html_abc588d6bfd91bcbf100709e57b7877df"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsghdr::nlmsg_type</a></div><div class="ttdeci">__u16 nlmsg_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00044">netlink.h:44</a></div></div>
<div class="ttc" id="netlink_8h_html_a533f12f954dec43e08cfaff6dcf9c751"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a533f12f954dec43e08cfaff6dcf9c751">NLMSG_NEXT</a></div><div class="ttdeci">#define NLMSG_NEXT(nlh, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00085">netlink.h:85</a></div></div>
<div class="ttc" id="structlinked__list__t_html_aa079d50cc4028f12d65c75cbb53f8c8a"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#aa079d50cc4028f12d65c75cbb53f8c8a">linked_list_t::create_enumerator</a></div><div class="ttdeci">enumerator_t *(* create_enumerator)(linked_list_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00071">linked_list.h:71</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00035">rtnetlink.h:35</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9">RTM_NEWLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00026">rtnetlink.h:26</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600a98404fda6f7cf17c4826b7e39e78ccea"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a98404fda6f7cf17c4826b7e39e78ccea">RTM_GETADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00039">rtnetlink.h:39</a></div></div>
<div class="ttc" id="netlink_8h_html_a151b98bf01f462dbc5d3c69e6396e064"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a151b98bf01f462dbc5d3c69e6396e064">NLMSG_DONE</a></div><div class="ttdeci">#define NLMSG_DONE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00094">netlink.h:94</a></div></div>
<div class="ttc" id="structnlmsghdr_html_ad697397e7366eb442db4bb4e963f79f7"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsghdr::nlmsg_flags</a></div><div class="ttdeci">__u16 nlmsg_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00045">netlink.h:45</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00029">kernel_netlink_shared.h:29</a></div></div>
<div class="ttc" id="netlink_8h_html_a2e67cb7b703696efae9909fbeba5616d"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a2e67cb7b703696efae9909fbeba5616d">NLMSG_OK</a></div><div class="ttdeci">#define NLMSG_OK(nlh, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00087">netlink.h:87</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a2b341e3994bfbc0aa8d680205abbd28b"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a></div><div class="ttdeci">u_int16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">duplicheck_msg.h:45</a></div></div>
<div class="ttc" id="structrtgenmsg_html_aea659b9733bbd3ba0d63fad3adef59af"><div class="ttname"><a href="../../d4/d2e/structrtgenmsg.html#aea659b9733bbd3ba0d63fad3adef59af">rtgenmsg::rtgen_family</a></div><div class="ttdeci">unsigned char rtgen_family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00455">rtnetlink.h:455</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a6755d5a6461a641020a34e5ce0f14deb"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a6755d5a6461a641020a34e5ce0f14deb">private_kernel_netlink_net_t::socket</a></div><div class="ttdeci">netlink_socket_t * socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00411">kernel_netlink_net.c:411</a></div></div>
<div class="ttc" id="netlink_8h_html_a49bcfe3ce8471f372dcd17f6f989cd88"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a49bcfe3ce8471f372dcd17f6f989cd88">NLM_F_MATCH</a></div><div class="ttdeci">#define NLM_F_MATCH</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00060">netlink.h:60</a></div></div>
<div class="ttc" id="netlink_8h_html_a9b2c023dd75018e29e84c0ac8df20720"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a9b2c023dd75018e29e84c0ac8df20720">NLM_F_ROOT</a></div><div class="ttdeci">#define NLM_F_ROOT</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00059">netlink.h:59</a></div></div>
<div class="ttc" id="aes-test_8c_html_a1277960b5f2b37137fe9b0b5a1ea0beb"><div class="ttname"><a href="../../dd/dd5/aes-test_8c.html#a1277960b5f2b37137fe9b0b5a1ea0beb">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/aes-test_8c_source.html#l00036">aes-test.c:36</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="structnlmsghdr_html_a75261bc7443b0c646c49dd8313f4a66a"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsghdr::nlmsg_len</a></div><div class="ttdeci">__u32 nlmsg_len</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00043">netlink.h:43</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0f87b0e61837c8bde853f9eda9756613"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0f87b0e61837c8bde853f9eda9756613">process_link</a></div><div class="ttdeci">static void process_link(private_kernel_netlink_net_t *this, struct nlmsghdr *hdr, bool event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">kernel_netlink_net.c:969</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a074ce3bd111ba07ab802a6c74063a5a2"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">iface_entry_t::addrs</a></div><div class="ttdeci">linked_list_t * addrs</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">kernel_netlink_net.c:151</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
<div class="ttc" id="structaddr__entry__t_html"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00107">kernel_netlink_net.c:107</a></div></div>
<div class="ttc" id="mconsole_8c_html_a251c32cfa402f283bd6349486d9caac0"><div class="ttname"><a href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a></div><div class="ttdeci">static int request(private_mconsole_t *this, void(*cb)(void *, char *, size_t), void *data, char *command,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d12/mconsole_8c_source.html#l00091">mconsole.c:91</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a9fecb8edaffa35df931c847d9e95a091"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">addr_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">kernel_netlink_net.c:110</a></div></div>
<div class="ttc" id="structrtgenmsg_html"><div class="ttname"><a href="../../d4/d2e/structrtgenmsg.html">rtgenmsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00454">rtnetlink.h:454</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ae4ad73febaabbbf1d9fcebe85ab130a4"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ae4ad73febaabbbf1d9fcebe85ab130a4">RTM_GETLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00030">rtnetlink.h:30</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a1db8c558ca19629f217439383b872e11"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a1db8c558ca19629f217439383b872e11">iface_entry_up_and_usable</a></div><div class="ttdeci">static bool iface_entry_up_and_usable(iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00193">kernel_netlink_net.c:193</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-46" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-46-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-46-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-46-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a6171ad9e6cb4f8e8abc248a8e14182ca_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-47" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-47-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-47-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-47-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a6171ad9e6cb4f8e8abc248a8e14182ca_icgraph.svg" width="432" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a46555f8629f621bd40ace28fe474457f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> is_address_better </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compare two IP addresses and return TRUE if the second address is the better choice of the two to reach the destination. For IPv6 we approximately follow RFC 6724. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00781">781</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00754">common_prefix()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00113">addr_entry_t::flags</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00079">host_t::get_family</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00710">get_scope()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">addr_entry_t::ip</a>, and <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00638">sa</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00848">get_interface_address()</a>.</p>
<div class="fragment"><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;{</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    u_char <a class="code" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, sb, sd, pa, pb;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">/* rule 2: prefer appropriate scope */</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">if</span> (d)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        sa = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a3f7980c4116904644f96e2d8fcfa8109">get_scope</a>(a-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        sb = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a3f7980c4116904644f96e2d8fcfa8109">get_scope</a>(b-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        sd = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a3f7980c4116904644f96e2d8fcfa8109">get_scope</a>(d);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordflow">if</span> (sa &lt; sb)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keywordflow">return</span> sa &lt; sd;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sb &lt; sa)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordflow">return</span> sb &gt;= sd;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(a-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>) == AF_INET)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    {   <span class="comment">/* stop here for IPv4, default to addresses found earlier */</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">/* rule 3: avoid deprecated addresses (RFC 4862) */</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a46ff6b0aafdd32abb3b2e1401af8ee29">flags</a> &amp; IFA_F_DEPRECATED) != (b-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a46ff6b0aafdd32abb3b2e1401af8ee29">flags</a> &amp; IFA_F_DEPRECATED))</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keywordflow">return</span> a-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a46ff6b0aafdd32abb3b2e1401af8ee29">flags</a> &amp; IFA_F_DEPRECATED;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">/* rule 4 is not applicable as we don&#39;t know if an address is a home or</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">     * care-of addresses.</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">     * rule 5 does not apply as we only compare addresses from one interface</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">     * rule 6 requires a policy table (optionally configurable) to match</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">     * configurable labels</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">/* rule 7: prefer temporary addresses (WE REVERSE THIS BY DEFAULT!) */</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">if</span> ((a-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a46ff6b0aafdd32abb3b2e1401af8ee29">flags</a> &amp; IFA_F_TEMPORARY) != (b-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a46ff6b0aafdd32abb3b2e1401af8ee29">flags</a> &amp; IFA_F_TEMPORARY))</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">if</span> (this-&gt;prefer_temporary_addrs)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            <span class="keywordflow">return</span> b-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a46ff6b0aafdd32abb3b2e1401af8ee29">flags</a> &amp; IFA_F_TEMPORARY;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="keywordflow">return</span> a-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a46ff6b0aafdd32abb3b2e1401af8ee29">flags</a> &amp; IFA_F_TEMPORARY;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="comment">/* rule 8: use longest matching prefix */</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordflow">if</span> (d)</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        pa = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a648efa40917556769449756994bdf492">common_prefix</a>(a-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>, d);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        pb = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a648efa40917556769449756994bdf492">common_prefix</a>(b-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">ip</a>, d);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">if</span> (pa != pb)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordflow">return</span> pb &gt; pa;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">/* default to addresses found earlier */</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a648efa40917556769449756994bdf492"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a648efa40917556769449756994bdf492">common_prefix</a></div><div class="ttdeci">static u_char common_prefix(host_t *a, host_t *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00754">kernel_netlink_net.c:754</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a46ff6b0aafdd32abb3b2e1401af8ee29"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a46ff6b0aafdd32abb3b2e1401af8ee29">addr_entry_t::flags</a></div><div class="ttdeci">u_char flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00113">kernel_netlink_net.c:113</a></div></div>
<div class="ttc" id="kernel__pfkey__ipsec_8c_html_a8539097a5c34139fca0cfdc9782d4cb1"><div class="ttname"><a href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a></div><div class="ttdeci">struct sadb_sa * sa</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l00638">kernel_pfkey_ipsec.c:638</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a3f7980c4116904644f96e2d8fcfa8109"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a3f7980c4116904644f96e2d8fcfa8109">get_scope</a></div><div class="ttdeci">static u_char get_scope(host_t *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00710">kernel_netlink_net.c:710</a></div></div>
<div class="ttc" id="structhost__t_html_a75956f3fa34ec58543cb717d7a6dbba6"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">host_t::get_family</a></div><div class="ttdeci">int(* get_family)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00079">host.h:79</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a9fecb8edaffa35df931c847d9e95a091"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a9fecb8edaffa35df931c847d9e95a091">addr_entry_t::ip</a></div><div class="ttdeci">host_t * ip</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00110">kernel_netlink_net.c:110</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-48" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-48-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-48-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-48-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a46555f8629f621bd40ace28fe474457f_cgraph.svg" width="100%" height="499"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-49" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-49-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-49-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-49-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a46555f8629f621bd40ace28fe474457f_icgraph.svg" width="100%" height="371"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5380f306f77b51da4bb8012386d5920e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> is_interface_up_and_usable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>check if an interface with a given index is up and usable</p>
<p>this-&gt;lock must be locked when calling this function </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00936">936</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">iface_entry_by_index()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00193">iface_entry_up_and_usable()</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01215">process_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;{</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <a class="code" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">if</span> (this-&gt;ifaces-&gt;find_first(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">ifaces</a>, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a>,</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                 (<span class="keywordtype">void</span>**)&amp;iface, &amp;index) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a1db8c558ca19629f217439383b872e11">iface_entry_up_and_usable</a>(iface);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a44a28287a4812f8e8101770a3cc94b87"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a></div><div class="ttdeci">static bool iface_entry_by_index(iface_entry_t *this, int *ifindex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">kernel_netlink_net.c:169</a></div></div>
<div class="ttc" id="structiface__entry__t_html"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00139">kernel_netlink_net.c:139</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a388b18d13f3b29682afae599da369527"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">private_kernel_netlink_net_t::ifaces</a></div><div class="ttdeci">linked_list_t * ifaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00396">kernel_netlink_net.c:396</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a1db8c558ca19629f217439383b872e11"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a1db8c558ca19629f217439383b872e11">iface_entry_up_and_usable</a></div><div class="ttdeci">static bool iface_entry_up_and_usable(iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00193">kernel_netlink_net.c:193</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-50" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-50-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-50-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-50-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a5380f306f77b51da4bb8012386d5920e_cgraph.svg" width="499" height="103"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-51" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-51-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-51-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-51-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a5380f306f77b51da4bb8012386d5920e_icgraph.svg" width="100%" height="371"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a34793bb5a8a46b632833c292910b1f81"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> is_known_vip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>check if the given IP is known as virtual IP</p>
<p>this-&gt;lock must be held when calling this function </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00661">661</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">addr_map_entry_match()</a>, <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">ip</a>, and <a class="el" href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">lookup</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02075">METHOD()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01215">process_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> <a class="code" href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a> = {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        .ip = <a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a>,</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    };</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">return</span> this-&gt;vips-&gt;get_match(this-&gt;vips, &amp;lookup,</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                                (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a>) != NULL;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;}</div>
<div class="ttc" id="error__notify__msg_8h_html_abcc82b944bf2a158e29a4042043185a5"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a></div><div class="ttdeci">char ip[60]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">error_notify_msg.h:53</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_acd3374d9d8f49b40648171e449a059bb"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a></div><div class="ttdeci">static bool addr_map_entry_match(addr_map_entry_t *a, addr_map_entry_t *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">kernel_netlink_net.c:257</a></div></div>
<div class="ttc" id="proposal__keywords__static_8c_html_a85d2eea012c83b4dd2615d97bddbffc8"><div class="ttname"><a href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a></div><div class="ttdeci">static const short lookup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">proposal_keywords_static.c:288</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-52" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-52-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-52-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-52-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a34793bb5a8a46b632833c292910b1f81_cgraph.svg" width="320" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-53" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-53-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-53-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-53-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a34793bb5a8a46b632833c292910b1f81_icgraph.svg" width="100%" height="409"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4ac3e70878acb3963e1064a4964e26f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> is_vip_installed_or_gone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> **&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>check if the given IP is known as virtual IP and currently installed</p>
<p>this function will also return TRUE if the virtual IP entry disappeared. in that case the returned entry will be NULL.</p>
<p>this-&gt;lock must be held when calling this function </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00640">640</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">addr_map_entry_match()</a>, <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">ip</a>, <a class="el" href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">lookup</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01970">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;{</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> <a class="code" href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a> = {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        .ip = <a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a>,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    };</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    *entry = this-&gt;vips-&gt;get_match(this-&gt;vips, &amp;lookup,</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                  (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> (*entry == NULL)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    {   <span class="comment">/* the virtual IP disappeared */</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">return</span> (*entry)-&gt;addr-&gt;installed;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div>
<div class="ttc" id="error__notify__msg_8h_html_abcc82b944bf2a158e29a4042043185a5"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a></div><div class="ttdeci">char ip[60]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">error_notify_msg.h:53</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_acd3374d9d8f49b40648171e449a059bb"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a></div><div class="ttdeci">static bool addr_map_entry_match(addr_map_entry_t *a, addr_map_entry_t *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">kernel_netlink_net.c:257</a></div></div>
<div class="ttc" id="proposal__keywords__static_8c_html_a85d2eea012c83b4dd2615d97bddbffc8"><div class="ttname"><a href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a></div><div class="ttdeci">static const short lookup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">proposal_keywords_static.c:288</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-54" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-54-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-54-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-54-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a4ac3e70878acb3963e1064a4964e26f0_cgraph.svg" width="384" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-55" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-55-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-55-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-55-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a4ac3e70878acb3963e1064a4964e26f0_icgraph.svg" width="304" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1160788a04132956fb9fcd0ab0552ba4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> manage_ipaddr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlmsg_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>if_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Manages the creation and deletion of ip addresses on an interface. By setting the appropriate nlmsg_type, the ip will be set or unset. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01930">1930</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../dd/deb/eap__mschapv2_8c_source.html#l00163">flags</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00095">host_t::get_address</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00079">host_t::get_family</a>, <a class="el" href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">netlink_buf_t::hdr</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../d1/dfe/kernel__netlink__shared_8c_source.html#l00618">netlink_add_attribute()</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00054">NLM_F_ACK</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00052">NLM_F_REQUEST</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00045">nlmsghdr::nlmsg_flags</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00043">nlmsghdr::nlmsg_len</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00082">NLMSG_LENGTH</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00044">nlmsghdr::nlmsg_type</a>, <a class="el" href="../../d9/dbe/test__utils_8c_source.html#l00206">prefix</a>, <a class="el" href="../../df/d12/mconsole_8c_source.html#l00091">request()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00258">RT_SCOPE_UNIVERSE</a>, and <a class="el" href="../../d9/d43/windows_8h_source.html#l00328">socket</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01970">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;{</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <a class="code" href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a> <a class="code" href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a>;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keyword">struct </span>ifaddrmsg *<a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> chunk;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(&amp;request, 0, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    chunk = ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(ip);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    hdr = &amp;request.<a class="code" href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">hdr</a>;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsg_flags</a> = <a class="code" href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a67d5b6ba8714b97d74df72d119351bee">NLM_F_ACK</a> | <a class="code" href="../../dd/deb/eap__mschapv2_8c.html#aff1a49ace550ffdd4860e52422343ba5">flags</a>;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> = nlmsg_type;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsg_len</a> = <a class="code" href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ifaddrmsg));</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    msg = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    msg-&gt;ifa_family = ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(ip);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    msg-&gt;ifa_flags = 0;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    msg-&gt;ifa_prefixlen = <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a> &lt; 0 ? chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> * 8 : <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    msg-&gt;ifa_scope = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158">RT_SCOPE_UNIVERSE</a>;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    msg-&gt;ifa_index = if_index;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, IFA_LOCAL, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">if</span> (ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(ip) == AF_INET6 &amp;&amp; this-&gt;rta_prefsrc_for_ipv6)</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    {   <span class="comment">/* if source routes are possible we let the virtual IP get deprecated</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">         * immediately (but mark it as valid forever) so it gets only used if</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">         * forced by our route, and not by the default IPv6 address selection */</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        <span class="keyword">struct </span>ifa_cacheinfo <a class="code" href="../../d2/d43/cert__cache_8c.html#adaf6833e5a54ee5de2a99117efda19e9">cache</a> = {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            .ifa_valid = 0xFFFFFFFF,</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            .ifa_prefered = 0,</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        };</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, IFA_CACHEINFO, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(cache),</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                              <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>-&gt;send_ack(this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>, hdr);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;}</div>
<div class="ttc" id="netlink_8h_html_a456954d27b8adedd78136a9511f13160"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a></div><div class="ttdeci">#define NLM_F_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00052">netlink.h:52</a></div></div>
<div class="ttc" id="group__windows_html_gaa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00328">windows.h:328</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html_a8d2a4634689d1535c752284f28528b69"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">netlink_buf_t::hdr</a></div><div class="ttdeci">struct nlmsghdr hdr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">kernel_netlink_shared.h:30</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158">RT_SCOPE_UNIVERSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00258">rtnetlink.h:258</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="structnlmsghdr_html"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html">nlmsghdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00042">netlink.h:42</a></div></div>
<div class="ttc" id="cert__cache_8c_html_adaf6833e5a54ee5de2a99117efda19e9"><div class="ttname"><a href="../../d2/d43/cert__cache_8c.html#adaf6833e5a54ee5de2a99117efda19e9">cache</a></div><div class="ttdeci">static void cache(private_cert_cache_t *this, certificate_t *subject, certificate_t *issuer, signature_scheme_t scheme)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d43/cert__cache_8c_source.html#l00083">cert_cache.c:83</a></div></div>
<div class="ttc" id="netlink_8h_html_ab6857a80029b18e3c1058ddfca5e6b6b"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a></div><div class="ttdeci">#define NLMSG_LENGTH(len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00082">netlink.h:82</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structnlmsghdr_html_abc588d6bfd91bcbf100709e57b7877df"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsghdr::nlmsg_type</a></div><div class="ttdeci">__u16 nlmsg_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00044">netlink.h:44</a></div></div>
<div class="ttc" id="structhost__t_html_aa3493ae67869e4cd9b4dbe98226650fb"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">host_t::get_address</a></div><div class="ttdeci">chunk_t(* get_address)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00095">host.h:95</a></div></div>
<div class="ttc" id="test__utils_8c_html_a0a7083cd7ae62f5c50d6abd5cdd491ab"><div class="ttname"><a href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a></div><div class="ttdeci">bool prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbe/test__utils_8c_source.html#l00206">test_utils.c:206</a></div></div>
<div class="ttc" id="netlink_8h_html_a67d5b6ba8714b97d74df72d119351bee"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a67d5b6ba8714b97d74df72d119351bee">NLM_F_ACK</a></div><div class="ttdeci">#define NLM_F_ACK</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00054">netlink.h:54</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="structnlmsghdr_html_ad697397e7366eb442db4bb4e963f79f7"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsghdr::nlmsg_flags</a></div><div class="ttdeci">__u16 nlmsg_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00045">netlink.h:45</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00029">kernel_netlink_shared.h:29</a></div></div>
<div class="ttc" id="structnlmsghdr_html_a75261bc7443b0c646c49dd8313f4a66a"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsghdr::nlmsg_len</a></div><div class="ttdeci">__u32 nlmsg_len</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00043">netlink.h:43</a></div></div>
<div class="ttc" id="eap__mschapv2_8c_html_aff1a49ace550ffdd4860e52422343ba5"><div class="ttname"><a href="../../dd/deb/eap__mschapv2_8c.html#aff1a49ace550ffdd4860e52422343ba5">flags</a></div><div class="ttdeci">u_int8_t flags</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/deb/eap__mschapv2_8c_source.html#l00163">eap_mschapv2.c:163</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
<div class="ttc" id="kernel__netlink__shared_8c_html_a202b8086fb6f849f0a33d96de2849705"><div class="ttname"><a href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a></div><div class="ttdeci">void netlink_add_attribute(struct nlmsghdr *hdr, int rta_type, chunk_t data, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfe/kernel__netlink__shared_8c_source.html#l00618">kernel_netlink_shared.c:618</a></div></div>
<div class="ttc" id="structhost__t_html_a75956f3fa34ec58543cb717d7a6dbba6"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">host_t::get_family</a></div><div class="ttdeci">int(* get_family)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00079">host.h:79</a></div></div>
<div class="ttc" id="mconsole_8c_html_a251c32cfa402f283bd6349486d9caac0"><div class="ttname"><a href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a></div><div class="ttdeci">static int request(private_mconsole_t *this, void(*cb)(void *, char *, size_t), void *data, char *command,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d12/mconsole_8c_source.html#l00091">mconsole.c:91</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-56" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-56-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-56-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-56-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a1160788a04132956fb9fcd0ab0552ba4_cgraph.svg" width="544" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-57" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-57-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-57-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-57-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a1160788a04132956fb9fcd0ab0552ba4_icgraph.svg" width="251" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2fc64fdc22a19e137870e17197ed5cc2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> manage_rule </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlmsg_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>family</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int32_t&#160;</td>
          <td class="paramname"><em>prio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>create or delete a rule to use our routing table </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02385">2385</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../d0/d72/ha__message_8c_source.html#l00051">family</a>, <a class="el" href="../../de/d60/settings_8h_source.html#l00166">settings_t::get_str</a>, <a class="el" href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">netlink_buf_t::hdr</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../d9/de4/ipsec__types_8c_source.html#l00043">mark_from_string()</a>, <a class="el" href="../../d4/dab/ipsec__types_8h_source.html#l00168">mark_t::mask</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../d1/dfe/kernel__netlink__shared_8c_source.html#l00618">netlink_add_attribute()</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00054">NLM_F_ACK</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00067">NLM_F_CREATE</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00066">NLM_F_EXCL</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00052">NLM_F_REQUEST</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00045">nlmsghdr::nlmsg_flags</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00043">nlmsghdr::nlmsg_len</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00082">NLMSG_LENGTH</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00044">nlmsghdr::nlmsg_type</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00150">library_t::ns</a>, <a class="el" href="../../df/d12/mconsole_8c_source.html#l00091">request()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00258">RT_SCOPE_UNIVERSE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00295">RTA_PRIORITY</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00182">rtmsg::rtm_family</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00192">rtmsg::rtm_flags</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00056">RTM_NEWRULE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00188">rtmsg::rtm_protocol</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00189">rtmsg::rtm_scope</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00187">rtmsg::rtm_table</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00190">rtmsg::rtm_type</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00199">RTN_UNICAST</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00224">RTPROT_BOOT</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00240">library_t::settings</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00328">socket</a>, and <a class="el" href="../../d4/dab/ipsec__types_8h_source.html#l00166">mark_t::value</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02496">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;{</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <a class="code" href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a> <a class="code" href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a>;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a> *<a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> chunk;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <span class="keywordtype">char</span> *fwmark;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(&amp;request, 0, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    hdr = &amp;request.<a class="code" href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">hdr</a>;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsg_flags</a> = <a class="code" href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a67d5b6ba8714b97d74df72d119351bee">NLM_F_ACK</a>;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> = nlmsg_type;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="keywordflow">if</span> (nlmsg_type == <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ae566f28280c97c9e2ea5917a5c5da85d">RTM_NEWRULE</a>)</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsg_flags</a> |= <a class="code" href="../../de/d4c/netlink_8h.html#a20a00ae52e4c150f54649d7346d23a7a">NLM_F_CREATE</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a0b0f8c9581ee93747c7d9e94ca0e0596">NLM_F_EXCL</a>;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    }</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsg_len</a> = <a class="code" href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a>));</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    msg = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtm_table</a> = table;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a> = <a class="code" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a6f1bcdda5769bb2a4ecc2f6641176d53">rtm_protocol</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#adf787fea3597fc0a9994ccce35b00f08">RTPROT_BOOT</a>;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#aea8db71cfc376c6543bedcf3a77dbd7f">rtm_scope</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158">RT_SCOPE_UNIVERSE</a>;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#acd17e0f7575b8084c0be4392e774bbeb">rtm_type</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a91a1343cab6c7576066ec821db5c138f">RTN_UNICAST</a>;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    chunk = <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(prio);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a1b02b788d3bfeaf02990a9342acf18bc">RTA_PRIORITY</a>, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    fwmark = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>-&gt;<a class="code" href="../../db/d2f/structsettings__t.html#ad71845306a0bdfa694487e3458712f45">get_str</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>,</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                            <span class="stringliteral">&quot;%s.plugins.kernel-netlink.fwmark&quot;</span>, NULL, <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">ns</a>);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    <span class="keywordflow">if</span> (fwmark)</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    {</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="preprocessor">#ifdef HAVE_LINUX_FIB_RULES_H</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="preprocessor"></span>        <a class="code" href="../../da/dbc/structmark__t.html">mark_t</a> mark;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <span class="keywordflow">if</span> (fwmark[0] == <span class="charliteral">&#39;!&#39;</span>)</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        {</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#abc41f4a98d88f3f0927430504c9c81a1">rtm_flags</a> |= FIB_RULE_INVERT;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            fwmark++;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        }</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2d/group__ipsec__types.html#gaafee0a8be9ddc148ab4af41b7cab0273">mark_from_string</a>(fwmark, &amp;mark))</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        {</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            chunk = <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(mark.<a class="code" href="../../da/dbc/structmark__t.html#a420e148b17e54623afb58ec6c9dc4a1c">value</a>);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, FRA_FWMARK, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            chunk = <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(mark.<a class="code" href="../../da/dbc/structmark__t.html#ad2fcaebea7189c04c56519586b7ec9a9">mask</a>);</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, FRA_FWMASK, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;            <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#abc41f4a98d88f3f0927430504c9c81a1">rtm_flags</a> &amp; FIB_RULE_INVERT)</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                this-&gt;routing_mark = mark;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;            }</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        }</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="preprocessor"></span>        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;setting firewall mark on routing rule is not supported&quot;</span>);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>-&gt;send_ack(this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>, hdr);</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;}</div>
<div class="ttc" id="rtnetlink_8h_html_adf787fea3597fc0a9994ccce35b00f08"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#adf787fea3597fc0a9994ccce35b00f08">RTPROT_BOOT</a></div><div class="ttdeci">#define RTPROT_BOOT</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00224">rtnetlink.h:224</a></div></div>
<div class="ttc" id="netlink_8h_html_a456954d27b8adedd78136a9511f13160"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a></div><div class="ttdeci">#define NLM_F_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00052">netlink.h:52</a></div></div>
<div class="ttc" id="group__windows_html_gaa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00328">windows.h:328</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html_a8d2a4634689d1535c752284f28528b69"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">netlink_buf_t::hdr</a></div><div class="ttdeci">struct nlmsghdr hdr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">kernel_netlink_shared.h:30</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158">RT_SCOPE_UNIVERSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00258">rtnetlink.h:258</a></div></div>
<div class="ttc" id="structsettings__t_html_ad71845306a0bdfa694487e3458712f45"><div class="ttname"><a href="../../db/d2f/structsettings__t.html#ad71845306a0bdfa694487e3458712f45">settings_t::get_str</a></div><div class="ttdeci">char *(* get_str)(settings_t *this, char *key, char *def,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d60/settings_8h_source.html#l00166">settings.h:166</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ab04a0655cd1e3bcac5e8f48c18df1a57a91a1343cab6c7576066ec821db5c138f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a91a1343cab6c7576066ec821db5c138f">RTN_UNICAST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00199">rtnetlink.h:199</a></div></div>
<div class="ttc" id="group__ipsec__types_html_gaafee0a8be9ddc148ab4af41b7cab0273"><div class="ttname"><a href="../../d3/d2d/group__ipsec__types.html#gaafee0a8be9ddc148ab4af41b7cab0273">mark_from_string</a></div><div class="ttdeci">bool mark_from_string(const char *value, mark_t *mark)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de4/ipsec__types_8c_source.html#l00043">ipsec_types.c:43</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="structnlmsghdr_html"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html">nlmsghdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00042">netlink.h:42</a></div></div>
<div class="ttc" id="structrtmsg_html_abc41f4a98d88f3f0927430504c9c81a1"><div class="ttname"><a href="../../da/d53/structrtmsg.html#abc41f4a98d88f3f0927430504c9c81a1">rtmsg::rtm_flags</a></div><div class="ttdeci">unsigned rtm_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00192">rtnetlink.h:192</a></div></div>
<div class="ttc" id="netlink_8h_html_ab6857a80029b18e3c1058ddfca5e6b6b"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a></div><div class="ttdeci">#define NLMSG_LENGTH(len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00082">netlink.h:82</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173a1b02b788d3bfeaf02990a9342acf18bc"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a1b02b788d3bfeaf02990a9342acf18bc">RTA_PRIORITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00295">rtnetlink.h:295</a></div></div>
<div class="ttc" id="structnlmsghdr_html_abc588d6bfd91bcbf100709e57b7877df"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsghdr::nlmsg_type</a></div><div class="ttdeci">__u16 nlmsg_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00044">netlink.h:44</a></div></div>
<div class="ttc" id="ha__message_8c_html_a6494da1d0747e053505497a35ebccbba"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a></div><div class="ttdeci">u_int8_t family</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00051">ha_message.c:51</a></div></div>
<div class="ttc" id="structmark__t_html_a420e148b17e54623afb58ec6c9dc4a1c"><div class="ttname"><a href="../../da/dbc/structmark__t.html#a420e148b17e54623afb58ec6c9dc4a1c">mark_t::value</a></div><div class="ttdeci">u_int32_t value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dab/ipsec__types_8h_source.html#l00166">ipsec_types.h:166</a></div></div>
<div class="ttc" id="netlink_8h_html_a67d5b6ba8714b97d74df72d119351bee"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a67d5b6ba8714b97d74df72d119351bee">NLM_F_ACK</a></div><div class="ttdeci">#define NLM_F_ACK</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00054">netlink.h:54</a></div></div>
<div class="ttc" id="structrtmsg_html_a2295e2054ab275a89be3c681a630a8e9"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtmsg::rtm_family</a></div><div class="ttdeci">unsigned char rtm_family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00182">rtnetlink.h:182</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ae566f28280c97c9e2ea5917a5c5da85d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ae566f28280c97c9e2ea5917a5c5da85d">RTM_NEWRULE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00056">rtnetlink.h:56</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="netlink_8h_html_a0b0f8c9581ee93747c7d9e94ca0e0596"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a0b0f8c9581ee93747c7d9e94ca0e0596">NLM_F_EXCL</a></div><div class="ttdeci">#define NLM_F_EXCL</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00066">netlink.h:66</a></div></div>
<div class="ttc" id="structnlmsghdr_html_ad697397e7366eb442db4bb4e963f79f7"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsghdr::nlmsg_flags</a></div><div class="ttdeci">__u16 nlmsg_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00045">netlink.h:45</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00029">kernel_netlink_shared.h:29</a></div></div>
<div class="ttc" id="structmark__t_html_ad2fcaebea7189c04c56519586b7ec9a9"><div class="ttname"><a href="../../da/dbc/structmark__t.html#ad2fcaebea7189c04c56519586b7ec9a9">mark_t::mask</a></div><div class="ttdeci">u_int32_t mask</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dab/ipsec__types_8h_source.html#l00168">ipsec_types.h:168</a></div></div>
<div class="ttc" id="structrtmsg_html"><div class="ttname"><a href="../../da/d53/structrtmsg.html">rtmsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00181">rtnetlink.h:181</a></div></div>
<div class="ttc" id="netlink_8h_html_a20a00ae52e4c150f54649d7346d23a7a"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a20a00ae52e4c150f54649d7346d23a7a">NLM_F_CREATE</a></div><div class="ttdeci">#define NLM_F_CREATE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00067">netlink.h:67</a></div></div>
<div class="ttc" id="structnlmsghdr_html_a75261bc7443b0c646c49dd8313f4a66a"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsghdr::nlmsg_len</a></div><div class="ttdeci">__u32 nlmsg_len</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00043">netlink.h:43</a></div></div>
<div class="ttc" id="structrtmsg_html_aea8db71cfc376c6543bedcf3a77dbd7f"><div class="ttname"><a href="../../da/d53/structrtmsg.html#aea8db71cfc376c6543bedcf3a77dbd7f">rtmsg::rtm_scope</a></div><div class="ttdeci">unsigned char rtm_scope</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00189">rtnetlink.h:189</a></div></div>
<div class="ttc" id="structlibrary__t_html_aea9e6313fee01053f94cdc4a5a00e2bd"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">library_t::ns</a></div><div class="ttdeci">const char * ns</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00150">library.h:150</a></div></div>
<div class="ttc" id="structrtmsg_html_a72deabb274ce59c11db0e21e7aeb8de7"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtmsg::rtm_table</a></div><div class="ttdeci">unsigned char rtm_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00187">rtnetlink.h:187</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
<div class="ttc" id="kernel__netlink__shared_8c_html_a202b8086fb6f849f0a33d96de2849705"><div class="ttname"><a href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a></div><div class="ttdeci">void netlink_add_attribute(struct nlmsghdr *hdr, int rta_type, chunk_t data, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfe/kernel__netlink__shared_8c_source.html#l00618">kernel_netlink_shared.c:618</a></div></div>
<div class="ttc" id="mconsole_8c_html_a251c32cfa402f283bd6349486d9caac0"><div class="ttname"><a href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a></div><div class="ttdeci">static int request(private_mconsole_t *this, void(*cb)(void *, char *, size_t), void *data, char *command,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d12/mconsole_8c_source.html#l00091">mconsole.c:91</a></div></div>
<div class="ttc" id="structrtmsg_html_acd17e0f7575b8084c0be4392e774bbeb"><div class="ttname"><a href="../../da/d53/structrtmsg.html#acd17e0f7575b8084c0be4392e774bbeb">rtmsg::rtm_type</a></div><div class="ttdeci">unsigned char rtm_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00190">rtnetlink.h:190</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
<div class="ttc" id="structlibrary__t_html_ad435178668da74384948b6a151d913f5"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">library_t::settings</a></div><div class="ttdeci">settings_t * settings</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00240">library.h:240</a></div></div>
<div class="ttc" id="structmark__t_html"><div class="ttname"><a href="../../da/dbc/structmark__t.html">mark_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dab/ipsec__types_8h_source.html#l00164">ipsec_types.h:164</a></div></div>
<div class="ttc" id="structrtmsg_html_a6f1bcdda5769bb2a4ecc2f6641176d53"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a6f1bcdda5769bb2a4ecc2f6641176d53">rtmsg::rtm_protocol</a></div><div class="ttdeci">unsigned char rtm_protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00188">rtnetlink.h:188</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-58" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-58-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-58-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-58-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a2fc64fdc22a19e137870e17197ed5cc2_cgraph.svg" width="568" height="164"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-59" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-59-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-59-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-59-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a2fc64fdc22a19e137870e17197ed5cc2_icgraph.svg" width="411" height="103"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0fb4225c5228122371f3ef9fe600c523"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> manage_srcroute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlmsg_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>dst_net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>prefixlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>gateway</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>src_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>if_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Forward declaration</p>
<p>Manages source routes in the routing table. By setting the appropriate nlmsg_type, the route gets added or removed. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">2144</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00246">chunk_alloca</a>, <a class="el" href="../../dd/deb/eap__mschapv2_8c_source.html#l00163">flags</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00095">host_t::get_address</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00079">host_t::get_family</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01481">get_interface_index()</a>, <a class="el" href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">netlink_buf_t::hdr</a>, <a class="el" href="../../d9/d7b/settings__lexer_8c_source.html#l00957">if()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00050">memcpy</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00078">memset</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../d1/dfe/kernel__netlink__shared_8c_source.html#l00618">netlink_add_attribute()</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00054">NLM_F_ACK</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00052">NLM_F_REQUEST</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00045">nlmsghdr::nlmsg_flags</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00043">nlmsghdr::nlmsg_len</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00082">NLMSG_LENGTH</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00044">nlmsghdr::nlmsg_type</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../df/d12/mconsole_8c_source.html#l00091">request()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00258">RT_SCOPE_UNIVERSE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00163">RTA_ALIGN</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00171">RTA_DATA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00290">RTA_DST</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00294">RTA_GATEWAY</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00156">rtattr::rta_len</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00169">RTA_LENGTH</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00297">RTA_METRICS</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00293">RTA_OIF</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00296">RTA_PREFSRC</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtattr::rta_type</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00395">RTAX_ADVMSS</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00383">RTAX_MTU</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00183">rtmsg::rtm_dst_len</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00182">rtmsg::rtm_family</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00188">rtmsg::rtm_protocol</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00189">rtmsg::rtm_scope</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00187">rtmsg::rtm_table</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00190">rtmsg::rtm_type</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00199">RTN_UNICAST</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00225">RTPROT_STATIC</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00328">socket</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02232">METHOD()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00552">reinstall_routes()</a>.</p>
<div class="fragment"><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;{</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <a class="code" href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a> <a class="code" href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a>;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a> *<a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/d03/structrtattr.html">rtattr</a> *rta;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keywordtype">int</span> ifindex;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> chunk;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    <span class="comment">/* if route is 0.0.0.0/0, we can&#39;t install it, as it would</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment">     * overwrite the default route. Instead, we add two routes:</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment">     * 0.0.0.0/1 and 128.0.0.0/1 */</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    <span class="keywordflow">if</span> (this-&gt;routing_table == 0 &amp;&amp; prefixlen == 0)</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    {</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> half_net;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        u_int8_t half_prefixlen;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        half_net = <a class="code" href="../../d4/d87/group__chunk.html#ga18018c843b9db59f3e74e052e9eb95ae">chunk_alloca</a>(dst_net.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(half_net.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>, 0, half_net.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;        half_prefixlen = 1;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        status = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a>(<span class="keyword">this</span>, nlmsg_type, <a class="code" href="../../dd/deb/eap__mschapv2_8c.html#aff1a49ace550ffdd4860e52422343ba5">flags</a>, half_net, half_prefixlen,</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                    gateway, src_ip, if_name);</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        half_net.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>[0] |= 0x80;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        status = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a>(<span class="keyword">this</span>, nlmsg_type, <a class="code" href="../../dd/deb/eap__mschapv2_8c.html#aff1a49ace550ffdd4860e52422343ba5">flags</a>, half_net, half_prefixlen,</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                    gateway, src_ip, if_name);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <a class="code" href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a>(&amp;request, 0, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    hdr = &amp;request.<a class="code" href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">hdr</a>;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsg_flags</a> = <a class="code" href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a67d5b6ba8714b97d74df72d119351bee">NLM_F_ACK</a> | <a class="code" href="../../dd/deb/eap__mschapv2_8c.html#aff1a49ace550ffdd4860e52422343ba5">flags</a>;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> = nlmsg_type;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsg_len</a> = <a class="code" href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a>));</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    msg = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a> = src_ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(src_ip);</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a6b911f60a25644cfeda2c931987e3c38">rtm_dst_len</a> = prefixlen;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtm_table</a> = this-&gt;routing_table;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a6f1bcdda5769bb2a4ecc2f6641176d53">rtm_protocol</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a482ca8ef5bbaf0c923a11e3c0df845dc">RTPROT_STATIC</a>;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#acd17e0f7575b8084c0be4392e774bbeb">rtm_type</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a91a1343cab6c7576066ec821db5c138f">RTN_UNICAST</a>;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#aea8db71cfc376c6543bedcf3a77dbd7f">rtm_scope</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158">RT_SCOPE_UNIVERSE</a>;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a">RTA_DST</a>, dst_net, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    chunk = src_ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(src_ip);</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561">RTA_PREFSRC</a>, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="keywordflow">if</span> (gateway &amp;&amp; gateway-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(gateway) == src_ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">get_family</a>(src_ip))</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    {</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        chunk = gateway-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">get_address</a>(gateway);</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ad0fa476f2036a14c89f65c8fa375315b">RTA_GATEWAY</a>, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    ifindex = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af19d8672f22f597f18a131d57efd33ec">get_interface_index</a>(<span class="keyword">this</span>, if_name);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    chunk.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> = (<span class="keywordtype">char</span>*)&amp;ifindex;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = <span class="keyword">sizeof</span>(ifindex);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d">RTA_OIF</a>, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="keywordflow">if</span> (this-&gt;mtu || this-&gt;mss)</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        chunk = <a class="code" href="../../d4/d87/group__chunk.html#ga18018c843b9db59f3e74e052e9eb95ae">chunk_alloca</a>(<a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fadfa86c399164b0ea4512318efcac">RTA_LENGTH</a>((<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d1/d03/structrtattr.html">rtattr</a>) +</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                                         <span class="keyword">sizeof</span>(u_int32_t)) * 2));</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = 0;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        rta = (<span class="keyword">struct </span><a class="code" href="../../d1/d03/structrtattr.html">rtattr</a>*)chunk.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <a class="code" href="../../d9/d7b/settings__lexer_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a> (this-&gt;mtu)</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rta_type</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a385c44f6fb256e5716a2302a5b940388acd5a7210b714bf965c3e361974a40092">RTAX_MTU</a>;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a078b98797232bf24c840008c4f6e581c">rta_len</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fadfa86c399164b0ea4512318efcac">RTA_LENGTH</a>(<span class="keyword">sizeof</span>(u_int32_t));</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta), &amp;this-&gt;mtu, <span class="keyword">sizeof</span>(u_int32_t));</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a078b98797232bf24c840008c4f6e581c">rta_len</a>;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        }</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        <span class="keywordflow">if</span> (this-&gt;mss)</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        {</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            rta = (<span class="keyword">struct </span><a class="code" href="../../d1/d03/structrtattr.html">rtattr</a>*)(chunk.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> + <a class="code" href="../../d9/d06/rtnetlink_8h.html#af26cd7c77aec0bb8e98de1e45c0334b5">RTA_ALIGN</a>(chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>));</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;            rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rta_type</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a385c44f6fb256e5716a2302a5b940388a5e24444f59aa6bf1be2f00ed3afffc81">RTAX_ADVMSS</a>;</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;            rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a078b98797232bf24c840008c4f6e581c">rta_len</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fadfa86c399164b0ea4512318efcac">RTA_LENGTH</a>(<span class="keyword">sizeof</span>(u_int32_t));</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            <a class="code" href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a>(<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta), &amp;this-&gt;mss, <span class="keyword">sizeof</span>(u_int32_t));</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#af26cd7c77aec0bb8e98de1e45c0334b5">RTA_ALIGN</a>(chunk.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>) + rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a078b98797232bf24c840008c4f6e581c">rta_len</a>;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <a class="code" href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a>(hdr, <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4f747c6ff31fc9d8da6aa5cb6f8d500d">RTA_METRICS</a>, chunk, <span class="keyword">sizeof</span>(request));</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    }</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>-&gt;send_ack(this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>, hdr);</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;}</div>
<div class="ttc" id="netlink_8h_html_a456954d27b8adedd78136a9511f13160"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a456954d27b8adedd78136a9511f13160">NLM_F_REQUEST</a></div><div class="ttdeci">#define NLM_F_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00052">netlink.h:52</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d">RTA_OIF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00293">rtnetlink.h:293</a></div></div>
<div class="ttc" id="group__windows_html_gaa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00328">windows.h:328</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a482ca8ef5bbaf0c923a11e3c0df845dc"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a482ca8ef5bbaf0c923a11e3c0df845dc">RTPROT_STATIC</a></div><div class="ttdeci">#define RTPROT_STATIC</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00225">rtnetlink.h:225</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html_a8d2a4634689d1535c752284f28528b69"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html#a8d2a4634689d1535c752284f28528b69">netlink_buf_t::hdr</a></div><div class="ttdeci">struct nlmsghdr hdr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00030">kernel_netlink_shared.h:30</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158">RT_SCOPE_UNIVERSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00258">rtnetlink.h:258</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a42f61974b6169a0f37cb8f46e57db89d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a></div><div class="ttdeci">#define RTA_DATA(rta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00171">rtnetlink.h:171</a></div></div>
<div class="ttc" id="structrtattr_html_a078b98797232bf24c840008c4f6e581c"><div class="ttname"><a href="../../d1/d03/structrtattr.html#a078b98797232bf24c840008c4f6e581c">rtattr::rta_len</a></div><div class="ttdeci">unsigned short rta_len</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00156">rtnetlink.h:156</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ab04a0655cd1e3bcac5e8f48c18df1a57a91a1343cab6c7576066ec821db5c138f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a91a1343cab6c7576066ec821db5c138f">RTN_UNICAST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00199">rtnetlink.h:199</a></div></div>
<div class="ttc" id="structnlmsghdr_html"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html">nlmsghdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00042">netlink.h:42</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fadfa86c399164b0ea4512318efcac"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fadfa86c399164b0ea4512318efcac">RTA_LENGTH</a></div><div class="ttdeci">#define RTA_LENGTH(len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00169">rtnetlink.h:169</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561">RTA_PREFSRC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00296">rtnetlink.h:296</a></div></div>
<div class="ttc" id="netlink_8h_html_ab6857a80029b18e3c1058ddfca5e6b6b"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#ab6857a80029b18e3c1058ddfca5e6b6b">NLMSG_LENGTH</a></div><div class="ttdeci">#define NLMSG_LENGTH(len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00082">netlink.h:82</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structnlmsghdr_html_abc588d6bfd91bcbf100709e57b7877df"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsghdr::nlmsg_type</a></div><div class="ttdeci">__u16 nlmsg_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00044">netlink.h:44</a></div></div>
<div class="ttc" id="structrtattr_html"><div class="ttname"><a href="../../d1/d03/structrtattr.html">rtattr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00155">rtnetlink.h:155</a></div></div>
<div class="ttc" id="structrtattr_html_a23bd02894aef9ce3741ba36767ce2ede"><div class="ttname"><a href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rtattr::rta_type</a></div><div class="ttdeci">unsigned short rta_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtnetlink.h:157</a></div></div>
<div class="ttc" id="structhost__t_html_aa3493ae67869e4cd9b4dbe98226650fb"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aa3493ae67869e4cd9b4dbe98226650fb">host_t::get_address</a></div><div class="ttdeci">chunk_t(* get_address)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00095">host.h:95</a></div></div>
<div class="ttc" id="group__memory__i_html_gaed653b4838032a2c5ce8960421c8cfd7"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#gaed653b4838032a2c5ce8960421c8cfd7">memcpy</a></div><div class="ttdeci">#define memcpy(d, s, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00050">memory.h:50</a></div></div>
<div class="ttc" id="netlink_8h_html_a67d5b6ba8714b97d74df72d119351bee"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a67d5b6ba8714b97d74df72d119351bee">NLM_F_ACK</a></div><div class="ttdeci">#define NLM_F_ACK</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00054">netlink.h:54</a></div></div>
<div class="ttc" id="structrtmsg_html_a2295e2054ab275a89be3c681a630a8e9"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtmsg::rtm_family</a></div><div class="ttdeci">unsigned char rtm_family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00182">rtnetlink.h:182</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a385c44f6fb256e5716a2302a5b940388a5e24444f59aa6bf1be2f00ed3afffc81"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a385c44f6fb256e5716a2302a5b940388a5e24444f59aa6bf1be2f00ed3afffc81">RTAX_ADVMSS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00395">rtnetlink.h:395</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173a4f747c6ff31fc9d8da6aa5cb6f8d500d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4f747c6ff31fc9d8da6aa5cb6f8d500d">RTA_METRICS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00297">rtnetlink.h:297</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="structrtmsg_html_a6b911f60a25644cfeda2c931987e3c38"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a6b911f60a25644cfeda2c931987e3c38">rtmsg::rtm_dst_len</a></div><div class="ttdeci">unsigned char rtm_dst_len</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00183">rtnetlink.h:183</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a">RTA_DST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00290">rtnetlink.h:290</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_af26cd7c77aec0bb8e98de1e45c0334b5"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#af26cd7c77aec0bb8e98de1e45c0334b5">RTA_ALIGN</a></div><div class="ttdeci">#define RTA_ALIGN(len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00163">rtnetlink.h:163</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="structnlmsghdr_html_ad697397e7366eb442db4bb4e963f79f7"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#ad697397e7366eb442db4bb4e963f79f7">nlmsghdr::nlmsg_flags</a></div><div class="ttdeci">__u16 nlmsg_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00045">netlink.h:45</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173ad0fa476f2036a14c89f65c8fa375315b"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ad0fa476f2036a14c89f65c8fa375315b">RTA_GATEWAY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00294">rtnetlink.h:294</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_af19d8672f22f597f18a131d57efd33ec"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#af19d8672f22f597f18a131d57efd33ec">get_interface_index</a></div><div class="ttdeci">static int get_interface_index(private_kernel_netlink_net_t *this, char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01481">kernel_netlink_net.c:1481</a></div></div>
<div class="ttc" id="unionnetlink__buf__t_html"><div class="ttname"><a href="../../db/dbc/unionnetlink__buf__t.html">netlink_buf_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2b/kernel__netlink__shared_8h_source.html#l00029">kernel_netlink_shared.h:29</a></div></div>
<div class="ttc" id="structrtmsg_html"><div class="ttname"><a href="../../da/d53/structrtmsg.html">rtmsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00181">rtnetlink.h:181</a></div></div>
<div class="ttc" id="group__chunk_html_ga18018c843b9db59f3e74e052e9eb95ae"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga18018c843b9db59f3e74e052e9eb95ae">chunk_alloca</a></div><div class="ttdeci">#define chunk_alloca(bytes)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00246">chunk.h:246</a></div></div>
<div class="ttc" id="structnlmsghdr_html_a75261bc7443b0c646c49dd8313f4a66a"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#a75261bc7443b0c646c49dd8313f4a66a">nlmsghdr::nlmsg_len</a></div><div class="ttdeci">__u32 nlmsg_len</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00043">netlink.h:43</a></div></div>
<div class="ttc" id="structrtmsg_html_aea8db71cfc376c6543bedcf3a77dbd7f"><div class="ttname"><a href="../../da/d53/structrtmsg.html#aea8db71cfc376c6543bedcf3a77dbd7f">rtmsg::rtm_scope</a></div><div class="ttdeci">unsigned char rtm_scope</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00189">rtnetlink.h:189</a></div></div>
<div class="ttc" id="eap__mschapv2_8c_html_aff1a49ace550ffdd4860e52422343ba5"><div class="ttname"><a href="../../dd/deb/eap__mschapv2_8c.html#aff1a49ace550ffdd4860e52422343ba5">flags</a></div><div class="ttdeci">u_int8_t flags</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/deb/eap__mschapv2_8c_source.html#l00163">eap_mschapv2.c:163</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0fb4225c5228122371f3ef9fe600c523"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a></div><div class="ttdeci">static status_t manage_srcroute(private_kernel_netlink_net_t *this, int nlmsg_type, int flags, chunk_t dst_net, u_int8_t prefixlen, host_t *gateway, host_t *src_ip, char *if_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">kernel_netlink_net.c:2144</a></div></div>
<div class="ttc" id="structrtmsg_html_a72deabb274ce59c11db0e21e7aeb8de7"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtmsg::rtm_table</a></div><div class="ttdeci">unsigned char rtm_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00187">rtnetlink.h:187</a></div></div>
<div class="ttc" id="group__memory__i_html_ga71dcb02253b987acc46948d01ab28696"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga71dcb02253b987acc46948d01ab28696">memset</a></div><div class="ttdeci">#define memset(s, c, n)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00078">memory.h:78</a></div></div>
<div class="ttc" id="kernel__netlink__shared_8c_html_a202b8086fb6f849f0a33d96de2849705"><div class="ttname"><a href="../../d1/dfe/kernel__netlink__shared_8c.html#a202b8086fb6f849f0a33d96de2849705">netlink_add_attribute</a></div><div class="ttdeci">void netlink_add_attribute(struct nlmsghdr *hdr, int rta_type, chunk_t data, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dfe/kernel__netlink__shared_8c_source.html#l00618">kernel_netlink_shared.c:618</a></div></div>
<div class="ttc" id="settings__lexer_8c_html_a33e91cd0cef6786e9e3a27ac67707207"><div class="ttname"><a href="../../d9/d7b/settings__lexer_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a></div><div class="ttdeci">if(!yyg-&gt;yy_init)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7b/settings__lexer_8c_source.html#l00957">settings_lexer.c:957</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="structhost__t_html_a75956f3fa34ec58543cb717d7a6dbba6"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a75956f3fa34ec58543cb717d7a6dbba6">host_t::get_family</a></div><div class="ttdeci">int(* get_family)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00079">host.h:79</a></div></div>
<div class="ttc" id="mconsole_8c_html_a251c32cfa402f283bd6349486d9caac0"><div class="ttname"><a href="../../df/d12/mconsole_8c.html#a251c32cfa402f283bd6349486d9caac0">request</a></div><div class="ttdeci">static int request(private_mconsole_t *this, void(*cb)(void *, char *, size_t), void *data, char *command,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d12/mconsole_8c_source.html#l00091">mconsole.c:91</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a385c44f6fb256e5716a2302a5b940388acd5a7210b714bf965c3e361974a40092"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a385c44f6fb256e5716a2302a5b940388acd5a7210b714bf965c3e361974a40092">RTAX_MTU</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00383">rtnetlink.h:383</a></div></div>
<div class="ttc" id="structrtmsg_html_acd17e0f7575b8084c0be4392e774bbeb"><div class="ttname"><a href="../../da/d53/structrtmsg.html#acd17e0f7575b8084c0be4392e774bbeb">rtmsg::rtm_type</a></div><div class="ttdeci">unsigned char rtm_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00190">rtnetlink.h:190</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
<div class="ttc" id="structrtmsg_html_a6f1bcdda5769bb2a4ecc2f6641176d53"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a6f1bcdda5769bb2a4ecc2f6641176d53">rtmsg::rtm_protocol</a></div><div class="ttdeci">unsigned char rtm_protocol</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00188">rtnetlink.h:188</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-60" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-60-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-60-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-60-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0fb4225c5228122371f3ef9fe600c523_cgraph.svg" width="100%" height="568"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-61" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-61-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-61-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-61-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0fb4225c5228122371f3ef9fe600c523_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a797d4b497f63d4cc78aa56fea04cc5a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">create_address_enumerator&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d22/group__kernel__net.html#gaec0f8396984f98ff469cb1f5fac1c7b5">kernel_address_type_t</a>&#160;</td>
          <td class="paramname"><em>which</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01410">1410</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01349">address_enumerator_destroy()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01380">create_iface_enumerator()</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../de/d46/enumerator_8c_source.html#l00536">enumerator_create_filter()</a>, <a class="el" href="../../de/d46/enumerator_8c_source.html#l00474">enumerator_create_nested()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01391">filter_interfaces()</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, and <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>.</p>
<div class="fragment"><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;{</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <a class="code" href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a> *<a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(data,</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        .<span class="keyword">this</span> = <span class="keyword">this</span>,</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        .which = which,</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    );</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;read_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../de/d46/enumerator_8c.html#a64ed75dceff083197b450b642f67d0fe">enumerator_create_nested</a>(</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                <a class="code" href="../../d3/de6/group__enumerator.html#ga7e32271ea79eb88b576ca6eb1c582751">enumerator_create_filter</a>(</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                    this-&gt;ifaces-&gt;create_enumerator(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">ifaces</a>),</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                    (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#adb8c440516a9849b9d93dc315c164053">filter_interfaces</a>, data, NULL),</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a3ef4b9f456462ecc582f49f38cc474f9">create_iface_enumerator</a>, data,</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a9fac900724f973c30540ca9e015a31c6">address_enumerator_destroy</a>);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;}</div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="enumerator_8c_html_a64ed75dceff083197b450b642f67d0fe"><div class="ttname"><a href="../../de/d46/enumerator_8c.html#a64ed75dceff083197b450b642f67d0fe">enumerator_create_nested</a></div><div class="ttdeci">enumerator_t * enumerator_create_nested(enumerator_t *outer, enumerator_t *(inner_constructor)(void *outer, void *data), void *data, void(*destroy_data)(void *data))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d46/enumerator_8c_source.html#l00474">enumerator.c:474</a></div></div>
<div class="ttc" id="structaddress__enumerator__t_html"><div class="ttname"><a href="../../da/d71/structaddress__enumerator__t.html">address_enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01340">kernel_netlink_net.c:1340</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a3ef4b9f456462ecc582f49f38cc474f9"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a3ef4b9f456462ecc582f49f38cc474f9">create_iface_enumerator</a></div><div class="ttdeci">static enumerator_t * create_iface_enumerator(iface_entry_t *iface, address_enumerator_t *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01380">kernel_netlink_net.c:1380</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a9fac900724f973c30540ca9e015a31c6"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a9fac900724f973c30540ca9e015a31c6">address_enumerator_destroy</a></div><div class="ttdeci">static void address_enumerator_destroy(address_enumerator_t *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01349">kernel_netlink_net.c:1349</a></div></div>
<div class="ttc" id="group__enumerator_html_ga7e32271ea79eb88b576ca6eb1c582751"><div class="ttname"><a href="../../d3/de6/group__enumerator.html#ga7e32271ea79eb88b576ca6eb1c582751">enumerator_create_filter</a></div><div class="ttdeci">enumerator_t * enumerator_create_filter(enumerator_t *unfiltered, bool(*filter)(void *data,...), void *data, void(*destructor)(void *data))</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d46/enumerator_8c_source.html#l00536">enumerator.c:536</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_adb8c440516a9849b9d93dc315c164053"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#adb8c440516a9849b9d93dc315c164053">filter_interfaces</a></div><div class="ttdeci">static bool filter_interfaces(address_enumerator_t *data, iface_entry_t **in, iface_entry_t **out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01391">kernel_netlink_net.c:1391</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a388b18d13f3b29682afae599da369527"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">private_kernel_netlink_net_t::ifaces</a></div><div class="ttdeci">linked_list_t * ifaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00396">kernel_netlink_net.c:396</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-62" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-62-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-62-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-62-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a797d4b497f63d4cc78aa56fea04cc5a6_cgraph.svg" width="100%" height="560"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a18c40e636c29feb4db892474af62edb0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_interface_name&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01429">1429</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00248">addr_map_entry_match_up()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00237">addr_map_entry_match_up_and_usable()</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">addr_map_entry_t::iface</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">iface_entry_t::ifname</a>, <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">ip</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00086">host_t::is_anyaddr</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">lookup</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00099">strdup</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, and <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>.</p>
<div class="fragment"><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;{</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *entry, <a class="code" href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a> = {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        .ip = <a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a>,</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    };</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">if</span> (ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a32c6adc65585ab7fd17fe74839156b74">is_anyaddr</a>(ip))</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    }</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;read_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">/* first try to find it on an up and usable interface */</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    entry = this-&gt;addrs-&gt;get_match(this-&gt;addrs, &amp;lookup,</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                                  (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af29ddd9c2b58f1a5d0bf38ed6ac2b718">addr_map_entry_match_up_and_usable</a>);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>)</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        {</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            *<a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a> = <a class="code" href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a>(entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;%H is on interface %s&quot;</span>, ip, *<a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    }</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">/* in a second step, consider virtual IPs installed by us */</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    entry = this-&gt;vips-&gt;get_match(this-&gt;vips, &amp;lookup,</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                  (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af29ddd9c2b58f1a5d0bf38ed6ac2b718">addr_map_entry_match_up_and_usable</a>);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            *<a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a> = <a class="code" href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a>(entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;virtual IP %H is on interface %s&quot;</span>, ip, *<a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a>);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">/* maybe it is installed on an ignored interface */</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    entry = this-&gt;addrs-&gt;get_match(this-&gt;addrs, &amp;lookup,</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                  (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#aa52f2cdfb0ddf0864d2808f1e96af8f6">addr_map_entry_match_up</a>);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;%H is not a local address or the interface is down&quot;</span>, ip);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="error__notify__msg_8h_html_abcc82b944bf2a158e29a4042043185a5"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a></div><div class="ttdeci">char ip[60]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">error_notify_msg.h:53</a></div></div>
<div class="ttc" id="proposal__keywords__static_8c_html_a85d2eea012c83b4dd2615d97bddbffc8"><div class="ttname"><a href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a></div><div class="ttdeci">static const short lookup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">proposal_keywords_static.c:288</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="structiface__entry__t_html_af77daca88bd8077974e87a298418e1b4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">iface_entry_t::ifname</a></div><div class="ttdeci">char ifname[IFNAMSIZ]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">kernel_netlink_net.c:145</a></div></div>
<div class="ttc" id="structhost__t_html_a32c6adc65585ab7fd17fe74839156b74"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a32c6adc65585ab7fd17fe74839156b74">host_t::is_anyaddr</a></div><div class="ttdeci">bool(* is_anyaddr)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00086">host.h:86</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a2b7c25110232f9e43068d0216e1c90f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">addr_map_entry_t::iface</a></div><div class="ttdeci">iface_entry_t * iface</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">kernel_netlink_net.c:211</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_af29ddd9c2b58f1a5d0bf38ed6ac2b718"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#af29ddd9c2b58f1a5d0bf38ed6ac2b718">addr_map_entry_match_up_and_usable</a></div><div class="ttdeci">static bool addr_map_entry_match_up_and_usable(addr_map_entry_t *a, addr_map_entry_t *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00237">kernel_netlink_net.c:237</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_aa52f2cdfb0ddf0864d2808f1e96af8f6"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#aa52f2cdfb0ddf0864d2808f1e96af8f6">addr_map_entry_match_up</a></div><div class="ttdeci">static bool addr_map_entry_match_up(addr_map_entry_t *a, addr_map_entry_t *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00248">kernel_netlink_net.c:248</a></div></div>
<div class="ttc" id="group__windows_html_ga9254b089d435892385cf14d0ab4a7a2d"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a></div><div class="ttdeci">#define strdup</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00099">windows.h:99</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="dh__speed_8c_html_a1317e52dffbcbe14fbfd1bd5ac61fff9"><div class="ttname"><a href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d1a/dh__speed_8c_source.html#l00030">dh_speed.c:30</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-63" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-63-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-63-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-63-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a18c40e636c29feb4db892474af62edb0_cgraph.svg" width="100%" height="377"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a427a6e01d6e9699d3396211dabe5fdbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_source_addr&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01914">1914</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;{</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#add8ea34240fa67be8682f623e7b61891">get_route</a>(<span class="keyword">this</span>, dest, -1, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, src, 0);</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_add8ea34240fa67be8682f623e7b61891"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#add8ea34240fa67be8682f623e7b61891">get_route</a></div><div class="ttdeci">static host_t * get_route(private_kernel_netlink_net_t *this, host_t *dest, int prefix, bool nexthop, host_t *candidate, u_int recursion)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">kernel_netlink_net.c:1659</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-64" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-64-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-64-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-64-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a427a6e01d6e9699d3396211dabe5fdbb_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae8055d717fc5d95acfd6fadf9eb073c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">get_nexthop&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01920">1920</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;{</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#add8ea34240fa67be8682f623e7b61891">get_route</a>(<span class="keyword">this</span>, dest, <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, src, 0);</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;}</div>
<div class="ttc" id="test__utils_8c_html_a0a7083cd7ae62f5c50d6abd5cdd491ab"><div class="ttname"><a href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a></div><div class="ttdeci">bool prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbe/test__utils_8c_source.html#l00206">test_utils.c:206</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_add8ea34240fa67be8682f623e7b61891"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#add8ea34240fa67be8682f623e7b61891">get_route</a></div><div class="ttdeci">static host_t * get_route(private_kernel_netlink_net_t *this, host_t *dest, int prefix, bool nexthop, host_t *candidate, u_int recursion)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">kernel_netlink_net.c:1659</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-65" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-65-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-65-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-65-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ae8055d717fc5d95acfd6fadf9eb073c4_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeca4a8be4eca27916eee69fadda9b886"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">add_ip&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>virtual_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>iface_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01970">1970</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00208">addr_map_entry_t::addr</a>, <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00674">addr_map_entry_add()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">addr_map_entry_match()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">iface_entry_t::addrs</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00050">host_t::clone</a>, <a class="el" href="../../d4/ded/test__threading_8c_source.html#l00117">condvar</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">addr_map_entry_t::iface</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00177">iface_entry_by_name()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">iface_entry_t::ifindex</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">iface_entry_t::ifname</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00147">linked_list_t::insert_last</a>, <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">ip</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00640">is_vip_installed_or_gone()</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">lookup</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01930">manage_ipaddr()</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00067">NLM_F_CREATE</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00066">NLM_F_EXCL</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">queue_route_reinstall()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00119">addr_entry_t::refcount</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00258">RT_SCOPE_UNIVERSE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00035">RTM_NEWADDR</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00099">strdup</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>, and <a class="el" href="../../d0/d40/condvar_8h_source.html#l00048">condvar_t::wait</a>.</p>
<div class="fragment"><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;{</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *entry, <a class="code" href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a> = {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        .ip = virtual_ip,</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    };</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <a class="code" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface = NULL;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;install_virtual_ip)</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    {   <span class="comment">/* disabled by config */</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;write_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="comment">/* the virtual IP might actually be installed as regular IP, in which case</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">     * we don&#39;t track it as virtual IP */</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    entry = this-&gt;addrs-&gt;get_match(this-&gt;addrs, &amp;lookup,</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                                  (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a>);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    {   <span class="comment">/* otherwise it might already be installed as virtual IP */</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        entry = this-&gt;vips-&gt;get_match(this-&gt;vips, &amp;lookup,</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                                     (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a>);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        {   <span class="comment">/* the vip we found can be in one of three states: 1) installed and</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">             * ready, 2) just added by another thread, but not yet confirmed to</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">             * be installed by the kernel, 3) just deleted, but not yet gone.</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">             * Then while we wait below, several things could happen (as we</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">             * release the lock).  For instance, the interface could disappear,</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="comment">             * or the IP is finally deleted, and it reappears on a different</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment">             * interface. All these cases are handled by the call below. */</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            <span class="keywordflow">while</span> (!<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a4ac3e70878acb3963e1064a4964e26f0">is_vip_installed_or_gone</a>(<span class="keyword">this</span>, virtual_ip, &amp;entry))</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>-&gt;<a class="code" href="../../d7/dab/structcondvar__t.html#a2cade69d16a4f8b4ee379b0380d702eb">wait</a>(this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>, this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;            }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr</a>-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">refcount</a>++;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    {</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;virtual IP %H is already installed on %s&quot;</span>, virtual_ip,</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;             entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="comment">/* try to find the target interface, either by config or via src ip */</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;install_virtual_ip_on ||</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;         this-&gt;ifaces-&gt;find_first(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">ifaces</a>, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0faeb03bf086f0d08fbfaf8faef65a16">iface_entry_by_name</a>,</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                        (<span class="keywordtype">void</span>**)&amp;iface, this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a0f48d2b9338c949768ffc4c0c39ccc56">install_virtual_ip_on</a>) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="keywordflow">if</span> (this-&gt;ifaces-&gt;find_first(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">ifaces</a>, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0faeb03bf086f0d08fbfaf8faef65a16">iface_entry_by_name</a>,</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                                     (<span class="keywordtype">void</span>**)&amp;iface, iface_name) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        {   <span class="comment">/* if we don&#39;t find the requested interface we just use the first */</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            this-&gt;ifaces-&gt;get_first(this-&gt;ifaces, (<span class="keywordtype">void</span>**)&amp;iface);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keywordflow">if</span> (iface)</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    {</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <a class="code" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keywordtype">char</span> *ifname;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordtype">int</span> ifi;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(addr,</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;            .<a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a> = virtual_ip-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(virtual_ip),</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            .refcount = 1,</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            .scope = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158">RT_SCOPE_UNIVERSE</a>,</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        );</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a5150f69ff51c8d6d0ed680fad1120c02">insert_last</a>(iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>, addr);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a32fc094777315d46304963b5a6a7e631">addr_map_entry_add</a>(this-&gt;vips, addr, iface);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        ifi = iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">ifindex</a>;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a1160788a04132956fb9fcd0ab0552ba4">manage_ipaddr</a>(<span class="keyword">this</span>, <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a>, <a class="code" href="../../de/d4c/netlink_8h.html#a20a00ae52e4c150f54649d7346d23a7a">NLM_F_CREATE</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a0b0f8c9581ee93747c7d9e94ca0e0596">NLM_F_EXCL</a>,</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                          ifi, virtual_ip, <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;            this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;write_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;            <span class="keywordflow">while</span> (!<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a4ac3e70878acb3963e1064a4964e26f0">is_vip_installed_or_gone</a>(<span class="keyword">this</span>, virtual_ip, &amp;entry))</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;            {   <span class="comment">/* wait until address appears */</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>-&gt;<a class="code" href="../../d7/dab/structcondvar__t.html#a2cade69d16a4f8b4ee379b0380d702eb">wait</a>(this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>, this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;            <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;            {   <span class="comment">/* we fail if the interface got deleted in the meantime */</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                ifname = <a class="code" href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a>(entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;virtual IP %H installed on %s&quot;</span>,</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                     virtual_ip, ifname);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                <span class="comment">/* during IKEv1 reauthentication, children get moved from</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">                 * old the new SA before the virtual IP is available. This</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">                 * kills the route for our virtual IP, reinstall. */</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0f4d312f2e3ae7e2ef669ff35e21bee8">queue_route_reinstall</a>(<span class="keyword">this</span>, ifname);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;            }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        }</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;adding virtual IP %H failed&quot;</span>, virtual_ip);</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    }</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;no interface available, unable to install virtual IP %H&quot;</span>,</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;         virtual_ip);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="error__notify__msg_8h_html_abcc82b944bf2a158e29a4042043185a5"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a></div><div class="ttdeci">char ip[60]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">error_notify_msg.h:53</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_acd3374d9d8f49b40648171e449a059bb"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a></div><div class="ttdeci">static bool addr_map_entry_match(addr_map_entry_t *a, addr_map_entry_t *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">kernel_netlink_net.c:257</a></div></div>
<div class="ttc" id="proposal__keywords__static_8c_html_a85d2eea012c83b4dd2615d97bddbffc8"><div class="ttname"><a href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a></div><div class="ttdeci">static const short lookup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">proposal_keywords_static.c:288</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a32fc094777315d46304963b5a6a7e631"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a32fc094777315d46304963b5a6a7e631">addr_map_entry_add</a></div><div class="ttdeci">static void addr_map_entry_add(hashtable_t *map, addr_entry_t *addr, iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00674">kernel_netlink_net.c:674</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a0a24f857b720ea82629522e1f5bd3cf5a5a87aef623f4c39c7f06a3b2a3405158">RT_SCOPE_UNIVERSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00258">rtnetlink.h:258</a></div></div>
<div class="ttc" id="structiface__entry__t_html_af77daca88bd8077974e87a298418e1b4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">iface_entry_t::ifname</a></div><div class="ttdeci">char ifname[IFNAMSIZ]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">kernel_netlink_net.c:145</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="structiface__entry__t_html"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00139">kernel_netlink_net.c:139</a></div></div>
<div class="ttc" id="structhost__t_html_aebe9cd9ffd665b04e223c5e8b6ce7114"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">host_t::clone</a></div><div class="ttdeci">host_t *(* clone)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00050">host.h:50</a></div></div>
<div class="ttc" id="test__threading_8c_html_a14975442a555aea5d1676fab41b7c4f0"><div class="ttname"><a href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a></div><div class="ttdeci">static condvar_t * condvar</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ded/test__threading_8c_source.html#l00117">test_threading.c:117</a></div></div>
<div class="ttc" id="structcondvar__t_html_a2cade69d16a4f8b4ee379b0380d702eb"><div class="ttname"><a href="../../d7/dab/structcondvar__t.html#a2cade69d16a4f8b4ee379b0380d702eb">condvar_t::wait</a></div><div class="ttdeci">void(* wait)(condvar_t *this, mutex_t *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d40/condvar_8h_source.html#l00048">condvar.h:48</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a056cb96f14fa76d54b1a36eaf765ae75"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">addr_entry_t::refcount</a></div><div class="ttdeci">u_int refcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00119">kernel_netlink_net.c:119</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a2b7c25110232f9e43068d0216e1c90f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">addr_map_entry_t::iface</a></div><div class="ttdeci">iface_entry_t * iface</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">kernel_netlink_net.c:211</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a1160788a04132956fb9fcd0ab0552ba4"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a1160788a04132956fb9fcd0ab0552ba4">manage_ipaddr</a></div><div class="ttdeci">static status_t manage_ipaddr(private_kernel_netlink_net_t *this, int nlmsg_type, int flags, int if_index, host_t *ip, int prefix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01930">kernel_netlink_net.c:1930</a></div></div>
<div class="ttc" id="test__utils_8c_html_a0a7083cd7ae62f5c50d6abd5cdd491ab"><div class="ttname"><a href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a></div><div class="ttdeci">bool prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbe/test__utils_8c_source.html#l00206">test_utils.c:206</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a1a08a8af40b92ca44f2e05c06dd601f4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">iface_entry_t::ifindex</a></div><div class="ttdeci">int ifindex</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">kernel_netlink_net.c:142</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00035">rtnetlink.h:35</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_add1a1a443f7c891e3a11780bc6f43ee9"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr_map_entry_t::addr</a></div><div class="ttdeci">addr_entry_t * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00208">kernel_netlink_net.c:208</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a4ac3e70878acb3963e1064a4964e26f0"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a4ac3e70878acb3963e1064a4964e26f0">is_vip_installed_or_gone</a></div><div class="ttdeci">static bool is_vip_installed_or_gone(private_kernel_netlink_net_t *this, host_t *ip, addr_map_entry_t **entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00640">kernel_netlink_net.c:640</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0faeb03bf086f0d08fbfaf8faef65a16"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0faeb03bf086f0d08fbfaf8faef65a16">iface_entry_by_name</a></div><div class="ttdeci">static bool iface_entry_by_name(iface_entry_t *this, char *ifname)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00177">kernel_netlink_net.c:177</a></div></div>
<div class="ttc" id="netlink_8h_html_a0b0f8c9581ee93747c7d9e94ca0e0596"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a0b0f8c9581ee93747c7d9e94ca0e0596">NLM_F_EXCL</a></div><div class="ttdeci">#define NLM_F_EXCL</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00066">netlink.h:66</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a0f48d2b9338c949768ffc4c0c39ccc56"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a0f48d2b9338c949768ffc4c0c39ccc56">private_kernel_netlink_net_t::install_virtual_ip_on</a></div><div class="ttdeci">char * install_virtual_ip_on</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00486">kernel_netlink_net.c:486</a></div></div>
<div class="ttc" id="structlinked__list__t_html_a5150f69ff51c8d6d0ed680fad1120c02"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a5150f69ff51c8d6d0ed680fad1120c02">linked_list_t::insert_last</a></div><div class="ttdeci">void(* insert_last)(linked_list_t *this, void *item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00147">linked_list.h:147</a></div></div>
<div class="ttc" id="group__windows_html_ga9254b089d435892385cf14d0ab4a7a2d"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a></div><div class="ttdeci">#define strdup</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00099">windows.h:99</a></div></div>
<div class="ttc" id="netlink_8h_html_a20a00ae52e4c150f54649d7346d23a7a"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a20a00ae52e4c150f54649d7346d23a7a">NLM_F_CREATE</a></div><div class="ttdeci">#define NLM_F_CREATE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00067">netlink.h:67</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a388b18d13f3b29682afae599da369527"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">private_kernel_netlink_net_t::ifaces</a></div><div class="ttdeci">linked_list_t * ifaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00396">kernel_netlink_net.c:396</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a074ce3bd111ba07ab802a6c74063a5a2"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">iface_entry_t::addrs</a></div><div class="ttdeci">linked_list_t * addrs</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">kernel_netlink_net.c:151</a></div></div>
<div class="ttc" id="structaddr__entry__t_html"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00107">kernel_netlink_net.c:107</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0f4d312f2e3ae7e2ef669ff35e21bee8"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0f4d312f2e3ae7e2ef669ff35e21bee8">queue_route_reinstall</a></div><div class="ttdeci">static void queue_route_reinstall(private_kernel_netlink_net_t *this, char *if_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">kernel_netlink_net.c:602</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-66" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-66-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-66-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-66-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aeca4a8be4eca27916eee69fadda9b886_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace07348130970cc5fbd634f755f6230f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">del_ip&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>virtual_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>wait</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02075">2075</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00208">addr_map_entry_t::addr</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">addr_map_entry_match()</a>, <a class="el" href="../../d4/ded/test__threading_8c_source.html#l00117">condvar</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00056">DBG2</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00034">FAILED</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">addr_map_entry_t::iface</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">iface_entry_t::ifindex</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">iface_entry_t::ifname</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00122">addr_entry_t::installed</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00661">is_known_vip()</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">lookup</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01930">manage_ipaddr()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00119">addr_entry_t::refcount</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00037">RTM_DELADDR</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>, and <a class="el" href="../../d0/d40/condvar_8h_source.html#l00048">condvar_t::wait</a>.</p>
<div class="fragment"><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;{</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *entry, <a class="code" href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a> = {</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        .ip = virtual_ip,</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    };</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;install_virtual_ip)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    {   <span class="comment">/* disabled by config */</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    }</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;deleting virtual IP %H&quot;</span>, virtual_ip);</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;write_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    entry = this-&gt;vips-&gt;get_match(this-&gt;vips, &amp;lookup,</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                                 (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a>);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="keywordflow">if</span> (!entry)</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    {   <span class="comment">/* we didn&#39;t install this IP as virtual IP */</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        entry = this-&gt;addrs-&gt;get_match(this-&gt;addrs, &amp;lookup,</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                                      (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a>);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;        {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;            <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;not deleting existing IP %H on %s&quot;</span>, virtual_ip,</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                 entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        }</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;virtual IP %H not cached, unable to delete&quot;</span>, virtual_ip);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a>;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    }</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keywordflow">if</span> (entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr</a>-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">refcount</a> == 1)</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    {</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        <span class="keywordtype">int</span> ifi;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="comment">/* we set this flag so that threads calling add_ip will block and wait</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">         * until the entry is gone, also so we can wait below */</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr</a>-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#afecdde0c0823c5ead35b35611d31f717">installed</a> = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        ifi = entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">iface</a>-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">ifindex</a>;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        status = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a1160788a04132956fb9fcd0ab0552ba4">manage_ipaddr</a>(<span class="keyword">this</span>, <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f">RTM_DELADDR</a>, 0, ifi, virtual_ip, <a class="code" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <span class="keywordflow">if</span> (status == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a> &amp;&amp; wait)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        {   <span class="comment">/* wait until the address is really gone */</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;write_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            <span class="keywordflow">while</span> (<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a34793bb5a8a46b632833c292910b1f81">is_known_vip</a>(<span class="keyword">this</span>, virtual_ip))</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            {</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>-&gt;<a class="code" href="../../d7/dab/structcondvar__t.html#a2cade69d16a4f8b4ee379b0380d702eb">wait</a>(this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>, this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        }</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr</a>-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">refcount</a>--;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    }</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <a class="code" href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;virtual IP %H used by other SAs, not deleting&quot;</span>,</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;         virtual_ip);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;}</div>
<div class="ttc" id="group__bus_html_ga95775200eefe571ca47cc1ec6011d241"><div class="ttname"><a href="../../de/d50/group__bus.html#ga95775200eefe571ca47cc1ec6011d241">DBG2</a></div><div class="ttdeci">#define DBG2(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00056">bus.h:56</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_acd3374d9d8f49b40648171e449a059bb"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#acd3374d9d8f49b40648171e449a059bb">addr_map_entry_match</a></div><div class="ttdeci">static bool addr_map_entry_match(addr_map_entry_t *a, addr_map_entry_t *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00257">kernel_netlink_net.c:257</a></div></div>
<div class="ttc" id="proposal__keywords__static_8c_html_a85d2eea012c83b4dd2615d97bddbffc8"><div class="ttname"><a href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a></div><div class="ttdeci">static const short lookup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">proposal_keywords_static.c:288</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f">RTM_DELADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00037">rtnetlink.h:37</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="structiface__entry__t_html_af77daca88bd8077974e87a298418e1b4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">iface_entry_t::ifname</a></div><div class="ttdeci">char ifname[IFNAMSIZ]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">kernel_netlink_net.c:145</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586aecedb56d1405a60c6069f4a0139bdec5">FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00034">status.h:34</a></div></div>
<div class="ttc" id="test__threading_8c_html_a14975442a555aea5d1676fab41b7c4f0"><div class="ttname"><a href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a></div><div class="ttdeci">static condvar_t * condvar</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ded/test__threading_8c_source.html#l00117">test_threading.c:117</a></div></div>
<div class="ttc" id="structcondvar__t_html_a2cade69d16a4f8b4ee379b0380d702eb"><div class="ttname"><a href="../../d7/dab/structcondvar__t.html#a2cade69d16a4f8b4ee379b0380d702eb">condvar_t::wait</a></div><div class="ttdeci">void(* wait)(condvar_t *this, mutex_t *mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d40/condvar_8h_source.html#l00048">condvar.h:48</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_a056cb96f14fa76d54b1a36eaf765ae75"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#a056cb96f14fa76d54b1a36eaf765ae75">addr_entry_t::refcount</a></div><div class="ttdeci">u_int refcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00119">kernel_netlink_net.c:119</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_a2b7c25110232f9e43068d0216e1c90f5"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#a2b7c25110232f9e43068d0216e1c90f5">addr_map_entry_t::iface</a></div><div class="ttdeci">iface_entry_t * iface</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00211">kernel_netlink_net.c:211</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a1160788a04132956fb9fcd0ab0552ba4"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a1160788a04132956fb9fcd0ab0552ba4">manage_ipaddr</a></div><div class="ttdeci">static status_t manage_ipaddr(private_kernel_netlink_net_t *this, int nlmsg_type, int flags, int if_index, host_t *ip, int prefix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01930">kernel_netlink_net.c:1930</a></div></div>
<div class="ttc" id="test__utils_8c_html_a0a7083cd7ae62f5c50d6abd5cdd491ab"><div class="ttname"><a href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a></div><div class="ttdeci">bool prefix</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dbe/test__utils_8c_source.html#l00206">test_utils.c:206</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a1a08a8af40b92ca44f2e05c06dd601f4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">iface_entry_t::ifindex</a></div><div class="ttdeci">int ifindex</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">kernel_netlink_net.c:142</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_add1a1a443f7c891e3a11780bc6f43ee9"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr_map_entry_t::addr</a></div><div class="ttdeci">addr_entry_t * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00208">kernel_netlink_net.c:208</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a34793bb5a8a46b632833c292910b1f81"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a34793bb5a8a46b632833c292910b1f81">is_known_vip</a></div><div class="ttdeci">static bool is_known_vip(private_kernel_netlink_net_t *this, host_t *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00661">kernel_netlink_net.c:661</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_afecdde0c0823c5ead35b35611d31f717"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#afecdde0c0823c5ead35b35611d31f717">addr_entry_t::installed</a></div><div class="ttdeci">bool installed</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00122">kernel_netlink_net.c:122</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-67" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-67-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-67-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-67-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ace07348130970cc5fbd634f755f6230f_cgraph.svg" width="100%" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6518ff90e8fda63a800cc1f01d138520"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">add_route&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>dst_net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>prefixlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>gateway</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>src_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>if_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02232">2232</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d1/d13/status_8h_source.html#l00038">ALREADY_DONE</a>, <a class="el" href="../../da/dfc/test__enum_8c_source.html#l00156">found</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">manage_srcroute()</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00067">NLM_F_CREATE</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00066">NLM_F_EXCL</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00287">route_entry_clone()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00042">RTM_NEWROUTE</a>, <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>, and <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>.</p>
<div class="fragment"><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;{</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <a class="code" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *<a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a>, route = {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        .dst_net = dst_net,</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        .prefixlen = prefixlen,</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        .gateway = gateway,</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        .src_ip = src_ip,</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        .if_name = if_name,</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    };</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    this-&gt;routes_lock-&gt;lock(this-&gt;routes_lock);</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    found = this-&gt;routes-&gt;get(this-&gt;routes, &amp;route);</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">if</span> (found)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        this-&gt;routes_lock-&gt;unlock(this-&gt;routes_lock);</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ab7d334aabd5e2b076cb07e97d723f91d">ALREADY_DONE</a>;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    }</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    status = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a>(<span class="keyword">this</span>, <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a>, <a class="code" href="../../de/d4c/netlink_8h.html#a20a00ae52e4c150f54649d7346d23a7a">NLM_F_CREATE</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a0b0f8c9581ee93747c7d9e94ca0e0596">NLM_F_EXCL</a>,</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                             dst_net, prefixlen, gateway, src_ip, if_name);</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <span class="keywordflow">if</span> (status == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        found = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a50ff6b3b73afc5e4e1e327c997d2c7de">route_entry_clone</a>(&amp;route);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        this-&gt;routes-&gt;put(this-&gt;routes, found, found);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    this-&gt;routes_lock-&gt;unlock(this-&gt;routes_lock);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;}</div>
<div class="ttc" id="test__enum_8c_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/test__enum_8c_source.html#l00156">test_enum.c:156</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a50ff6b3b73afc5e4e1e327c997d2c7de"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a50ff6b3b73afc5e4e1e327c997d2c7de">route_entry_clone</a></div><div class="ttdeci">static route_entry_t * route_entry_clone(route_entry_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00287">kernel_netlink_net.c:287</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00042">rtnetlink.h:42</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structroute__entry__t_html"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html">route_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00101">kernel_libipsec_ipsec.c:101</a></div></div>
<div class="ttc" id="netlink_8h_html_a0b0f8c9581ee93747c7d9e94ca0e0596"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a0b0f8c9581ee93747c7d9e94ca0e0596">NLM_F_EXCL</a></div><div class="ttdeci">#define NLM_F_EXCL</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00066">netlink.h:66</a></div></div>
<div class="ttc" id="netlink_8h_html_a20a00ae52e4c150f54649d7346d23a7a"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a20a00ae52e4c150f54649d7346d23a7a">NLM_F_CREATE</a></div><div class="ttdeci">#define NLM_F_CREATE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00067">netlink.h:67</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ab7d334aabd5e2b076cb07e97d723f91d"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ab7d334aabd5e2b076cb07e97d723f91d">ALREADY_DONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00038">status.h:38</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0fb4225c5228122371f3ef9fe600c523"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a></div><div class="ttdeci">static status_t manage_srcroute(private_kernel_netlink_net_t *this, int nlmsg_type, int flags, chunk_t dst_net, u_int8_t prefixlen, host_t *gateway, host_t *src_ip, char *if_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">kernel_netlink_net.c:2144</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-68" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-68-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-68-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-68-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a6518ff90e8fda63a800cc1f01d138520_cgraph.svg" width="100%" height="568"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5f3f1ce8f8dde7cdab3e054848d5895b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">del_route&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a>&#160;</td>
          <td class="paramname"><em>dst_net</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int8_t&#160;</td>
          <td class="paramname"><em>prefixlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>gateway</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *&#160;</td>
          <td class="paramname"><em>src_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>if_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02263">2263</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../da/dfc/test__enum_8c_source.html#l00156">found</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">manage_srcroute()</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00044">NOT_FOUND</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00304">route_entry_destroy()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00044">RTM_DELROUTE</a>, and <a class="el" href="../../dd/dcc/charon-svc_8c_source.html#l00031">status</a>.</p>
<div class="fragment"><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;{</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <a class="code" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <a class="code" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *<a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a>, route = {</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        .dst_net = dst_net,</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        .prefixlen = prefixlen,</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        .gateway = gateway,</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        .src_ip = src_ip,</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        .if_name = if_name,</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    };</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    this-&gt;routes_lock-&gt;lock(this-&gt;routes_lock);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    found = this-&gt;routes-&gt;get(this-&gt;routes, &amp;route);</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="keywordflow">if</span> (!found)</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        this-&gt;routes_lock-&gt;unlock(this-&gt;routes_lock);</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586acdaa2919bac56fe1090eb3dbb9526472">NOT_FOUND</a>;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    this-&gt;routes-&gt;remove(this-&gt;routes, found);</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a16c52872ecaf51327953d6549e19fcd9">route_entry_destroy</a>(found);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    status = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a>(<span class="keyword">this</span>, <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471">RTM_DELROUTE</a>, 0, dst_net, prefixlen,</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                             gateway, src_ip, if_name);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    this-&gt;routes_lock-&gt;unlock(this-&gt;routes_lock);</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;}</div>
<div class="ttc" id="test__enum_8c_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/test__enum_8c_source.html#l00156">test_enum.c:156</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471">RTM_DELROUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00044">rtnetlink.h:44</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a16c52872ecaf51327953d6549e19fcd9"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a16c52872ecaf51327953d6549e19fcd9">route_entry_destroy</a></div><div class="ttdeci">static void route_entry_destroy(route_entry_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00304">kernel_netlink_net.c:304</a></div></div>
<div class="ttc" id="structroute__entry__t_html"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html">route_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00101">kernel_libipsec_ipsec.c:101</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0fb4225c5228122371f3ef9fe600c523"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a></div><div class="ttdeci">static status_t manage_srcroute(private_kernel_netlink_net_t *this, int nlmsg_type, int flags, chunk_t dst_net, u_int8_t prefixlen, host_t *gateway, host_t *src_ip, char *if_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">kernel_netlink_net.c:2144</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00031">charon-svc.c:31</a></div></div>
<div class="ttc" id="group__status__i_html_gaf9bff8ff1154a04a899276af806b8586"><div class="ttname"><a href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a></div><div class="ttdeci">status_t</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00030">status.h:30</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586acdaa2919bac56fe1090eb3dbb9526472"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586acdaa2919bac56fe1090eb3dbb9526472">NOT_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00044">status.h:44</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-69" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-69-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-69-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-69-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a5f3f1ce8f8dde7cdab3e054848d5895b_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="acf60c75dd18e7081cecee6bc166bcebf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">METHOD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d4b/structkernel__net__t.html">kernel_net_t</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/ddc/windows_2thread_8c.html#a343cd07ea8770e572cfe3a7d39ea8401">destroy</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02496">2496</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02482">addr_map_destroy()</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00341">close</a>, <a class="el" href="../../d4/ded/test__threading_8c_source.html#l00117">condvar</a>, <a class="el" href="../../df/d63/spinlock_8h_source.html#l00047">spinlock_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d0/d40/condvar_8h_source.html#l00084">condvar_t::destroy</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00109">route_entry_t::dst_net</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00107">route_entry_t::gateway</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00103">route_entry_t::if_name</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00160">iface_entry_destroy()</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02385">manage_rule()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">manage_srcroute()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00535">net_changes_clear()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00111">route_entry_t::prefixlen</a>, <a class="el" href="../../dd/d33/watcher_8h_source.html#l00099">watcher_t::remove</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00304">route_entry_destroy()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00044">RTM_DELROUTE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00058">RTM_DELRULE</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00328">socket</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00105">route_entry_t::src_ip</a>, and <a class="el" href="../../dd/d08/library_8h_source.html#l00225">library_t::watcher</a>.</p>
<div class="fragment"><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;{</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    <a class="code" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *route;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="keywordflow">if</span> (this-&gt;routing_table)</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    {</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a2fc64fdc22a19e137870e17197ed5cc2">manage_rule</a>(<span class="keyword">this</span>, <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a176648d155f27bef64928203100263ee">RTM_DELRULE</a>, AF_INET, this-&gt;routing_table,</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                    this-&gt;routing_table_prio);</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a2fc64fdc22a19e137870e17197ed5cc2">manage_rule</a>(<span class="keyword">this</span>, <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a176648d155f27bef64928203100263ee">RTM_DELRULE</a>, AF_INET6, this-&gt;routing_table,</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                    this-&gt;routing_table_prio);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="keywordflow">if</span> (this-&gt;socket_events &gt; 0)</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    {</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ababa189d43d8e4ab5a745740258caf34">watcher</a>-&gt;<a class="code" href="../../df/d43/structwatcher__t.html#ab13ec3fc1468f8ff598a81a0a3c28547">remove</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ababa189d43d8e4ab5a745740258caf34">watcher</a>, this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a9ede06ea51e3426a1f16b3fdad351901">socket_events</a>);</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        <a class="code" href="../../da/d9b/group__windows.html#ga9c7f6d5331abb2692a876d5ee67474b7">close</a>(this-&gt;socket_events);</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    }</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    enumerator = this-&gt;routes-&gt;create_enumerator(this-&gt;routes);</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, NULL, (<span class="keywordtype">void</span>**)&amp;route))</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a>(<span class="keyword">this</span>, <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471">RTM_DELROUTE</a>, 0, route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a791ee71e6e19dd2e3bd95716b031de00">dst_net</a>, route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a637604b34e72c11f5b70e36533a78db4">prefixlen</a>,</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                        route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a>, route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">src_ip</a>, route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">if_name</a>);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a16c52872ecaf51327953d6549e19fcd9">route_entry_destroy</a>(route);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    }</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    this-&gt;routes-&gt;destroy(this-&gt;routes);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    this-&gt;routes_lock-&gt;destroy(this-&gt;routes_lock);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;<a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ad005c300e70718321d1b8550ccb476af">net_changes_clear</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    this-&gt;net_changes-&gt;destroy(this-&gt;net_changes);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    this-&gt;net_changes_lock-&gt;destroy(this-&gt;net_changes_lock);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a8e22541bb38cf5d3072adad93e2b0767">addr_map_destroy</a>(this-&gt;addrs);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a8e22541bb38cf5d3072adad93e2b0767">addr_map_destroy</a>(this-&gt;vips);</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    this-&gt;ifaces-&gt;destroy_function(this-&gt;ifaces, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a21cd8aae9699bfaca9118243ceda91df">iface_entry_destroy</a>);</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    this-&gt;rt_exclude-&gt;destroy(this-&gt;rt_exclude);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    this-&gt;roam_lock-&gt;destroy(this-&gt;roam_lock);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>-&gt;<a class="code" href="../../d7/dab/structcondvar__t.html#a4b1bc97f0bcae38f4429f73f84a8a60b">destroy</a>(this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>);</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a8b5528b5b1d8305fee7c92574f7118b0">destroy</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;}</div>
<div class="ttc" id="group__windows_html_gaa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00328">windows.h:328</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a0a710843eb1c0183af31b41b07bf76b0"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">route_entry_t::src_ip</a></div><div class="ttdeci">host_t * src_ip</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00105">kernel_libipsec_ipsec.c:105</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a791ee71e6e19dd2e3bd95716b031de00"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a791ee71e6e19dd2e3bd95716b031de00">route_entry_t::dst_net</a></div><div class="ttdeci">chunk_t dst_net</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00109">kernel_libipsec_ipsec.c:109</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="test__threading_8c_html_a14975442a555aea5d1676fab41b7c4f0"><div class="ttname"><a href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a></div><div class="ttdeci">static condvar_t * condvar</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ded/test__threading_8c_source.html#l00117">test_threading.c:117</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a9ede06ea51e3426a1f16b3fdad351901"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a9ede06ea51e3426a1f16b3fdad351901">private_kernel_netlink_net_t::socket_events</a></div><div class="ttdeci">int socket_events</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00416">kernel_netlink_net.c:416</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a637604b34e72c11f5b70e36533a78db4"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a637604b34e72c11f5b70e36533a78db4">route_entry_t::prefixlen</a></div><div class="ttdeci">u_int8_t prefixlen</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00111">kernel_libipsec_ipsec.c:111</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471">RTM_DELROUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00044">rtnetlink.h:44</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a0cfdaa8399a8c743f7eaa5e98428802f"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">route_entry_t::if_name</a></div><div class="ttdeci">char * if_name</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00103">kernel_libipsec_ipsec.c:103</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a8e22541bb38cf5d3072adad93e2b0767"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a8e22541bb38cf5d3072adad93e2b0767">addr_map_destroy</a></div><div class="ttdeci">static void addr_map_destroy(hashtable_t *map)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l02482">kernel_netlink_net.c:2482</a></div></div>
<div class="ttc" id="structcondvar__t_html_a4b1bc97f0bcae38f4429f73f84a8a60b"><div class="ttname"><a href="../../d7/dab/structcondvar__t.html#a4b1bc97f0bcae38f4429f73f84a8a60b">condvar_t::destroy</a></div><div class="ttdeci">void(* destroy)(condvar_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d40/condvar_8h_source.html#l00084">condvar.h:84</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600a176648d155f27bef64928203100263ee"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600a176648d155f27bef64928203100263ee">RTM_DELRULE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00058">rtnetlink.h:58</a></div></div>
<div class="ttc" id="structspinlock__t_html_a8b5528b5b1d8305fee7c92574f7118b0"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a8b5528b5b1d8305fee7c92574f7118b0">spinlock_t::destroy</a></div><div class="ttdeci">void(* destroy)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00047">spinlock.h:47</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a2fc64fdc22a19e137870e17197ed5cc2"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a2fc64fdc22a19e137870e17197ed5cc2">manage_rule</a></div><div class="ttdeci">static status_t manage_rule(private_kernel_netlink_net_t *this, int nlmsg_type, int family, u_int32_t table, u_int32_t prio)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l02385">kernel_netlink_net.c:2385</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a16c52872ecaf51327953d6549e19fcd9"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a16c52872ecaf51327953d6549e19fcd9">route_entry_destroy</a></div><div class="ttdeci">static void route_entry_destroy(route_entry_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00304">kernel_netlink_net.c:304</a></div></div>
<div class="ttc" id="structroute__entry__t_html"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html">route_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00101">kernel_libipsec_ipsec.c:101</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_ad005c300e70718321d1b8550ccb476af"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#ad005c300e70718321d1b8550ccb476af">net_changes_clear</a></div><div class="ttdeci">static void net_changes_clear(private_kernel_netlink_net_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00535">kernel_netlink_net.c:535</a></div></div>
<div class="ttc" id="structlibrary__t_html_ababa189d43d8e4ab5a745740258caf34"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#ababa189d43d8e4ab5a745740258caf34">library_t::watcher</a></div><div class="ttdeci">watcher_t * watcher</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00225">library.h:225</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a21cd8aae9699bfaca9118243ceda91df"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a21cd8aae9699bfaca9118243ceda91df">iface_entry_destroy</a></div><div class="ttdeci">static void iface_entry_destroy(iface_entry_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00160">kernel_netlink_net.c:160</a></div></div>
<div class="ttc" id="group__windows_html_ga9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00341">windows.h:341</a></div></div>
<div class="ttc" id="structwatcher__t_html_ab13ec3fc1468f8ff598a81a0a3c28547"><div class="ttname"><a href="../../df/d43/structwatcher__t.html#ab13ec3fc1468f8ff598a81a0a3c28547">watcher_t::remove</a></div><div class="ttdeci">void(* remove)(watcher_t *this, int fd)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d33/watcher_8h_source.html#l00099">watcher.h:99</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0fb4225c5228122371f3ef9fe600c523"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a></div><div class="ttdeci">static status_t manage_srcroute(private_kernel_netlink_net_t *this, int nlmsg_type, int flags, chunk_t dst_net, u_int8_t prefixlen, host_t *gateway, host_t *src_ip, char *if_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">kernel_netlink_net.c:2144</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a4fd0d4902ebe96633cc03703529d5bc1"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">route_entry_t::gateway</a></div><div class="ttdeci">host_t * gateway</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00107">kernel_libipsec_ipsec.c:107</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-70" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-70-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-70-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-70-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_acf60c75dd18e7081cecee6bc166bcebf_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a56a31ce09ddc60d87a5b04e50ca3de67"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void net_change_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destroy a <a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> object </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00350">350</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00535">net_changes_clear()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">queue_route_reinstall()</a>.</p>
<div class="fragment"><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;{</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(this-&gt;if_name);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-71" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-71-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-71-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-71-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a56a31ce09ddc60d87a5b04e50ca3de67_cgraph.svg" width="243" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-72" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-72-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-72-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-72-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a56a31ce09ddc60d87a5b04e50ca3de67_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0f2fc1a51aba0dc778bd148f650550ff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> net_change_equals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compare two <a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> objects </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00367">367</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00344">net_change_t::if_name</a>, and <a class="el" href="../../da/d66/string_8h_source.html#l00028">streq()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/group__string__i.html#ga65c3d08890165aaa4663c72d07f93bb7">streq</a>(a-&gt;<a class="code" href="../../df/d6f/structnet__change__t.html#ae443c87b68649f6a6c38e36c124275b7">if_name</a>, b-&gt;<a class="code" href="../../df/d6f/structnet__change__t.html#ae443c87b68649f6a6c38e36c124275b7">if_name</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
<div class="ttc" id="group__string__i_html_ga65c3d08890165aaa4663c72d07f93bb7"><div class="ttname"><a href="../../d4/d40/group__string__i.html#ga65c3d08890165aaa4663c72d07f93bb7">streq</a></div><div class="ttdeci">static bool streq(const char *x, const char *y)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d66/string_8h_source.html#l00028">string.h:28</a></div></div>
<div class="ttc" id="structnet__change__t_html_ae443c87b68649f6a6c38e36c124275b7"><div class="ttname"><a href="../../df/d6f/structnet__change__t.html#ae443c87b68649f6a6c38e36c124275b7">net_change_t::if_name</a></div><div class="ttdeci">char * if_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00344">kernel_netlink_net.c:344</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-73" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-73-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-73-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-73-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0f2fc1a51aba0dc778bd148f650550ff_cgraph.svg" width="246" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-74" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-74-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-74-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-74-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0f2fc1a51aba0dc778bd148f650550ff_icgraph.svg" width="451" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a42a9217a43385132ed195727fdae32c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int net_change_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Hash a <a class="el" href="../../df/d6f/structnet__change__t.html">net_change_t</a> object </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00359">359</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00057">chunk_create()</a>, and <a class="el" href="../../d8/d39/chunk_8c_source.html#l00969">chunk_hash()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d87/group__chunk.html#ga714bd1cb9e1f743523c2a58a49f1b6a4">chunk_hash</a>(<a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(this-&gt;if_name, strlen(this-&gt;if_name)));</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div>
<div class="ttc" id="group__chunk_html_ga714bd1cb9e1f743523c2a58a49f1b6a4"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga714bd1cb9e1f743523c2a58a49f1b6a4">chunk_hash</a></div><div class="ttdeci">u_int32_t chunk_hash(chunk_t chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00969">chunk.c:969</a></div></div>
<div class="ttc" id="group__chunk_html_gad94ca029616a107e89eaa618408fd7b6"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a></div><div class="ttdeci">static chunk_t chunk_create(u_char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00057">chunk.h:57</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-75" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-75-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-75-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-75-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a42a9217a43385132ed195727fdae32c9_cgraph.svg" width="100%" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-76" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-76-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-76-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-76-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a42a9217a43385132ed195727fdae32c9_icgraph.svg" width="440" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad005c300e70718321d1b8550ccb476af"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void net_changes_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clear the queued network changes. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00535">535</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00350">net_change_destroy()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02496">METHOD()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00552">reinstall_routes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;{</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *change;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    enumerator = this-&gt;net_changes-&gt;create_enumerator(this-&gt;net_changes);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, NULL, (<span class="keywordtype">void</span>**)&amp;change))</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        this-&gt;net_changes-&gt;remove_at(this-&gt;net_changes, enumerator);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a56a31ce09ddc60d87a5b04e50ca3de67">net_change_destroy</a>(change);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="ttc" id="structnet__change__t_html"><div class="ttname"><a href="../../df/d6f/structnet__change__t.html">net_change_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00342">kernel_netlink_net.c:342</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a56a31ce09ddc60d87a5b04e50ca3de67"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a56a31ce09ddc60d87a5b04e50ca3de67">net_change_destroy</a></div><div class="ttdeci">static void net_change_destroy(net_change_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00350">kernel_netlink_net.c:350</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-77" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-77-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-77-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-77-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ad005c300e70718321d1b8550ccb476af_cgraph.svg" width="422" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-78" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-78-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-78-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-78-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ad005c300e70718321d1b8550ccb476af_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae6a815ab18f327d4cb1d05deca255373"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a>* parse_route </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *&#160;</td>
          <td class="paramname"><em>hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a> *&#160;</td>
          <td class="paramname"><em>route</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Parse route received with RTM_NEWROUTE. The given <a class="el" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a> object will be reused if not NULL.</p>
<p>Returned chunks point to internal data of the Netlink message. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01589">1589</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00057">chunk_create()</a>, <a class="el" href="../../d8/d39/chunk_8c_source.html#l00035">chunk_empty</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01546">rt_entry_t::dst</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01548">rt_entry_t::dst_len</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01544">rt_entry_t::gtw</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01550">rt_entry_t::oif</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01551">rt_entry_t::priority</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00171">RTA_DATA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00290">RTA_DST</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00294">RTA_GATEWAY</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00167">RTA_NEXT</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00293">RTA_OIF</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00164">RTA_OK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00172">RTA_PAYLOAD</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00296">RTA_PREFSRC</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00295">RTA_PRIORITY</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00304">RTA_TABLE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtattr::rta_type</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00183">rtmsg::rtm_dst_len</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00316">RTM_PAYLOAD</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00315">RTM_RTA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00187">rtmsg::rtm_table</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01545">rt_entry_t::src</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01549">rt_entry_t::table</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;{</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/d03/structrtattr.html">rtattr</a> *rta;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a> *<a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordtype">size_t</span> rtasize;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    msg = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    rta = <a class="code" href="../../d9/d06/rtnetlink_8h.html#aba2657fb912970829e5131017f0f7728">RTM_RTA</a>(msg);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    rtasize = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a845b50c0230af0fc532afec8c7c58aff">RTM_PAYLOAD</a>(hdr);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">if</span> (route)</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#ac61adb8cd44995ddbe4ab35d2ca5b1d5">gtw</a> = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a63635790d84015ed086636e270b35b4d">src</a> = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#af4daf9e6221e77c9915cc0c2843793ec">dst</a> = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#ab32d86e023a9cc3af2cc2a10ff07c5bc">dst_len</a> = msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a6b911f60a25644cfeda2c931987e3c38">rtm_dst_len</a>;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a22d1e96680c09a1f5872ba4da8ca011e">table</a> = msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtm_table</a>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a> = 0;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">priority</a> = 0;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(route,</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            .dst_len = msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a6b911f60a25644cfeda2c931987e3c38">rtm_dst_len</a>,</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            .table = msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtm_table</a>,</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        );</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d9/d06/rtnetlink_8h.html#a374ac181878db21a64f22a35b49237e1">RTA_OK</a>(rta, rtasize))</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <span class="keywordflow">switch</span> (rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rta_type</a>)</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561">RTA_PREFSRC</a>:</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a63635790d84015ed086636e270b35b4d">src</a> = <a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta), <a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta));</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ad0fa476f2036a14c89f65c8fa375315b">RTA_GATEWAY</a>:</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#ac61adb8cd44995ddbe4ab35d2ca5b1d5">gtw</a> = <a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta), <a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta));</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a">RTA_DST</a>:</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#af4daf9e6221e77c9915cc0c2843793ec">dst</a> = <a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta), <a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta));</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d">RTA_OIF</a>:</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta) == <span class="keyword">sizeof</span>(route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a>))</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                {</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                    route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">oif</a> = *(u_int32_t*)<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a1b02b788d3bfeaf02990a9342acf18bc">RTA_PRIORITY</a>:</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta) == <span class="keyword">sizeof</span>(route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">priority</a>))</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                    route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">priority</a> = *(u_int32_t*)<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="preprocessor">#ifdef HAVE_RTA_TABLE</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ae676963e7fc31cf8bc06398076ee558f">RTA_TABLE</a>:</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta) == <span class="keyword">sizeof</span>(route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a22d1e96680c09a1f5872ba4da8ca011e">table</a>))</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                    route-&gt;<a class="code" href="../../dc/d39/structrt__entry__t.html#a22d1e96680c09a1f5872ba4da8ca011e">table</a> = *(u_int32_t*)<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                }</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_RTA_TABLE*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="preprocessor"></span>        }</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        rta = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a07af6f6f3cbf507b32f187e9dc4b4336">RTA_NEXT</a>(rta, rtasize);</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    }</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">return</span> route;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;}</div>
<div class="ttc" id="rtnetlink_8h_html_a374ac181878db21a64f22a35b49237e1"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a374ac181878db21a64f22a35b49237e1">RTA_OK</a></div><div class="ttdeci">#define RTA_OK(rta, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00164">rtnetlink.h:164</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d">RTA_OIF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00293">rtnetlink.h:293</a></div></div>
<div class="ttc" id="structrt__entry__t_html_aca95e189d026b46db1df62d06ed772a2"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#aca95e189d026b46db1df62d06ed772a2">rt_entry_t::priority</a></div><div class="ttdeci">u_int32_t priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01551">kernel_netlink_net.c:1551</a></div></div>
<div class="ttc" id="group__chunk_html_gac9858e0c37c9bf6c0706d0a6e3b6453d"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a></div><div class="ttdeci">chunk_t chunk_empty</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00035">chunk.c:35</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a42f61974b6169a0f37cb8f46e57db89d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a></div><div class="ttdeci">#define RTA_DATA(rta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00171">rtnetlink.h:171</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a07af6f6f3cbf507b32f187e9dc4b4336"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a07af6f6f3cbf507b32f187e9dc4b4336">RTA_NEXT</a></div><div class="ttdeci">#define RTA_NEXT(rta, attrlen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00167">rtnetlink.h:167</a></div></div>
<div class="ttc" id="structrt__entry__t_html_a63635790d84015ed086636e270b35b4d"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#a63635790d84015ed086636e270b35b4d">rt_entry_t::src</a></div><div class="ttdeci">chunk_t src</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01545">kernel_netlink_net.c:1545</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561">RTA_PREFSRC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00296">rtnetlink.h:296</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173a1b02b788d3bfeaf02990a9342acf18bc"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a1b02b788d3bfeaf02990a9342acf18bc">RTA_PRIORITY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00295">rtnetlink.h:295</a></div></div>
<div class="ttc" id="structrtattr_html"><div class="ttname"><a href="../../d1/d03/structrtattr.html">rtattr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00155">rtnetlink.h:155</a></div></div>
<div class="ttc" id="structrt__entry__t_html_ab32d86e023a9cc3af2cc2a10ff07c5bc"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#ab32d86e023a9cc3af2cc2a10ff07c5bc">rt_entry_t::dst_len</a></div><div class="ttdeci">u_int8_t dst_len</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01548">kernel_netlink_net.c:1548</a></div></div>
<div class="ttc" id="structrtattr_html_a23bd02894aef9ce3741ba36767ce2ede"><div class="ttname"><a href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rtattr::rta_type</a></div><div class="ttdeci">unsigned short rta_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtnetlink.h:157</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173ae676963e7fc31cf8bc06398076ee558f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ae676963e7fc31cf8bc06398076ee558f">RTA_TABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00304">rtnetlink.h:304</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a9c7e775ba76d89b27381d7085c4cce79"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a></div><div class="ttdeci">#define RTA_PAYLOAD(rta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00172">rtnetlink.h:172</a></div></div>
<div class="ttc" id="group__chunk_html_gad94ca029616a107e89eaa618408fd7b6"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a></div><div class="ttdeci">static chunk_t chunk_create(u_char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00057">chunk.h:57</a></div></div>
<div class="ttc" id="structrt__entry__t_html_ac61adb8cd44995ddbe4ab35d2ca5b1d5"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#ac61adb8cd44995ddbe4ab35d2ca5b1d5">rt_entry_t::gtw</a></div><div class="ttdeci">chunk_t gtw</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01544">kernel_netlink_net.c:1544</a></div></div>
<div class="ttc" id="structrtmsg_html_a6b911f60a25644cfeda2c931987e3c38"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a6b911f60a25644cfeda2c931987e3c38">rtmsg::rtm_dst_len</a></div><div class="ttdeci">unsigned char rtm_dst_len</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00183">rtnetlink.h:183</a></div></div>
<div class="ttc" id="structrt__entry__t_html_a2800d1ae173df5f63352480fbb8efa43"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#a2800d1ae173df5f63352480fbb8efa43">rt_entry_t::oif</a></div><div class="ttdeci">u_int32_t oif</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01550">kernel_netlink_net.c:1550</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173aeaa6ccca099b53e43a297cd67607626a">RTA_DST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00290">rtnetlink.h:290</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173ad0fa476f2036a14c89f65c8fa375315b"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ad0fa476f2036a14c89f65c8fa375315b">RTA_GATEWAY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00294">rtnetlink.h:294</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a845b50c0230af0fc532afec8c7c58aff"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a845b50c0230af0fc532afec8c7c58aff">RTM_PAYLOAD</a></div><div class="ttdeci">#define RTM_PAYLOAD(n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00316">rtnetlink.h:316</a></div></div>
<div class="ttc" id="structrtmsg_html"><div class="ttname"><a href="../../da/d53/structrtmsg.html">rtmsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00181">rtnetlink.h:181</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structrt__entry__t_html_af4daf9e6221e77c9915cc0c2843793ec"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#af4daf9e6221e77c9915cc0c2843793ec">rt_entry_t::dst</a></div><div class="ttdeci">chunk_t dst</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01546">kernel_netlink_net.c:1546</a></div></div>
<div class="ttc" id="structrtmsg_html_a72deabb274ce59c11db0e21e7aeb8de7"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtmsg::rtm_table</a></div><div class="ttdeci">unsigned char rtm_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00187">rtnetlink.h:187</a></div></div>
<div class="ttc" id="structrt__entry__t_html_a22d1e96680c09a1f5872ba4da8ca011e"><div class="ttname"><a href="../../dc/d39/structrt__entry__t.html#a22d1e96680c09a1f5872ba4da8ca011e">rt_entry_t::table</a></div><div class="ttdeci">u_int32_t table</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01549">kernel_netlink_net.c:1549</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_aba2657fb912970829e5131017f0f7728"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#aba2657fb912970829e5131017f0f7728">RTM_RTA</a></div><div class="ttdeci">#define RTM_RTA(r)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00315">rtnetlink.h:315</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-79" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-79-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-79-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-79-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ae6a815ab18f327d4cb1d05deca255373_cgraph.svg" width="251" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-80" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-80-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-80-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-80-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ae6a815ab18f327d4cb1d05deca255373_icgraph.svg" width="355" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a524a440e79bfb8f59290902a14bb30e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void process_addr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *&#160;</td>
          <td class="paramname"><em>hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>process RTM_NEWADDR/RTM_DELADDR from kernel </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">1071</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00208">addr_map_entry_t::addr</a>, <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00128">addr_entry_destroy()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00674">addr_map_entry_add()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00691">addr_map_entry_remove()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">iface_entry_t::addrs</a>, <a class="el" href="../../d0/d40/condvar_8h_source.html#l00079">condvar_t::broadcast</a>, <a class="el" href="../../d8/d39/chunk_8c_source.html#l00035">chunk_empty</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00050">host_t::clone</a>, <a class="el" href="../../d4/ded/test__threading_8c_source.html#l00117">condvar</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00130">host_t::destroy</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">fire_roam_event()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00148">iface_entry_t::flags</a>, <a class="el" href="../../da/dfc/test__enum_8c_source.html#l00156">found</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">host</a>, <a class="el" href="../../df/da9/host_8c_source.html#l00477">host_create_from_chunk()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">iface_entry_by_index()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">iface_entry_t::ifname</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00147">linked_list_t::insert_last</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00122">addr_entry_t::installed</a>, <a class="el" href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">ip</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">lookup</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00044">nlmsghdr::nlmsg_type</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">queue_route_reinstall()</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00132">linked_list_t::remove</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00171">RTA_DATA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00167">RTA_NEXT</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00164">RTA_OK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00172">RTA_PAYLOAD</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtattr::rta_type</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00037">RTM_DELADDR</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00035">RTM_NEWADDR</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00099">strdup</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>, <a class="el" href="../../dc/d33/cmac_8c_source.html#l00078">update()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00154">iface_entry_t::usable</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02294">init_address_list()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01278">receive_events()</a>.</p>
<div class="fragment"><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;{</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <span class="keyword">struct </span>ifaddrmsg* <a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a> = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/d03/structrtattr.html">rtattr</a> *rta = IFA_RTA(msg);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordtype">size_t</span> rtasize = IFA_PAYLOAD (hdr);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a> = NULL;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <a class="code" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *iface;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="../../d0/d14/structchunk__t.html">chunk_t</a> local = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>, address = <a class="code" href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a>;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordtype">char</span> *route_ifname = NULL;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../dc/d33/cmac_8c.html#ab6ca46636c74b9241792379582ee7ce6">update</a> = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a> = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, changed = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d9/d06/rtnetlink_8h.html#a374ac181878db21a64f22a35b49237e1">RTA_OK</a>(rta, rtasize))</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordflow">switch</span> (rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rta_type</a>)</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <span class="keywordflow">case</span> IFA_LOCAL:</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                local.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                local.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="keywordflow">case</span> IFA_ADDRESS:</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                address.ptr = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                address.len = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        rta = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a07af6f6f3cbf507b32f187e9dc4b4336">RTA_NEXT</a>(rta, rtasize);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">/* For PPP interfaces, we need the IFA_LOCAL address,</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">     * IFA_ADDRESS is the peers address. But IFA_LOCAL is</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">     * not included in all cases (IPv6?), so fallback to IFA_ADDRESS. */</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">if</span> (local.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a>)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        host = <a class="code" href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a>(msg-&gt;ifa_family, local, 0);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (address.ptr)</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        host = <a class="code" href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a>(msg-&gt;ifa_family, address, 0);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="keywordflow">if</span> (host == NULL)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    {   <span class="comment">/* bad family? */</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;write_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">if</span> (this-&gt;ifaces-&gt;find_first(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">ifaces</a>, (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a>,</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                                 (<span class="keywordtype">void</span>**)&amp;iface, &amp;msg-&gt;ifa_index) == <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <a class="code" href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a> *entry, <a class="code" href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a> = {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            .ip = <a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>,</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;            .iface = iface,</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        };</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <a class="code" href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a> *<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        entry = this-&gt;vips-&gt;get(this-&gt;vips, &amp;lookup);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">if</span> (hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> == <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a>)</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            {   <span class="comment">/* mark as installed and signal waiting threads */</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr</a>-&gt;<a class="code" href="../../d5/d02/structaddr__entry__t.html#afecdde0c0823c5ead35b35611d31f717">installed</a> = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            {   <span class="comment">/* the address was already marked as uninstalled */</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                addr = entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr</a>;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a977f48a04ed92490066040287bc7b256">remove</a>(iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>, addr, NULL);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ae2b62cb29d42de4ef8ef3a436a0cbde5">addr_map_entry_remove</a>(this-&gt;vips, addr, iface);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a7235c174351cbc6544dad599e0cb03d1">addr_entry_destroy</a>(addr);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <span class="comment">/* no roam events etc. for virtual IPs */</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>-&gt;<a class="code" href="../../d7/dab/structcondvar__t.html#a74176965ac6053fdd34f191671d46c62">broadcast</a>(this-&gt;<a class="code" href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a>);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(host);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        entry = this-&gt;addrs-&gt;get(this-&gt;addrs, &amp;lookup);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="keywordflow">if</span> (entry)</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            <span class="keywordflow">if</span> (hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> == <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f">RTM_DELADDR</a>)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                found = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                addr = entry-&gt;<a class="code" href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr</a>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a977f48a04ed92490066040287bc7b256">remove</a>(iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>, addr, NULL);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                <span class="keywordflow">if</span> (iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">usable</a>)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                    changed = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;%H disappeared from %s&quot;</span>, host,</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                         iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ae2b62cb29d42de4ef8ef3a436a0cbde5">addr_map_entry_remove</a>(this-&gt;addrs, addr, iface);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a7235c174351cbc6544dad599e0cb03d1">addr_entry_destroy</a>(addr);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="keywordflow">if</span> (hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a> == <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a>)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                found = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                changed = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                route_ifname = <a class="code" href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a>(iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(addr,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                    .<a class="code" href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a> = host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">clone</a>(host),</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                    .flags = msg-&gt;ifa_flags,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                    .scope = msg-&gt;ifa_scope,</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                );</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#a5150f69ff51c8d6d0ed680fad1120c02">insert_last</a>(iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>, addr);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a32fc094777315d46304963b5a6a7e631">addr_map_entry_add</a>(this-&gt;addrs, addr, iface);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a> &amp;&amp; iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">usable</a>)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;%H appeared on %s&quot;</span>, host, iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                }</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            }</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="keywordflow">if</span> (found &amp;&amp; (iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#abfcdafd79963dfa36b5703427c625048">flags</a> &amp; IFF_UP))</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            update = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keywordflow">if</span> (!iface-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">usable</a>)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        {   <span class="comment">/* ignore events for interfaces excluded by config */</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            update = changed = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">if</span> (update &amp;&amp; <a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a> &amp;&amp; route_ifname)</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0f4d312f2e3ae7e2ef669ff35e21bee8">queue_route_reinstall</a>(<span class="keyword">this</span>, route_ifname);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(route_ifname);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(host);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">/* send an update to all IKE_SAs */</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">if</span> (update &amp;&amp; <a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a> &amp;&amp; changed)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0c5e768dcc201c5dbfcbed72326396da">fire_roam_event</a>(<span class="keyword">this</span>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;}</div>
<div class="ttc" id="test__traffic__selector_8c_html_a1c2046dcb30a629d6d9f45ff8f403f12"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">test_traffic_selector.c:403</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a374ac181878db21a64f22a35b49237e1"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a374ac181878db21a64f22a35b49237e1">RTA_OK</a></div><div class="ttdeci">#define RTA_OK(rta, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00164">rtnetlink.h:164</a></div></div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="test__enum_8c_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/test__enum_8c_source.html#l00156">test_enum.c:156</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="error__notify__msg_8h_html_abcc82b944bf2a158e29a4042043185a5"><div class="ttname"><a href="../../d2/d3f/error__notify__msg_8h.html#abcc82b944bf2a158e29a4042043185a5">ip</a></div><div class="ttdeci">char ip[60]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3f/error__notify__msg_8h_source.html#l00053">error_notify_msg.h:53</a></div></div>
<div class="ttc" id="proposal__keywords__static_8c_html_a85d2eea012c83b4dd2615d97bddbffc8"><div class="ttname"><a href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a></div><div class="ttdeci">static const short lookup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">proposal_keywords_static.c:288</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a32fc094777315d46304963b5a6a7e631"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a32fc094777315d46304963b5a6a7e631">addr_map_entry_add</a></div><div class="ttdeci">static void addr_map_entry_add(hashtable_t *map, addr_entry_t *addr, iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00674">kernel_netlink_net.c:674</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html">addr_map_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00203">kernel_netlink_net.c:203</a></div></div>
<div class="ttc" id="cmac_8c_html_ab6ca46636c74b9241792379582ee7ce6"><div class="ttname"><a href="../../dc/d33/cmac_8c.html#ab6ca46636c74b9241792379582ee7ce6">update</a></div><div class="ttdeci">static bool update(private_mac_t *this, chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/cmac_8c_source.html#l00078">cmac.c:78</a></div></div>
<div class="ttc" id="group__host_html_gaf40fcca3c58e789ff4f82bbf875727e4"><div class="ttname"><a href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a></div><div class="ttdeci">host_t * host_create_from_chunk(int family, chunk_t address, u_int16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/host_8c_source.html#l00477">host.c:477</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f">RTM_DELADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00037">rtnetlink.h:37</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a33d3a0bd02d90b6a9940413cdc7b2b8b"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">iface_entry_t::usable</a></div><div class="ttdeci">bool usable</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00154">kernel_netlink_net.c:154</a></div></div>
<div class="ttc" id="group__chunk_html_gac9858e0c37c9bf6c0706d0a6e3b6453d"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac9858e0c37c9bf6c0706d0a6e3b6453d">chunk_empty</a></div><div class="ttdeci">chunk_t chunk_empty</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00035">chunk.c:35</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a42f61974b6169a0f37cb8f46e57db89d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a></div><div class="ttdeci">#define RTA_DATA(rta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00171">rtnetlink.h:171</a></div></div>
<div class="ttc" id="structiface__entry__t_html_af77daca88bd8077974e87a298418e1b4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">iface_entry_t::ifname</a></div><div class="ttdeci">char ifname[IFNAMSIZ]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">kernel_netlink_net.c:145</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a44a28287a4812f8e8101770a3cc94b87"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a></div><div class="ttdeci">static bool iface_entry_by_index(iface_entry_t *this, int *ifindex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">kernel_netlink_net.c:169</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a07af6f6f3cbf507b32f187e9dc4b4336"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a07af6f6f3cbf507b32f187e9dc4b4336">RTA_NEXT</a></div><div class="ttdeci">#define RTA_NEXT(rta, attrlen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00167">rtnetlink.h:167</a></div></div>
<div class="ttc" id="structiface__entry__t_html"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00139">kernel_netlink_net.c:139</a></div></div>
<div class="ttc" id="structhost__t_html_aebe9cd9ffd665b04e223c5e8b6ce7114"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#aebe9cd9ffd665b04e223c5e8b6ce7114">host_t::clone</a></div><div class="ttdeci">host_t *(* clone)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00050">host.h:50</a></div></div>
<div class="ttc" id="test__threading_8c_html_a14975442a555aea5d1676fab41b7c4f0"><div class="ttname"><a href="../../d4/ded/test__threading_8c.html#a14975442a555aea5d1676fab41b7c4f0">condvar</a></div><div class="ttdeci">static condvar_t * condvar</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ded/test__threading_8c_source.html#l00117">test_threading.c:117</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structnlmsghdr_html_abc588d6bfd91bcbf100709e57b7877df"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsghdr::nlmsg_type</a></div><div class="ttdeci">__u16 nlmsg_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00044">netlink.h:44</a></div></div>
<div class="ttc" id="structrtattr_html"><div class="ttname"><a href="../../d1/d03/structrtattr.html">rtattr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00155">rtnetlink.h:155</a></div></div>
<div class="ttc" id="structrtattr_html_a23bd02894aef9ce3741ba36767ce2ede"><div class="ttname"><a href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rtattr::rta_type</a></div><div class="ttdeci">unsigned short rta_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtnetlink.h:157</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00035">rtnetlink.h:35</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a9c7e775ba76d89b27381d7085c4cce79"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a></div><div class="ttdeci">#define RTA_PAYLOAD(rta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00172">rtnetlink.h:172</a></div></div>
<div class="ttc" id="structchunk__t_html"><div class="ttname"><a href="../../d0/d14/structchunk__t.html">chunk_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00040">chunk.h:40</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="structaddr__map__entry__t_html_add1a1a443f7c891e3a11780bc6f43ee9"><div class="ttname"><a href="../../d1/dce/structaddr__map__entry__t.html#add1a1a443f7c891e3a11780bc6f43ee9">addr_map_entry_t::addr</a></div><div class="ttdeci">addr_entry_t * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00208">kernel_netlink_net.c:208</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="structlinked__list__t_html_a977f48a04ed92490066040287bc7b256"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a977f48a04ed92490066040287bc7b256">linked_list_t::remove</a></div><div class="ttdeci">int(* remove)(linked_list_t *this, void *item, bool(*compare)(void *, void *))</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00132">linked_list.h:132</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a565d71e8ad36560cb72c7f6edd56ba63"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a></div><div class="ttdeci">static HANDLE event</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00041">charon-svc.c:41</a></div></div>
<div class="ttc" id="structlinked__list__t_html_a5150f69ff51c8d6d0ed680fad1120c02"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#a5150f69ff51c8d6d0ed680fad1120c02">linked_list_t::insert_last</a></div><div class="ttdeci">void(* insert_last)(linked_list_t *this, void *item)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00147">linked_list.h:147</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_ae2b62cb29d42de4ef8ef3a436a0cbde5"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#ae2b62cb29d42de4ef8ef3a436a0cbde5">addr_map_entry_remove</a></div><div class="ttdeci">static void addr_map_entry_remove(hashtable_t *map, addr_entry_t *addr, iface_entry_t *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00691">kernel_netlink_net.c:691</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__windows_html_ga9254b089d435892385cf14d0ab4a7a2d"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a></div><div class="ttdeci">#define strdup</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00099">windows.h:99</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="structhost__t_html_af9703b61f348ea0409dc9cb197b2b788"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">host_t::destroy</a></div><div class="ttdeci">void(* destroy)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00130">host.h:130</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a7235c174351cbc6544dad599e0cb03d1"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a7235c174351cbc6544dad599e0cb03d1">addr_entry_destroy</a></div><div class="ttdeci">static void addr_entry_destroy(addr_entry_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00128">kernel_netlink_net.c:128</a></div></div>
<div class="ttc" id="structcondvar__t_html_a74176965ac6053fdd34f191671d46c62"><div class="ttname"><a href="../../d7/dab/structcondvar__t.html#a74176965ac6053fdd34f191671d46c62">condvar_t::broadcast</a></div><div class="ttdeci">void(* broadcast)(condvar_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d40/condvar_8h_source.html#l00079">condvar.h:79</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structaddr__entry__t_html_afecdde0c0823c5ead35b35611d31f717"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html#afecdde0c0823c5ead35b35611d31f717">addr_entry_t::installed</a></div><div class="ttdeci">bool installed</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00122">kernel_netlink_net.c:122</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a388b18d13f3b29682afae599da369527"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">private_kernel_netlink_net_t::ifaces</a></div><div class="ttdeci">linked_list_t * ifaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00396">kernel_netlink_net.c:396</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a074ce3bd111ba07ab802a6c74063a5a2"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">iface_entry_t::addrs</a></div><div class="ttdeci">linked_list_t * addrs</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">kernel_netlink_net.c:151</a></div></div>
<div class="ttc" id="structaddr__entry__t_html"><div class="ttname"><a href="../../d5/d02/structaddr__entry__t.html">addr_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00107">kernel_netlink_net.c:107</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
<div class="ttc" id="structiface__entry__t_html_abfcdafd79963dfa36b5703427c625048"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#abfcdafd79963dfa36b5703427c625048">iface_entry_t::flags</a></div><div class="ttdeci">u_int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00148">kernel_netlink_net.c:148</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0c5e768dcc201c5dbfcbed72326396da"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0c5e768dcc201c5dbfcbed72326396da">fire_roam_event</a></div><div class="ttdeci">static void fire_roam_event(private_kernel_netlink_net_t *this, bool address)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">kernel_netlink_net.c:904</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0f4d312f2e3ae7e2ef669ff35e21bee8"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0f4d312f2e3ae7e2ef669ff35e21bee8">queue_route_reinstall</a></div><div class="ttdeci">static void queue_route_reinstall(private_kernel_netlink_net_t *this, char *if_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">kernel_netlink_net.c:602</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-81" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-81-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-81-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-81-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a524a440e79bfb8f59290902a14bb30e8_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-82" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-82-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-82-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-82-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a524a440e79bfb8f59290902a14bb30e8_icgraph.svg" width="582" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0f87b0e61837c8bde853f9eda9756613"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void process_link </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *&#160;</td>
          <td class="paramname"><em>hdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>process RTM_NEWLINK/RTM_DELLINK from kernel </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">969</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00954">addr_entry_unregister()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">iface_entry_t::addrs</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">fire_roam_event()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00148">iface_entry_t::flags</a>, <a class="el" href="../../de/d6a/hydra_8c_source.html#l00046">hydra</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">iface_entry_by_index()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00160">iface_entry_destroy()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00472">ifinfomsg::ifi_flags</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00471">ifinfomsg::ifi_index</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">iface_entry_t::ifindex</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">iface_entry_t::ifname</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d1/d4a/linked__list_8h_source.html#l00210">linked_list_t::invoke_function</a>, <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00478">kernel_interface_t::is_interface_usable</a>, <a class="el" href="../../dc/d63/hydra_8h_source.html#l00046">hydra_t::kernel_interface</a>, <a class="el" href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list_create()</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../d6/d1a/dh__speed_8c_source.html#l00030">name</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00044">nlmsghdr::nlmsg_type</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">queue_route_reinstall()</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00171">RTA_DATA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00167">RTA_NEXT</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00164">RTA_OK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtattr::rta_type</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00028">RTM_DELLINK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00026">RTM_NEWLINK</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00099">strdup</a>, <a class="el" href="../../d1/d13/status_8h_source.html#l00032">SUCCESS</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>, <a class="el" href="../../dc/d33/cmac_8c_source.html#l00078">update()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00154">iface_entry_t::usable</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02294">init_address_list()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01278">receive_events()</a>.</p>
<div class="fragment"><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d2/d18/structifinfomsg.html">ifinfomsg</a>* <a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a> = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/d03/structrtattr.html">rtattr</a> *rta = IFLA_RTA(msg);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordtype">size_t</span> rtasize = IFLA_PAYLOAD (hdr);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <a class="code" href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a> *current, *entry = NULL;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a> = NULL;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../dc/d33/cmac_8c.html#ab6ca46636c74b9241792379582ee7ce6">update</a> = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, update_routes = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d9/d06/rtnetlink_8h.html#a374ac181878db21a64f22a35b49237e1">RTA_OK</a>(rta, rtasize))</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">switch</span> (rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rta_type</a>)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordflow">case</span> IFLA_IFNAME:</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                name = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        rta = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a07af6f6f3cbf507b32f187e9dc4b4336">RTA_NEXT</a>(rta, rtasize);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">if</span> (!name)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        name = <span class="stringliteral">&quot;(unknown)&quot;</span>;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;write_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">switch</span> (hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a>)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9">RTM_NEWLINK</a>:</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="keywordflow">if</span> (this-&gt;ifaces-&gt;find_first(this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">ifaces</a>,</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                                    (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a>, (<span class="keywordtype">void</span>**)&amp;entry,</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                    &amp;msg-&gt;<a class="code" href="../../d2/d18/structifinfomsg.html#a61de5e202571e2ce389b0c6d4aa24a4a">ifi_index</a>) != <a class="code" href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a>)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(entry,</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                    .ifindex = msg-&gt;<a class="code" href="../../d2/d18/structifinfomsg.html#a61de5e202571e2ce389b0c6d4aa24a4a">ifi_index</a>,</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                    .addrs = <a class="code" href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a>(),</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                    .usable = <a class="code" href="../../d6/d9d/group__libhydra.html#ga35c899fffe25d189c598655cdf558dde">hydra</a>-&gt;<a class="code" href="../../dd/db5/structhydra__t.html#adf646db4986ffd1d4aecade40cd53dac">kernel_interface</a>-&gt;<a class="code" href="../../db/df8/structkernel__interface__t.html#a055edb216ddb9a3ca313ecc6d18b01cc">is_interface_usable</a>(</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                                <a class="code" href="../../d6/d9d/group__libhydra.html#ga35c899fffe25d189c598655cdf558dde">hydra</a>-&gt;<a class="code" href="../../dd/db5/structhydra__t.html#adf646db4986ffd1d4aecade40cd53dac">kernel_interface</a>, name),</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                );</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                this-&gt;ifaces-&gt;insert_last(this-&gt;ifaces, entry);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            strncpy(entry-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>, name, IFNAMSIZ);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            entry-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>[IFNAMSIZ-1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a> &amp;&amp; entry-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">usable</a>)</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                <span class="keywordflow">if</span> (!(entry-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#abfcdafd79963dfa36b5703427c625048">flags</a> &amp; IFF_UP) &amp;&amp; (msg-&gt;<a class="code" href="../../d2/d18/structifinfomsg.html#ab307fa542ef964c144bd6fce53e223a2">ifi_flags</a> &amp; IFF_UP))</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    update = update_routes = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;interface %s activated&quot;</span>, name);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                }</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                <span class="keywordflow">if</span> ((entry-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#abfcdafd79963dfa36b5703427c625048">flags</a> &amp; IFF_UP) &amp;&amp; !(msg-&gt;<a class="code" href="../../d2/d18/structifinfomsg.html#ab307fa542ef964c144bd6fce53e223a2">ifi_flags</a> &amp; IFF_UP))</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                    update = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;interface %s deactivated&quot;</span>, name);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            entry-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#abfcdafd79963dfa36b5703427c625048">flags</a> = msg-&gt;<a class="code" href="../../d2/d18/structifinfomsg.html#ab307fa542ef964c144bd6fce53e223a2">ifi_flags</a>;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aab751ce80fc2805f9803dda4726ddaf2">RTM_DELLINK</a>:</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            enumerator = this-&gt;ifaces-&gt;create_enumerator(this-&gt;ifaces);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, &amp;current))</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                <span class="keywordflow">if</span> (current-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">ifindex</a> == msg-&gt;<a class="code" href="../../d2/d18/structifinfomsg.html#a61de5e202571e2ce389b0c6d4aa24a4a">ifi_index</a>)</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a> &amp;&amp; current-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">usable</a>)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                        update = <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                        <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;interface %s deleted&quot;</span>, current-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">ifname</a>);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                    <span class="comment">/* TODO: move virtual IPs installed on this interface to</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">                     * another interface? */</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    this-&gt;ifaces-&gt;remove_at(this-&gt;ifaces, enumerator);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    current-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>-&gt;<a class="code" href="../../dc/de6/structlinked__list__t.html#abc2240775e98944ee4da05b35b374210">invoke_function</a>(current-&gt;<a class="code" href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">addrs</a>,</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                                (<span class="keywordtype">void</span>*)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#aaed5d0408522c487f320dcb1bc620d80">addr_entry_unregister</a>, current, <span class="keyword">this</span>);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a21cd8aae9699bfaca9118243ceda91df">iface_entry_destroy</a>(current);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">if</span> (update_routes &amp;&amp; <a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0f4d312f2e3ae7e2ef669ff35e21bee8">queue_route_reinstall</a>(<span class="keyword">this</span>, <a class="code" href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a>(name));</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordflow">if</span> (update &amp;&amp; <a class="code" href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a>)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0c5e768dcc201c5dbfcbed72326396da">fire_roam_event</a>(<span class="keyword">this</span>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;}</div>
<div class="ttc" id="structifinfomsg_html_ab307fa542ef964c144bd6fce53e223a2"><div class="ttname"><a href="../../d2/d18/structifinfomsg.html#ab307fa542ef964c144bd6fce53e223a2">ifinfomsg::ifi_flags</a></div><div class="ttdeci">unsigned ifi_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00472">rtnetlink.h:472</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a374ac181878db21a64f22a35b49237e1"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a374ac181878db21a64f22a35b49237e1">RTA_OK</a></div><div class="ttdeci">#define RTA_OK(rta, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00164">rtnetlink.h:164</a></div></div>
<div class="ttc" id="structifinfomsg_html_a61de5e202571e2ce389b0c6d4aa24a4a"><div class="ttname"><a href="../../d2/d18/structifinfomsg.html#a61de5e202571e2ce389b0c6d4aa24a4a">ifinfomsg::ifi_index</a></div><div class="ttdeci">int ifi_index</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00471">rtnetlink.h:471</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="cmac_8c_html_ab6ca46636c74b9241792379582ee7ce6"><div class="ttname"><a href="../../dc/d33/cmac_8c.html#ab6ca46636c74b9241792379582ee7ce6">update</a></div><div class="ttdeci">static bool update(private_mac_t *this, chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/cmac_8c_source.html#l00078">cmac.c:78</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a33d3a0bd02d90b6a9940413cdc7b2b8b"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a33d3a0bd02d90b6a9940413cdc7b2b8b">iface_entry_t::usable</a></div><div class="ttdeci">bool usable</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00154">kernel_netlink_net.c:154</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a42f61974b6169a0f37cb8f46e57db89d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a></div><div class="ttdeci">#define RTA_DATA(rta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00171">rtnetlink.h:171</a></div></div>
<div class="ttc" id="structiface__entry__t_html_af77daca88bd8077974e87a298418e1b4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#af77daca88bd8077974e87a298418e1b4">iface_entry_t::ifname</a></div><div class="ttdeci">char ifname[IFNAMSIZ]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00145">kernel_netlink_net.c:145</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a44a28287a4812f8e8101770a3cc94b87"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a44a28287a4812f8e8101770a3cc94b87">iface_entry_by_index</a></div><div class="ttdeci">static bool iface_entry_by_index(iface_entry_t *this, int *ifindex)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00169">kernel_netlink_net.c:169</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a07af6f6f3cbf507b32f187e9dc4b4336"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a07af6f6f3cbf507b32f187e9dc4b4336">RTA_NEXT</a></div><div class="ttdeci">#define RTA_NEXT(rta, attrlen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00167">rtnetlink.h:167</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="structiface__entry__t_html"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html">iface_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00139">kernel_netlink_net.c:139</a></div></div>
<div class="ttc" id="structnlmsghdr_html_abc588d6bfd91bcbf100709e57b7877df"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsghdr::nlmsg_type</a></div><div class="ttdeci">__u16 nlmsg_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00044">netlink.h:44</a></div></div>
<div class="ttc" id="structrtattr_html"><div class="ttname"><a href="../../d1/d03/structrtattr.html">rtattr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00155">rtnetlink.h:155</a></div></div>
<div class="ttc" id="group__linked__list_html_ga15bb4333e53dbef32d196e4388f43fdf"><div class="ttname"><a href="../../d3/dc0/group__linked__list.html#ga15bb4333e53dbef32d196e4388f43fdf">linked_list_create</a></div><div class="ttdeci">linked_list_t * linked_list_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/linked__list_8c_source.html#l00484">linked_list.c:484</a></div></div>
<div class="ttc" id="structrtattr_html_a23bd02894aef9ce3741ba36767ce2ede"><div class="ttname"><a href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rtattr::rta_type</a></div><div class="ttdeci">unsigned short rta_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtnetlink.h:157</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a1a08a8af40b92ca44f2e05c06dd601f4"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a1a08a8af40b92ca44f2e05c06dd601f4">iface_entry_t::ifindex</a></div><div class="ttdeci">int ifindex</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00142">kernel_netlink_net.c:142</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_aaed5d0408522c487f320dcb1bc620d80"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#aaed5d0408522c487f320dcb1bc620d80">addr_entry_unregister</a></div><div class="ttdeci">static void addr_entry_unregister(addr_entry_t *addr, iface_entry_t *iface, private_kernel_netlink_net_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00954">kernel_netlink_net.c:954</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="group__status__i_html_ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8"><div class="ttname"><a href="../../dc/d77/group__status__i.html#ggaf9bff8ff1154a04a899276af806b8586ac7f69f7c9e5aea9b8f54cf02870e2bf8">SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d13/status_8h_source.html#l00032">status.h:32</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9">RTM_NEWLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00026">rtnetlink.h:26</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600aab751ce80fc2805f9803dda4726ddaf2"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aab751ce80fc2805f9803dda4726ddaf2">RTM_DELLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00028">rtnetlink.h:28</a></div></div>
<div class="ttc" id="charon-svc_8c_html_a565d71e8ad36560cb72c7f6edd56ba63"><div class="ttname"><a href="../../dd/dcc/charon-svc_8c.html#a565d71e8ad36560cb72c7f6edd56ba63">event</a></div><div class="ttdeci">static HANDLE event</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcc/charon-svc_8c_source.html#l00041">charon-svc.c:41</a></div></div>
<div class="ttc" id="structhydra__t_html_adf646db4986ffd1d4aecade40cd53dac"><div class="ttname"><a href="../../dd/db5/structhydra__t.html#adf646db4986ffd1d4aecade40cd53dac">hydra_t::kernel_interface</a></div><div class="ttdeci">kernel_interface_t * kernel_interface</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d63/hydra_8h_source.html#l00046">hydra.h:46</a></div></div>
<div class="ttc" id="group__libhydra_html_ga35c899fffe25d189c598655cdf558dde"><div class="ttname"><a href="../../d6/d9d/group__libhydra.html#ga35c899fffe25d189c598655cdf558dde">hydra</a></div><div class="ttdeci">hydra_t * hydra</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6a/hydra_8c_source.html#l00046">hydra.c:46</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a21cd8aae9699bfaca9118243ceda91df"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a21cd8aae9699bfaca9118243ceda91df">iface_entry_destroy</a></div><div class="ttdeci">static void iface_entry_destroy(iface_entry_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00160">kernel_netlink_net.c:160</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__windows_html_ga9254b089d435892385cf14d0ab4a7a2d"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a></div><div class="ttdeci">#define strdup</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00099">windows.h:99</a></div></div>
<div class="ttc" id="structkernel__interface__t_html_a055edb216ddb9a3ca313ecc6d18b01cc"><div class="ttname"><a href="../../db/df8/structkernel__interface__t.html#a055edb216ddb9a3ca313ecc6d18b01cc">kernel_interface_t::is_interface_usable</a></div><div class="ttdeci">bool(* is_interface_usable)(kernel_interface_t *this, const char *iface)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/kernel__interface_8h_source.html#l00478">kernel_interface.h:478</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a388b18d13f3b29682afae599da369527"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a388b18d13f3b29682afae599da369527">private_kernel_netlink_net_t::ifaces</a></div><div class="ttdeci">linked_list_t * ifaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00396">kernel_netlink_net.c:396</a></div></div>
<div class="ttc" id="structiface__entry__t_html_a074ce3bd111ba07ab802a6c74063a5a2"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#a074ce3bd111ba07ab802a6c74063a5a2">iface_entry_t::addrs</a></div><div class="ttdeci">linked_list_t * addrs</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00151">kernel_netlink_net.c:151</a></div></div>
<div class="ttc" id="structlinked__list__t_html_abc2240775e98944ee4da05b35b374210"><div class="ttname"><a href="../../dc/de6/structlinked__list__t.html#abc2240775e98944ee4da05b35b374210">linked_list_t::invoke_function</a></div><div class="ttdeci">void(* invoke_function)(linked_list_t *this, linked_list_invoke_t function,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d4a/linked__list_8h_source.html#l00210">linked_list.h:210</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
<div class="ttc" id="dh__speed_8c_html_a1317e52dffbcbe14fbfd1bd5ac61fff9"><div class="ttname"><a href="../../d6/d1a/dh__speed_8c.html#a1317e52dffbcbe14fbfd1bd5ac61fff9">name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d1a/dh__speed_8c_source.html#l00030">dh_speed.c:30</a></div></div>
<div class="ttc" id="structiface__entry__t_html_abfcdafd79963dfa36b5703427c625048"><div class="ttname"><a href="../../d5/dd4/structiface__entry__t.html#abfcdafd79963dfa36b5703427c625048">iface_entry_t::flags</a></div><div class="ttdeci">u_int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00148">kernel_netlink_net.c:148</a></div></div>
<div class="ttc" id="structifinfomsg_html"><div class="ttname"><a href="../../d2/d18/structifinfomsg.html">ifinfomsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00467">rtnetlink.h:467</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0c5e768dcc201c5dbfcbed72326396da"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0c5e768dcc201c5dbfcbed72326396da">fire_roam_event</a></div><div class="ttdeci">static void fire_roam_event(private_kernel_netlink_net_t *this, bool address)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">kernel_netlink_net.c:904</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0f4d312f2e3ae7e2ef669ff35e21bee8"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0f4d312f2e3ae7e2ef669ff35e21bee8">queue_route_reinstall</a></div><div class="ttdeci">static void queue_route_reinstall(private_kernel_netlink_net_t *this, char *if_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">kernel_netlink_net.c:602</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-83" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-83-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-83-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-83-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0f87b0e61837c8bde853f9eda9756613_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-84" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-84-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-84-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-84-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0f87b0e61837c8bde853f9eda9756613_icgraph.svg" width="576" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa4ee1f950fc5de3ab43335aebf95aeed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void process_route </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *&#160;</td>
          <td class="paramname"><em>hdr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>process RTM_NEWROUTE and RTM_DELROUTE from kernel </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01215">1215</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00057">chunk_create()</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00130">host_t::destroy</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">fire_roam_event()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00848">get_interface_address()</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">host</a>, <a class="el" href="../../df/da9/host_8c_source.html#l00477">host_create_from_chunk()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00936">is_interface_up_and_usable()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00661">is_known_vip()</a>, <a class="el" href="../../d4/d2b/leak__detective_8c_source.html#l00160">lock</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00281">RT_TABLE_LOCAL</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00171">RTA_DATA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00167">RTA_NEXT</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00293">RTA_OIF</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00164">RTA_OK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00172">RTA_PAYLOAD</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00296">RTA_PREFSRC</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtattr::rta_type</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00269">RTM_F_CLONED</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00182">rtmsg::rtm_family</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00192">rtmsg::rtm_flags</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00316">RTM_PAYLOAD</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00315">RTM_RTA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00187">rtmsg::rtm_table</a>, and <a class="el" href="../../df/d63/spinlock_8h_source.html#l00042">spinlock_t::unlock</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01278">receive_events()</a>.</p>
<div class="fragment"><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;{</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a>* <a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a> = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d1/d03/structrtattr.html">rtattr</a> *rta = <a class="code" href="../../d9/d06/rtnetlink_8h.html#aba2657fb912970829e5131017f0f7728">RTM_RTA</a>(msg);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordtype">size_t</span> rtasize = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a845b50c0230af0fc532afec8c7c58aff">RTM_PAYLOAD</a>(hdr);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    u_int32_t rta_oif = 0;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a> = NULL;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="comment">/* ignore routes added by us or in the local routing table (local addrs) */</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtm_table</a> &amp;&amp; (msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtm_table</a> == this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a38e23f48e64d16e25a382402819ea77c">routing_table</a> ||</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                           msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtm_table</a> == <a class="code" href="../../d9/d06/rtnetlink_8h.html#a1b32484bdf929bdbdb9e71c201a8d6d7af2a0278bea827b3860ce7bb7c4aa3762">RT_TABLE_LOCAL</a>))</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#abc41f4a98d88f3f0927430504c9c81a1">rtm_flags</a> &amp; <a class="code" href="../../d9/d06/rtnetlink_8h.html#a9bdd2b4a3f6e819e37dbac3626353fc9">RTM_F_CLONED</a>)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    {   <span class="comment">/* ignore cached routes, seem to be created a lot for IPv6 */</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../d9/d06/rtnetlink_8h.html#a374ac181878db21a64f22a35b49237e1">RTA_OK</a>(rta, rtasize))</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordflow">switch</span> (rta-&gt;<a class="code" href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rta_type</a>)</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561">RTA_PREFSRC</a>:</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(host);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                host = <a class="code" href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a>(msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a>,</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                            <a class="code" href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a>(<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta), <a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta)), 0);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d">RTA_OIF</a>:</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a>(rta) == <span class="keyword">sizeof</span>(rta_oif))</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                    rta_oif = *(u_int32_t*)<a class="code" href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a>(rta);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        rta = <a class="code" href="../../d9/d06/rtnetlink_8h.html#a07af6f6f3cbf507b32f187e9dc4b4336">RTA_NEXT</a>(rta, rtasize);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;read_lock(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">if</span> (rta_oif &amp;&amp; !<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a5380f306f77b51da4bb8012386d5920e">is_interface_up_and_usable</a>(<span class="keyword">this</span>, rta_oif))</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    {   <span class="comment">/* ignore route changes for interfaces that are ignored or down */</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(host);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span> (!host &amp;&amp; rta_oif)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        host = <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af1bf8d0ca6eaf4ea6e8d04d791f73987">get_interface_address</a>(<span class="keyword">this</span>, rta_oif, msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtm_family</a>,</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                     NULL, NULL);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">if</span> (!host || <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a34793bb5a8a46b632833c292910b1f81">is_known_vip</a>(<span class="keyword">this</span>, host))</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    {   <span class="comment">/* ignore routes added for virtual IPs */</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(host);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>-&gt;<a class="code" href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">unlock</a>(this-&gt;<a class="code" href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a>);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0c5e768dcc201c5dbfcbed72326396da">fire_roam_event</a>(<span class="keyword">this</span>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(host);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;}</div>
<div class="ttc" id="test__traffic__selector_8c_html_a1c2046dcb30a629d6d9f45ff8f403f12"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">test_traffic_selector.c:403</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a374ac181878db21a64f22a35b49237e1"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a374ac181878db21a64f22a35b49237e1">RTA_OK</a></div><div class="ttdeci">#define RTA_OK(rta, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00164">rtnetlink.h:164</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173ab3ed253bec602077ac3bfffaaa9a9c7d">RTA_OIF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00293">rtnetlink.h:293</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_af1bf8d0ca6eaf4ea6e8d04d791f73987"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#af1bf8d0ca6eaf4ea6e8d04d791f73987">get_interface_address</a></div><div class="ttdeci">static host_t * get_interface_address(private_kernel_netlink_net_t *this, int ifindex, int family, host_t *dest, host_t *candidate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00848">kernel_netlink_net.c:848</a></div></div>
<div class="ttc" id="group__host_html_gaf40fcca3c58e789ff4f82bbf875727e4"><div class="ttname"><a href="../../d7/df1/group__host.html#gaf40fcca3c58e789ff4f82bbf875727e4">host_create_from_chunk</a></div><div class="ttdeci">host_t * host_create_from_chunk(int family, chunk_t address, u_int16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/host_8c_source.html#l00477">host.c:477</a></div></div>
<div class="ttc" id="leak__detective_8c_html_a9d715be33353e7c670f4a839ac4033de"><div class="ttname"><a href="../../d4/d2b/leak__detective_8c.html#a9d715be33353e7c670f4a839ac4033de">lock</a></div><div class="ttdeci">static spinlock_t * lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2b/leak__detective_8c_source.html#l00160">leak_detective.c:160</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a42f61974b6169a0f37cb8f46e57db89d"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a42f61974b6169a0f37cb8f46e57db89d">RTA_DATA</a></div><div class="ttdeci">#define RTA_DATA(rta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00171">rtnetlink.h:171</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a1b32484bdf929bdbdb9e71c201a8d6d7af2a0278bea827b3860ce7bb7c4aa3762"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a1b32484bdf929bdbdb9e71c201a8d6d7af2a0278bea827b3860ce7bb7c4aa3762">RT_TABLE_LOCAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00281">rtnetlink.h:281</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a9bdd2b4a3f6e819e37dbac3626353fc9"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a9bdd2b4a3f6e819e37dbac3626353fc9">RTM_F_CLONED</a></div><div class="ttdeci">#define RTM_F_CLONED</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00269">rtnetlink.h:269</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a07af6f6f3cbf507b32f187e9dc4b4336"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a07af6f6f3cbf507b32f187e9dc4b4336">RTA_NEXT</a></div><div class="ttdeci">#define RTA_NEXT(rta, attrlen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00167">rtnetlink.h:167</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a38e23f48e64d16e25a382402819ea77c"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a38e23f48e64d16e25a382402819ea77c">private_kernel_netlink_net_t::routing_table</a></div><div class="ttdeci">int routing_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00436">kernel_netlink_net.c:436</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ac4fb73b9e0bbdbc8a639619e800d8173a4922fd1100ea005e98252b103cb75561">RTA_PREFSRC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00296">rtnetlink.h:296</a></div></div>
<div class="ttc" id="structrtmsg_html_abc41f4a98d88f3f0927430504c9c81a1"><div class="ttname"><a href="../../da/d53/structrtmsg.html#abc41f4a98d88f3f0927430504c9c81a1">rtmsg::rtm_flags</a></div><div class="ttdeci">unsigned rtm_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00192">rtnetlink.h:192</a></div></div>
<div class="ttc" id="structrtattr_html"><div class="ttname"><a href="../../d1/d03/structrtattr.html">rtattr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00155">rtnetlink.h:155</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="structrtattr_html_a23bd02894aef9ce3741ba36767ce2ede"><div class="ttname"><a href="../../d1/d03/structrtattr.html#a23bd02894aef9ce3741ba36767ce2ede">rtattr::rta_type</a></div><div class="ttdeci">unsigned short rta_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00157">rtnetlink.h:157</a></div></div>
<div class="ttc" id="structrtmsg_html_a2295e2054ab275a89be3c681a630a8e9"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a2295e2054ab275a89be3c681a630a8e9">rtmsg::rtm_family</a></div><div class="ttdeci">unsigned char rtm_family</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00182">rtnetlink.h:182</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a9c7e775ba76d89b27381d7085c4cce79"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a9c7e775ba76d89b27381d7085c4cce79">RTA_PAYLOAD</a></div><div class="ttdeci">#define RTA_PAYLOAD(rta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00172">rtnetlink.h:172</a></div></div>
<div class="ttc" id="group__chunk_html_gad94ca029616a107e89eaa618408fd7b6"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gad94ca029616a107e89eaa618408fd7b6">chunk_create</a></div><div class="ttdeci">static chunk_t chunk_create(u_char *ptr, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00057">chunk.h:57</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_a845b50c0230af0fc532afec8c7c58aff"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#a845b50c0230af0fc532afec8c7c58aff">RTM_PAYLOAD</a></div><div class="ttdeci">#define RTM_PAYLOAD(n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00316">rtnetlink.h:316</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a34793bb5a8a46b632833c292910b1f81"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a34793bb5a8a46b632833c292910b1f81">is_known_vip</a></div><div class="ttdeci">static bool is_known_vip(private_kernel_netlink_net_t *this, host_t *ip)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00661">kernel_netlink_net.c:661</a></div></div>
<div class="ttc" id="structrtmsg_html"><div class="ttname"><a href="../../da/d53/structrtmsg.html">rtmsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00181">rtnetlink.h:181</a></div></div>
<div class="ttc" id="structspinlock__t_html_a5269d013e192f6f216a70c2d78ee15a2"><div class="ttname"><a href="../../d9/dda/structspinlock__t.html#a5269d013e192f6f216a70c2d78ee15a2">spinlock_t::unlock</a></div><div class="ttdeci">void(* unlock)(spinlock_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d63/spinlock_8h_source.html#l00042">spinlock.h:42</a></div></div>
<div class="ttc" id="structhost__t_html_af9703b61f348ea0409dc9cb197b2b788"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">host_t::destroy</a></div><div class="ttdeci">void(* destroy)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00130">host.h:130</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
<div class="ttc" id="structrtmsg_html_a72deabb274ce59c11db0e21e7aeb8de7"><div class="ttname"><a href="../../da/d53/structrtmsg.html#a72deabb274ce59c11db0e21e7aeb8de7">rtmsg::rtm_table</a></div><div class="ttdeci">unsigned char rtm_table</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00187">rtnetlink.h:187</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_aba2657fb912970829e5131017f0f7728"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#aba2657fb912970829e5131017f0f7728">RTM_RTA</a></div><div class="ttdeci">#define RTM_RTA(r)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00315">rtnetlink.h:315</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a5380f306f77b51da4bb8012386d5920e"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a5380f306f77b51da4bb8012386d5920e">is_interface_up_and_usable</a></div><div class="ttdeci">static bool is_interface_up_and_usable(private_kernel_netlink_net_t *this, int index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00936">kernel_netlink_net.c:936</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0c5e768dcc201c5dbfcbed72326396da"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0c5e768dcc201c5dbfcbed72326396da">fire_roam_event</a></div><div class="ttdeci">static void fire_roam_event(private_kernel_netlink_net_t *this, bool address)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">kernel_netlink_net.c:904</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-85" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-85-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-85-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-85-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aa4ee1f950fc5de3ab43335aebf95aeed_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-86" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-86-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-86-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-86-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aa4ee1f950fc5de3ab43335aebf95aeed_icgraph.svg" width="579" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0f4d312f2e3ae7e2ef669ff35e21bee8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void queue_route_reinstall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>if_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Queue route reinstallation caused by network changes for a given interface.</p>
<p>The route reinstallation is delayed for a while and only done once for several calls during this delay, in order to avoid doing it too often. The interface name is freed. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">602</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d5/d84/callback__job_8c_source.html#l00127">callback_job_create()</a>, <a class="el" href="../../da/dfc/test__enum_8c_source.html#l00156">found</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00350">net_change_destroy()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00552">reinstall_routes()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00068">ROUTE_DELAY</a>, <a class="el" href="../../d2/dd8/scheduler_8h_source.html#l00097">scheduler_t::schedule_job_ms</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00220">library_t::scheduler</a>, <a class="el" href="../../df/d73/time_8c_source.html#l00031">time_monotonic()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00063">timeval_add_ms()</a>, and <a class="el" href="../../dc/d33/cmac_8c_source.html#l00078">update()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01970">METHOD()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">process_addr()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">process_link()</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;{</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *<a class="code" href="../../dc/d33/cmac_8c.html#ab6ca46636c74b9241792379582ee7ce6">update</a>, *<a class="code" href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="../../d9/df9/group__time__i.html#gaeba0d8f51eb0a83c2b01ecf27e0b3260">timeval_t</a> now;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="../../d2/d68/structjob__t.html">job_t</a> *job;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(update,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        .if_name = if_name</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    );</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    this-&gt;net_changes_lock-&gt;lock(this-&gt;net_changes_lock);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    found = this-&gt;net_changes-&gt;put(this-&gt;net_changes, update, update);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> (found)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a56a31ce09ddc60d87a5b04e50ca3de67">net_change_destroy</a>(found);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="../../d9/df9/group__time__i.html#gafa0e4f2038e67e1bb455fb3730f59a1e">time_monotonic</a>(&amp;now);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">if</span> (timercmp(&amp;now, &amp;this-&gt;last_route_reinstall, &gt;))</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <a class="code" href="../../d9/df9/group__time__i.html#gae899a18c6fe769db669751008f13e360">timeval_add_ms</a>(&amp;now, <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a96f22cfbf0c80c9849f9fc765f9bd2c5">ROUTE_DELAY</a>);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        this-&gt;last_route_reinstall = now;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        job = (<a class="code" href="../../d2/d68/structjob__t.html">job_t</a>*)<a class="code" href="../../d0/d8f/group__callback__job.html#ga6934f856d27d82413610263e27a5cfa1">callback_job_create</a>((<a class="code" href="../../d0/d8f/group__callback__job.html#ga8f3d8c9efd643a62a07bd0709aa45f08">callback_job_cb_t</a>)<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#af3cebb1319733db373466a7b44f0aebf">reinstall_routes</a>,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                          <span class="keyword">this</span>, NULL, NULL);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a4a3d65df74a3b5aa043fd799cc776bee">scheduler</a>-&gt;<a class="code" href="../../d2/d3c/structscheduler__t.html#ac98edbbabf818fb9a38040ca99eac8a9">schedule_job_ms</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a4a3d65df74a3b5aa043fd799cc776bee">scheduler</a>, job, <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a96f22cfbf0c80c9849f9fc765f9bd2c5">ROUTE_DELAY</a>);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    this-&gt;net_changes_lock-&gt;unlock(this-&gt;net_changes_lock);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;}</div>
<div class="ttc" id="test__enum_8c_html_a7141f237b2648c631ce5b73215683565"><div class="ttname"><a href="../../da/dfc/test__enum_8c.html#a7141f237b2648c631ce5b73215683565">found</a></div><div class="ttdeci">bool found</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/test__enum_8c_source.html#l00156">test_enum.c:156</a></div></div>
<div class="ttc" id="cmac_8c_html_ab6ca46636c74b9241792379582ee7ce6"><div class="ttname"><a href="../../dc/d33/cmac_8c.html#ab6ca46636c74b9241792379582ee7ce6">update</a></div><div class="ttdeci">static bool update(private_mac_t *this, chunk_t data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d33/cmac_8c_source.html#l00078">cmac.c:78</a></div></div>
<div class="ttc" id="group__time__i_html_gafa0e4f2038e67e1bb455fb3730f59a1e"><div class="ttname"><a href="../../d9/df9/group__time__i.html#gafa0e4f2038e67e1bb455fb3730f59a1e">time_monotonic</a></div><div class="ttdeci">time_t time_monotonic(timeval_t *tv)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d73/time_8c_source.html#l00031">time.c:31</a></div></div>
<div class="ttc" id="structnet__change__t_html"><div class="ttname"><a href="../../df/d6f/structnet__change__t.html">net_change_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00342">kernel_netlink_net.c:342</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a96f22cfbf0c80c9849f9fc765f9bd2c5"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a96f22cfbf0c80c9849f9fc765f9bd2c5">ROUTE_DELAY</a></div><div class="ttdeci">#define ROUTE_DELAY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00068">kernel_netlink_net.c:68</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="structlibrary__t_html_a4a3d65df74a3b5aa043fd799cc776bee"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a4a3d65df74a3b5aa043fd799cc776bee">library_t::scheduler</a></div><div class="ttdeci">scheduler_t * scheduler</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00220">library.h:220</a></div></div>
<div class="ttc" id="structscheduler__t_html_ac98edbbabf818fb9a38040ca99eac8a9"><div class="ttname"><a href="../../d2/d3c/structscheduler__t.html#ac98edbbabf818fb9a38040ca99eac8a9">scheduler_t::schedule_job_ms</a></div><div class="ttdeci">void(* schedule_job_ms)(scheduler_t *this, job_t *job, u_int32_t ms)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dd8/scheduler_8h_source.html#l00097">scheduler.h:97</a></div></div>
<div class="ttc" id="group__callback__job_html_ga8f3d8c9efd643a62a07bd0709aa45f08"><div class="ttname"><a href="../../d0/d8f/group__callback__job.html#ga8f3d8c9efd643a62a07bd0709aa45f08">callback_job_cb_t</a></div><div class="ttdeci">job_requeue_t(* callback_job_cb_t)(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/ddd/callback__job_8h_source.html#l00040">callback_job.h:40</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a56a31ce09ddc60d87a5b04e50ca3de67"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a56a31ce09ddc60d87a5b04e50ca3de67">net_change_destroy</a></div><div class="ttdeci">static void net_change_destroy(net_change_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00350">kernel_netlink_net.c:350</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="group__time__i_html_gae899a18c6fe769db669751008f13e360"><div class="ttname"><a href="../../d9/df9/group__time__i.html#gae899a18c6fe769db669751008f13e360">timeval_add_ms</a></div><div class="ttdeci">static void timeval_add_ms(timeval_t *tv, u_int ms)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00063">time.h:63</a></div></div>
<div class="ttc" id="structjob__t_html"><div class="ttname"><a href="../../d2/d68/structjob__t.html">job_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6a/job_8h_source.html#l00119">job.h:119</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_af3cebb1319733db373466a7b44f0aebf"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#af3cebb1319733db373466a7b44f0aebf">reinstall_routes</a></div><div class="ttdeci">static job_requeue_t reinstall_routes(private_kernel_netlink_net_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00552">kernel_netlink_net.c:552</a></div></div>
<div class="ttc" id="group__time__i_html_gaeba0d8f51eb0a83c2b01ecf27e0b3260"><div class="ttname"><a href="../../d9/df9/group__time__i.html#gaeba0d8f51eb0a83c2b01ecf27e0b3260">timeval_t</a></div><div class="ttdeci">struct timeval timeval_t</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00038">time.h:38</a></div></div>
<div class="ttc" id="group__callback__job_html_ga6934f856d27d82413610263e27a5cfa1"><div class="ttname"><a href="../../d0/d8f/group__callback__job.html#ga6934f856d27d82413610263e27a5cfa1">callback_job_create</a></div><div class="ttdeci">callback_job_t * callback_job_create(callback_job_cb_t cb, void *data, callback_job_cleanup_t cleanup, callback_job_cancel_t cancel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d84/callback__job_8c_source.html#l00127">callback_job.c:127</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-87" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-87-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-87-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-87-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0f4d312f2e3ae7e2ef669ff35e21bee8_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-88" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-88-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-88-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-88-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a0f4d312f2e3ae7e2ef669ff35e21bee8_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aadc72ac0ee4c3eee050dcde86c5230d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> receive_events </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d2f/group__watcher.html#ga0ef1a504b06dd8f3ab0d73f0ee8d8a13">watcher_event_t</a>&#160;</td>
          <td class="paramname"><em>event</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Receives events from kernel </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01278">1278</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../d4/d9b/bus_8h_source.html#l00053">DBG1</a>, <a class="el" href="../../db/d16/debug_8h_source.html#l00048">DBG_KNL</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">len</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00272">MSG_DONTWAIT</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00038">sockaddr_nl::nl_pid</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00085">NLMSG_NEXT</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00087">NLMSG_OK</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00044">nlmsghdr::nlmsg_type</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">process_addr()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">process_link()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01215">process_route()</a>, <a class="el" href="../../d2/d6e/apple_8h_source.html#l00074">recvfrom</a>, <a class="el" href="../../dd/deb/eap__mschapv2_8c.html#a802a59b89beb732f00fc45271d6e46e5">response</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00037">RTM_DELADDR</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00028">RTM_DELLINK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00044">RTM_DELROUTE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00035">RTM_NEWADDR</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00026">RTM_NEWLINK</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00042">RTM_NEWROUTE</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00084">sleep</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;{</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="../../dd/deb/eap__mschapv2_8c.html#a802a59b89beb732f00fc45271d6e46e5">response</a>[1536];</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *hdr = (<span class="keyword">struct </span><a class="code" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a>*)response;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../d6/d8c/structsockaddr__nl.html">sockaddr_nl</a> <a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    socklen_t addr_len = <span class="keyword">sizeof</span>(<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    len = <a class="code" href="../../d2/d21/group__apple.html#ga3102fdddc55c0c8906c40365b5b2fa71">recvfrom</a>(this-&gt;socket_events, response, <span class="keyword">sizeof</span>(response),</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                   <a class="code" href="../../da/d9b/group__windows.html#gab18d3d439e4a9c8d0f73e7166e8eb376">MSG_DONTWAIT</a>, (<span class="keyword">struct</span> sockaddr*)&amp;<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>, &amp;addr_len);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">if</span> (len &lt; 0)</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        <span class="keywordflow">switch</span> (errno)</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        {</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            <span class="keywordflow">case</span> EINTR:</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <span class="comment">/* interrupted, try again */</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            <span class="keywordflow">case</span> EAGAIN:</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                <span class="comment">/* no data ready, select again */</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <a class="code" href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a>(<a class="code" href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a>, <span class="stringliteral">&quot;unable to receive from rt event socket&quot;</span>);</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                <a class="code" href="../../da/d9b/group__windows.html#gacc8612feeec5f569b1e096e3110d0dca">sleep</a>(1);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    }</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a>.nl_pid != 0)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    {   <span class="comment">/* not from kernel. not interested, try another one */</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../de/d4c/netlink_8h.html#a2e67cb7b703696efae9909fbeba5616d">NLMSG_OK</a>(hdr, len))</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="comment">/* looks good so far, dispatch netlink message */</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">switch</span> (hdr-&gt;<a class="code" href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsg_type</a>)</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a>:</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f">RTM_DELADDR</a>:</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a524a440e79bfb8f59290902a14bb30e8">process_addr</a>(<span class="keyword">this</span>, hdr, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9">RTM_NEWLINK</a>:</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aab751ce80fc2805f9803dda4726ddaf2">RTM_DELLINK</a>:</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0f87b0e61837c8bde853f9eda9756613">process_link</a>(<span class="keyword">this</span>, hdr, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a>:</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471">RTM_DELROUTE</a>:</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <span class="keywordflow">if</span> (this-&gt;<a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#aa4ee1f950fc5de3ab43335aebf95aeed">process_route</a>)</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                {</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#aa4ee1f950fc5de3ab43335aebf95aeed">process_route</a>(<span class="keyword">this</span>, hdr);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        }</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        hdr = <a class="code" href="../../de/d4c/netlink_8h.html#a533f12f954dec43e08cfaff6dcf9c751">NLMSG_NEXT</a>(hdr, len);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;}</div>
<div class="ttc" id="group__windows_html_gab18d3d439e4a9c8d0f73e7166e8eb376"><div class="ttname"><a href="../../da/d9b/group__windows.html#gab18d3d439e4a9c8d0f73e7166e8eb376">MSG_DONTWAIT</a></div><div class="ttdeci">#define MSG_DONTWAIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00272">windows.h:272</a></div></div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aef23b6be96b2c2cb58c8cb8a56a9a54f">RTM_DELADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00037">rtnetlink.h:37</a></div></div>
<div class="ttc" id="group__debug_html_gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2"><div class="ttname"><a href="../../de/db7/group__debug.html#gga7e9915df78adc12ef31cc2a7b2b1e2ffaa77875b2c8ef9dbf586e70ed900501c2">DBG_KNL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d16/debug_8h_source.html#l00048">debug.h:48</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a524a440e79bfb8f59290902a14bb30e8"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a524a440e79bfb8f59290902a14bb30e8">process_addr</a></div><div class="ttdeci">static void process_addr(private_kernel_netlink_net_t *this, struct nlmsghdr *hdr, bool event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01071">kernel_netlink_net.c:1071</a></div></div>
<div class="ttc" id="group__apple_html_ga3102fdddc55c0c8906c40365b5b2fa71"><div class="ttname"><a href="../../d2/d21/group__apple.html#ga3102fdddc55c0c8906c40365b5b2fa71">recvfrom</a></div><div class="ttdeci">#define recvfrom</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/apple_8h_source.html#l00074">apple.h:74</a></div></div>
<div class="ttc" id="structnlmsghdr_html"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html">nlmsghdr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00042">netlink.h:42</a></div></div>
<div class="ttc" id="structnlmsghdr_html_abc588d6bfd91bcbf100709e57b7877df"><div class="ttname"><a href="../../df/d65/structnlmsghdr.html#abc588d6bfd91bcbf100709e57b7877df">nlmsghdr::nlmsg_type</a></div><div class="ttdeci">__u16 nlmsg_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00044">netlink.h:44</a></div></div>
<div class="ttc" id="netlink_8h_html_a533f12f954dec43e08cfaff6dcf9c751"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a533f12f954dec43e08cfaff6dcf9c751">NLMSG_NEXT</a></div><div class="ttdeci">#define NLMSG_NEXT(nlh, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00085">netlink.h:85</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00042">rtnetlink.h:42</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aea96b09cdd621a0632116e2081ac5471">RTM_DELROUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00044">rtnetlink.h:44</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac32f34c78397fe34b031f9400241ce0f">RTM_NEWADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00035">rtnetlink.h:35</a></div></div>
<div class="ttc" id="group__bus_html_gab6331f4db667f2aa9a269311605425d2"><div class="ttname"><a href="../../de/d50/group__bus.html#gab6331f4db667f2aa9a269311605425d2">DBG1</a></div><div class="ttdeci">#define DBG1(group, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d9b/bus_8h_source.html#l00053">bus.h:53</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600abed7a52e59e1172bcb7472b60e4c89b9">RTM_NEWLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00026">rtnetlink.h:26</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600aab751ce80fc2805f9803dda4726ddaf2"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600aab751ce80fc2805f9803dda4726ddaf2">RTM_DELLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00028">rtnetlink.h:28</a></div></div>
<div class="ttc" id="netlink_8h_html_a2e67cb7b703696efae9909fbeba5616d"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a2e67cb7b703696efae9909fbeba5616d">NLMSG_OK</a></div><div class="ttdeci">#define NLMSG_OK(nlh, len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00087">netlink.h:87</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a2b341e3994bfbc0aa8d680205abbd28b"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a></div><div class="ttdeci">u_int16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">duplicheck_msg.h:45</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structsockaddr__nl_html"><div class="ttname"><a href="../../d6/d8c/structsockaddr__nl.html">sockaddr_nl</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00035">netlink.h:35</a></div></div>
<div class="ttc" id="group__windows_html_gacc8612feeec5f569b1e096e3110d0dca"><div class="ttname"><a href="../../da/d9b/group__windows.html#gacc8612feeec5f569b1e096e3110d0dca">sleep</a></div><div class="ttdeci">#define sleep</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00084">windows.h:84</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0f87b0e61837c8bde853f9eda9756613"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0f87b0e61837c8bde853f9eda9756613">process_link</a></div><div class="ttdeci">static void process_link(private_kernel_netlink_net_t *this, struct nlmsghdr *hdr, bool event)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">kernel_netlink_net.c:969</a></div></div>
<div class="ttc" id="eap__mschapv2_8c_html_a802a59b89beb732f00fc45271d6e46e5"><div class="ttname"><a href="../../dd/deb/eap__mschapv2_8c.html#a802a59b89beb732f00fc45271d6e46e5">response</a></div><div class="ttdeci">struct @28 response</div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_aa4ee1f950fc5de3ab43335aebf95aeed"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#aa4ee1f950fc5de3ab43335aebf95aeed">process_route</a></div><div class="ttdeci">static void process_route(private_kernel_netlink_net_t *this, struct nlmsghdr *hdr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l01215">kernel_netlink_net.c:1215</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-89" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-89-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-89-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-89-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aadc72ac0ee4c3eee050dcde86c5230d6_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-90" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-90-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-90-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-90-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_aadc72ac0ee4c3eee050dcde86c5230d6_icgraph.svg" width="427" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="af3cebb1319733db373466a7b44f0aebf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d63/structjob__requeue__t.html">job_requeue_t</a> reinstall_routes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Act upon queued network changes. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00552">552</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator_t::destroy</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00109">route_entry_t::dst_net</a>, <a class="el" href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator_t::enumerate</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00107">route_entry_t::gateway</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00103">route_entry_t::if_name</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00344">net_change_t::if_name</a>, <a class="el" href="../../d3/d6a/job_8h_source.html#l00108">JOB_REQUEUE_NONE</a>, <a class="el" href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">lookup</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">manage_srcroute()</a>, <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00535">net_changes_clear()</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00067">NLM_F_CREATE</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00066">NLM_F_EXCL</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00111">route_entry_t::prefixlen</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00042">RTM_NEWROUTE</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00105">route_entry_t::src_ip</a>, and <a class="el" href="../../da/d66/string_8h_source.html#l00028">streq()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00602">queue_route_reinstall()</a>.</p>
<div class="fragment"><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;{</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *enumerator;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *route;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    this-&gt;net_changes_lock-&gt;lock(this-&gt;net_changes_lock);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    this-&gt;routes_lock-&gt;lock(this-&gt;routes_lock);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    enumerator = this-&gt;routes-&gt;create_enumerator(this-&gt;routes);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">while</span> (enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerate</a>(enumerator, NULL, (<span class="keywordtype">void</span>**)&amp;route))</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="../../df/d6f/structnet__change__t.html">net_change_t</a> *change, <a class="code" href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a> = {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            .if_name = route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">if_name</a>,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        };</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="comment">/* check if a change for the outgoing interface is queued */</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        change = this-&gt;net_changes-&gt;get(this-&gt;net_changes, &amp;lookup);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordflow">if</span> (!change)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        {   <span class="comment">/* in case src_ip is not on the outgoing interface */</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<span class="keyword">public</span>.interface.get_interface(&amp;this-&gt;<a class="code" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a239043d2e6ef663f05227d976e7a6c1a">public</a>.<a class="code" href="../../df/d59/structkernel__netlink__net__t.html#a6e980f5ff408867aba49afceccd20822">interface</a>,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                                route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">src_ip</a>, &amp;lookup.<a class="code" href="../../df/d6f/structnet__change__t.html#ae443c87b68649f6a6c38e36c124275b7">if_name</a>))</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d40/group__string__i.html#ga65c3d08890165aaa4663c72d07f93bb7">streq</a>(lookup.<a class="code" href="../../df/d6f/structnet__change__t.html#ae443c87b68649f6a6c38e36c124275b7">if_name</a>, route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">if_name</a>))</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                    change = this-&gt;net_changes-&gt;get(this-&gt;net_changes, &amp;lookup);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(lookup.<a class="code" href="../../df/d6f/structnet__change__t.html#ae443c87b68649f6a6c38e36c124275b7">if_name</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">if</span> (change)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a>(<span class="keyword">this</span>, <a class="code" href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a>, <a class="code" href="../../de/d4c/netlink_8h.html#a20a00ae52e4c150f54649d7346d23a7a">NLM_F_CREATE</a> | <a class="code" href="../../de/d4c/netlink_8h.html#a0b0f8c9581ee93747c7d9e94ca0e0596">NLM_F_EXCL</a>,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                            route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a791ee71e6e19dd2e3bd95716b031de00">dst_net</a>, route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a637604b34e72c11f5b70e36533a78db4">prefixlen</a>, route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a>,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                            route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">src_ip</a>, route-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">if_name</a>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    enumerator-&gt;<a class="code" href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">destroy</a>(enumerator);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    this-&gt;routes_lock-&gt;unlock(this-&gt;routes_lock);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="../../d5/d90/kernel__netlink__net_8c.html#ad005c300e70718321d1b8550ccb476af">net_changes_clear</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    this-&gt;net_changes_lock-&gt;unlock(this-&gt;net_changes_lock);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;}</div>
<div class="ttc" id="proposal__keywords__static_8c_html_a85d2eea012c83b4dd2615d97bddbffc8"><div class="ttname"><a href="../../d5/d9b/proposal__keywords__static_8c.html#a85d2eea012c83b4dd2615d97bddbffc8">lookup</a></div><div class="ttdeci">static const short lookup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d9b/proposal__keywords__static_8c_source.html#l00288">proposal_keywords_static.c:288</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a0a710843eb1c0183af31b41b07bf76b0"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">route_entry_t::src_ip</a></div><div class="ttdeci">host_t * src_ip</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00105">kernel_libipsec_ipsec.c:105</a></div></div>
<div class="ttc" id="structnet__change__t_html"><div class="ttname"><a href="../../df/d6f/structnet__change__t.html">net_change_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00342">kernel_netlink_net.c:342</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a791ee71e6e19dd2e3bd95716b031de00"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a791ee71e6e19dd2e3bd95716b031de00">route_entry_t::dst_net</a></div><div class="ttdeci">chunk_t dst_net</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00109">kernel_libipsec_ipsec.c:109</a></div></div>
<div class="ttc" id="group__job_html_ga7a4d84fe5043983e82b3e0bbf80218e9"><div class="ttname"><a href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a></div><div class="ttdeci">#define JOB_REQUEUE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6a/job_8h_source.html#l00108">job.h:108</a></div></div>
<div class="ttc" id="structenumerator__t_html_a56c66aa7f0314f87d79aa61aac16c1ca"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a56c66aa7f0314f87d79aa61aac16c1ca">enumerator_t::destroy</a></div><div class="ttdeci">void(* destroy)(enumerator_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00048">enumerator.h:48</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#abed82baf7f470b522273a3e37c24c600ac2946a0250567ebcbea47141faff48b0">RTM_NEWROUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00042">rtnetlink.h:42</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a637604b34e72c11f5b70e36533a78db4"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a637604b34e72c11f5b70e36533a78db4">route_entry_t::prefixlen</a></div><div class="ttdeci">u_int8_t prefixlen</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00111">kernel_libipsec_ipsec.c:111</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a0cfdaa8399a8c743f7eaa5e98428802f"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">route_entry_t::if_name</a></div><div class="ttdeci">char * if_name</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00103">kernel_libipsec_ipsec.c:103</a></div></div>
<div class="ttc" id="structenumerator__t_html_a38cd1d97cc0f06351f701546e896aaf7"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html#a38cd1d97cc0f06351f701546e896aaf7">enumerator_t::enumerate</a></div><div class="ttdeci">bool(* enumerate)(enumerator_t *this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00043">enumerator.h:43</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="structroute__entry__t_html"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html">route_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00101">kernel_libipsec_ipsec.c:101</a></div></div>
<div class="ttc" id="netlink_8h_html_a0b0f8c9581ee93747c7d9e94ca0e0596"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a0b0f8c9581ee93747c7d9e94ca0e0596">NLM_F_EXCL</a></div><div class="ttdeci">#define NLM_F_EXCL</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00066">netlink.h:66</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_ad005c300e70718321d1b8550ccb476af"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#ad005c300e70718321d1b8550ccb476af">net_changes_clear</a></div><div class="ttdeci">static void net_changes_clear(private_kernel_netlink_net_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00535">kernel_netlink_net.c:535</a></div></div>
<div class="ttc" id="group__string__i_html_ga65c3d08890165aaa4663c72d07f93bb7"><div class="ttname"><a href="../../d4/d40/group__string__i.html#ga65c3d08890165aaa4663c72d07f93bb7">streq</a></div><div class="ttdeci">static bool streq(const char *x, const char *y)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d66/string_8h_source.html#l00028">string.h:28</a></div></div>
<div class="ttc" id="structkernel__netlink__net__t_html_a6e980f5ff408867aba49afceccd20822"><div class="ttname"><a href="../../df/d59/structkernel__netlink__net__t.html#a6e980f5ff408867aba49afceccd20822">kernel_netlink_net_t::interface</a></div><div class="ttdeci">kernel_net_t interface</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da7/kernel__netlink__net_8h_source.html#l00036">kernel_netlink_net.h:36</a></div></div>
<div class="ttc" id="netlink_8h_html_a20a00ae52e4c150f54649d7346d23a7a"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a20a00ae52e4c150f54649d7346d23a7a">NLM_F_CREATE</a></div><div class="ttdeci">#define NLM_F_CREATE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00067">netlink.h:67</a></div></div>
<div class="ttc" id="structenumerator__t_html"><div class="ttname"><a href="../../db/dd3/structenumerator__t.html">enumerator_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d47/enumerator_8h_source.html#l00032">enumerator.h:32</a></div></div>
<div class="ttc" id="kernel__netlink__net_8c_html_a0fb4225c5228122371f3ef9fe600c523"><div class="ttname"><a href="../../d5/d90/kernel__netlink__net_8c.html#a0fb4225c5228122371f3ef9fe600c523">manage_srcroute</a></div><div class="ttdeci">static status_t manage_srcroute(private_kernel_netlink_net_t *this, int nlmsg_type, int flags, chunk_t dst_net, u_int8_t prefixlen, host_t *gateway, host_t *src_ip, char *if_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l02144">kernel_netlink_net.c:2144</a></div></div>
<div class="ttc" id="structprivate__kernel__netlink__net__t_html_a239043d2e6ef663f05227d976e7a6c1a"><div class="ttname"><a href="../../d7/d5f/structprivate__kernel__netlink__net__t.html#a239043d2e6ef663f05227d976e7a6c1a">private_kernel_netlink_net_t::public</a></div><div class="ttdeci">kernel_netlink_net_t public</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00381">kernel_netlink_net.c:381</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a4fd0d4902ebe96633cc03703529d5bc1"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">route_entry_t::gateway</a></div><div class="ttdeci">host_t * gateway</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00107">kernel_libipsec_ipsec.c:107</a></div></div>
<div class="ttc" id="structnet__change__t_html_ae443c87b68649f6a6c38e36c124275b7"><div class="ttname"><a href="../../df/d6f/structnet__change__t.html#ae443c87b68649f6a6c38e36c124275b7">net_change_t::if_name</a></div><div class="ttdeci">char * if_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d90/kernel__netlink__net_8c_source.html#l00344">kernel_netlink_net.c:344</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-91" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-91-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-91-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-91-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af3cebb1319733db373466a7b44f0aebf_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-92" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-92-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-92-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-92-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af3cebb1319733db373466a7b44f0aebf_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6845422ba132bb780bdc513b2c846d64"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d63/structjob__requeue__t.html">job_requeue_t</a> roam_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d5f/structprivate__kernel__netlink__net__t.html">private_kernel_netlink_net_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>callback function that raises the delayed roam event </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00888">888</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../de/d6a/hydra_8c_source.html#l00046">hydra</a>, <a class="el" href="../../d3/d6a/job_8h_source.html#l00108">JOB_REQUEUE_NONE</a>, <a class="el" href="../../dc/d63/hydra_8h_source.html#l00046">hydra_t::kernel_interface</a>, and <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00608">kernel_interface_t::roam</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00904">fire_roam_event()</a>.</p>
<div class="fragment"><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;{</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="keywordtype">bool</span> address;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    this-&gt;roam_lock-&gt;lock(this-&gt;roam_lock);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    address = this-&gt;roam_address;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    this-&gt;roam_address = <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    this-&gt;roam_lock-&gt;unlock(this-&gt;roam_lock);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <a class="code" href="../../d6/d9d/group__libhydra.html#ga35c899fffe25d189c598655cdf558dde">hydra</a>-&gt;<a class="code" href="../../dd/db5/structhydra__t.html#adf646db4986ffd1d4aecade40cd53dac">kernel_interface</a>-&gt;<a class="code" href="../../db/df8/structkernel__interface__t.html#a887872145a07ba929fa39bd93b4c03b5">roam</a>(<a class="code" href="../../d6/d9d/group__libhydra.html#ga35c899fffe25d189c598655cdf558dde">hydra</a>-&gt;<a class="code" href="../../dd/db5/structhydra__t.html#adf646db4986ffd1d4aecade40cd53dac">kernel_interface</a>, address);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structkernel__interface__t_html_a887872145a07ba929fa39bd93b4c03b5"><div class="ttname"><a href="../../db/df8/structkernel__interface__t.html#a887872145a07ba929fa39bd93b4c03b5">kernel_interface_t::roam</a></div><div class="ttdeci">void(* roam)(kernel_interface_t *this, bool address)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d8e/kernel__interface_8h_source.html#l00608">kernel_interface.h:608</a></div></div>
<div class="ttc" id="group__job_html_ga7a4d84fe5043983e82b3e0bbf80218e9"><div class="ttname"><a href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a></div><div class="ttdeci">#define JOB_REQUEUE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6a/job_8h_source.html#l00108">job.h:108</a></div></div>
<div class="ttc" id="structhydra__t_html_adf646db4986ffd1d4aecade40cd53dac"><div class="ttname"><a href="../../dd/db5/structhydra__t.html#adf646db4986ffd1d4aecade40cd53dac">hydra_t::kernel_interface</a></div><div class="ttdeci">kernel_interface_t * kernel_interface</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d63/hydra_8h_source.html#l00046">hydra.h:46</a></div></div>
<div class="ttc" id="group__libhydra_html_ga35c899fffe25d189c598655cdf558dde"><div class="ttname"><a href="../../d6/d9d/group__libhydra.html#ga35c899fffe25d189c598655cdf558dde">hydra</a></div><div class="ttdeci">hydra_t * hydra</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d6a/hydra_8c_source.html#l00046">hydra.c:46</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-93" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-93-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-93-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-93-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a6845422ba132bb780bdc513b2c846d64_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a50ff6b3b73afc5e4e1e327c997d2c7de"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a>* route_entry_clone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Clone a <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> object. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00287">287</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00251">chunk_clone</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, and <a class="el" href="../../d9/d43/windows_8h_source.html#l00099">strdup</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02232">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *route;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(route,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        .if_name = <a class="code" href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a>(this-&gt;if_name),</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        .src_ip = this-&gt;src_ip-&gt;clone(this-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">src_ip</a>),</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        .gateway = this-&gt;gateway ? this-&gt;gateway-&gt;clone(this-&gt;gateway) : NULL,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        .dst_net = <a class="code" href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a>(this-&gt;dst_net),</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        .prefixlen = this-&gt;prefixlen,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">return</span> route;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div>
<div class="ttc" id="structroute__entry__t_html_a0a710843eb1c0183af31b41b07bf76b0"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">route_entry_t::src_ip</a></div><div class="ttdeci">host_t * src_ip</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00105">kernel_libipsec_ipsec.c:105</a></div></div>
<div class="ttc" id="structroute__entry__t_html"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html">route_entry_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00101">kernel_libipsec_ipsec.c:101</a></div></div>
<div class="ttc" id="group__chunk_html_gac7a055a5fa92106988cddbc641899871"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac7a055a5fa92106988cddbc641899871">chunk_clone</a></div><div class="ttdeci">#define chunk_clone(chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00251">chunk.h:251</a></div></div>
<div class="ttc" id="group__windows_html_ga9254b089d435892385cf14d0ab4a7a2d"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9254b089d435892385cf14d0ab4a7a2d">strdup</a></div><div class="ttdeci">#define strdup</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00099">windows.h:99</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-94" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-94-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-94-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-94-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a50ff6b3b73afc5e4e1e327c997d2c7de_icgraph.svg" width="264" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a16c52872ecaf51327953d6549e19fcd9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void route_entry_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destroy a <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> object </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00304">304</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00205">chunk_free()</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02263">METHOD()</a>.</p>
<div class="fragment"><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;{</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(this-&gt;if_name);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;src_ip);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;gateway);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a>(&amp;this-&gt;dst_net);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="ttc" id="group__chunk_html_gaa86c84493369a4254d5801cdca20d458"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gaa86c84493369a4254d5801cdca20d458">chunk_free</a></div><div class="ttdeci">static void chunk_free(chunk_t *chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00205">chunk.h:205</a></div></div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-95" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-95-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-95-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-95-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a16c52872ecaf51327953d6549e19fcd9_cgraph.svg" width="379" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-96" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-96-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-96-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-96-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a16c52872ecaf51327953d6549e19fcd9_icgraph.svg" width="278" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6292b2ef17d9eb62070af2a8af54dcf3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> route_entry_equals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compare two <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> objects </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00325">325</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00306">chunk_equals()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00109">route_entry_t::dst_net</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00107">route_entry_t::gateway</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00103">route_entry_t::if_name</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00117">host_t::ip_equals</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00111">route_entry_t::prefixlen</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00105">route_entry_t::src_ip</a>, and <a class="el" href="../../da/d66/string_8h_source.html#l00028">streq()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;{</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">if_name</a> &amp;&amp; b-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">if_name</a> &amp;&amp; <a class="code" href="../../d4/d40/group__string__i.html#ga65c3d08890165aaa4663c72d07f93bb7">streq</a>(a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">if_name</a>, b-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">if_name</a>) &amp;&amp;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">src_ip</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">src_ip</a>, b-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">src_ip</a>) &amp;&amp;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="../../d4/d87/group__chunk.html#gae6aabf03218cda073ab2173e02bff4ba">chunk_equals</a>(a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a791ee71e6e19dd2e3bd95716b031de00">dst_net</a>, b-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a791ee71e6e19dd2e3bd95716b031de00">dst_net</a>) &amp;&amp; a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a637604b34e72c11f5b70e36533a78db4">prefixlen</a> == b-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a637604b34e72c11f5b70e36533a78db4">prefixlen</a>)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">return</span> (!a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a> &amp;&amp; !b-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a>) || (a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a> &amp;&amp; b-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a> &amp;&amp;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a>-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">ip_equals</a>(a-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a>, b-&gt;<a class="code" href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">gateway</a>));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div>
<div class="ttc" id="structhost__t_html_a7c1454eaeb7aeadd449616181c14f620"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a7c1454eaeb7aeadd449616181c14f620">host_t::ip_equals</a></div><div class="ttdeci">bool(* ip_equals)(host_t *this, host_t *other)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00117">host.h:117</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a0a710843eb1c0183af31b41b07bf76b0"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a0a710843eb1c0183af31b41b07bf76b0">route_entry_t::src_ip</a></div><div class="ttdeci">host_t * src_ip</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00105">kernel_libipsec_ipsec.c:105</a></div></div>
<div class="ttc" id="group__chunk_html_gae6aabf03218cda073ab2173e02bff4ba"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gae6aabf03218cda073ab2173e02bff4ba">chunk_equals</a></div><div class="ttdeci">static bool chunk_equals(chunk_t a, chunk_t b)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00306">chunk.h:306</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a791ee71e6e19dd2e3bd95716b031de00"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a791ee71e6e19dd2e3bd95716b031de00">route_entry_t::dst_net</a></div><div class="ttdeci">chunk_t dst_net</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00109">kernel_libipsec_ipsec.c:109</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a637604b34e72c11f5b70e36533a78db4"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a637604b34e72c11f5b70e36533a78db4">route_entry_t::prefixlen</a></div><div class="ttdeci">u_int8_t prefixlen</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00111">kernel_libipsec_ipsec.c:111</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a0cfdaa8399a8c743f7eaa5e98428802f"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a0cfdaa8399a8c743f7eaa5e98428802f">route_entry_t::if_name</a></div><div class="ttdeci">char * if_name</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00103">kernel_libipsec_ipsec.c:103</a></div></div>
<div class="ttc" id="group__string__i_html_ga65c3d08890165aaa4663c72d07f93bb7"><div class="ttname"><a href="../../d4/d40/group__string__i.html#ga65c3d08890165aaa4663c72d07f93bb7">streq</a></div><div class="ttdeci">static bool streq(const char *x, const char *y)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d66/string_8h_source.html#l00028">string.h:28</a></div></div>
<div class="ttc" id="structroute__entry__t_html_a4fd0d4902ebe96633cc03703529d5bc1"><div class="ttname"><a href="../../de/db4/structroute__entry__t.html#a4fd0d4902ebe96633cc03703529d5bc1">route_entry_t::gateway</a></div><div class="ttdeci">host_t * gateway</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00107">kernel_libipsec_ipsec.c:107</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-97" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-97-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-97-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-97-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a6292b2ef17d9eb62070af2a8af54dcf3_cgraph.svg" width="411" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-98" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-98-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-98-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-98-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a6292b2ef17d9eb62070af2a8af54dcf3_icgraph.svg" width="448" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2db2b3799d8a71b78f774ff07a5dae00"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u_int route_entry_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Hash a <a class="el" href="../../de/db4/structroute__entry__t.html">route_entry_t</a> object </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00316">316</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../d8/d39/chunk_8c_source.html#l00969">chunk_hash()</a>, and <a class="el" href="../../d8/d39/chunk_8c_source.html#l00960">chunk_hash_inc()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l02544">kernel_netlink_net_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d4/d87/group__chunk.html#ga59c607182e7cb24bb0ef4e6eae302bd9">chunk_hash_inc</a>(<a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(this-&gt;prefixlen),</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                          <a class="code" href="../../d4/d87/group__chunk.html#ga714bd1cb9e1f743523c2a58a49f1b6a4">chunk_hash</a>(this-&gt;dst_net));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="ttc" id="group__chunk_html_ga714bd1cb9e1f743523c2a58a49f1b6a4"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga714bd1cb9e1f743523c2a58a49f1b6a4">chunk_hash</a></div><div class="ttdeci">u_int32_t chunk_hash(chunk_t chunk)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00969">chunk.c:969</a></div></div>
<div class="ttc" id="group__chunk_html_ga59c607182e7cb24bb0ef4e6eae302bd9"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga59c607182e7cb24bb0ef4e6eae302bd9">chunk_hash_inc</a></div><div class="ttdeci">u_int32_t chunk_hash_inc(chunk_t chunk, u_int32_t hash)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d39/chunk_8c_source.html#l00960">chunk.c:960</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-99" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-99-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-99-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-99-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a2db2b3799d8a71b78f774ff07a5dae00_cgraph.svg" width="100%" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-100" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-100-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-100-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-100-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_a2db2b3799d8a71b78f774ff07a5dae00_icgraph.svg" width="438" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab49cfa5833bc6a05cc7058bd45aed9aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> route_usable </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d65/structnlmsghdr.html">nlmsghdr</a> *&#160;</td>
          <td class="paramname"><em>hdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if the route received with RTM_NEWROUTE is usable based on its type. </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01566">1566</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../dd/d49/test__stream_8c_source.html#l00028">msg</a>, <a class="el" href="../../de/d4c/netlink_8h_source.html#l00084">NLMSG_DATA</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00190">rtmsg::rtm_type</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00206">RTN_BLACKHOLE</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00208">RTN_PROHIBIT</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00209">RTN_THROW</a>, <a class="el" href="../../d9/d06/rtnetlink_8h_source.html#l00207">RTN_UNREACHABLE</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;{</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keyword">struct </span><a class="code" href="../../da/d53/structrtmsg.html">rtmsg</a> *<a class="code" href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    msg = <a class="code" href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a>(hdr);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordflow">switch</span> (msg-&gt;<a class="code" href="../../da/d53/structrtmsg.html#acd17e0f7575b8084c0be4392e774bbeb">rtm_type</a>)</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57acc8f8930e2ba6858c033abc329bbcb30">RTN_BLACKHOLE</a>:</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57aed739ae95db9e96d6e7389d55bb71726">RTN_UNREACHABLE</a>:</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a44fa779398b3595e6b69837050d333b1">RTN_PROHIBIT</a>:</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a8674c1603587c07860b6b0c5be359adf">RTN_THROW</a>:</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    }</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ab04a0655cd1e3bcac5e8f48c18df1a57aed739ae95db9e96d6e7389d55bb71726"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57aed739ae95db9e96d6e7389d55bb71726">RTN_UNREACHABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00207">rtnetlink.h:207</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ab04a0655cd1e3bcac5e8f48c18df1a57a8674c1603587c07860b6b0c5be359adf"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a8674c1603587c07860b6b0c5be359adf">RTN_THROW</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00209">rtnetlink.h:209</a></div></div>
<div class="ttc" id="test__stream_8c_html_afbbc03d010d4a43d0dcc0ef3c41de5ec"><div class="ttname"><a href="../../dd/d49/test__stream_8c.html#afbbc03d010d4a43d0dcc0ef3c41de5ec">msg</a></div><div class="ttdeci">static char msg[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d49/test__stream_8c_source.html#l00028">test_stream.c:28</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="structrtmsg_html"><div class="ttname"><a href="../../da/d53/structrtmsg.html">rtmsg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00181">rtnetlink.h:181</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ab04a0655cd1e3bcac5e8f48c18df1a57a44fa779398b3595e6b69837050d333b1"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a44fa779398b3595e6b69837050d333b1">RTN_PROHIBIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00208">rtnetlink.h:208</a></div></div>
<div class="ttc" id="rtnetlink_8h_html_ab04a0655cd1e3bcac5e8f48c18df1a57acc8f8930e2ba6858c033abc329bbcb30"><div class="ttname"><a href="../../d9/d06/rtnetlink_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57acc8f8930e2ba6858c033abc329bbcb30">RTN_BLACKHOLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00206">rtnetlink.h:206</a></div></div>
<div class="ttc" id="structrtmsg_html_acd17e0f7575b8084c0be4392e774bbeb"><div class="ttname"><a href="../../da/d53/structrtmsg.html#acd17e0f7575b8084c0be4392e774bbeb">rtmsg::rtm_type</a></div><div class="ttdeci">unsigned char rtm_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d06/rtnetlink_8h_source.html#l00190">rtnetlink.h:190</a></div></div>
<div class="ttc" id="netlink_8h_html_a4e5a9ade768e40e88087d07940c42142"><div class="ttname"><a href="../../de/d4c/netlink_8h.html#a4e5a9ade768e40e88087d07940c42142">NLMSG_DATA</a></div><div class="ttdeci">#define NLMSG_DATA(nlh)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4c/netlink_8h_source.html#l00084">netlink.h:84</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-101" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-101-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-101-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-101-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_ab49cfa5833bc6a05cc7058bd45aed9aa_icgraph.svg" width="360" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="af8fd81b195f159d61c21e5b82eb1a8fd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void rt_entry_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d39/structrt__entry__t.html">rt_entry_t</a> *&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Free a route entry </p>

<p>Definition at line <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01557">1557</a> of file <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html">kernel_netlink_net.c</a>.</p>

<p>References <a class="el" href="../../de/d10/object_8h_source.html#l00028">DESTROY_IF</a>, and <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l01659">get_route()</a>.</p>
<div class="fragment"><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;{</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a>(this-&gt;src_host);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;}</div>
<div class="ttc" id="group__object__i_html_ga2e86e6c6ba5209237c549480551198cc"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga2e86e6c6ba5209237c549480551198cc">DESTROY_IF</a></div><div class="ttdeci">#define DESTROY_IF(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00028">object.h:28</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
</div><!-- fragment -->
<p><div id="dynsection-102" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-102-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-102-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-102-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af8fd81b195f159d61c21e5b82eb1a8fd_cgraph.svg" width="222" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

<p><div id="dynsection-103" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-103-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-103-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-103-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d5/d90/kernel__netlink__net_8c_af8fd81b195f159d61c21e5b82eb1a8fd_icgraph.svg" width="382" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_6f63d64429d786849a1d5a9c3466ac82.html">libhydra</a></li><li class="navelem"><a class="el" href="../../dir_7c70a566b2094371eadbb944cfcc5aa1.html">plugins</a></li><li class="navelem"><a class="el" href="../../dir_b77fdc1b3997c39066c42bf438d40d93.html">kernel_netlink</a></li><li class="navelem"><a class="el" href="../../d5/d90/kernel__netlink__net_8c.html">kernel_netlink_net.c</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:03:48 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
