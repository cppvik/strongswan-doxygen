<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: keymat_v2_t Struct Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('de/da8/structkeymat__v2__t.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../de/d72/structkeymat__v2__t-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">keymat_v2_t Struct Reference<div class="ingroups"><a class="el" href="../../db/d0b/group__keymat__v2.html">keymat_v2</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>&quot;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for keymat_v2_t:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../d1/dd0/structkeymat__v2__t__coll__graph.svg" width="107" height="128"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a5c13a65401b78a41cd4b9d93fa80f534"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da8/structkeymat__v2__t.html#a5c13a65401b78a41cd4b9d93fa80f534">keymat</a></td></tr>
<tr class="separator:a5c13a65401b78a41cd4b9d93fa80f534"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09b3aa06f50eea1ca583a320c04b2054"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da8/structkeymat__v2__t.html#a09b3aa06f50eea1ca583a320c04b2054">derive_ike_keys</a> )(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, <a class="el" href="../../d4/d49/group__prf.html#ga44165ddd081f606d3a926685dd4aa5f4">pseudo_random_function_t</a> rekey_function, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> rekey_skd)</td></tr>
<tr class="separator:a09b3aa06f50eea1ca583a320c04b2054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e69d451b4e2797f0ec63c603dd8d7ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da8/structkeymat__v2__t.html#a1e69d451b4e2797f0ec63c603dd8d7ec">derive_child_keys</a> )(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_r)</td></tr>
<tr class="separator:a1e69d451b4e2797f0ec63c603dd8d7ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aca8aef7f31d147b2706740a1a9d517"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d49/group__prf.html#ga44165ddd081f606d3a926685dd4aa5f4">pseudo_random_function_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da8/structkeymat__v2__t.html#a4aca8aef7f31d147b2706740a1a9d517">get_skd</a> )(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *skd)</td></tr>
<tr class="separator:a4aca8aef7f31d147b2706740a1a9d517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad29511e9f7cdfe48daaecf14f09cd2ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da8/structkeymat__v2__t.html#ad29511e9f7cdfe48daaecf14f09cd2ca">get_auth_octets</a> )(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../db/df6/verify_8c.html#afe502ce4bb6d6c49b6b0a5a8a1b81c0e">verify</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> ike_sa_init, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, char <a class="el" href="../../d1/d6a/simaka__message_8c.html#a28962056f6d756a2c9a6623417fb0551">reserved</a>[3], <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *octets)</td></tr>
<tr class="separator:ad29511e9f7cdfe48daaecf14f09cd2ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a6108a9c95ab2580bfdbac9d0235a15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da8/structkeymat__v2__t.html#a6a6108a9c95ab2580bfdbac9d0235a15">get_psk_sig</a> )(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../db/df6/verify_8c.html#afe502ce4bb6d6c49b6b0a5a8a1b81c0e">verify</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> ike_sa_init, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> secret, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, char <a class="el" href="../../d1/d6a/simaka__message_8c.html#a28962056f6d756a2c9a6623417fb0551">reserved</a>[3], <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d4/d58/tls__crypto_8c.html#a884ed5ade4451796146c867f753cc193">sig</a>)</td></tr>
<tr class="separator:a6a6108a9c95ab2580bfdbac9d0235a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bda228f67627c031fc2b2bcc5096404"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da8/structkeymat__v2__t.html#a4bda228f67627c031fc2b2bcc5096404">add_hash_algorithm</a> )(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../dd/d1c/group__hasher.html#gad4fa8b947395725abf0510e387204ebe">hash_algorithm_t</a> <a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td></tr>
<tr class="separator:a4bda228f67627c031fc2b2bcc5096404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d74cdb00f9cb792ab8818d3d37df779"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da8/structkeymat__v2__t.html#a2d74cdb00f9cb792ab8818d3d37df779">hash_algorithm_supported</a> )(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../dd/d1c/group__hasher.html#gad4fa8b947395725abf0510e387204ebe">hash_algorithm_t</a> <a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td></tr>
<tr class="separator:a2d74cdb00f9cb792ab8818d3d37df779"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Derivation and management of sensitive keying material, IKEv2 variant. </p>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00031">31</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>
</div><h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4bda228f67627c031fc2b2bcc5096404"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* keymat_v2_t::add_hash_algorithm)(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../dd/d1c/group__hasher.html#gad4fa8b947395725abf0510e387204ebe">hash_algorithm_t</a> <a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a hash algorithm supported by the peer for signature authentication.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hash</td><td>hash algorithm </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00133">133</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1e69d451b4e2797f0ec63c603dd8d7ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v2_t::derive_child_keys)(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *encr_r, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *integ_r)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Derive keys for a CHILD_SA.</p>
<p>The keys for the CHILD_SA are allocated in the integ and encr chunks. An implementation might hand out encrypted keys only, which are decrypted in the kernel before use. If no PFS is used for the CHILD_SA, dh can be NULL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proposal</td><td>selected algorithms </td></tr>
    <tr><td class="paramname">dh</td><td>diffie hellman key allocated by create_dh(), or NULL </td></tr>
    <tr><td class="paramname">nonce_i</td><td>initiators nonce value </td></tr>
    <tr><td class="paramname">nonce_r</td><td>responders nonce value </td></tr>
    <tr><td class="paramname">encr_i</td><td>chunk to write initiators encryption key to </td></tr>
    <tr><td class="paramname">integ_i</td><td>chunk to write initiators integrity key to </td></tr>
    <tr><td class="paramname">encr_r</td><td>chunk to write responders encryption key to </td></tr>
    <tr><td class="paramname">integ_r</td><td>chunk to write responders integrity key to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE on success </dd></dl>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00077">77</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>

<p>Referenced by <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00635">process_child_add()</a>, and <a class="el" href="../../d7/d52/keymat__tests_8c_source.html#l00080">START_TEST()</a>.</p>

</div>
</div>
<a class="anchor" id="a09b3aa06f50eea1ca583a320c04b2054"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v2_t::derive_ike_keys)(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../df/d06/structproposal__t.html">proposal_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a5372eff556866bada29dd4643e028e02">proposal</a>, <a class="el" href="../../d1/dd3/structdiffie__hellman__t.html">diffie_hellman_t</a> *<a class="el" href="../../d8/dfe/test__vectors__plugin_8c.html#ac09e29c0ed6e1af19686249114310aae">dh</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_i, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce_r, <a class="el" href="../../dc/da6/structike__sa__id__t.html">ike_sa_id_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, <a class="el" href="../../d4/d49/group__prf.html#ga44165ddd081f606d3a926685dd4aa5f4">pseudo_random_function_t</a> rekey_function, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> rekey_skd)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Derive keys for the IKE_SA.</p>
<p>These keys are not handed out, but are used by the associated signers, crypters and authentication functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proposal</td><td>selected algorithms </td></tr>
    <tr><td class="paramname">dh</td><td>diffie hellman key allocated by create_dh() </td></tr>
    <tr><td class="paramname">nonce_i</td><td>initiators nonce value </td></tr>
    <tr><td class="paramname">nonce_r</td><td>responders nonce value </td></tr>
    <tr><td class="paramname">id</td><td>IKE_SA identifier </td></tr>
    <tr><td class="paramname">rekey_prf</td><td>PRF of old SA if rekeying, PRF_UNDEFINED otherwise </td></tr>
    <tr><td class="paramname">rekey_sdk</td><td>SKd of old SA if rekeying </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE on success </dd></dl>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00053">53</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>

<p>Referenced by <a class="el" href="../../de/dfc/ha__dispatcher_8c_source.html#l00127">process_ike_add()</a>, and <a class="el" href="../../d7/d52/keymat__tests_8c_source.html#l00031">START_TEST()</a>.</p>

</div>
</div>
<a class="anchor" id="ad29511e9f7cdfe48daaecf14f09cd2ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v2_t::get_auth_octets)(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../db/df6/verify_8c.html#afe502ce4bb6d6c49b6b0a5a8a1b81c0e">verify</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> ike_sa_init, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, char <a class="el" href="../../d1/d6a/simaka__message_8c.html#a28962056f6d756a2c9a6623417fb0551">reserved</a>[3], <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *octets)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate octets to use for authentication procedure (RFC4306 2.15).</p>
<p>This method creates the plain octets and is usually signed by a private key. PSK and EAP authentication include a secret into the data, use the <a class="el" href="../../de/da8/structkeymat__v2__t.html#a6a6108a9c95ab2580bfdbac9d0235a15">get_psk_sig()</a> method instead.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verify</td><td>TRUE to create for verfification, FALSE to sign </td></tr>
    <tr><td class="paramname">ike_sa_init</td><td>encoded ike_sa_init message </td></tr>
    <tr><td class="paramname">nonce</td><td>nonce value </td></tr>
    <tr><td class="paramname">id</td><td>identity </td></tr>
    <tr><td class="paramname">reserved</td><td>reserved bytes of id_payload </td></tr>
    <tr><td class="paramname">octests</td><td>chunk receiving allocated auth octets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if octets created successfully </dd></dl>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00105">105</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>

<p>Referenced by <a class="el" href="../../d3/db3/pretend__auth_8c_source.html#l00185">build_auth()</a>, <a class="el" href="../../d4/d9a/pubkey__authenticator_8c_source.html#l00358">METHOD()</a>, <a class="el" href="../../d5/d33/rebuild__auth_8c_source.html#l00055">rebuild_auth()</a>, <a class="el" href="../../d4/d9a/pubkey__authenticator_8c_source.html#l00257">sign_classic()</a>, and <a class="el" href="../../d4/d9a/pubkey__authenticator_8c_source.html#l00203">sign_signature_auth()</a>.</p>

</div>
</div>
<a class="anchor" id="a6a6108a9c95ab2580bfdbac9d0235a15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v2_t::get_psk_sig)(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../db/df6/verify_8c.html#afe502ce4bb6d6c49b6b0a5a8a1b81c0e">verify</a>, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> ike_sa_init, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> nonce, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> secret, <a class="el" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="el" href="../../d4/da3/test__identification_8c.html#aecb3b0d045ada529257a2fbf8f829599">id</a>, char <a class="el" href="../../d1/d6a/simaka__message_8c.html#a28962056f6d756a2c9a6623417fb0551">reserved</a>[3], <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *<a class="el" href="../../d4/d58/tls__crypto_8c.html#a884ed5ade4451796146c867f753cc193">sig</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Build the shared secret signature used for PSK and EAP authentication.</p>
<p>This method wraps the <a class="el" href="../../de/da8/structkeymat__v2__t.html#ad29511e9f7cdfe48daaecf14f09cd2ca">get_auth_octets()</a> method and additionally includes the secret into the signature. If no secret is given, SK_p is used as secret (used for EAP methods without MSK).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verify</td><td>TRUE to create for verfification, FALSE to sign </td></tr>
    <tr><td class="paramname">ike_sa_init</td><td>encoded ike_sa_init message </td></tr>
    <tr><td class="paramname">nonce</td><td>nonce value </td></tr>
    <tr><td class="paramname">secret</td><td>optional secret to include into signature </td></tr>
    <tr><td class="paramname">id</td><td>identity </td></tr>
    <tr><td class="paramname">reserved</td><td>reserved bytes of id_payload </td></tr>
    <tr><td class="paramname">sign</td><td>chunk receiving allocated signature octets </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if signature created successfully </dd></dl>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00124">124</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>

<p>Referenced by <a class="el" href="../../d3/ddf/eap__authenticator_8c_source.html#l00496">build_auth()</a>, <a class="el" href="../../d2/d92/psk__authenticator_8c_source.html#l00056">METHOD()</a>, and <a class="el" href="../../d3/ddf/eap__authenticator_8c_source.html#l00443">verify_auth()</a>.</p>

</div>
</div>
<a class="anchor" id="a4aca8aef7f31d147b2706740a1a9d517"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d49/group__prf.html#ga44165ddd081f606d3a926685dd4aa5f4">pseudo_random_function_t</a>(* keymat_v2_t::get_skd)(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> *skd)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get SKd to pass to derive_ikey_keys() during rekeying.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">skd</td><td>chunk to write SKd to (internal data) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PRF function to derive keymat </dd></dl>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00088">88</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>

<p>Referenced by <a class="el" href="../../df/d7c/ike__init_8c_source.html#l00517">derive_keys()</a>, and <a class="el" href="../../dc/dd5/ha__ike_8c_source.html#l00073">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a2d74cdb00f9cb792ab8818d3d37df779"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* keymat_v2_t::hash_algorithm_supported)(<a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a> *this, <a class="el" href="../../dd/d1c/group__hasher.html#gad4fa8b947395725abf0510e387204ebe">hash_algorithm_t</a> <a class="el" href="../../d6/d84/stroke__keywords_8c.html#a5541f85ce416df233cce93949f0eeeca">hash</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if a given hash algorithm is supported by the peer for signature authentication.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hash</td><td>hash algorithm </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if supported, FALSE otherwise </dd></dl>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00142">142</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d9a/pubkey__authenticator_8c_source.html#l00117">select_signature_schemes()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c13a65401b78a41cd4b9d93fa80f534"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a> keymat_v2_t::keymat</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implements <a class="el" href="../../d2/d63/structkeymat__t.html">keymat_t</a>. </p>

<p>Definition at line <a class="el" href="../../dd/d53/keymat__v2_8h_source.html#l00036">36</a> of file <a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/d9e/keymat_8c_source.html#l00026">keymat_create()</a>, and <a class="el" href="../../d7/d52/keymat__tests_8c_source.html#l00031">START_TEST()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="../../dd/d53/keymat__v2_8h_source.html">keymat_v2.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../de/da8/structkeymat__v2__t.html">keymat_v2_t</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:27 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
