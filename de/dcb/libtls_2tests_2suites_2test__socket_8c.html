<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: test_socket.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('de/dcb/libtls_2tests_2suites_2test__socket_8c.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">libtls/tests/suites/test_socket.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="../../d6/d7a/test__suite_8h_source.html">test_suite.h</a>&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../db/ddd/callback__job_8h_source.html">processing/jobs/callback_job.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d9/d53/mem__cred_8h_source.html">credentials/sets/mem_cred.h</a>&gt;</code><br/>
<code>#include &quot;<a class="el" href="../../dc/de6/tls__socket_8h_source.html">tls_socket.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for libtls/tests/suites/test_socket.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../d2/d37/libtls_2tests_2suites_2test__socket_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aea430c2184eea355b57105be1a6bdad7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#aea430c2184eea355b57105be1a6bdad7">START_SETUP</a> (setup_creds)</td></tr>
<tr class="separator:aea430c2184eea355b57105be1a6bdad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c54ef320aeee6ab1d8c5fbedefab651"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d18/group__test__suite.html#gab68451c03c02d2fc454f0a6d134506a2">END_SETUP</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a5c54ef320aeee6ab1d8c5fbedefab651">START_TEARDOWN</a> (teardown_creds)</td></tr>
<tr class="separator:a5c54ef320aeee6ab1d8c5fbedefab651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83ce985fd78c1b926fd57a95efef0c3c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../de/d63/structjob__requeue__t.html">job_requeue_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a83ce985fd78c1b926fd57a95efef0c3c">serve_echo</a> (<a class="el" href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a> *config)</td></tr>
<tr class="separator:a83ce985fd78c1b926fd57a95efef0c3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e665104566fbb4bd8fcd9d3b336110"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a52e665104566fbb4bd8fcd9d3b336110">start_echo_server</a> (<a class="el" href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a> *config)</td></tr>
<tr class="separator:a52e665104566fbb4bd8fcd9d3b336110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0bb9ef647f2319f96ededd2394977c3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab0bb9ef647f2319f96ededd2394977c3">run_echo_client</a> (<a class="el" href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a> *config)</td></tr>
<tr class="separator:ab0bb9ef647f2319f96ededd2394977c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab74d2178e43d8a7a809ccbdbef66b060"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a> (<a class="el" href="../../db/db4/group__tls.html#ga09354d8c40ff4fdb9e677f415595e9b4">tls_version_t</a> <a class="el" href="../../d2/d0b/version_8c.html#a5fd4c14b95cb371aafc8810b4bf2bad9">version</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a9e26a4afe91a21810290057677a17a11">port</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> cauth, u_int i)</td></tr>
<tr class="separator:ab74d2178e43d8a7a809ccbdbef66b060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eea2e528e1d4949dddbb55396230be7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a1eea2e528e1d4949dddbb55396230be7">START_TEST</a> (test_tls12)</td></tr>
<tr class="separator:a1eea2e528e1d4949dddbb55396230be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa050565d872783d8b823fbe18ece7e66"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#aa050565d872783d8b823fbe18ece7e66">START_TEST</a> (test_tls12_mutual)</td></tr>
<tr class="separator:aa050565d872783d8b823fbe18ece7e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5a9952f35633a6c69ee9d30dd583a9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ad5a9952f35633a6c69ee9d30dd583a9c">START_TEST</a> (test_tls11)</td></tr>
<tr class="separator:ad5a9952f35633a6c69ee9d30dd583a9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a109586c93c27aff11574cdad1bba0cfb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a109586c93c27aff11574cdad1bba0cfb">START_TEST</a> (test_tls11_mutual)</td></tr>
<tr class="separator:a109586c93c27aff11574cdad1bba0cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e0d5b490d1bc47cbb23ccaac0e5522"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a18e0d5b490d1bc47cbb23ccaac0e5522">START_TEST</a> (test_tls10)</td></tr>
<tr class="separator:a18e0d5b490d1bc47cbb23ccaac0e5522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23c1910984a7df4ef31eeaf136d29b70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a23c1910984a7df4ef31eeaf136d29b70">START_TEST</a> (test_tls10_mutual)</td></tr>
<tr class="separator:a23c1910984a7df4ef31eeaf136d29b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a895d842b0600a963c029521aae528e11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a> <a class="el" href="../../de/d18/group__test__suite.html#gafed1e97188dea85f283bf53d405a39c5">Suite</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a895d842b0600a963c029521aae528e11">socket_suite_create</a> ()</td></tr>
<tr class="separator:a895d842b0600a963c029521aae528e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af1da463627532f30f3a53d328d502b28"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d8/d38/structmem__cred__t.html">mem_cred_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a></td></tr>
<tr class="separator:af1da463627532f30f3a53d328d502b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6fb49baf89e350db09a6a3b89052fff"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab6fb49baf89e350db09a6a3b89052fff">rsa</a> []</td></tr>
<tr class="separator:ab6fb49baf89e350db09a6a3b89052fff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a151d46c7c71708d215f186be8fe47"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ac8a151d46c7c71708d215f186be8fe47">ecdsa</a> []</td></tr>
<tr class="separator:ac8a151d46c7c71708d215f186be8fe47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb6e8cdb48ba76d6b2ad9442ec466111"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#acb6e8cdb48ba76d6b2ad9442ec466111">rsa_crt</a> []</td></tr>
<tr class="separator:acb6e8cdb48ba76d6b2ad9442ec466111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a658aef9950550445c55bcecfd702f094"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a658aef9950550445c55bcecfd702f094">ecdsa_crt</a> []</td></tr>
<tr class="separator:a658aef9950550445c55bcecfd702f094"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab0bb9ef647f2319f96ededd2394977c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void run_echo_client </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a> *&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run client to perform echo test </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00358">358</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00271">echo_server_config_t::addr</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00274">echo_server_config_t::cauth</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00342">ck_assert</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00341">ck_assert_int_eq</a>, <a class="el" href="../../d7/d9b/pt-tls-client_8c_source.html#l00053">client()</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00341">close</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00302">connect</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00272">echo_server_config_t::data</a>, <a class="el" href="../../dc/de6/tls__socket_8h_source.html#l00096">tls_socket_t::destroy</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00130">host_t::destroy</a>, <a class="el" href="../../d1/d5e/identification_8h_source.html#l00285">identification_t::destroy</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00558">EWOULDBLOCK</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00059">host_t::get_sockaddr</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00072">host_t::get_sockaddr_len</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">host</a>, <a class="el" href="../../df/da9/host_8c_source.html#l00418">host_create_from_string()</a>, <a class="el" href="../../d6/d2f/identification_8c_source.html#l01042">identification_create_from_string()</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00044">chunk_t::len</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">len</a>, <a class="el" href="../../dc/d18/memory_8h_source.html#l00028">memeq()</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00270">echo_server_config_t::port</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00042">chunk_t::ptr</a>, <a class="el" href="../../dc/de6/tls__socket_8h_source.html#l00049">tls_socket_t::read</a>, <a class="el" href="../../d9/d8a/sasl__mechanism_8c_source.html#l00025">server</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00328">socket</a>, <a class="el" href="../../d4/ded/test__threading_8c_source.html#l01550">tls</a>, <a class="el" href="../../dd/db9/tls__socket_8c_source.html#l00407">tls_socket_create()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00269">echo_server_config_t::version</a>, and <a class="el" href="../../dc/de6/tls__socket_8h_source.html#l00058">tls_socket_t::write</a>.</p>

<p>Referenced by <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">test_tls()</a>.</p>
<div class="fragment"><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;{</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="../../d6/d46/structtls__socket__t.html">tls_socket_t</a> *<a class="code" href="../../d4/ded/test__threading_8c.html#a9c79b6f22f3267edfecedbc7dbe9fe32">tls</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    ssize_t <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, rd, wr;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordtype">int</span> fd;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="code" href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a>, *<a class="code" href="../../d7/d9b/pt-tls-client_8c.html#a909fb6319573549ef7cd13f84fdd5090">client</a> = NULL;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordtype">char</span> buf[128];</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    host = <a class="code" href="../../d7/df1/group__host.html#gad1ee7d1c0d17eee7f6e204e22ea2c206">host_create_from_string</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a9f7acc8733dfa81b472255c8a3d1ca04">addr</a>, config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a0634a5a352458c50a7bdcec6bc630d67">port</a>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    server = <a class="code" href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a9f7acc8733dfa81b472255c8a3d1ca04">addr</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#aeced04de7c7593ecdf91f35899134907">cauth</a>)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        client = <a class="code" href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    fd = <a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(fd != -1);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(<a class="code" href="../../da/d9b/group__windows.html#gadfd4ee688142ebda1142c1b0c7577e91">connect</a>(fd, host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#ae37aee519ce187fe08e1f750688b0d3e">get_sockaddr</a>(host),</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                      *host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a1b57f01c08cf587ce4192cc028a0fe29">get_sockaddr_len</a>(host)) != -1);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    tls = <a class="code" href="../../d9/d02/group__tls__socket.html#ga87e01d517201cb95bfa1d1ed0ccaa447">tls_socket_create</a>(<a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, server, client, fd, NULL,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                            config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a18915f2db620422fad9dd32e68ae9474">version</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(tls != NULL);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    wr = rd = 0;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">while</span> (rd &lt; config-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>.len)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        len = tls-&gt;<a class="code" href="../../d6/d46/structtls__socket__t.html#a84eaf09ec0cedaac80603093415f5ac4">write</a>(tls, config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a66277ab2543d2bceecc7cd53bce43198">data</a>.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> + wr, config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a66277ab2543d2bceecc7cd53bce43198">data</a>.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a> - wr);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(len &gt;= 0);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        wr += <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        len = tls-&gt;<a class="code" href="../../d6/d46/structtls__socket__t.html#a48d99ec09ca30e23cdc923bc11b29b1b">read</a>(tls, buf, <span class="keyword">sizeof</span>(buf), <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (len == -1 &amp;&amp; errno == <a class="code" href="../../da/d9b/group__windows.html#ga4a3a0b3605fd3b2336455062ee8e25f0">EWOULDBLOCK</a>)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (len == 0)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <a class="code" href="../../de/d18/group__test__suite.html#gad83d291e7602ccafd7be2e953edf9dca">ck_assert_int_eq</a>(rd, config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a66277ab2543d2bceecc7cd53bce43198">data</a>.<a class="code" href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">len</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(len &gt; 0);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(rd + len &lt;= config-&gt;<a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a>.len);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(<a class="code" href="../../dd/d74/group__memory__i.html#ga46d7935db00fd7092430dbf4f36c2850">memeq</a>(buf, config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a66277ab2543d2bceecc7cd53bce43198">data</a>.<a class="code" href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">ptr</a> + rd, len));</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        rd += <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    tls-&gt;<a class="code" href="../../d6/d46/structtls__socket__t.html#a53494dc9469ca97ea3eb6cec62d7a87e">destroy</a>(tls);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="../../da/d9b/group__windows.html#ga9c7f6d5331abb2692a876d5ee67474b7">close</a>(fd);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(host);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    server-&gt;<a class="code" href="../../d6/d02/structidentification__t.html#a9c0437f279eef4b6b19a8e82ca5321eb">destroy</a>(server);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div>
<div class="ttc" id="test__traffic__selector_8c_html_a1c2046dcb30a629d6d9f45ff8f403f12"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">test_traffic_selector.c:403</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__windows_html_gaa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00328">windows.h:328</a></div></div>
<div class="ttc" id="group__test__suite_html_gad83d291e7602ccafd7be2e953edf9dca"><div class="ttname"><a href="../../de/d18/group__test__suite.html#gad83d291e7602ccafd7be2e953edf9dca">ck_assert_int_eq</a></div><div class="ttdeci">#define ck_assert_int_eq</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00341">test_suite.h:341</a></div></div>
<div class="ttc" id="structchunk__t_html_a57bc08e43504ac6d264e6567e13c78d7"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#a57bc08e43504ac6d264e6567e13c78d7">chunk_t::ptr</a></div><div class="ttdeci">u_char * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00042">chunk.h:42</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="pt-tls-client_8c_html_a909fb6319573549ef7cd13f84fdd5090"><div class="ttname"><a href="../../d7/d9b/pt-tls-client_8c.html#a909fb6319573549ef7cd13f84fdd5090">client</a></div><div class="ttdeci">static int client(char *address, u_int16_t port, char *identity)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/pt-tls-client_8c_source.html#l00053">pt-tls-client.c:53</a></div></div>
<div class="ttc" id="structidentification__t_html"><div class="ttname"><a href="../../d6/d02/structidentification__t.html">identification_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d5e/identification_8h_source.html#l00197">identification.h:197</a></div></div>
<div class="ttc" id="structchunk__t_html_ae7e16cac6012e4269d4c5d7014ce1a1f"><div class="ttname"><a href="../../d0/d14/structchunk__t.html#ae7e16cac6012e4269d4c5d7014ce1a1f">chunk_t::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00044">chunk.h:44</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_aeced04de7c7593ecdf91f35899134907"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#aeced04de7c7593ecdf91f35899134907">echo_server_config_t::cauth</a></div><div class="ttdeci">bool cauth</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00274">libtls/tests/suites/test_socket.c:274</a></div></div>
<div class="ttc" id="structtls__socket__t_html_a48d99ec09ca30e23cdc923bc11b29b1b"><div class="ttname"><a href="../../d6/d46/structtls__socket__t.html#a48d99ec09ca30e23cdc923bc11b29b1b">tls_socket_t::read</a></div><div class="ttdeci">ssize_t(* read)(tls_socket_t *this, void *buf, size_t len, bool block)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de6/tls__socket_8h_source.html#l00049">tls_socket.h:49</a></div></div>
<div class="ttc" id="structidentification__t_html_a9c0437f279eef4b6b19a8e82ca5321eb"><div class="ttname"><a href="../../d6/d02/structidentification__t.html#a9c0437f279eef4b6b19a8e82ca5321eb">identification_t::destroy</a></div><div class="ttdeci">void(* destroy)(identification_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d5e/identification_8h_source.html#l00285">identification.h:285</a></div></div>
<div class="ttc" id="structtls__socket__t_html_a53494dc9469ca97ea3eb6cec62d7a87e"><div class="ttname"><a href="../../d6/d46/structtls__socket__t.html#a53494dc9469ca97ea3eb6cec62d7a87e">tls_socket_t::destroy</a></div><div class="ttdeci">void(* destroy)(tls_socket_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de6/tls__socket_8h_source.html#l00096">tls_socket.h:96</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a9f7acc8733dfa81b472255c8a3d1ca04"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a9f7acc8733dfa81b472255c8a3d1ca04">echo_server_config_t::addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00271">libtls/tests/suites/test_socket.c:271</a></div></div>
<div class="ttc" id="structtls__socket__t_html_a84eaf09ec0cedaac80603093415f5ac4"><div class="ttname"><a href="../../d6/d46/structtls__socket__t.html#a84eaf09ec0cedaac80603093415f5ac4">tls_socket_t::write</a></div><div class="ttdeci">ssize_t(* write)(tls_socket_t *this, void *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de6/tls__socket_8h_source.html#l00058">tls_socket.h:58</a></div></div>
<div class="ttc" id="structhost__t_html_a1b57f01c08cf587ce4192cc028a0fe29"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a1b57f01c08cf587ce4192cc028a0fe29">host_t::get_sockaddr_len</a></div><div class="ttdeci">socklen_t *(* get_sockaddr_len)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00072">host.h:72</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a18915f2db620422fad9dd32e68ae9474"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a18915f2db620422fad9dd32e68ae9474">echo_server_config_t::version</a></div><div class="ttdeci">tls_version_t version</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00269">libtls/tests/suites/test_socket.c:269</a></div></div>
<div class="ttc" id="group__memory__i_html_ga46d7935db00fd7092430dbf4f36c2850"><div class="ttname"><a href="../../dd/d74/group__memory__i.html#ga46d7935db00fd7092430dbf4f36c2850">memeq</a></div><div class="ttdeci">static bool memeq(const void *x, const void *y, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/memory_8h_source.html#l00028">memory.h:28</a></div></div>
<div class="ttc" id="group__windows_html_ga4a3a0b3605fd3b2336455062ee8e25f0"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga4a3a0b3605fd3b2336455062ee8e25f0">EWOULDBLOCK</a></div><div class="ttdeci">#define EWOULDBLOCK</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00558">windows.h:558</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a2b341e3994bfbc0aa8d680205abbd28b"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a></div><div class="ttdeci">u_int16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">duplicheck_msg.h:45</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__test__suite_html_ga07bed5f12e10d5de7c72f91f9d12a56f"><div class="ttname"><a href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a></div><div class="ttdeci">#define ck_assert</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00342">test_suite.h:342</a></div></div>
<div class="ttc" id="group__windows_html_ga9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00341">windows.h:341</a></div></div>
<div class="ttc" id="group__identification_html_ga23065d7dd9165080ce47e4c20089761e"><div class="ttname"><a href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a></div><div class="ttdeci">identification_t * identification_create_from_string(char *string)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2f/identification_8c_source.html#l01042">identification.c:1042</a></div></div>
<div class="ttc" id="structhost__t_html_af9703b61f348ea0409dc9cb197b2b788"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">host_t::destroy</a></div><div class="ttdeci">void(* destroy)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00130">host.h:130</a></div></div>
<div class="ttc" id="sasl__mechanism_8c_html_ae57ae4ecc2c00b47149ec5130bc9c9ef"><div class="ttname"><a href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a></div><div class="ttdeci">bool server</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8a/sasl__mechanism_8c_source.html#l00025">sasl_mechanism.c:25</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
<div class="ttc" id="group__windows_html_gadfd4ee688142ebda1142c1b0c7577e91"><div class="ttname"><a href="../../da/d9b/group__windows.html#gadfd4ee688142ebda1142c1b0c7577e91">connect</a></div><div class="ttdeci">#define connect</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00302">windows.h:302</a></div></div>
<div class="ttc" id="test__threading_8c_html_a9c79b6f22f3267edfecedbc7dbe9fe32"><div class="ttname"><a href="../../d4/ded/test__threading_8c.html#a9c79b6f22f3267edfecedbc7dbe9fe32">tls</a></div><div class="ttdeci">static END_TEST thread_value_t * tls[10]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ded/test__threading_8c_source.html#l01550">test_threading.c:1550</a></div></div>
<div class="ttc" id="group__tls__socket_html_ga87e01d517201cb95bfa1d1ed0ccaa447"><div class="ttname"><a href="../../d9/d02/group__tls__socket.html#ga87e01d517201cb95bfa1d1ed0ccaa447">tls_socket_create</a></div><div class="ttdeci">tls_socket_t * tls_socket_create(bool is_server, identification_t *server, identification_t *peer, int fd, tls_cache_t *cache, tls_version_t max_version, bool nullok)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db9/tls__socket_8c_source.html#l00407">tls_socket.c:407</a></div></div>
<div class="ttc" id="group__host_html_gad1ee7d1c0d17eee7f6e204e22ea2c206"><div class="ttname"><a href="../../d7/df1/group__host.html#gad1ee7d1c0d17eee7f6e204e22ea2c206">host_create_from_string</a></div><div class="ttdeci">host_t * host_create_from_string(char *string, u_int16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/host_8c_source.html#l00418">host.c:418</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a0634a5a352458c50a7bdcec6bc630d67"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a0634a5a352458c50a7bdcec6bc630d67">echo_server_config_t::port</a></div><div class="ttdeci">u_int16_t port</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00270">libtls/tests/suites/test_socket.c:270</a></div></div>
<div class="ttc" id="structhost__t_html_ae37aee519ce187fe08e1f750688b0d3e"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#ae37aee519ce187fe08e1f750688b0d3e">host_t::get_sockaddr</a></div><div class="ttdeci">sockaddr_t *(* get_sockaddr)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00059">host.h:59</a></div></div>
<div class="ttc" id="structtls__socket__t_html"><div class="ttname"><a href="../../d6/d46/structtls__socket__t.html">tls_socket_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de6/tls__socket_8h_source.html#l00035">tls_socket.h:35</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a66277ab2543d2bceecc7cd53bce43198"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a66277ab2543d2bceecc7cd53bce43198">echo_server_config_t::data</a></div><div class="ttdeci">chunk_t data</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00272">libtls/tests/suites/test_socket.c:272</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_ab0bb9ef647f2319f96ededd2394977c3_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_ab0bb9ef647f2319f96ededd2394977c3_icgraph.svg" width="443" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a83ce985fd78c1b926fd57a95efef0c3c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../de/d63/structjob__requeue__t.html">job_requeue_t</a> serve_echo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a> *&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run an echo server </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00280">280</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../d2/d6e/apple_8h_source.html#l00068">accept</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00271">echo_server_config_t::addr</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00274">echo_server_config_t::cauth</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00342">ck_assert</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00343">ck_assert_msg</a>, <a class="el" href="../../d7/d9b/pt-tls-client_8c_source.html#l00053">client()</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00341">close</a>, <a class="el" href="../../dc/de6/tls__socket_8h_source.html#l00096">tls_socket_t::destroy</a>, <a class="el" href="../../d1/d5e/identification_8h_source.html#l00285">identification_t::destroy</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00273">echo_server_config_t::fd</a>, <a class="el" href="../../d6/d2f/identification_8c_source.html#l01042">identification_create_from_string()</a>, <a class="el" href="../../d3/d6a/job_8h_source.html#l00108">JOB_REQUEUE_NONE</a>, <a class="el" href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">len</a>, <a class="el" href="../../dc/de6/tls__socket_8h_source.html#l00049">tls_socket_t::read</a>, <a class="el" href="../../d9/d8a/sasl__mechanism_8c_source.html#l00025">server</a>, <a class="el" href="../../d9/dd1/strerror_8h_source.html#l00049">strerror</a>, <a class="el" href="../../d4/ded/test__threading_8c_source.html#l01550">tls</a>, <a class="el" href="../../dd/db9/tls__socket_8c_source.html#l00407">tls_socket_create()</a>, <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00269">echo_server_config_t::version</a>, and <a class="el" href="../../dc/de6/tls__socket_8h_source.html#l00058">tls_socket_t::write</a>.</p>

<p>Referenced by <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00333">start_echo_server()</a>.</p>
<div class="fragment"><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="../../d6/d46/structtls__socket__t.html">tls_socket_t</a> *<a class="code" href="../../d4/ded/test__threading_8c.html#a9c79b6f22f3267edfecedbc7dbe9fe32">tls</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">int</span> sfd, cfd;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="../../d6/d02/structidentification__t.html">identification_t</a> *<a class="code" href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a>, *<a class="code" href="../../d7/d9b/pt-tls-client_8c.html#a909fb6319573549ef7cd13f84fdd5090">client</a> = NULL;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    ssize_t <a class="code" href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a>, total, done;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">char</span> buf[128];</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    server = <a class="code" href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a9f7acc8733dfa81b472255c8a3d1ca04">addr</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#aeced04de7c7593ecdf91f35899134907">cauth</a>)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        client = <a class="code" href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    sfd = config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">fd</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        cfd = <a class="code" href="../../d2/d21/group__apple.html#ga2fe3d034024f850bed737a97851616bf">accept</a>(sfd, NULL, NULL);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span> (cfd &lt; 0)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        tls = <a class="code" href="../../d9/d02/group__tls__socket.html#ga87e01d517201cb95bfa1d1ed0ccaa447">tls_socket_create</a>(<a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, server, client, cfd, NULL,</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a18915f2db620422fad9dd32e68ae9474">version</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(tls != NULL);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">while</span> (<a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            len = tls-&gt;<a class="code" href="../../d6/d46/structtls__socket__t.html#a48d99ec09ca30e23cdc923bc11b29b1b">read</a>(tls, buf, <span class="keyword">sizeof</span>(buf), <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">if</span> (len &lt;= 0)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            total = 0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">while</span> (total &lt; len)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                done = tls-&gt;<a class="code" href="../../d6/d46/structtls__socket__t.html#a84eaf09ec0cedaac80603093415f5ac4">write</a>(tls, buf + total, len - total);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <a class="code" href="../../de/d18/group__test__suite.html#gaa8e4e3f37577a6ea78111250f60a5943">ck_assert_msg</a>(done &gt; 0, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d7/d20/group__strerror__i.html#ga75a49b8c951e5603be44d64dd90a78ec">strerror</a>(errno));</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                total += done;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        tls-&gt;<a class="code" href="../../d6/d46/structtls__socket__t.html#a53494dc9469ca97ea3eb6cec62d7a87e">destroy</a>(tls);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="../../da/d9b/group__windows.html#ga9c7f6d5331abb2692a876d5ee67474b7">close</a>(cfd);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    server-&gt;<a class="code" href="../../d6/d02/structidentification__t.html#a9c0437f279eef4b6b19a8e82ca5321eb">destroy</a>(server);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
<div class="ttc" id="pt-tls-client_8c_html_a909fb6319573549ef7cd13f84fdd5090"><div class="ttname"><a href="../../d7/d9b/pt-tls-client_8c.html#a909fb6319573549ef7cd13f84fdd5090">client</a></div><div class="ttdeci">static int client(char *address, u_int16_t port, char *identity)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/pt-tls-client_8c_source.html#l00053">pt-tls-client.c:53</a></div></div>
<div class="ttc" id="structidentification__t_html"><div class="ttname"><a href="../../d6/d02/structidentification__t.html">identification_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d5e/identification_8h_source.html#l00197">identification.h:197</a></div></div>
<div class="ttc" id="group__job_html_ga7a4d84fe5043983e82b3e0bbf80218e9"><div class="ttname"><a href="../../d5/de3/group__job.html#ga7a4d84fe5043983e82b3e0bbf80218e9">JOB_REQUEUE_NONE</a></div><div class="ttdeci">#define JOB_REQUEUE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6a/job_8h_source.html#l00108">job.h:108</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a1c610f34fa9444505a6cb4d1581fea1f"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">echo_server_config_t::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00273">libtls/tests/suites/test_socket.c:273</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_aeced04de7c7593ecdf91f35899134907"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#aeced04de7c7593ecdf91f35899134907">echo_server_config_t::cauth</a></div><div class="ttdeci">bool cauth</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00274">libtls/tests/suites/test_socket.c:274</a></div></div>
<div class="ttc" id="structtls__socket__t_html_a48d99ec09ca30e23cdc923bc11b29b1b"><div class="ttname"><a href="../../d6/d46/structtls__socket__t.html#a48d99ec09ca30e23cdc923bc11b29b1b">tls_socket_t::read</a></div><div class="ttdeci">ssize_t(* read)(tls_socket_t *this, void *buf, size_t len, bool block)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de6/tls__socket_8h_source.html#l00049">tls_socket.h:49</a></div></div>
<div class="ttc" id="structidentification__t_html_a9c0437f279eef4b6b19a8e82ca5321eb"><div class="ttname"><a href="../../d6/d02/structidentification__t.html#a9c0437f279eef4b6b19a8e82ca5321eb">identification_t::destroy</a></div><div class="ttdeci">void(* destroy)(identification_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d5e/identification_8h_source.html#l00285">identification.h:285</a></div></div>
<div class="ttc" id="group__apple_html_ga2fe3d034024f850bed737a97851616bf"><div class="ttname"><a href="../../d2/d21/group__apple.html#ga2fe3d034024f850bed737a97851616bf">accept</a></div><div class="ttdeci">#define accept</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d6e/apple_8h_source.html#l00068">apple.h:68</a></div></div>
<div class="ttc" id="structtls__socket__t_html_a53494dc9469ca97ea3eb6cec62d7a87e"><div class="ttname"><a href="../../d6/d46/structtls__socket__t.html#a53494dc9469ca97ea3eb6cec62d7a87e">tls_socket_t::destroy</a></div><div class="ttdeci">void(* destroy)(tls_socket_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de6/tls__socket_8h_source.html#l00096">tls_socket.h:96</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a9f7acc8733dfa81b472255c8a3d1ca04"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a9f7acc8733dfa81b472255c8a3d1ca04">echo_server_config_t::addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00271">libtls/tests/suites/test_socket.c:271</a></div></div>
<div class="ttc" id="group__test__suite_html_gaa8e4e3f37577a6ea78111250f60a5943"><div class="ttname"><a href="../../de/d18/group__test__suite.html#gaa8e4e3f37577a6ea78111250f60a5943">ck_assert_msg</a></div><div class="ttdeci">#define ck_assert_msg</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00343">test_suite.h:343</a></div></div>
<div class="ttc" id="structtls__socket__t_html_a84eaf09ec0cedaac80603093415f5ac4"><div class="ttname"><a href="../../d6/d46/structtls__socket__t.html#a84eaf09ec0cedaac80603093415f5ac4">tls_socket_t::write</a></div><div class="ttdeci">ssize_t(* write)(tls_socket_t *this, void *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de6/tls__socket_8h_source.html#l00058">tls_socket.h:58</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a18915f2db620422fad9dd32e68ae9474"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a18915f2db620422fad9dd32e68ae9474">echo_server_config_t::version</a></div><div class="ttdeci">tls_version_t version</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00269">libtls/tests/suites/test_socket.c:269</a></div></div>
<div class="ttc" id="group__strerror__i_html_ga75a49b8c951e5603be44d64dd90a78ec"><div class="ttname"><a href="../../d7/d20/group__strerror__i.html#ga75a49b8c951e5603be44d64dd90a78ec">strerror</a></div><div class="ttdeci">#define strerror(errnum)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd1/strerror_8h_source.html#l00049">strerror.h:49</a></div></div>
<div class="ttc" id="duplicheck__msg_8h_html_a2b341e3994bfbc0aa8d680205abbd28b"><div class="ttname"><a href="../../d2/da4/duplicheck__msg_8h.html#a2b341e3994bfbc0aa8d680205abbd28b">len</a></div><div class="ttdeci">u_int16_t len</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/da4/duplicheck__msg_8h_source.html#l00045">duplicheck_msg.h:45</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__test__suite_html_ga07bed5f12e10d5de7c72f91f9d12a56f"><div class="ttname"><a href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a></div><div class="ttdeci">#define ck_assert</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00342">test_suite.h:342</a></div></div>
<div class="ttc" id="group__windows_html_ga9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00341">windows.h:341</a></div></div>
<div class="ttc" id="group__identification_html_ga23065d7dd9165080ce47e4c20089761e"><div class="ttname"><a href="../../d5/d8d/group__identification.html#ga23065d7dd9165080ce47e4c20089761e">identification_create_from_string</a></div><div class="ttdeci">identification_t * identification_create_from_string(char *string)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d2f/identification_8c_source.html#l01042">identification.c:1042</a></div></div>
<div class="ttc" id="sasl__mechanism_8c_html_ae57ae4ecc2c00b47149ec5130bc9c9ef"><div class="ttname"><a href="../../d9/d8a/sasl__mechanism_8c.html#ae57ae4ecc2c00b47149ec5130bc9c9ef">server</a></div><div class="ttdeci">bool server</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d8a/sasl__mechanism_8c_source.html#l00025">sasl_mechanism.c:25</a></div></div>
<div class="ttc" id="test__threading_8c_html_a9c79b6f22f3267edfecedbc7dbe9fe32"><div class="ttname"><a href="../../d4/ded/test__threading_8c.html#a9c79b6f22f3267edfecedbc7dbe9fe32">tls</a></div><div class="ttdeci">static END_TEST thread_value_t * tls[10]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ded/test__threading_8c_source.html#l01550">test_threading.c:1550</a></div></div>
<div class="ttc" id="group__tls__socket_html_ga87e01d517201cb95bfa1d1ed0ccaa447"><div class="ttname"><a href="../../d9/d02/group__tls__socket.html#ga87e01d517201cb95bfa1d1ed0ccaa447">tls_socket_create</a></div><div class="ttdeci">tls_socket_t * tls_socket_create(bool is_server, identification_t *server, identification_t *peer, int fd, tls_cache_t *cache, tls_version_t max_version, bool nullok)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db9/tls__socket_8c_source.html#l00407">tls_socket.c:407</a></div></div>
<div class="ttc" id="structtls__socket__t_html"><div class="ttname"><a href="../../d6/d46/structtls__socket__t.html">tls_socket_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de6/tls__socket_8h_source.html#l00035">tls_socket.h:35</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a83ce985fd78c1b926fd57a95efef0c3c_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a83ce985fd78c1b926fd57a95efef0c3c_icgraph.svg" width="595" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a895d842b0600a963c029521aae528e11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a> <a class="el" href="../../de/d18/group__test__suite.html#gafed1e97188dea85f283bf53d405a39c5">Suite</a>* socket_suite_create </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00483">483</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../d1/d14/fetch_8c_source.html#l00022">count</a>, <a class="el" href="../../d3/d63/aes__crypter_8c_source.html#l00545">s</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00339">Suite</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00362">suite_add_tcase</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00356">suite_create</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00340">TCase</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00358">tcase_add_checked_fixture</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00360">tcase_add_loop_test</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00357">tcase_create</a>, <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l01861">tls_crypto_get_supported_suites()</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#gafed1e97188dea85f283bf53d405a39c5">Suite</a> *<a class="code" href="../../d3/d63/aes__crypter_8c.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#gaed0f17a17f1ea58efb01fc3633bf059a">TCase</a> *tc;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    count = <a class="code" href="../../d5/dbd/group__tls__crypto.html#ga3907a12a0a0102cad72980a8b38719b3">tls_crypto_get_supported_suites</a>(<a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, NULL);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    s = <a class="code" href="../../de/d18/group__test__suite.html#ga80831b0facb4904ae478309c902427d5">suite_create</a>(<span class="stringliteral">&quot;socket&quot;</span>);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    tc = <a class="code" href="../../de/d18/group__test__suite.html#gaf2bea682ac19f9a8d3b334864e17f219">tcase_create</a>(<span class="stringliteral">&quot;TLS 1.2/anon&quot;</span>);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga53f91df239b6d284706e7175f6bedb31">tcase_add_checked_fixture</a>(tc, setup_creds, teardown_creds);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga9747e1b5770c30a2081ce3748a7d7529">tcase_add_loop_test</a>(tc, test_tls12, 0, count);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga27e6f90529b3ddd9bbfcf327aafcb4f7">suite_add_tcase</a>(s, tc);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    tc = <a class="code" href="../../de/d18/group__test__suite.html#gaf2bea682ac19f9a8d3b334864e17f219">tcase_create</a>(<span class="stringliteral">&quot;TLS 1.2/mutl&quot;</span>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga53f91df239b6d284706e7175f6bedb31">tcase_add_checked_fixture</a>(tc, setup_creds, teardown_creds);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga9747e1b5770c30a2081ce3748a7d7529">tcase_add_loop_test</a>(tc, test_tls12_mutual, 0, count);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga27e6f90529b3ddd9bbfcf327aafcb4f7">suite_add_tcase</a>(s, tc);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    tc = <a class="code" href="../../de/d18/group__test__suite.html#gaf2bea682ac19f9a8d3b334864e17f219">tcase_create</a>(<span class="stringliteral">&quot;TLS 1.1/anon&quot;</span>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga53f91df239b6d284706e7175f6bedb31">tcase_add_checked_fixture</a>(tc, setup_creds, teardown_creds);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga9747e1b5770c30a2081ce3748a7d7529">tcase_add_loop_test</a>(tc, test_tls11, 0, count);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga27e6f90529b3ddd9bbfcf327aafcb4f7">suite_add_tcase</a>(s, tc);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    tc = <a class="code" href="../../de/d18/group__test__suite.html#gaf2bea682ac19f9a8d3b334864e17f219">tcase_create</a>(<span class="stringliteral">&quot;TLS 1.1/mutl&quot;</span>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga53f91df239b6d284706e7175f6bedb31">tcase_add_checked_fixture</a>(tc, setup_creds, teardown_creds);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga9747e1b5770c30a2081ce3748a7d7529">tcase_add_loop_test</a>(tc, test_tls11_mutual, 0, count);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga27e6f90529b3ddd9bbfcf327aafcb4f7">suite_add_tcase</a>(s, tc);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    tc = <a class="code" href="../../de/d18/group__test__suite.html#gaf2bea682ac19f9a8d3b334864e17f219">tcase_create</a>(<span class="stringliteral">&quot;TLS 1.0/anon&quot;</span>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga53f91df239b6d284706e7175f6bedb31">tcase_add_checked_fixture</a>(tc, setup_creds, teardown_creds);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga9747e1b5770c30a2081ce3748a7d7529">tcase_add_loop_test</a>(tc, test_tls10, 0, count);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga27e6f90529b3ddd9bbfcf327aafcb4f7">suite_add_tcase</a>(s, tc);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    tc = <a class="code" href="../../de/d18/group__test__suite.html#gaf2bea682ac19f9a8d3b334864e17f219">tcase_create</a>(<span class="stringliteral">&quot;TLS 1.0/mutl&quot;</span>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga53f91df239b6d284706e7175f6bedb31">tcase_add_checked_fixture</a>(tc, setup_creds, teardown_creds);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga9747e1b5770c30a2081ce3748a7d7529">tcase_add_loop_test</a>(tc, test_tls10_mutual, 0, count);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga27e6f90529b3ddd9bbfcf327aafcb4f7">suite_add_tcase</a>(s, tc);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/d63/aes__crypter_8c.html#a20c782a91c883391b9bdf9e3176e447c">s</a>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;}</div>
<div class="ttc" id="group__tls__crypto_html_ga3907a12a0a0102cad72980a8b38719b3"><div class="ttname"><a href="../../d5/dbd/group__tls__crypto.html#ga3907a12a0a0102cad72980a8b38719b3">tls_crypto_get_supported_suites</a></div><div class="ttdeci">int tls_crypto_get_supported_suites(bool null, tls_cipher_suite_t **out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d58/tls__crypto_8c_source.html#l01861">tls_crypto.c:1861</a></div></div>
<div class="ttc" id="group__test__suite_html_ga9747e1b5770c30a2081ce3748a7d7529"><div class="ttname"><a href="../../de/d18/group__test__suite.html#ga9747e1b5770c30a2081ce3748a7d7529">tcase_add_loop_test</a></div><div class="ttdeci">#define tcase_add_loop_test</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00360">test_suite.h:360</a></div></div>
<div class="ttc" id="fetch_8c_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">static int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d14/fetch_8c_source.html#l00022">fetch.c:22</a></div></div>
<div class="ttc" id="aes__crypter_8c_html_a20c782a91c883391b9bdf9e3176e447c"><div class="ttname"><a href="../../d3/d63/aes__crypter_8c.html#a20c782a91c883391b9bdf9e3176e447c">s</a></div><div class="ttdeci">#define s(x, c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d63/aes__crypter_8c_source.html#l00545">aes_crypter.c:545</a></div></div>
<div class="ttc" id="group__test__suite_html_gaed0f17a17f1ea58efb01fc3633bf059a"><div class="ttname"><a href="../../de/d18/group__test__suite.html#gaed0f17a17f1ea58efb01fc3633bf059a">TCase</a></div><div class="ttdeci">#define TCase</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00340">test_suite.h:340</a></div></div>
<div class="ttc" id="group__test__suite_html_ga27e6f90529b3ddd9bbfcf327aafcb4f7"><div class="ttname"><a href="../../de/d18/group__test__suite.html#ga27e6f90529b3ddd9bbfcf327aafcb4f7">suite_add_tcase</a></div><div class="ttdeci">#define suite_add_tcase</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00362">test_suite.h:362</a></div></div>
<div class="ttc" id="group__test__suite_html_ga53f91df239b6d284706e7175f6bedb31"><div class="ttname"><a href="../../de/d18/group__test__suite.html#ga53f91df239b6d284706e7175f6bedb31">tcase_add_checked_fixture</a></div><div class="ttdeci">#define tcase_add_checked_fixture</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00358">test_suite.h:358</a></div></div>
<div class="ttc" id="group__test__suite_html_gaf2bea682ac19f9a8d3b334864e17f219"><div class="ttname"><a href="../../de/d18/group__test__suite.html#gaf2bea682ac19f9a8d3b334864e17f219">tcase_create</a></div><div class="ttdeci">#define tcase_create</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00357">test_suite.h:357</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__test__suite_html_ga80831b0facb4904ae478309c902427d5"><div class="ttname"><a href="../../de/d18/group__test__suite.html#ga80831b0facb4904ae478309c902427d5">suite_create</a></div><div class="ttdeci">#define suite_create</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00356">test_suite.h:356</a></div></div>
<div class="ttc" id="group__test__suite_html_gafed1e97188dea85f283bf53d405a39c5"><div class="ttname"><a href="../../de/d18/group__test__suite.html#gafed1e97188dea85f283bf53d405a39c5">Suite</a></div><div class="ttdeci">#define Suite</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00339">test_suite.h:339</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a895d842b0600a963c029521aae528e11_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a52e665104566fbb4bd8fcd9d3b336110"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void start_echo_server </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a> *&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Start a echo server using config </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00333">333</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00271">echo_server_config_t::addr</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00296">bind</a>, <a class="el" href="../../d5/d84/callback__job_8c_source.html#l00127">callback_job_create()</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00342">ck_assert</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00343">ck_assert_msg</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00130">host_t::destroy</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00273">echo_server_config_t::fd</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00059">host_t::get_sockaddr</a>, <a class="el" href="../../df/ded/host_8h_source.html#l00072">host_t::get_sockaddr_len</a>, <a class="el" href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">host</a>, <a class="el" href="../../df/da9/host_8c_source.html#l00418">host_create_from_string()</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00270">echo_server_config_t::port</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00215">library_t::processor</a>, <a class="el" href="../../d9/d99/processor_8h_source.html#l00077">processor_t::queue_job</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00280">serve_echo()</a>, <a class="el" href="../../d9/d99/processor_8h_source.html#l00100">processor_t::set_threads</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00321">setsockopt</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00328">socket</a>, and <a class="el" href="../../d9/dd1/strerror_8h_source.html#l00049">strerror</a>.</p>

<p>Referenced by <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">test_tls()</a>.</p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="code" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">int</span> on = 1;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    host = <a class="code" href="../../d7/df1/group__host.html#gad1ee7d1c0d17eee7f6e204e22ea2c206">host_create_from_string</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a9f7acc8733dfa81b472255c8a3d1ca04">addr</a>, config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a0634a5a352458c50a7bdcec6bc630d67">port</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">fd</a> = <a class="code" href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">fd</a> != -1);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(<a class="code" href="../../da/d9b/group__windows.html#ga2ebd12809845fab1c8fe85b1337de183">setsockopt</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">fd</a>, SOL_SOCKET, SO_REUSEADDR,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                         (<span class="keywordtype">void</span>*)&amp;on, <span class="keyword">sizeof</span>(on)) != -1);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#gaa8e4e3f37577a6ea78111250f60a5943">ck_assert_msg</a>(<a class="code" href="../../da/d9b/group__windows.html#gaf65cc88d9ccb2274b94e0025d25d965f">bind</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">fd</a>, host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#ae37aee519ce187fe08e1f750688b0d3e">get_sockaddr</a>(host),</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                  *host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#a1b57f01c08cf587ce4192cc028a0fe29">get_sockaddr_len</a>(host)) != -1, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d7/d20/group__strerror__i.html#ga75a49b8c951e5603be44d64dd90a78ec">strerror</a>(errno));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    host-&gt;<a class="code" href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">destroy</a>(host);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(listen(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">fd</a>, 1) != -1);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#af757732ea9e4e4531e1e0dfafe273abf">processor</a>-&gt;<a class="code" href="../../d0/db8/structprocessor__t.html#afcfa6a6b6a78af897230bfb49cb26764">set_threads</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#af757732ea9e4e4531e1e0dfafe273abf">processor</a>, 8);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#af757732ea9e4e4531e1e0dfafe273abf">processor</a>-&gt;<a class="code" href="../../d0/db8/structprocessor__t.html#a798f6d1c1128a7fb380d2ef92816fd86">queue_job</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#af757732ea9e4e4531e1e0dfafe273abf">processor</a>, (<a class="code" href="../../d2/d68/structjob__t.html">job_t</a>*)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <a class="code" href="../../d0/d8f/group__callback__job.html#ga6934f856d27d82413610263e27a5cfa1">callback_job_create</a>((<span class="keywordtype">void</span>*)<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a83ce985fd78c1b926fd57a95efef0c3c">serve_echo</a>, config, NULL, NULL));</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_a83ce985fd78c1b926fd57a95efef0c3c"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a83ce985fd78c1b926fd57a95efef0c3c">serve_echo</a></div><div class="ttdeci">static job_requeue_t serve_echo(echo_server_config_t *config)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00280">libtls/tests/suites/test_socket.c:280</a></div></div>
<div class="ttc" id="test__traffic__selector_8c_html_a1c2046dcb30a629d6d9f45ff8f403f12"><div class="ttname"><a href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d6f/test__traffic__selector_8c_source.html#l00403">test_traffic_selector.c:403</a></div></div>
<div class="ttc" id="group__windows_html_gaa8318fbee111c5bde5952c63e894c962"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaa8318fbee111c5bde5952c63e894c962">socket</a></div><div class="ttdeci">#define socket</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00328">windows.h:328</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a1c610f34fa9444505a6cb4d1581fea1f"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">echo_server_config_t::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00273">libtls/tests/suites/test_socket.c:273</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="group__windows_html_gaf65cc88d9ccb2274b94e0025d25d965f"><div class="ttname"><a href="../../da/d9b/group__windows.html#gaf65cc88d9ccb2274b94e0025d25d965f">bind</a></div><div class="ttdeci">#define bind</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00296">windows.h:296</a></div></div>
<div class="ttc" id="group__windows_html_ga2ebd12809845fab1c8fe85b1337de183"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga2ebd12809845fab1c8fe85b1337de183">setsockopt</a></div><div class="ttdeci">#define setsockopt</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00321">windows.h:321</a></div></div>
<div class="ttc" id="structlibrary__t_html_af757732ea9e4e4531e1e0dfafe273abf"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#af757732ea9e4e4531e1e0dfafe273abf">library_t::processor</a></div><div class="ttdeci">processor_t * processor</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00215">library.h:215</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a9f7acc8733dfa81b472255c8a3d1ca04"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a9f7acc8733dfa81b472255c8a3d1ca04">echo_server_config_t::addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00271">libtls/tests/suites/test_socket.c:271</a></div></div>
<div class="ttc" id="group__test__suite_html_gaa8e4e3f37577a6ea78111250f60a5943"><div class="ttname"><a href="../../de/d18/group__test__suite.html#gaa8e4e3f37577a6ea78111250f60a5943">ck_assert_msg</a></div><div class="ttdeci">#define ck_assert_msg</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00343">test_suite.h:343</a></div></div>
<div class="ttc" id="structprocessor__t_html_a798f6d1c1128a7fb380d2ef92816fd86"><div class="ttname"><a href="../../d0/db8/structprocessor__t.html#a798f6d1c1128a7fb380d2ef92816fd86">processor_t::queue_job</a></div><div class="ttdeci">void(* queue_job)(processor_t *this, job_t *job)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d99/processor_8h_source.html#l00077">processor.h:77</a></div></div>
<div class="ttc" id="structhost__t_html_a1b57f01c08cf587ce4192cc028a0fe29"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#a1b57f01c08cf587ce4192cc028a0fe29">host_t::get_sockaddr_len</a></div><div class="ttdeci">socklen_t *(* get_sockaddr_len)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00072">host.h:72</a></div></div>
<div class="ttc" id="group__strerror__i_html_ga75a49b8c951e5603be44d64dd90a78ec"><div class="ttname"><a href="../../d7/d20/group__strerror__i.html#ga75a49b8c951e5603be44d64dd90a78ec">strerror</a></div><div class="ttdeci">#define strerror(errnum)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dd1/strerror_8h_source.html#l00049">strerror.h:49</a></div></div>
<div class="ttc" id="group__test__suite_html_ga07bed5f12e10d5de7c72f91f9d12a56f"><div class="ttname"><a href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a></div><div class="ttdeci">#define ck_assert</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00342">test_suite.h:342</a></div></div>
<div class="ttc" id="structhost__t_html_af9703b61f348ea0409dc9cb197b2b788"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#af9703b61f348ea0409dc9cb197b2b788">host_t::destroy</a></div><div class="ttdeci">void(* destroy)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00130">host.h:130</a></div></div>
<div class="ttc" id="structhost__t_html"><div class="ttname"><a href="../../d5/dcf/structhost__t.html">host_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00043">host.h:43</a></div></div>
<div class="ttc" id="structjob__t_html"><div class="ttname"><a href="../../d2/d68/structjob__t.html">job_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d6a/job_8h_source.html#l00119">job.h:119</a></div></div>
<div class="ttc" id="group__host_html_gad1ee7d1c0d17eee7f6e204e22ea2c206"><div class="ttname"><a href="../../d7/df1/group__host.html#gad1ee7d1c0d17eee7f6e204e22ea2c206">host_create_from_string</a></div><div class="ttdeci">host_t * host_create_from_string(char *string, u_int16_t port)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/host_8c_source.html#l00418">host.c:418</a></div></div>
<div class="ttc" id="structprocessor__t_html_afcfa6a6b6a78af897230bfb49cb26764"><div class="ttname"><a href="../../d0/db8/structprocessor__t.html#afcfa6a6b6a78af897230bfb49cb26764">processor_t::set_threads</a></div><div class="ttdeci">void(* set_threads)(processor_t *this, u_int count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d99/processor_8h_source.html#l00100">processor.h:100</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a0634a5a352458c50a7bdcec6bc630d67"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a0634a5a352458c50a7bdcec6bc630d67">echo_server_config_t::port</a></div><div class="ttdeci">u_int16_t port</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00270">libtls/tests/suites/test_socket.c:270</a></div></div>
<div class="ttc" id="structhost__t_html_ae37aee519ce187fe08e1f750688b0d3e"><div class="ttname"><a href="../../d5/dcf/structhost__t.html#ae37aee519ce187fe08e1f750688b0d3e">host_t::get_sockaddr</a></div><div class="ttdeci">sockaddr_t *(* get_sockaddr)(host_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/ded/host_8h_source.html#l00059">host.h:59</a></div></div>
<div class="ttc" id="group__callback__job_html_ga6934f856d27d82413610263e27a5cfa1"><div class="ttname"><a href="../../d0/d8f/group__callback__job.html#ga6934f856d27d82413610263e27a5cfa1">callback_job_create</a></div><div class="ttdeci">callback_job_t * callback_job_create(callback_job_cb_t cb, void *data, callback_job_cleanup_t cleanup, callback_job_cancel_t cancel)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d84/callback__job_8c_source.html#l00127">callback_job.c:127</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a52e665104566fbb4bd8fcd9d3b336110_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a52e665104566fbb4bd8fcd9d3b336110_icgraph.svg" width="456" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aea430c2184eea355b57105be1a6bdad7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">START_SETUP </td>
          <td>(</td>
          <td class="paramtype">setup_creds&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00222">222</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../d9/d53/mem__cred_8h_source.html#l00048">mem_cred_t::add_cert</a>, <a class="el" href="../../d9/d53/mem__cred_8h_source.html#l00087">mem_cred_t::add_key</a>, <a class="el" href="../../d1/db3/credential__manager_8h_source.html#l00251">credential_manager_t::add_set</a>, <a class="el" href="../../d5/d78/builder_8h_source.html#l00051">BUILD_BLOB</a>, <a class="el" href="../../d5/d78/builder_8h_source.html#l00155">BUILD_END</a>, <a class="el" href="../../d5/d64/load__tester__creds_8c_source.html#l00155">cert</a>, <a class="el" href="../../d0/dc9/certificate_8h_source.html#l00040">CERT_X509</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00231">chunk_from_thing</a>, <a class="el" href="../../d3/dc9/credential__factory_8h_source.html#l00070">credential_factory_t::create</a>, <a class="el" href="../../d3/dc9/credential__factory_8h_source.html#l00041">CRED_CERTIFICATE</a>, <a class="el" href="../../d3/dc9/credential__factory_8h_source.html#l00037">CRED_PRIVATE_KEY</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00185">library_t::credmgr</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00180">library_t::creds</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00115">ecdsa</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00189">ecdsa_crt</a>, <a class="el" href="../../d0/d19/radius__mppe_8h_source.html#l00316">key</a>, <a class="el" href="../../da/d10/public__key_8h_source.html#l00044">KEY_ECDSA</a>, <a class="el" href="../../da/d10/public__key_8h_source.html#l00042">KEY_RSA</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../d9/d89/mem__cred_8c_source.html#l00779">mem_cred_create()</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00034">rsa</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00132">rsa_crt</a>, <a class="el" href="../../d9/d53/mem__cred_8h_source.html#l00040">mem_cred_t::set</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="../../d5/d9e/structprivate__key__t.html">private_key_t</a> *<a class="code" href="../../d0/d19/radius__mppe_8h.html#ab6e215785807d1ec2ff07341741e6825">key</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="../../d6/d41/structcertificate__t.html">certificate_t</a> *<a class="code" href="../../d5/d64/load__tester__creds_8c.html#a810d1e0d181419198e4d8046413d75ec">cert</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a> = <a class="code" href="../../d8/d02/group__mem__cred.html#gaa52fd614922d5b94956113247f386f21">mem_cred_create</a>();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    key = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">creds</a>-&gt;<a class="code" href="../../dd/df7/structcredential__factory__t.html#ad8140448ccfa7173f0d1a66555065774">create</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">creds</a>, <a class="code" href="../../d9/da9/group__credential__factory.html#ggad21bac5d5c20920fc4e009ec4e720896aa5b6801ac48e48642f25adb2abd9db71">CRED_PRIVATE_KEY</a>, <a class="code" href="../../de/d2a/group__public__key.html#gga4f367c350737c92475175fb229c5570ea65cf8a6f083e35e24ef99d073358e357">KEY_RSA</a>,</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                             <a class="code" href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496ae810115fae76a344459b3c2b71c0d85c">BUILD_BLOB</a>, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab6fb49baf89e350db09a6a3b89052fff">rsa</a>), <a class="code" href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496aed7c4a18e7d9c09a4834c4ff2865f3cb">BUILD_END</a>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (key)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>-&gt;<a class="code" href="../../d8/d38/structmem__cred__t.html#a53c1044806a267c2250bc1c606f5c992">add_key</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>, key);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    key = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">creds</a>-&gt;<a class="code" href="../../dd/df7/structcredential__factory__t.html#ad8140448ccfa7173f0d1a66555065774">create</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">creds</a>, <a class="code" href="../../d9/da9/group__credential__factory.html#ggad21bac5d5c20920fc4e009ec4e720896aa5b6801ac48e48642f25adb2abd9db71">CRED_PRIVATE_KEY</a>, <a class="code" href="../../de/d2a/group__public__key.html#gga4f367c350737c92475175fb229c5570eab6fdc1c4a75a821b26e7f8884e743c9b">KEY_ECDSA</a>,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                             <a class="code" href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496ae810115fae76a344459b3c2b71c0d85c">BUILD_BLOB</a>, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ac8a151d46c7c71708d215f186be8fe47">ecdsa</a>), <a class="code" href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496aed7c4a18e7d9c09a4834c4ff2865f3cb">BUILD_END</a>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (key)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>-&gt;<a class="code" href="../../d8/d38/structmem__cred__t.html#a53c1044806a267c2250bc1c606f5c992">add_key</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>, key);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    cert = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">creds</a>-&gt;<a class="code" href="../../dd/df7/structcredential__factory__t.html#ad8140448ccfa7173f0d1a66555065774">create</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">creds</a>, <a class="code" href="../../d9/da9/group__credential__factory.html#ggad21bac5d5c20920fc4e009ec4e720896a873e21a64bb3ff3a61d69cc9b896ad7f">CRED_CERTIFICATE</a>, <a class="code" href="../../d8/d88/group__certificate.html#gga23f138bba282b72e8d9aff637efd69afa2babe61b2300e5ee9dbaac53c19b2af9">CERT_X509</a>,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                              <a class="code" href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496ae810115fae76a344459b3c2b71c0d85c">BUILD_BLOB</a>, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#acb6e8cdb48ba76d6b2ad9442ec466111">rsa_crt</a>), <a class="code" href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496aed7c4a18e7d9c09a4834c4ff2865f3cb">BUILD_END</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (cert)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>-&gt;<a class="code" href="../../d8/d38/structmem__cred__t.html#a15102337fe2c1312c23f024f050d813c">add_cert</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, cert);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    cert = <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">creds</a>-&gt;<a class="code" href="../../dd/df7/structcredential__factory__t.html#ad8140448ccfa7173f0d1a66555065774">create</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">creds</a>, <a class="code" href="../../d9/da9/group__credential__factory.html#ggad21bac5d5c20920fc4e009ec4e720896a873e21a64bb3ff3a61d69cc9b896ad7f">CRED_CERTIFICATE</a>, <a class="code" href="../../d8/d88/group__certificate.html#gga23f138bba282b72e8d9aff637efd69afa2babe61b2300e5ee9dbaac53c19b2af9">CERT_X509</a>,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                              <a class="code" href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496ae810115fae76a344459b3c2b71c0d85c">BUILD_BLOB</a>, <a class="code" href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a658aef9950550445c55bcecfd702f094">ecdsa_crt</a>), <a class="code" href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496aed7c4a18e7d9c09a4834c4ff2865f3cb">BUILD_END</a>);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (cert)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>-&gt;<a class="code" href="../../d8/d38/structmem__cred__t.html#a15102337fe2c1312c23f024f050d813c">add_cert</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, cert);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ac76a30d66eefa5be9e7058f51f33ce3a">credmgr</a>-&gt;<a class="code" href="../../dd/d3a/structcredential__manager__t.html#a28d99ff020ee12b284a8929e36ab9c6d">add_set</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ac76a30d66eefa5be9e7058f51f33ce3a">credmgr</a>, &amp;<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>-&gt;<a class="code" href="../../d8/d38/structmem__cred__t.html#a14128ab2fd45cc01e10df4b6df94b112">set</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
<div class="ttc" id="structmem__cred__t_html_a15102337fe2c1312c23f024f050d813c"><div class="ttname"><a href="../../d8/d38/structmem__cred__t.html#a15102337fe2c1312c23f024f050d813c">mem_cred_t::add_cert</a></div><div class="ttdeci">void(* add_cert)(mem_cred_t *this, bool trusted, certificate_t *cert)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d53/mem__cred_8h_source.html#l00048">mem_cred.h:48</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_af1da463627532f30f3a53d328d502b28"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a></div><div class="ttdeci">static mem_cred_t * creds</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00029">libtls/tests/suites/test_socket.c:29</a></div></div>
<div class="ttc" id="structmem__cred__t_html_a53c1044806a267c2250bc1c606f5c992"><div class="ttname"><a href="../../d8/d38/structmem__cred__t.html#a53c1044806a267c2250bc1c606f5c992">mem_cred_t::add_key</a></div><div class="ttdeci">void(* add_key)(mem_cred_t *this, private_key_t *key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d53/mem__cred_8h_source.html#l00087">mem_cred.h:87</a></div></div>
<div class="ttc" id="structcredential__factory__t_html_ad8140448ccfa7173f0d1a66555065774"><div class="ttname"><a href="../../dd/df7/structcredential__factory__t.html#ad8140448ccfa7173f0d1a66555065774">credential_factory_t::create</a></div><div class="ttdeci">void *(* create)(credential_factory_t *this, credential_type_t type, int subtype,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/credential__factory_8h_source.html#l00070">credential_factory.h:70</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="structmem__cred__t_html_a14128ab2fd45cc01e10df4b6df94b112"><div class="ttname"><a href="../../d8/d38/structmem__cred__t.html#a14128ab2fd45cc01e10df4b6df94b112">mem_cred_t::set</a></div><div class="ttdeci">credential_set_t set</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d53/mem__cred_8h_source.html#l00040">mem_cred.h:40</a></div></div>
<div class="ttc" id="group__chunk_html_gac3f5fa345b175b600f58a86b04ac9671"><div class="ttname"><a href="../../d4/d87/group__chunk.html#gac3f5fa345b175b600f58a86b04ac9671">chunk_from_thing</a></div><div class="ttdeci">#define chunk_from_thing(thing)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00231">chunk.h:231</a></div></div>
<div class="ttc" id="structcertificate__t_html"><div class="ttname"><a href="../../d6/d41/structcertificate__t.html">certificate_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc9/certificate_8h_source.html#l00093">certificate.h:93</a></div></div>
<div class="ttc" id="group__certificate_html_gga23f138bba282b72e8d9aff637efd69afa2babe61b2300e5ee9dbaac53c19b2af9"><div class="ttname"><a href="../../d8/d88/group__certificate.html#gga23f138bba282b72e8d9aff637efd69afa2babe61b2300e5ee9dbaac53c19b2af9">CERT_X509</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc9/certificate_8h_source.html#l00040">certificate.h:40</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ab6fb49baf89e350db09a6a3b89052fff"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab6fb49baf89e350db09a6a3b89052fff">rsa</a></div><div class="ttdeci">static char rsa[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00034">libtls/tests/suites/test_socket.c:34</a></div></div>
<div class="ttc" id="structlibrary__t_html_a17351cb5b3809e8ec3b4573f6cf2c7f0"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#a17351cb5b3809e8ec3b4573f6cf2c7f0">library_t::creds</a></div><div class="ttdeci">credential_factory_t * creds</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00180">library.h:180</a></div></div>
<div class="ttc" id="structcredential__manager__t_html_a28d99ff020ee12b284a8929e36ab9c6d"><div class="ttname"><a href="../../dd/d3a/structcredential__manager__t.html#a28d99ff020ee12b284a8929e36ab9c6d">credential_manager_t::add_set</a></div><div class="ttdeci">void(* add_set)(credential_manager_t *this, credential_set_t *set)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db3/credential__manager_8h_source.html#l00251">credential_manager.h:251</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_a658aef9950550445c55bcecfd702f094"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a658aef9950550445c55bcecfd702f094">ecdsa_crt</a></div><div class="ttdeci">static char ecdsa_crt[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00189">libtls/tests/suites/test_socket.c:189</a></div></div>
<div class="ttc" id="group__builder_html_ggac235124c17a6e240bceba033c947c496ae810115fae76a344459b3c2b71c0d85c"><div class="ttname"><a href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496ae810115fae76a344459b3c2b71c0d85c">BUILD_BLOB</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d78/builder_8h_source.html#l00051">builder.h:51</a></div></div>
<div class="ttc" id="group__mem__cred_html_gaa52fd614922d5b94956113247f386f21"><div class="ttname"><a href="../../d8/d02/group__mem__cred.html#gaa52fd614922d5b94956113247f386f21">mem_cred_create</a></div><div class="ttdeci">mem_cred_t * mem_cred_create()</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d89/mem__cred_8c_source.html#l00779">mem_cred.c:779</a></div></div>
<div class="ttc" id="group__public__key_html_gga4f367c350737c92475175fb229c5570ea65cf8a6f083e35e24ef99d073358e357"><div class="ttname"><a href="../../de/d2a/group__public__key.html#gga4f367c350737c92475175fb229c5570ea65cf8a6f083e35e24ef99d073358e357">KEY_RSA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d10/public__key_8h_source.html#l00042">public_key.h:42</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__public__key_html_gga4f367c350737c92475175fb229c5570eab6fdc1c4a75a821b26e7f8884e743c9b"><div class="ttname"><a href="../../de/d2a/group__public__key.html#gga4f367c350737c92475175fb229c5570eab6fdc1c4a75a821b26e7f8884e743c9b">KEY_ECDSA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d10/public__key_8h_source.html#l00044">public_key.h:44</a></div></div>
<div class="ttc" id="structlibrary__t_html_ac76a30d66eefa5be9e7058f51f33ce3a"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#ac76a30d66eefa5be9e7058f51f33ce3a">library_t::credmgr</a></div><div class="ttdeci">credential_manager_t * credmgr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00185">library.h:185</a></div></div>
<div class="ttc" id="group__builder_html_ggac235124c17a6e240bceba033c947c496aed7c4a18e7d9c09a4834c4ff2865f3cb"><div class="ttname"><a href="../../de/d8f/group__builder.html#ggac235124c17a6e240bceba033c947c496aed7c4a18e7d9c09a4834c4ff2865f3cb">BUILD_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d78/builder_8h_source.html#l00155">builder.h:155</a></div></div>
<div class="ttc" id="load__tester__creds_8c_html_a810d1e0d181419198e4d8046413d75ec"><div class="ttname"><a href="../../d5/d64/load__tester__creds_8c.html#a810d1e0d181419198e4d8046413d75ec">cert</a></div><div class="ttdeci">static char cert[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d64/load__tester__creds_8c_source.html#l00155">load_tester_creds.c:155</a></div></div>
<div class="ttc" id="radius__mppe_8h_html_ab6e215785807d1ec2ff07341741e6825"><div class="ttname"><a href="../../d0/d19/radius__mppe_8h.html#ab6e215785807d1ec2ff07341741e6825">key</a></div><div class="ttdeci">u_int8_t key[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d19/radius__mppe_8h_source.html#l00316">radius_mppe.h:316</a></div></div>
<div class="ttc" id="structprivate__key__t_html"><div class="ttname"><a href="../../d5/d9e/structprivate__key__t.html">private_key_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dd3/private__key_8h_source.html#l00032">private_key.h:32</a></div></div>
<div class="ttc" id="group__credential__factory_html_ggad21bac5d5c20920fc4e009ec4e720896a873e21a64bb3ff3a61d69cc9b896ad7f"><div class="ttname"><a href="../../d9/da9/group__credential__factory.html#ggad21bac5d5c20920fc4e009ec4e720896a873e21a64bb3ff3a61d69cc9b896ad7f">CRED_CERTIFICATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/credential__factory_8h_source.html#l00041">credential_factory.h:41</a></div></div>
<div class="ttc" id="group__credential__factory_html_ggad21bac5d5c20920fc4e009ec4e720896aa5b6801ac48e48642f25adb2abd9db71"><div class="ttname"><a href="../../d9/da9/group__credential__factory.html#ggad21bac5d5c20920fc4e009ec4e720896aa5b6801ac48e48642f25adb2abd9db71">CRED_PRIVATE_KEY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/credential__factory_8h_source.html#l00037">credential_factory.h:37</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ac8a151d46c7c71708d215f186be8fe47"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ac8a151d46c7c71708d215f186be8fe47">ecdsa</a></div><div class="ttdeci">static char ecdsa[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00115">libtls/tests/suites/test_socket.c:115</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_acb6e8cdb48ba76d6b2ad9442ec466111"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#acb6e8cdb48ba76d6b2ad9442ec466111">rsa_crt</a></div><div class="ttdeci">static char rsa_crt[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00132">libtls/tests/suites/test_socket.c:132</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_aea430c2184eea355b57105be1a6bdad7_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5c54ef320aeee6ab1d8c5fbedefab651"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d18/group__test__suite.html#gab68451c03c02d2fc454f0a6d134506a2">END_SETUP</a> START_TEARDOWN </td>
          <td>(</td>
          <td class="paramtype">teardown_creds&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00258">258</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../dd/d08/library_8h_source.html#l00185">library_t::credmgr</a>, <a class="el" href="../../d9/d53/mem__cred_8h_source.html#l00149">mem_cred_t::destroy</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../d1/db3/credential__manager_8h_source.html#l00258">credential_manager_t::remove_set</a>, and <a class="el" href="../../d9/d53/mem__cred_8h_source.html#l00040">mem_cred_t::set</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ac76a30d66eefa5be9e7058f51f33ce3a">credmgr</a>-&gt;<a class="code" href="../../dd/d3a/structcredential__manager__t.html#a0c17330c63226be0d7d3c1f979cba780">remove_set</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ac76a30d66eefa5be9e7058f51f33ce3a">credmgr</a>, &amp;<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>-&gt;<a class="code" href="../../d8/d38/structmem__cred__t.html#a14128ab2fd45cc01e10df4b6df94b112">set</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>-&gt;<a class="code" href="../../d8/d38/structmem__cred__t.html#ad480d3595f0277f8bf840a8678ea685c">destroy</a>(<a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_af1da463627532f30f3a53d328d502b28"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#af1da463627532f30f3a53d328d502b28">creds</a></div><div class="ttdeci">static mem_cred_t * creds</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00029">libtls/tests/suites/test_socket.c:29</a></div></div>
<div class="ttc" id="structcredential__manager__t_html_a0c17330c63226be0d7d3c1f979cba780"><div class="ttname"><a href="../../dd/d3a/structcredential__manager__t.html#a0c17330c63226be0d7d3c1f979cba780">credential_manager_t::remove_set</a></div><div class="ttdeci">void(* remove_set)(credential_manager_t *this, credential_set_t *set)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/db3/credential__manager_8h_source.html#l00258">credential_manager.h:258</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="structmem__cred__t_html_a14128ab2fd45cc01e10df4b6df94b112"><div class="ttname"><a href="../../d8/d38/structmem__cred__t.html#a14128ab2fd45cc01e10df4b6df94b112">mem_cred_t::set</a></div><div class="ttdeci">credential_set_t set</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d53/mem__cred_8h_source.html#l00040">mem_cred.h:40</a></div></div>
<div class="ttc" id="structmem__cred__t_html_ad480d3595f0277f8bf840a8678ea685c"><div class="ttname"><a href="../../d8/d38/structmem__cred__t.html#ad480d3595f0277f8bf840a8678ea685c">mem_cred_t::destroy</a></div><div class="ttdeci">void(* destroy)(mem_cred_t *this)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d53/mem__cred_8h_source.html#l00149">mem_cred.h:149</a></div></div>
<div class="ttc" id="structlibrary__t_html_ac76a30d66eefa5be9e7058f51f33ce3a"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#ac76a30d66eefa5be9e7058f51f33ce3a">library_t::credmgr</a></div><div class="ttdeci">credential_manager_t * credmgr</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00185">library.h:185</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1eea2e528e1d4949dddbb55396230be7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_tls12&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00447">447</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">test_tls()</a>, and <a class="el" href="../../df/d79/tls_8h_source.html#l00054">TLS_1_2</a>.</p>
<div class="fragment"><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a>(<a class="code" href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a8d79d526c34d1313f9d251fe022ea90c">TLS_1_2</a>, 5671, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, _i);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="ttc" id="group__tls_html_gga09354d8c40ff4fdb9e677f415595e9b4a8d79d526c34d1313f9d251fe022ea90c"><div class="ttname"><a href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a8d79d526c34d1313f9d251fe022ea90c">TLS_1_2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d79/tls_8h_source.html#l00054">tls.h:54</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ab74d2178e43d8a7a809ccbdbef66b060"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a></div><div class="ttdeci">static void test_tls(tls_version_t version, u_int16_t port, bool cauth, u_int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">libtls/tests/suites/test_socket.c:414</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a1eea2e528e1d4949dddbb55396230be7_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa050565d872783d8b823fbe18ece7e66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a> START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_tls12_mutual&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00453">453</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">test_tls()</a>, <a class="el" href="../../df/d79/tls_8h_source.html#l00054">TLS_1_2</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;{</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a>(<a class="code" href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a8d79d526c34d1313f9d251fe022ea90c">TLS_1_2</a>, 5672, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, _i);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;}</div>
<div class="ttc" id="group__tls_html_gga09354d8c40ff4fdb9e677f415595e9b4a8d79d526c34d1313f9d251fe022ea90c"><div class="ttname"><a href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a8d79d526c34d1313f9d251fe022ea90c">TLS_1_2</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d79/tls_8h_source.html#l00054">tls.h:54</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ab74d2178e43d8a7a809ccbdbef66b060"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a></div><div class="ttdeci">static void test_tls(tls_version_t version, u_int16_t port, bool cauth, u_int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">libtls/tests/suites/test_socket.c:414</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_aa050565d872783d8b823fbe18ece7e66_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad5a9952f35633a6c69ee9d30dd583a9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a> START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_tls11&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00459">459</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">test_tls()</a>, and <a class="el" href="../../df/d79/tls_8h_source.html#l00053">TLS_1_1</a>.</p>
<div class="fragment"><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;{</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a>(<a class="code" href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a0ef64184cf06bb1352a698b98d6545f8">TLS_1_1</a>, 5673, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, _i);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__tls_html_gga09354d8c40ff4fdb9e677f415595e9b4a0ef64184cf06bb1352a698b98d6545f8"><div class="ttname"><a href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a0ef64184cf06bb1352a698b98d6545f8">TLS_1_1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d79/tls_8h_source.html#l00053">tls.h:53</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ab74d2178e43d8a7a809ccbdbef66b060"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a></div><div class="ttdeci">static void test_tls(tls_version_t version, u_int16_t port, bool cauth, u_int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">libtls/tests/suites/test_socket.c:414</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_ad5a9952f35633a6c69ee9d30dd583a9c_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a109586c93c27aff11574cdad1bba0cfb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a> START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_tls11_mutual&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00465">465</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">test_tls()</a>, <a class="el" href="../../df/d79/tls_8h_source.html#l00053">TLS_1_1</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;{</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a>(<a class="code" href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a0ef64184cf06bb1352a698b98d6545f8">TLS_1_1</a>, 5674, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, _i);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div>
<div class="ttc" id="group__tls_html_gga09354d8c40ff4fdb9e677f415595e9b4a0ef64184cf06bb1352a698b98d6545f8"><div class="ttname"><a href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a0ef64184cf06bb1352a698b98d6545f8">TLS_1_1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d79/tls_8h_source.html#l00053">tls.h:53</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ab74d2178e43d8a7a809ccbdbef66b060"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a></div><div class="ttdeci">static void test_tls(tls_version_t version, u_int16_t port, bool cauth, u_int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">libtls/tests/suites/test_socket.c:414</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a109586c93c27aff11574cdad1bba0cfb_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a18e0d5b490d1bc47cbb23ccaac0e5522"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a> START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_tls10&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00471">471</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01233">FALSE</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">test_tls()</a>, and <a class="el" href="../../df/d79/tls_8h_source.html#l00052">TLS_1_0</a>.</p>
<div class="fragment"><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a>(<a class="code" href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a12987111553a75b5dc8d8ce749ee9ff9">TLS_1_0</a>, 5675, <a class="code" href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, _i);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}</div>
<div class="ttc" id="pkcs11_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01233">pkcs11.h:1233</a></div></div>
<div class="ttc" id="group__tls_html_gga09354d8c40ff4fdb9e677f415595e9b4a12987111553a75b5dc8d8ce749ee9ff9"><div class="ttname"><a href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a12987111553a75b5dc8d8ce749ee9ff9">TLS_1_0</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d79/tls_8h_source.html#l00052">tls.h:52</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ab74d2178e43d8a7a809ccbdbef66b060"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a></div><div class="ttdeci">static void test_tls(tls_version_t version, u_int16_t port, bool cauth, u_int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">libtls/tests/suites/test_socket.c:414</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a18e0d5b490d1bc47cbb23ccaac0e5522_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a23c1910984a7df4ef31eeaf136d29b70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/d18/group__test__suite.html#gaefcd1ca1799d2395f7bbe3c50bcc8ff8">END_TEST</a> START_TEST </td>
          <td>(</td>
          <td class="paramtype">test_tls10_mutual&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00477">477</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">test_tls()</a>, <a class="el" href="../../df/d79/tls_8h_source.html#l00052">TLS_1_0</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>
<div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;{</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a>(<a class="code" href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a12987111553a75b5dc8d8ce749ee9ff9">TLS_1_0</a>, 5676, <a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, _i);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div>
<div class="ttc" id="group__tls_html_gga09354d8c40ff4fdb9e677f415595e9b4a12987111553a75b5dc8d8ce749ee9ff9"><div class="ttname"><a href="../../db/db4/group__tls.html#gga09354d8c40ff4fdb9e677f415595e9b4a12987111553a75b5dc8d8ce749ee9ff9">TLS_1_0</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d79/tls_8h_source.html#l00052">tls.h:52</a></div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ab74d2178e43d8a7a809ccbdbef66b060"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab74d2178e43d8a7a809ccbdbef66b060">test_tls</a></div><div class="ttdeci">static void test_tls(tls_version_t version, u_int16_t port, bool cauth, u_int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">libtls/tests/suites/test_socket.c:414</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_a23c1910984a7df4ef31eeaf136d29b70_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab74d2178e43d8a7a809ccbdbef66b060"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void test_tls </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/db4/group__tls.html#ga09354d8c40ff4fdb9e677f415595e9b4">tls_version_t</a>&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>&#160;</td>
          <td class="paramname"><em>cauth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Common test wrapper function for different test variants </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00414">414</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>References <a class="el" href="../../de/d3b/test__host_8c_source.html#l00658">addr</a>, <a class="el" href="../../dd/dd5/chunk_8h_source.html#l00226">chunk_from_chars</a>, <a class="el" href="../../d6/d7a/test__suite_8h_source.html#l00342">ck_assert</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00341">close</a>, <a class="el" href="../../d1/d14/fetch_8c_source.html#l00022">count</a>, <a class="el" href="../../d9/d42/eap__gtc_8c_source.html#l00050">data</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00273">echo_server_config_t::fd</a>, <a class="el" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free()</a>, <a class="el" href="../../de/d10/object_8h_source.html#l00043">INIT</a>, <a class="el" href="../../d5/d27/library_8c_source.html#l00067">lib</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00150">library_t::ns</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00358">run_echo_client()</a>, <a class="el" href="../../de/d60/settings_8h_source.html#l00215">settings_t::set_str</a>, <a class="el" href="../../dd/d08/library_8h_source.html#l00240">library_t::settings</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00279">SHUT_RDWR</a>, <a class="el" href="../../d9/d43/windows_8h_source.html#l00284">shutdown</a>, <a class="el" href="../../d9/d12/printf__hook__builtin_8h_source.html#l00073">snprintf</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00333">start_echo_server()</a>, <a class="el" href="../../d5/dbd/group__tls__crypto.html#gac793f9acda24b3a7730c817242c3a9db">tls_cipher_suite_names</a>, <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l01861">tls_crypto_get_supported_suites()</a>, and <a class="el" href="../../db/d62/pkcs11_8h_source.html#l01236">TRUE</a>.</p>

<p>Referenced by <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00447">START_TEST()</a>, and <a class="el" href="../../d4/ded/test__threading_8c_source.html#l01658">threading_suite_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a> *config;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="../../d5/dbd/group__tls__crypto.html#ga1dea8574df1b593c2a6248ca8d5ba28d">tls_cipher_suite_t</a> *suites;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordtype">char</span> suite[128];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a>(config,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        .<a class="code" href="../../de/d09/eap__sim__peer_8c.html#ae000f2bae31d37c237cb739f6d4d4eca">version</a> = <a class="code" href="../../de/d09/eap__sim__peer_8c.html#ae000f2bae31d37c237cb739f6d4d4eca">version</a>,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        .<a class="code" href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a> = <span class="stringliteral">&quot;127.0.0.1&quot;</span>,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        .<a class="code" href="../../d0/d72/ha__message_8c.html#a9e26a4afe91a21810290057677a17a11">port</a> = <a class="code" href="../../d0/d72/ha__message_8c.html#a9e26a4afe91a21810290057677a17a11">port</a>,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        .cauth = cauth,</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        .<a class="code" href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a> = <a class="code" href="../../d4/d87/group__chunk.html#ga4e840ddd09136bdd6995ef664a52f8f1">chunk_from_chars</a>(0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08),</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    );</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a52e665104566fbb4bd8fcd9d3b336110">start_echo_server</a>(config);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    count = <a class="code" href="../../d5/dbd/group__tls__crypto.html#ga3907a12a0a0102cad72980a8b38719b3">tls_crypto_get_supported_suites</a>(<a class="code" href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, &amp;suites);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a>(i &lt; count);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a>(suite, <span class="keyword">sizeof</span>(suite), <span class="stringliteral">&quot;%N&quot;</span>, <a class="code" href="../../d5/dbd/group__tls__crypto.html#gac793f9acda24b3a7730c817242c3a9db">tls_cipher_suite_names</a>, suites[i]);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>-&gt;<a class="code" href="../../db/d2f/structsettings__t.html#aa6570b30953b910cbf9c69bc2a54d987">set_str</a>(<a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">settings</a>, <span class="stringliteral">&quot;%s.tls.suites&quot;</span>, suite, <a class="code" href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a>-&gt;<a class="code" href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">ns</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab0bb9ef647f2319f96ededd2394977c3">run_echo_client</a>(config);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(suites);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="../../da/d9b/group__windows.html#gabb5abf491305ecb624576b9d3120e0ae">shutdown</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">fd</a>, <a class="code" href="../../da/d9b/group__windows.html#ga80c54d1399557c97a0c81a319d08e9db">SHUT_RDWR</a>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="../../da/d9b/group__windows.html#ga9c7f6d5331abb2692a876d5ee67474b7">close</a>(config-&gt;<a class="code" href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">fd</a>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a>(config);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div>
<div class="ttc" id="group__tls__crypto_html_ga3907a12a0a0102cad72980a8b38719b3"><div class="ttname"><a href="../../d5/dbd/group__tls__crypto.html#ga3907a12a0a0102cad72980a8b38719b3">tls_crypto_get_supported_suites</a></div><div class="ttdeci">int tls_crypto_get_supported_suites(bool null, tls_cipher_suite_t **out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d58/tls__crypto_8c_source.html#l01861">tls_crypto.c:1861</a></div></div>
<div class="ttc" id="test__host_8c_html_aa0e04e47800a4ae6a856f0fdb5426215"><div class="ttname"><a href="../../de/d3b/test__host_8c.html#aa0e04e47800a4ae6a856f0fdb5426215">addr</a></div><div class="ttdeci">char * addr</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d3b/test__host_8c_source.html#l00658">test_host.c:658</a></div></div>
<div class="ttc" id="fetch_8c_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../d1/d14/fetch_8c.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">static int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d14/fetch_8c_source.html#l00022">fetch.c:22</a></div></div>
<div class="ttc" id="eap__gtc_8c_html_af2428667844f97f09f11f86c1ae10092"><div class="ttname"><a href="../../d9/d42/eap__gtc_8c.html#af2428667844f97f09f11f86c1ae10092">data</a></div><div class="ttdeci">u_int8_t data[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d42/eap__gtc_8c_source.html#l00050">eap_gtc.c:50</a></div></div>
<div class="ttc" id="group__windows_html_ga80c54d1399557c97a0c81a319d08e9db"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga80c54d1399557c97a0c81a319d08e9db">SHUT_RDWR</a></div><div class="ttdeci">#define SHUT_RDWR</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00279">windows.h:279</a></div></div>
<div class="ttc" id="eap__sim__peer_8c_html_ae000f2bae31d37c237cb739f6d4d4eca"><div class="ttname"><a href="../../de/d09/eap__sim__peer_8c.html#ae000f2bae31d37c237cb739f6d4d4eca">version</a></div><div class="ttdeci">static chunk_t version</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d09/eap__sim__peer_8c_source.html#l00106">eap_sim_peer.c:106</a></div></div>
<div class="ttc" id="structecho__server__config__t_html_a1c610f34fa9444505a6cb4d1581fea1f"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html#a1c610f34fa9444505a6cb4d1581fea1f">echo_server_config_t::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00273">libtls/tests/suites/test_socket.c:273</a></div></div>
<div class="ttc" id="group__library_html_gab7a6e433c9311a97d217ce0c4a16f5e7"><div class="ttname"><a href="../../d3/d99/group__library.html#gab7a6e433c9311a97d217ce0c4a16f5e7">lib</a></div><div class="ttdeci">library_t * lib</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/library_8c_source.html#l00067">library.c:67</a></div></div>
<div class="ttc" id="structsettings__t_html_aa6570b30953b910cbf9c69bc2a54d987"><div class="ttname"><a href="../../db/d2f/structsettings__t.html#aa6570b30953b910cbf9c69bc2a54d987">settings_t::set_str</a></div><div class="ttdeci">void(* set_str)(settings_t *this, char *key, char *value,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d60/settings_8h_source.html#l00215">settings.h:215</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_a52e665104566fbb4bd8fcd9d3b336110"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#a52e665104566fbb4bd8fcd9d3b336110">start_echo_server</a></div><div class="ttdeci">static void start_echo_server(echo_server_config_t *config)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00333">libtls/tests/suites/test_socket.c:333</a></div></div>
<div class="ttc" id="group__tls__crypto_html_gac793f9acda24b3a7730c817242c3a9db"><div class="ttname"><a href="../../d5/dbd/group__tls__crypto.html#gac793f9acda24b3a7730c817242c3a9db">tls_cipher_suite_names</a></div><div class="ttdeci">enum_name_t * tls_cipher_suite_names</div></div>
<div class="ttc" id="group__tls__crypto_html_ga1dea8574df1b593c2a6248ca8d5ba28d"><div class="ttname"><a href="../../d5/dbd/group__tls__crypto.html#ga1dea8574df1b593c2a6248ca8d5ba28d">tls_cipher_suite_t</a></div><div class="ttdeci">tls_cipher_suite_t</div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd8/tls__crypto_8h_source.html#l00045">tls_crypto.h:45</a></div></div>
<div class="ttc" id="settings__parser_8c_html_af07d89f5ceaea0c7c8252cc41fd75f37"><div class="ttname"><a href="../../da/dfc/settings__parser_8c.html#af07d89f5ceaea0c7c8252cc41fd75f37">free</a></div><div class="ttdeci">void free(void *)</div></div>
<div class="ttc" id="pkcs11_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../db/d62/pkcs11_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/pkcs11_8h_source.html#l01236">pkcs11.h:1236</a></div></div>
<div class="ttc" id="group__printf__hook__builtin_html_gaa367b75c5aed883fef5befbdf04835a4"><div class="ttname"><a href="../../d1/dc8/group__printf__hook__builtin.html#gaa367b75c5aed883fef5befbdf04835a4">snprintf</a></div><div class="ttdeci">#define snprintf</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d12/printf__hook__builtin_8h_source.html#l00073">printf_hook_builtin.h:73</a></div></div>
<div class="ttc" id="group__test__suite_html_ga07bed5f12e10d5de7c72f91f9d12a56f"><div class="ttname"><a href="../../de/d18/group__test__suite.html#ga07bed5f12e10d5de7c72f91f9d12a56f">ck_assert</a></div><div class="ttdeci">#define ck_assert</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d7a/test__suite_8h_source.html#l00342">test_suite.h:342</a></div></div>
<div class="ttc" id="group__windows_html_ga9c7f6d5331abb2692a876d5ee67474b7"><div class="ttname"><a href="../../da/d9b/group__windows.html#ga9c7f6d5331abb2692a876d5ee67474b7">close</a></div><div class="ttdeci">#define close</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00341">windows.h:341</a></div></div>
<div class="ttc" id="group__object__i_html_ga30018aa95f4403e42ef13cead122d417"><div class="ttname"><a href="../../db/d52/group__object__i.html#ga30018aa95f4403e42ef13cead122d417">INIT</a></div><div class="ttdeci">#define INIT(this,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d10/object_8h_source.html#l00043">object.h:43</a></div></div>
<div class="ttc" id="structlibrary__t_html_aea9e6313fee01053f94cdc4a5a00e2bd"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#aea9e6313fee01053f94cdc4a5a00e2bd">library_t::ns</a></div><div class="ttdeci">const char * ns</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00150">library.h:150</a></div></div>
<div class="ttc" id="ha__message_8c_html_a9e26a4afe91a21810290057677a17a11"><div class="ttname"><a href="../../d0/d72/ha__message_8c.html#a9e26a4afe91a21810290057677a17a11">port</a></div><div class="ttdeci">u_int16_t port</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ha__message_8c_source.html#l00050">ha_message.c:50</a></div></div>
<div class="ttc" id="group__windows_html_gabb5abf491305ecb624576b9d3120e0ae"><div class="ttname"><a href="../../da/d9b/group__windows.html#gabb5abf491305ecb624576b9d3120e0ae">shutdown</a></div><div class="ttdeci">#define shutdown</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d43/windows_8h_source.html#l00284">windows.h:284</a></div></div>
<div class="ttc" id="group__chunk_html_ga4e840ddd09136bdd6995ef664a52f8f1"><div class="ttname"><a href="../../d4/d87/group__chunk.html#ga4e840ddd09136bdd6995ef664a52f8f1">chunk_from_chars</a></div><div class="ttdeci">#define chunk_from_chars(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dd5/chunk_8h_source.html#l00226">chunk.h:226</a></div></div>
<div class="ttc" id="structlibrary__t_html_ad435178668da74384948b6a151d913f5"><div class="ttname"><a href="../../d6/de0/structlibrary__t.html#ad435178668da74384948b6a151d913f5">library_t::settings</a></div><div class="ttdeci">settings_t * settings</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d08/library_8h_source.html#l00240">library.h:240</a></div></div>
<div class="ttc" id="structecho__server__config__t_html"><div class="ttname"><a href="../../d5/dc6/structecho__server__config__t.html">echo_server_config_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00268">libtls/tests/suites/test_socket.c:268</a></div></div>
<div class="ttc" id="libtls_2tests_2suites_2test__socket_8c_html_ab0bb9ef647f2319f96ededd2394977c3"><div class="ttname"><a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html#ab0bb9ef647f2319f96ededd2394977c3">run_echo_client</a></div><div class="ttdeci">static void run_echo_client(echo_server_config_t *config)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00358">libtls/tests/suites/test_socket.c:358</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_ab74d2178e43d8a7a809ccbdbef66b060_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</p>

<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_ab74d2178e43d8a7a809ccbdbef66b060_icgraph.svg" width="280" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="af1da463627532f30f3a53d328d502b28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/d38/structmem__cred__t.html">mem_cred_t</a>* creds</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Credentials for authentication </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00029">29</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac8a151d46c7c71708d215f186be8fe47"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char ecdsa[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    0x30,0x81,0xa4,0x02,0x01,0x01,0x04,0x30,0xc0,0x1f,0xfd,0x65,0xc6,0xc4,0x4c,0xb8,</div>
<div class="line">    0xff,0x56,0x08,0xb5,0xbd,0xb8,0xf5,0x93,0xf7,0x51,0x0e,0x92,0x1f,0x06,0xbf,0xa6,</div>
<div class="line">    0xd9,0x1d,0xae,0xa3,0x16,0x0d,0x0f,0xc9,0xd5,0x97,0x90,0x46,0xf1,0x98,0xa8,0x18,</div>
<div class="line">    0x07,0xba,0xcf,0x91,0x8e,0x07,0xed,0x88,0xa0,0x07,0x06,0x05,0x2b,0x81,0x04,0x00,</div>
<div class="line">    0x22,0xa1,0x64,0x03,0x62,0x00,0x04,0xd6,0xba,0xe1,0xf0,0x09,0x22,0x21,0x12,0x69,</div>
<div class="line">    0xed,0x0e,0xd5,0x02,0x8c,0xb8,0x52,0xbb,0x57,0x68,0x0e,0xf3,0xdb,0xb9,0xb1,0xee,</div>
<div class="line">    0x9c,0x67,0xa0,0xb8,0xdc,0x13,0x1e,0x5b,0x44,0x71,0x04,0xef,0x4e,0xe3,0xdd,0xf4,</div>
<div class="line">    0xa6,0xc3,0xba,0x77,0x53,0xb8,0x28,0x5f,0xd2,0x97,0x05,0xa3,0x5b,0xe6,0xde,0x0a,</div>
<div class="line">    0xce,0x11,0xa8,0xaf,0x02,0xbd,0xfa,0x17,0xf9,0xa7,0x38,0x3e,0x5b,0x57,0xb0,0x01,</div>
<div class="line">    0xb3,0xc6,0x09,0x29,0x65,0xae,0xfb,0x87,0x92,0xa3,0xd7,0x3d,0x9a,0x1c,0x52,0x09,</div>
<div class="line">    0xb1,0x47,0xc8,0xf6,0x18,0xbb,0x97,</div>
<div class="line">}</div>
</div><!-- fragment --><p>ECDSA private key </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00115">115</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l00998">build_cipher_suite_list()</a>, <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l01230">METHOD()</a>, <a class="el" href="../../d5/dd9/stroke__config_8c_source.html#l00318">parse_pubkey_constraints()</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00222">START_SETUP()</a>, and <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l01778">tls_crypto_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a658aef9950550445c55bcecfd702f094"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char ecdsa_crt[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>TLS certificate for ECDSA key </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00189">189</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>Referenced by <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00222">START_SETUP()</a>.</p>

</div>
</div>
<a class="anchor" id="ab6fb49baf89e350db09a6a3b89052fff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char rsa[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>RSA private key, 2048 bit </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00034">34</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>Referenced by <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l00998">build_cipher_suite_list()</a>, <a class="el" href="../../d0/d29/openssl__rsa__private__key_8c_source.html#l00071">build_emsa_pkcs1_signature()</a>, <a class="el" href="../../d0/d29/openssl__rsa__private__key_8c_source.html#l00173">METHOD()</a>, <a class="el" href="../../d0/d29/openssl__rsa__private__key_8c_source.html#l00511">openssl_rsa_private_key_connect()</a>, <a class="el" href="../../d0/d29/openssl__rsa__private__key_8c_source.html#l00326">openssl_rsa_private_key_gen()</a>, <a class="el" href="../../d0/d29/openssl__rsa__private__key_8c_source.html#l00382">openssl_rsa_private_key_load()</a>, <a class="el" href="../../d4/db6/openssl__rsa__public__key_8c_source.html#l00368">openssl_rsa_public_key_load()</a>, <a class="el" href="../../d5/dd9/stroke__config_8c_source.html#l00318">parse_pubkey_constraints()</a>, <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00222">START_SETUP()</a>, <a class="el" href="../../d4/d58/tls__crypto_8c_source.html#l01778">tls_crypto_create()</a>, and <a class="el" href="../../d4/db6/openssl__rsa__public__key_8c_source.html#l00056">verify_emsa_pkcs1_signature()</a>.</p>

</div>
</div>
<a class="anchor" id="acb6e8cdb48ba76d6b2ad9442ec466111"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char rsa_crt[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>TLS certificate for RSA key </p>

<p>Definition at line <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00132">132</a> of file <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html">libtls/tests/suites/test_socket.c</a>.</p>

<p>Referenced by <a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c_source.html#l00222">START_SETUP()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_e222e764d3cfb05ba74b1a6a5205e9a6.html">libtls</a></li><li class="navelem"><a class="el" href="../../dir_2e9af3150f40b3bafbefbf21520e2b25.html">tests</a></li><li class="navelem"><a class="el" href="../../dir_eee4bdde13690f1de7e96c0a985e5565.html">suites</a></li><li class="navelem"><a class="el" href="../../de/dcb/libtls_2tests_2suites_2test__socket_8c.html">test_socket.c</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:08 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
