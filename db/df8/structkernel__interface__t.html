<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>strongSwan: kernel_interface_t Struct Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../strongswan.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">strongSwan
   &#160;<span id="projectnumber">5.3.5</span>
   </div>
   <div id="projectbrief">IPSec implementation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/df8/structkernel__interface__t.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../d8/d52/structkernel__interface__t-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">kernel_interface_t Struct Reference<div class="ingroups"><a class="el" href="../../dc/db7/group__kernel__interface.html">kernel_interface</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &quot;<a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>&quot;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for kernel_interface_t:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../de/dc6/structkernel__interface__t__coll__graph.svg" width="347" height="232"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a50e1014c04e475b51839008a4a9abc93"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/db7/group__kernel__interface.html#ga039a38d35321a297417331e6a9731d05">kernel_feature_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a50e1014c04e475b51839008a4a9abc93">get_features</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td></tr>
<tr class="separator:a50e1014c04e475b51839008a4a9abc93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c6d47b8ec9e639b4db6781c9bf14ccb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a2c6d47b8ec9e639b4db6781c9bf14ccb">get_spi</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t *spi)</td></tr>
<tr class="separator:a2c6d47b8ec9e639b4db6781c9bf14ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab08bb416490a0818d2127d4bd533be6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#ab08bb416490a0818d2127d4bd533be6f">get_cpi</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int16_t *cpi)</td></tr>
<tr class="separator:ab08bb416490a0818d2127d4bd533be6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4636e985fa84a70d1a5321711eab8f75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a4636e985fa84a70d1a5321711eab8f75">alloc_reqid</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *local_ts, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *remote_ts, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark_in, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark_out, u_int32_t *reqid)</td></tr>
<tr class="separator:a4636e985fa84a70d1a5321711eab8f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1348cbf157ad421307431552f1b68e9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a1348cbf157ad421307431552f1b68e9f">release_reqid</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int32_t reqid, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark_in, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark_out)</td></tr>
<tr class="separator:a1348cbf157ad421307431552f1b68e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d02d803e5ef220dc3772de9e9d01dd1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a0d02d803e5ef220dc3772de9e9d01dd1">add_sa</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t reqid, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, u_int32_t tfc, <a class="el" href="../../db/d18/structlifetime__cfg__t.html">lifetime_cfg_t</a> *lifetime, u_int16_t enc_alg, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> enc_key, u_int16_t int_alg, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> int_key, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a> mode, u_int16_t ipcomp, u_int16_t cpi, u_int32_t replay_window, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> encap, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> esn, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> inbound, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d4/da5/watcher_8c.html#a555c5ce92a336acef1ff02fb00381924">update</a>, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *src_ts, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *dst_ts)</td></tr>
<tr class="separator:a0d02d803e5ef220dc3772de9e9d01dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10341ee84a456ab1aed1a1674ba0ad83"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a10341ee84a456ab1aed1a1674ba0ad83">update_sa</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t cpi, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *new_src, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *new_dst, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> encap, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> new_encap, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark)</td></tr>
<tr class="separator:a10341ee84a456ab1aed1a1674ba0ad83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e93b18ce2881a6419d20f9c7ff4c7c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a0e93b18ce2881a6419d20f9c7ff4c7c0">query_sa</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, u_int64_t *<a class="el" href="../../d4/d2b/leak__detective_8c.html#a560b3a4f7e96e03dde71fcb1eb36d25f">bytes</a>, u_int64_t *packets, time_t *time)</td></tr>
<tr class="separator:a0e93b18ce2881a6419d20f9c7ff4c7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53dacffbe5432b526d8a4dd344e3e940"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a53dacffbe5432b526d8a4dd344e3e940">del_sa</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t cpi, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark)</td></tr>
<tr class="separator:a53dacffbe5432b526d8a4dd344e3e940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa156fdebc96d9524fa64555cccee9c23"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#aa156fdebc96d9524fa64555cccee9c23">flush_sas</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td></tr>
<tr class="separator:aa156fdebc96d9524fa64555cccee9c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35977ef1416d61d5969ab61a42f34ab1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a35977ef1416d61d5969ab61a42f34ab1">add_policy</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga9819e3d53b7af6756cde6e1299376d43">policy_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../df/d7b/structipsec__sa__cfg__t.html">ipsec_sa_cfg_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga8f7b420ca3c549a6e610bb9fa30da31f">policy_priority_t</a> priority)</td></tr>
<tr class="separator:a35977ef1416d61d5969ab61a42f34ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac29be8224b21cdc227ac627bf79d6ef0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#ac29be8224b21cdc227ac627bf79d6ef0">query_policy</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, time_t *use_time)</td></tr>
<tr class="separator:ac29be8224b21cdc227ac627bf79d6ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d66b4f71eec9081fe854b491388c35"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a20d66b4f71eec9081fe854b491388c35">del_policy</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga9819e3d53b7af6756cde6e1299376d43">policy_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../df/d7b/structipsec__sa__cfg__t.html">ipsec_sa_cfg_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga8f7b420ca3c549a6e610bb9fa30da31f">policy_priority_t</a> priority)</td></tr>
<tr class="separator:a20d66b4f71eec9081fe854b491388c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b89be75f254e84a8cad39d5c181ee0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a18b89be75f254e84a8cad39d5c181ee0">flush_policies</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td></tr>
<tr class="separator:a18b89be75f254e84a8cad39d5c181ee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35e60fed47940c05455d8159c39f1f31"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a35e60fed47940c05455d8159c39f1f31">get_source_addr</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d2b/ip__packet_8c.html#aef6af1f03450c0582fd9489a8166aa61">dest</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>)</td></tr>
<tr class="separator:a35e60fed47940c05455d8159c39f1f31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6289f5c66d4ae77f1a10fcf2fe354db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#ab6289f5c66d4ae77f1a10fcf2fe354db">get_nexthop</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d2b/ip__packet_8c.html#aef6af1f03450c0582fd9489a8166aa61">dest</a>, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>)</td></tr>
<tr class="separator:ab6289f5c66d4ae77f1a10fcf2fe354db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45d64d725e92ad43372b4194f4888919"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a45d64d725e92ad43372b4194f4888919">get_interface</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>, char **<a class="el" href="../../d7/da0/test__parser_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td></tr>
<tr class="separator:a45d64d725e92ad43372b4194f4888919"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a868e94580aa6456c28c5f7e638a03b5c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a868e94580aa6456c28c5f7e638a03b5c">create_address_enumerator</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d0/d22/group__kernel__net.html#gaec0f8396984f98ff469cb1f5fac1c7b5">kernel_address_type_t</a> which)</td></tr>
<tr class="separator:a868e94580aa6456c28c5f7e638a03b5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bfff40c7707aab722fc8f7dd1132aca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a6bfff40c7707aab722fc8f7dd1132aca">add_ip</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *virtual_ip, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, char *iface)</td></tr>
<tr class="separator:a6bfff40c7707aab722fc8f7dd1132aca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a550a180d12023bbfd84f6a26cc10d808"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a550a180d12023bbfd84f6a26cc10d808">del_ip</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *virtual_ip, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> wait)</td></tr>
<tr class="separator:a550a180d12023bbfd84f6a26cc10d808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe72bb4ec53d1c3af11b4ed882256a26"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#abe72bb4ec53d1c3af11b4ed882256a26">add_route</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dst_net, u_int8_t prefixlen, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *gateway, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *src_ip, char *if_name)</td></tr>
<tr class="separator:abe72bb4ec53d1c3af11b4ed882256a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e71beed4ad0ca3856579fe03bd0d89c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a3e71beed4ad0ca3856579fe03bd0d89c">del_route</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dst_net, u_int8_t prefixlen, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *gateway, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *src_ip, char *if_name)</td></tr>
<tr class="separator:a3e71beed4ad0ca3856579fe03bd0d89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41d81c7e4d4e152685aaaabf930c2610"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a41d81c7e4d4e152685aaaabf930c2610">bypass_socket</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, int fd, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</td></tr>
<tr class="separator:a41d81c7e4d4e152685aaaabf930c2610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a3ca992266ed990682c644bf4349111"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a5a3ca992266ed990682c644bf4349111">enable_udp_decap</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, int fd, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a9e26a4afe91a21810290057677a17a11">port</a>)</td></tr>
<tr class="separator:a5a3ca992266ed990682c644bf4349111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055edb216ddb9a3ca313ecc6d18b01cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a055edb216ddb9a3ca313ecc6d18b01cc">is_interface_usable</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, const char *iface)</td></tr>
<tr class="separator:a055edb216ddb9a3ca313ecc6d18b01cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc589b2debfd9e04d4126f6d6b35f6e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#adc589b2debfd9e04d4126f6d6b35f6e8">all_interfaces_usable</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td></tr>
<tr class="separator:adc589b2debfd9e04d4126f6d6b35f6e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e638a846c4fee7f99cd8c53cee961b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#aa5e638a846c4fee7f99cd8c53cee961b">get_address_by_ts</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *ts, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> **<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#a2e690af7a15a94fbcb5138d2e3b2db9e">vip</a>)</td></tr>
<tr class="separator:aa5e638a846c4fee7f99cd8c53cee961b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f73d53e0e222fd0595734dd16ad4ef5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a6f73d53e0e222fd0595734dd16ad4ef5">add_ipsec_interface</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/db7/group__kernel__interface.html#ga97e697671274b28e3d022bceefa659d1">kernel_ipsec_constructor_t</a> <a class="el" href="../../d4/d08/pkcs11__public__key_8c.html#aba411f8641b7fafc2e5321094473bdb9">create</a>)</td></tr>
<tr class="separator:a6f73d53e0e222fd0595734dd16ad4ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a063c091a8ac31fbd8bbb517798b9cbf4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a063c091a8ac31fbd8bbb517798b9cbf4">remove_ipsec_interface</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/db7/group__kernel__interface.html#ga97e697671274b28e3d022bceefa659d1">kernel_ipsec_constructor_t</a> <a class="el" href="../../d4/d08/pkcs11__public__key_8c.html#aba411f8641b7fafc2e5321094473bdb9">create</a>)</td></tr>
<tr class="separator:a063c091a8ac31fbd8bbb517798b9cbf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9632503273a148a91f52dcc07ab2b54c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a9632503273a148a91f52dcc07ab2b54c">add_net_interface</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/db7/group__kernel__interface.html#ga50a3db23fb07fe288b23a3c10c2d4337">kernel_net_constructor_t</a> <a class="el" href="../../d4/d08/pkcs11__public__key_8c.html#aba411f8641b7fafc2e5321094473bdb9">create</a>)</td></tr>
<tr class="separator:a9632503273a148a91f52dcc07ab2b54c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa576d824a1ae14a7b65caaf14c625a36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#aa576d824a1ae14a7b65caaf14c625a36">remove_net_interface</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/db7/group__kernel__interface.html#ga50a3db23fb07fe288b23a3c10c2d4337">kernel_net_constructor_t</a> <a class="el" href="../../d4/d08/pkcs11__public__key_8c.html#aba411f8641b7fafc2e5321094473bdb9">create</a>)</td></tr>
<tr class="separator:aa576d824a1ae14a7b65caaf14c625a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35773ba225bd774c4029dce9d72fe64c"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a35773ba225bd774c4029dce9d72fe64c">add_listener</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/d43/structkernel__listener__t.html">kernel_listener_t</a> *<a class="el" href="../../d4/d9f/charon-tkm_8c.html#a88dcd2f2f299c6eb73701fb23390476c">listener</a>)</td></tr>
<tr class="separator:a35773ba225bd774c4029dce9d72fe64c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d22f6485952bc354322bcc97d672ef4"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a8d22f6485952bc354322bcc97d672ef4">remove_listener</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/d43/structkernel__listener__t.html">kernel_listener_t</a> *<a class="el" href="../../d4/d9f/charon-tkm_8c.html#a88dcd2f2f299c6eb73701fb23390476c">listener</a>)</td></tr>
<tr class="separator:a8d22f6485952bc354322bcc97d672ef4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b7a6065d4006ba4d00c31a869e90cbe"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a4b7a6065d4006ba4d00c31a869e90cbe">acquire</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int32_t reqid, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts)</td></tr>
<tr class="separator:a4b7a6065d4006ba4d00c31a869e90cbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecbb97357904d50273c2d88bc9d7366c"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#aecbb97357904d50273c2d88bc9d7366c">expire</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t spi, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> hard)</td></tr>
<tr class="separator:aecbb97357904d50273c2d88bc9d7366c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad11becf1dec9918734b7ddeffe972090"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#ad11becf1dec9918734b7ddeffe972090">mapping</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t spi, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *remote)</td></tr>
<tr class="separator:ad11becf1dec9918734b7ddeffe972090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38e6124b2feaad307ac62bbca17efc24"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a38e6124b2feaad307ac62bbca17efc24">migrate</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int32_t reqid, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *local, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *remote)</td></tr>
<tr class="separator:a38e6124b2feaad307ac62bbca17efc24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a887872145a07ba929fa39bd93b4c03b5"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a887872145a07ba929fa39bd93b4c03b5">roam</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> address)</td></tr>
<tr class="separator:a887872145a07ba929fa39bd93b4c03b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bbbd006ae7489593522ec61b8844649"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a7bbbd006ae7489593522ec61b8844649">tun</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d1/d32/structtun__device__t.html">tun_device_t</a> *tun, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> created)</td></tr>
<tr class="separator:a7bbbd006ae7489593522ec61b8844649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adacbc98f884ab5b7d3c671580eaaee18"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#adacbc98f884ab5b7d3c671580eaaee18">register_algorithm</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int16_t alg_id, <a class="el" href="../../d0/d04/group__transforms.html#gaf335c7940ad619e477cffde4ffb66378">transform_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, u_int16_t kernel_id, char *kernel_name)</td></tr>
<tr class="separator:adacbc98f884ab5b7d3c671580eaaee18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bbb6afb54cb1bdc0ddb153bbe7d38ef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#a1bbb6afb54cb1bdc0ddb153bbe7d38ef">lookup_algorithm</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int16_t alg_id, <a class="el" href="../../d0/d04/group__transforms.html#gaf335c7940ad619e477cffde4ffb66378">transform_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, u_int16_t *kernel_id, char **kernel_name)</td></tr>
<tr class="separator:a1bbb6afb54cb1bdc0ddb153bbe7d38ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa342284c4154c376c98fa699c6b04229"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/df8/structkernel__interface__t.html#aa342284c4154c376c98fa699c6b04229">destroy</a> )(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td></tr>
<tr class="separator:aa342284c4154c376c98fa699c6b04229"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manager and wrapper for different kernel interfaces.</p>
<p>The kernel interface handles the communication with the kernel for SA and policy management and interface and IP address management. </p>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00092">92</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>
</div><h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4b7a6065d4006ba4d00c31a869e90cbe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::acquire)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int32_t reqid, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Raise an acquire event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reqid</td><td>reqid of the policy to acquire </td></tr>
    <tr><td class="paramname">src_ts</td><td>source traffic selector </td></tr>
    <tr><td class="paramname">dst_ts</td><td>destination traffic selector </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00564">564</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01633">acquire()</a>, <a class="el" href="../../da/dc8/ees__callbacks_8c_source.html#l00025">charon_esa_acquire()</a>, and <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l00817">process_acquire()</a>.</p>

</div>
</div>
<a class="anchor" id="a6bfff40c7707aab722fc8f7dd1132aca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::add_ip)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *virtual_ip, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, char *iface)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a virtual IP to an interface.</p>
<p>Virtual IPs are attached to an interface. If an IP is added multiple times, the IP is refcounted and not removed until <a class="el" href="../../db/df8/structkernel__interface__t.html#a550a180d12023bbfd84f6a26cc10d808">del_ip()</a> was called as many times as <a class="el" href="../../db/df8/structkernel__interface__t.html#a6bfff40c7707aab722fc8f7dd1132aca">add_ip()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">virtual_ip</td><td>virtual ip address to assign </td></tr>
    <tr><td class="paramname">prefix</td><td>prefix length to install IP with, -1 for auto </td></tr>
    <tr><td class="paramname">iface</td><td>interface to install virtual IP on </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00401">401</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d2/d03/load__tester__config_8c_source.html#l00628">allocate_addr()</a>, <a class="el" href="../../d5/dbf/ike__sa_8c_source.html#l00782">METHOD()</a>, and <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00966">reinstall_vip()</a>.</p>

</div>
</div>
<a class="anchor" id="a6f73d53e0e222fd0595734dd16ad4ef5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::add_ipsec_interface)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/db7/group__kernel__interface.html#ga97e697671274b28e3d022bceefa659d1">kernel_ipsec_constructor_t</a> <a class="el" href="../../d4/d08/pkcs11__public__key_8c.html#aba411f8641b7fafc2e5321094473bdb9">create</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register an ipsec kernel interface constructor on the manager.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">create</td><td>constructor to register </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if the ipsec kernel interface was registered successfully, FALSE if an interface was already registered or the registration failed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00507">507</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d73/kernel__ipsec_8c_source.html#l00023">kernel_ipsec_register()</a>, and <a class="el" href="../../d4/d98/load__tester__plugin_8c_source.html#l00261">load_tester_plugin_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a35773ba225bd774c4029dce9d72fe64c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::add_listener)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/d43/structkernel__listener__t.html">kernel_listener_t</a> *<a class="el" href="../../d4/d9f/charon-tkm_8c.html#a88dcd2f2f299c6eb73701fb23390476c">listener</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a listener to the kernel interface.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">listener</td><td>listener to add </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00546">546</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../df/dd7/forecast__forwarder_8c_source.html#l00439">forecast_forwarder_create()</a>, <a class="el" href="../../db/d67/kernel__handler_8c_source.html#l00143">kernel_handler_create()</a>, and <a class="el" href="../../d8/dd3/kernel__libipsec__router_8c_source.html#l00323">kernel_libipsec_router_create()</a>.</p>

</div>
</div>
<a class="anchor" id="a9632503273a148a91f52dcc07ab2b54c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::add_net_interface)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/db7/group__kernel__interface.html#ga50a3db23fb07fe288b23a3c10c2d4337">kernel_net_constructor_t</a> <a class="el" href="../../d4/d08/pkcs11__public__key_8c.html#aba411f8641b7fafc2e5321094473bdb9">create</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register a network kernel interface constructor on the manager.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">create</td><td>constructor to register </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if the kernel net interface was registered successfully, FALSE if an interface was already registered or the registration failed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00528">528</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d86/kernel__net_8c_source.html#l00023">kernel_net_register()</a>.</p>

</div>
</div>
<a class="anchor" id="a35977ef1416d61d5969ab61a42f34ab1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::add_policy)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga9819e3d53b7af6756cde6e1299376d43">policy_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../df/d7b/structipsec__sa__cfg__t.html">ipsec_sa_cfg_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga8f7b420ca3c549a6e610bb9fa30da31f">policy_priority_t</a> priority)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a policy to the SPD.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address of SA </td></tr>
    <tr><td class="paramname">dst</td><td>dest address of SA </td></tr>
    <tr><td class="paramname">src_ts</td><td>traffic selector to match traffic source </td></tr>
    <tr><td class="paramname">dst_ts</td><td>traffic selector to match traffic dest </td></tr>
    <tr><td class="paramname">direction</td><td>direction of traffic, POLICY_(IN|OUT|FWD) </td></tr>
    <tr><td class="paramname">type</td><td>type of policy, POLICY_(IPSEC|PASS|DROP) </td></tr>
    <tr><td class="paramname">sa</td><td>details about the SA(s) tied to this policy </td></tr>
    <tr><td class="paramname">mark</td><td>mark for this policy </td></tr>
    <tr><td class="paramname">priority</td><td>priority of this policy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00279">279</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00830">install_policies_internal()</a>, and <a class="el" href="../../d1/d8c/shunt__manager_8c_source.html#l00063">install_shunt_policy()</a>.</p>

</div>
</div>
<a class="anchor" id="abe72bb4ec53d1c3af11b4ed882256a26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::add_route)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dst_net, u_int8_t prefixlen, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *gateway, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *src_ip, char *if_name)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a route.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst_net</td><td>destination net </td></tr>
    <tr><td class="paramname">prefixlen</td><td>destination net prefix length </td></tr>
    <tr><td class="paramname">gateway</td><td>gateway for this route </td></tr>
    <tr><td class="paramname">src_ip</td><td>source ip of the route </td></tr>
    <tr><td class="paramname">if_name</td><td>name of the interface the route is bound to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed ALREADY_DONE if the route already exists </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00428">428</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00299">add_exclude_route()</a>, <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l02063">add_policy_internal()</a>, and <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00391">install_route()</a>.</p>

</div>
</div>
<a class="anchor" id="a0d02d803e5ef220dc3772de9e9d01dd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::add_sa)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t reqid, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, u_int32_t tfc, <a class="el" href="../../db/d18/structlifetime__cfg__t.html">lifetime_cfg_t</a> *lifetime, u_int16_t enc_alg, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> enc_key, u_int16_t int_alg, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> int_key, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gaece48cbb898dc0b6b592b3fb645b0eb0">ipsec_mode_t</a> mode, u_int16_t ipcomp, u_int16_t cpi, u_int32_t replay_window, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d0/d72/ha__message_8c.html#a4345dfbca89c2653de8f69f577b25168">initiator</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> encap, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> esn, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> inbound, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> <a class="el" href="../../d4/da5/watcher_8c.html#a555c5ce92a336acef1ff02fb00381924">update</a>, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *src_ts, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *dst_ts)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add an SA to the SAD.</p>
<p>This function does install a single SA for a single protocol in one direction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address for this SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address for this SA </td></tr>
    <tr><td class="paramname">spi</td><td>SPI allocated by us or remote peer </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for this SA (ESP/AH) </td></tr>
    <tr><td class="paramname">reqid</td><td>reqid for this SA </td></tr>
    <tr><td class="paramname">mark</td><td>optional mark for this SA </td></tr>
    <tr><td class="paramname">tfc</td><td>Traffic Flow Confidentiality padding for this SA </td></tr>
    <tr><td class="paramname">lifetime</td><td><a class="el" href="../../db/d18/structlifetime__cfg__t.html">lifetime_cfg_t</a> for this SA </td></tr>
    <tr><td class="paramname">enc_alg</td><td>Algorithm to use for encryption (ESP only) </td></tr>
    <tr><td class="paramname">enc_key</td><td>key to use for encryption </td></tr>
    <tr><td class="paramname">int_alg</td><td>Algorithm to use for integrity protection </td></tr>
    <tr><td class="paramname">int_key</td><td>key to use for integrity protection </td></tr>
    <tr><td class="paramname">mode</td><td>mode of the SA (tunnel, transport) </td></tr>
    <tr><td class="paramname">ipcomp</td><td>IPComp transform to use </td></tr>
    <tr><td class="paramname">cpi</td><td>CPI for IPComp </td></tr>
    <tr><td class="paramname">replay_window</td><td>anti-replay window size </td></tr>
    <tr><td class="paramname">initiator</td><td>TRUE if initiator of the exchange creating this SA </td></tr>
    <tr><td class="paramname">encap</td><td>enable UDP encapsulation for NAT traversal </td></tr>
    <tr><td class="paramname">esn</td><td>TRUE to use Extended Sequence Numbers </td></tr>
    <tr><td class="paramname">inbound</td><td>TRUE if this is an inbound SA </td></tr>
    <tr><td class="paramname">update</td><td>TRUE if an SPI has already been allocated for SA </td></tr>
    <tr><td class="paramname">src_ts</td><td>list of source traffic selectors </td></tr>
    <tr><td class="paramname">dst_ts</td><td>list of destination traffic selectors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00188">188</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00657">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="adc589b2debfd9e04d4126f6d6b35f6e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::all_interfaces_usable)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if interfaces are excluded by config.</p>
<dl class="section return"><dt>Returns</dt><dd>TRUE if no interfaces are exclued by config </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00485">485</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d0/d09/receiver_8c_source.html#l00417">receive_packets()</a>.</p>

</div>
</div>
<a class="anchor" id="a4636e985fa84a70d1a5321711eab8f75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::alloc_reqid)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *local_ts, <a class="el" href="../../dc/de6/structlinked__list__t.html">linked_list_t</a> *remote_ts, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark_in, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark_out, u_int32_t *reqid)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate or confirm a reqid to use for a given SA pair.</p>
<p>Each returned reqid by a successful call to <a class="el" href="../../db/df8/structkernel__interface__t.html#a4636e985fa84a70d1a5321711eab8f75">alloc_reqid()</a> must be released using <a class="el" href="../../db/df8/structkernel__interface__t.html#a1348cbf157ad421307431552f1b68e9f">release_reqid()</a>.</p>
<p>The reqid parameter is an in/out parameter. If it points to non-zero, the reqid is confirmed and registered for use. If it points to zero, a reqid is allocated for the given selectors, and returned to reqid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">local_ts</td><td>traffic selectors of local side for SA </td></tr>
    <tr><td class="paramname">remote_ts</td><td>traffic selectors of remote side for SA </td></tr>
    <tr><td class="paramname">mark_in</td><td>inbound mark on SA </td></tr>
    <tr><td class="paramname">mark_out</td><td>outbound mark on SA </td></tr>
    <tr><td class="paramname">reqid</td><td>allocated reqid </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if reqid allocated </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00141">141</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00657">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a41d81c7e4d4e152685aaaabf930c2610"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::bypass_socket)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, int fd, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set up a bypass policy for a given socket.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>socket file descriptor to setup policy for </td></tr>
    <tr><td class="paramname">family</td><td>protocol family of the socket </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if policy set up successfully </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00453">453</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/dbc/socket__default__socket_8c_source.html#l00613">open_socket()</a>.</p>

</div>
</div>
<a class="anchor" id="a868e94580aa6456c28c5f7e638a03b5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dd3/structenumerator__t.html">enumerator_t</a>*(* kernel_interface_t::create_address_enumerator)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d0/d22/group__kernel__net.html#gaec0f8396984f98ff469cb1f5fac1c7b5">kernel_address_type_t</a> which)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates an enumerator over all local addresses.</p>
<p>This function blocks an internal cached address list until the enumerator gets destroyed. The hosts are read-only, do not modify of free.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">which</td><td>a combination of address types to enumerate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>enumerator over <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a>'s </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00386">386</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d68/ike__mobike_8c_source.html#l00191">build_address_list()</a>, <a class="el" href="../../d4/de0/ike__me_8c_source.html#l00128">gather_and_add_endpoints()</a>, <a class="el" href="../../d9/d75/ike__natd_8c_source.html#l00290">METHOD()</a>, and <a class="el" href="../../df/d60/tnc__ifmap__listener_8c_source.html#l00048">publish_device_ip_addresses()</a>.</p>

</div>
</div>
<a class="anchor" id="a550a180d12023bbfd84f6a26cc10d808"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::del_ip)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *virtual_ip, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> wait)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a virtual IP from an interface.</p>
<p>The kernel interface uses refcounting, see <a class="el" href="../../db/df8/structkernel__interface__t.html#a6bfff40c7707aab722fc8f7dd1132aca">add_ip()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">virtual_ip</td><td>virtual ip address to remove </td></tr>
    <tr><td class="paramname">prefix</td><td>prefix length of the IP to uninstall, -1 for auto </td></tr>
    <tr><td class="paramname">wait</td><td>TRUE to wait untily IP is gone </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00414">414</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d2/d03/load__tester__config_8c_source.html#l00868">cleanup_leases()</a>, <a class="el" href="../../d5/dbf/ike__sa_8c_source.html#l00816">METHOD()</a>, and <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00966">reinstall_vip()</a>.</p>

</div>
</div>
<a class="anchor" id="a20d66b4f71eec9081fe854b491388c35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::del_policy)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga9819e3d53b7af6756cde6e1299376d43">policy_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, <a class="el" href="../../df/d7b/structipsec__sa__cfg__t.html">ipsec_sa_cfg_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a8539097a5c34139fca0cfdc9782d4cb1">sa</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, <a class="el" href="../../d3/d2d/group__ipsec__types.html#ga8f7b420ca3c549a6e610bb9fa30da31f">policy_priority_t</a> priority)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a policy from the SPD.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address of SA </td></tr>
    <tr><td class="paramname">dst</td><td>dest address of SA </td></tr>
    <tr><td class="paramname">src_ts</td><td>traffic selector to match traffic source </td></tr>
    <tr><td class="paramname">dst_ts</td><td>traffic selector to match traffic dest </td></tr>
    <tr><td class="paramname">direction</td><td>direction of traffic, POLICY_(IN|OUT|FWD) </td></tr>
    <tr><td class="paramname">type</td><td>type of policy, POLICY_(IPSEC|PASS|DROP) </td></tr>
    <tr><td class="paramname">sa</td><td>details about the SA(s) tied to this policy </td></tr>
    <tr><td class="paramname">mark</td><td>mark for this policy </td></tr>
    <tr><td class="paramname">priority</td><td>priority of the policy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00320">320</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00858">del_policies_internal()</a>, and <a class="el" href="../../d1/d8c/shunt__manager_8c_source.html#l00200">uninstall_shunt_policy()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e71beed4ad0ca3856579fe03bd0d89c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::del_route)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d0/d14/structchunk__t.html">chunk_t</a> dst_net, u_int8_t prefixlen, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *gateway, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *src_ip, char *if_name)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete a route.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dst_net</td><td>destination net </td></tr>
    <tr><td class="paramname">prefixlen</td><td>destination net prefix length </td></tr>
    <tr><td class="paramname">gateway</td><td>gateway for this route </td></tr>
    <tr><td class="paramname">src_ip</td><td>source ip of the route </td></tr>
    <tr><td class="paramname">if_name</td><td>name of the interface the route is bound to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00442">442</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l02063">add_policy_internal()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00391">install_route()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00565">METHOD()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00355">remove_exclude_route()</a>, and <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01382">uninstall_route()</a>.</p>

</div>
</div>
<a class="anchor" id="a53dacffbe5432b526d8a4dd344e3e940"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::del_sa)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t cpi, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete a previously installed SA from the SAD.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address for this SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address for this SA </td></tr>
    <tr><td class="paramname">spi</td><td>SPI allocated by us or remote peer </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for this SA (ESP/AH) </td></tr>
    <tr><td class="paramname">cpi</td><td>CPI for IPComp or 0 </td></tr>
    <tr><td class="paramname">mark</td><td>optional mark for this SA </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00254">254</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l01110">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="aa342284c4154c376c98fa699c6b04229"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::destroy)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroys a <a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> object. </p>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00647">647</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../de/d6a/hydra_8c_source.html#l00051">libhydra_deinit()</a>.</p>

</div>
</div>
<a class="anchor" id="a5a3ca992266ed990682c644bf4349111"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::enable_udp_decap)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, int fd, int <a class="el" href="../../d0/d72/ha__message_8c.html#a6494da1d0747e053505497a35ebccbba">family</a>, u_int16_t <a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a9e26a4afe91a21810290057677a17a11">port</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enable decapsulation of ESP-in-UDP packets for the given port/socket.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>socket file descriptor </td></tr>
    <tr><td class="paramname">family</td><td>protocol family of the socket </td></tr>
    <tr><td class="paramname">port</td><td>the UDP port </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if UDP decapsulation was enabled successfully </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00463">463</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/dbc/socket__default__socket_8c_source.html#l00613">open_socket()</a>.</p>

</div>
</div>
<a class="anchor" id="aecbb97357904d50273c2d88bc9d7366c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::expire)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t spi, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> hard)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Raise an expire event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">protocol</td><td>protocol of the expired SA </td></tr>
    <tr><td class="paramname">spi</td><td>spi of the expired SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address of expired SA </td></tr>
    <tr><td class="paramname">hard</td><td>TRUE if it is a hard expire, FALSE otherwise </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00575">575</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../da/dc8/ees__callbacks_8c_source.html#l00033">charon_esa_expire()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00225">expire()</a>, <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l02032">expire_job()</a>, and <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l00866">process_expire()</a>.</p>

</div>
</div>
<a class="anchor" id="a18b89be75f254e84a8cad39d5c181ee0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::flush_policies)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flush all policies from the SPD.</p>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00333">333</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa156fdebc96d9524fa64555cccee9c23"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::flush_sas)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flush all SAs from the SAD.</p>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00263">263</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa5e638a846c4fee7f99cd8c53cee961b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::get_address_by_ts)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *ts, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> **<a class="el" href="../../d4/d49/lookip__msg_8h.html#afd9af3f59e138074b4ce031fd27cde8d">ip</a>, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> *<a class="el" href="../../d4/d49/lookip__msg_8h.html#a2e690af7a15a94fbcb5138d2e3b2db9e">vip</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tries to find an IP address of a local interface that is included in the supplied traffic selector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ts</td><td>traffic selector </td></tr>
    <tr><td class="paramname">ip</td><td>returned IP address (has to be destroyed) </td></tr>
    <tr><td class="paramname">vip</td><td>set to TRUE if returned address is a virtual IP </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if address found </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00496">496</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l02063">add_policy_internal()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00391">install_route()</a>, and <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01476">manage_route()</a>.</p>

</div>
</div>
<a class="anchor" id="ab08bb416490a0818d2127d4bd533be6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::get_cpi)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int16_t *cpi)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a Compression Parameter Index (CPI) from the kernel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address of SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address of SA </td></tr>
    <tr><td class="paramname">cpi</td><td>allocated cpi </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00121">121</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00645">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a50e1014c04e475b51839008a4a9abc93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/db7/group__kernel__interface.html#ga039a38d35321a297417331e6a9731d05">kernel_feature_t</a>(* kernel_interface_t::get_features)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the feature set supported by the net and ipsec kernel backends.</p>
<dl class="section return"><dt>Returns</dt><dd>ORed feature-set of backends </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00099">99</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d9a/child__create_8c_source.html#l00730">build_payloads()</a>, <a class="el" href="../../d9/d75/ike__natd_8c_source.html#l00085">force_encap()</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l02237">install_route()</a>, and <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00775">require_policy_update()</a>.</p>

</div>
</div>
<a class="anchor" id="a45d64d725e92ad43372b4194f4888919"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::get_interface)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../dd/d6f/test__traffic__selector_8c.html#a1c2046dcb30a629d6d9f45ff8f403f12">host</a>, char **<a class="el" href="../../d7/da0/test__parser_8c.html#a5ac083a645d964373f022d03df4849c8">name</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the interface name of a local address. Interfaces that are down or ignored by config are not considered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">host</td><td>address to get interface name from </td></tr>
    <tr><td class="paramname">name</td><td>allocated interface name (optional) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if interface found and usable </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00374">374</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00299">add_exclude_route()</a>, <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l02063">add_policy_internal()</a>, <a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c_source.html#l02237">install_route()</a>, <a class="el" href="../../d6/db0/updown__listener_8c_source.html#l00232">invoke_once()</a>, <a class="el" href="../../d5/dd9/stroke__config_8c_source.html#l00189">is_local()</a>, <a class="el" href="../../d5/dbf/ike__sa_8c_source.html#l00782">METHOD()</a>, <a class="el" href="../../d0/d09/receiver_8c_source.html#l00417">receive_packets()</a>, <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00966">reinstall_vip()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00355">remove_exclude_route()</a>, and <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01382">uninstall_route()</a>.</p>

</div>
</div>
<a class="anchor" id="ab6289f5c66d4ae77f1a10fcf2fe354db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a>*(* kernel_interface_t::get_nexthop)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d2b/ip__packet_8c.html#aef6af1f03450c0582fd9489a8166aa61">dest</a>, int <a class="el" href="../../d9/dbe/test__utils_8c.html#a0a7083cd7ae62f5c50d6abd5cdd491ab">prefix</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the next hop for a destination.</p>
<p>Does a route lookup to get the next hop used to reach dest. The returned host is allocated and must be destroyed. An optional src address can be used to check if a route is available for the given source to dest.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dest</td><td>target destination address </td></tr>
    <tr><td class="paramname">prefix</td><td>prefix length if dest is a subnet, -1 for auto </td></tr>
    <tr><td class="paramname">src</td><td>source address to check, or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>next hop address, NULL if unreachable </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00363">363</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00299">add_exclude_route()</a>, <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l02063">add_policy_internal()</a>, <a class="el" href="../../db/d51/kernel__libipsec__ipsec_8c_source.html#l00391">install_route()</a>, and <a class="el" href="../../d0/d8e/kernel__wfp__ipsec_8c_source.html#l01476">manage_route()</a>.</p>

</div>
</div>
<a class="anchor" id="a35e60fed47940c05455d8159c39f1f31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dcf/structhost__t.html">host_t</a>*(* kernel_interface_t::get_source_addr)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d4/d2b/ip__packet_8c.html#aef6af1f03450c0582fd9489a8166aa61">dest</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get our outgoing source address for a destination.</p>
<p>Does a route lookup to get the source address used to reach dest. The returned host is allocated and must be destroyed. An optional src address can be used to check if a route is available for the given source to dest.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dest</td><td>target destination address </td></tr>
    <tr><td class="paramname">src</td><td>source address to check, or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>outgoing source address, NULL if unreachable </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00347">347</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d5/dbf/ike__sa_8c_source.html#l02086">is_any_path_valid()</a>, <a class="el" href="../../d5/dbf/ike__sa_8c_source.html#l02066">is_current_path_valid()</a>, <a class="el" href="../../d7/d68/ike__mobike_8c_source.html#l00320">METHOD()</a>, <a class="el" href="../../d7/d9c/dhcp__socket_8c_source.html#l00186">prepare_dhcp()</a>, and <a class="el" href="../../d5/dbf/ike__sa_8c_source.html#l01194">resolve_hosts()</a>.</p>

</div>
</div>
<a class="anchor" id="a2c6d47b8ec9e639b4db6781c9bf14ccb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::get_spi)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t *spi)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a SPI from the kernel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>source address of SA </td></tr>
    <tr><td class="paramname">dst</td><td>destination address of SA </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for SA (ESP/AH) </td></tr>
    <tr><td class="paramname">spi</td><td>allocated spi </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00110">110</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00629">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a055edb216ddb9a3ca313ecc6d18b01cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::is_interface_usable)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, const char *iface)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>manager methods Verifies that the given interface is usable and not excluded by configuration.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iface</td><td>interface name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if usable </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00478">478</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d1f/kernel__pfroute__net_8c_source.html#l01696">init_address_list()</a>, and <a class="el" href="../../d5/d90/kernel__netlink__net_8c_source.html#l00969">process_link()</a>.</p>

</div>
</div>
<a class="anchor" id="a1bbb6afb54cb1bdc0ddb153bbe7d38ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::lookup_algorithm)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int16_t alg_id, <a class="el" href="../../d0/d04/group__transforms.html#gaf335c7940ad619e477cffde4ffb66378">transform_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, u_int16_t *kernel_id, char **kernel_name)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the kernel-specific id and/or name for an algorithms depending on the arguments specified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alg_id</td><td>the IKE id of the algorithm </td></tr>
    <tr><td class="paramname">type</td><td>the transform type of the algorithm </td></tr>
    <tr><td class="paramname">kernel_id</td><td>the kernel id of the algorithm (optional) </td></tr>
    <tr><td class="paramname">kernel_name</td><td>the kernel name of the algorithm (optional) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if algorithm was found </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00640">640</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l00235">lookup_algorithm()</a>.</p>

</div>
</div>
<a class="anchor" id="ad11becf1dec9918734b7ddeffe972090"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::mapping)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int32_t spi, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *remote)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Raise a mapping event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">protocol</td><td>protocol of affected SA </td></tr>
    <tr><td class="paramname">spi</td><td>spi of the SA </td></tr>
    <tr><td class="paramname">dst</td><td>original destination address of SA </td></tr>
    <tr><td class="paramname">remote</td><td>new remote host </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00586">586</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l00969">process_mapping()</a>.</p>

</div>
</div>
<a class="anchor" id="a38e6124b2feaad307ac62bbca17efc24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::migrate)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int32_t reqid, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *local, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *remote)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Raise a migrate event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reqid</td><td>reqid of the policy </td></tr>
    <tr><td class="paramname">src_ts</td><td>source traffic selector </td></tr>
    <tr><td class="paramname">dst_ts</td><td>destination traffic selector </td></tr>
    <tr><td class="paramname">direction</td><td>direction of the policy (in|out) </td></tr>
    <tr><td class="paramname">local</td><td>local host address to be used in the IKE_SA </td></tr>
    <tr><td class="paramname">remote</td><td>remote host address to be used in the IKE_SA </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00599">599</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d5/d47/kernel__netlink__ipsec_8c_source.html#l00895">process_migrate()</a>.</p>

</div>
</div>
<a class="anchor" id="ac29be8224b21cdc227ac627bf79d6ef0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::query_policy)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *src_ts, <a class="el" href="../../d4/d0a/structtraffic__selector__t.html">traffic_selector_t</a> *dst_ts, <a class="el" href="../../d3/d2d/group__ipsec__types.html#gac70d376272773594f4dd526b01a92ba2">policy_dir_t</a> direction, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, time_t *use_time)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Query the use time of a policy.</p>
<p>The use time of a policy is the time the policy was used for the last time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">src_ts</td><td>traffic selector to match traffic source </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dst_ts</td><td>traffic selector to match traffic dest </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">direction</td><td>direction of traffic, POLICY_(IN|OUT|FWD) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mark</td><td>optional mark </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">use_time</td><td>the (monotonic) time of this SA's last use </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00300">300</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00522">update_usetime()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e93b18ce2881a6419d20f9c7ff4c7c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::query_sa)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark, u_int64_t *<a class="el" href="../../d4/d2b/leak__detective_8c.html#a560b3a4f7e96e03dde71fcb1eb36d25f">bytes</a>, u_int64_t *packets, time_t *time)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Query the number of bytes processed by an SA from the SAD.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">src</td><td>source address for this SA </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dst</td><td>destination address for this SA </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">spi</td><td>SPI allocated by us or remote peer </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">protocol</td><td>protocol for this SA (ESP/AH) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mark</td><td>optional mark for this SA </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bytes</td><td>the number of bytes processed by SA </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">packets</td><td>number of packets processed by SA </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">time</td><td>last (monotonic) time of SA use </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00239">239</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00462">update_usebytes()</a>.</p>

</div>
</div>
<a class="anchor" id="adacbc98f884ab5b7d3c671580eaaee18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::register_algorithm)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int16_t alg_id, <a class="el" href="../../d0/d04/group__transforms.html#gaf335c7940ad619e477cffde4ffb66378">transform_type_t</a> <a class="el" href="../../d7/da0/test__parser_8c.html#a4f74e41aae4bcdc6f1aed7475be1ba41">type</a>, u_int16_t kernel_id, char *kernel_name)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register a new algorithm with the kernel interface.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alg_id</td><td>the IKE id of the algorithm </td></tr>
    <tr><td class="paramname">type</td><td>the transform type of the algorithm </td></tr>
    <tr><td class="paramname">kernel_id</td><td>the kernel id of the algorithm </td></tr>
    <tr><td class="paramname">kernel_name</td><td>the kernel name of the algorithm </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00626">626</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1348cbf157ad421307431552f1b68e9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::release_reqid)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int32_t reqid, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark_in, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark_out)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release a previously allocated reqid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">reqid</td><td>reqid to release </td></tr>
    <tr><td class="paramname">mark_in</td><td>inbound mark on SA </td></tr>
    <tr><td class="paramname">mark_out</td><td>outbound mark on SA </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if reqid released </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00154">154</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l01110">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a063c091a8ac31fbd8bbb517798b9cbf4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::remove_ipsec_interface)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/db7/group__kernel__interface.html#ga97e697671274b28e3d022bceefa659d1">kernel_ipsec_constructor_t</a> <a class="el" href="../../d4/d08/pkcs11__public__key_8c.html#aba411f8641b7fafc2e5321094473bdb9">create</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unregister an ipsec kernel interface constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">create</td><td>constructor to unregister </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if the ipsec kernel interface was unregistered successfully, FALSE otherwise </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00517">517</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d9/d73/kernel__ipsec_8c_source.html#l00023">kernel_ipsec_register()</a>, and <a class="el" href="../../d4/d98/load__tester__plugin_8c_source.html#l00248">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a8d22f6485952bc354322bcc97d672ef4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::remove_listener)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/d43/structkernel__listener__t.html">kernel_listener_t</a> *<a class="el" href="../../d4/d9f/charon-tkm_8c.html#a88dcd2f2f299c6eb73701fb23390476c">listener</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove a listener from the kernel interface.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">listener</td><td>listener to remove </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00554">554</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../df/dd7/forecast__forwarder_8c_source.html#l00419">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="aa576d824a1ae14a7b65caaf14c625a36"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a>(* kernel_interface_t::remove_net_interface)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../dc/db7/group__kernel__interface.html#ga50a3db23fb07fe288b23a3c10c2d4337">kernel_net_constructor_t</a> <a class="el" href="../../d4/d08/pkcs11__public__key_8c.html#aba411f8641b7fafc2e5321094473bdb9">create</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unregister a network kernel interface constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">create</td><td>constructor to unregister </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if the kernel net interface was unregistered successfully, FALSE otherwise </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00538">538</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dc/d86/kernel__net_8c_source.html#l00023">kernel_net_register()</a>.</p>

</div>
</div>
<a class="anchor" id="a887872145a07ba929fa39bd93b4c03b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::roam)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> address)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Raise a roam event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>TRUE if address list, FALSE if routing changed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00608">608</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d3d/kernel__iph__net_8c_source.html#l00124">roam_event()</a>.</p>

</div>
</div>
<a class="anchor" id="a7bbbd006ae7489593522ec61b8844649"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* kernel_interface_t::tun)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, <a class="el" href="../../d1/d32/structtun__device__t.html">tun_device_t</a> *tun, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> created)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Raise a tun event.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tun</td><td>TUN device </td></tr>
    <tr><td class="paramname">created</td><td>TRUE if created, FALSE if going to be destroyed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00616">616</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../d1/d1f/kernel__pfroute__net_8c_source.html#l01195">METHOD()</a>.</p>

</div>
</div>
<a class="anchor" id="a10341ee84a456ab1aed1a1674ba0ad83"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d77/group__status__i.html#gaf9bff8ff1154a04a899276af806b8586">status_t</a>(* kernel_interface_t::update_sa)(<a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a> *this, u_int32_t spi, u_int8_t <a class="el" href="../../d7/d2c/dnskey__builder_8c.html#ad82c402f0fb34c2cbfc1e60d7b6c08a4">protocol</a>, u_int16_t cpi, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../db/d99/manager_2templates_2ikesa_2list_8cs.html#a798fdc52964d4c82550724e0ce9738bf">src</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *<a class="el" href="../../d9/dbc/kernel__pfkey__ipsec_8c.html#a2c489e7a93d1497f3690274e047e8aaf">dst</a>, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *new_src, <a class="el" href="../../d5/dcf/structhost__t.html">host_t</a> *new_dst, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> encap, <a class="el" href="../../d7/dbb/group__types__i.html#gabb452686968e48b67397da5f97445f5b">bool</a> new_encap, <a class="el" href="../../da/dbc/structmark__t.html">mark_t</a> mark)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update the hosts on an installed SA.</p>
<p>We cannot directly update the destination address as the kernel requires the spi, the protocol AND the destination address (and family) to identify SAs. Therefore if the destination address changed we create a new SA and delete the old one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spi</td><td>SPI of the SA </td></tr>
    <tr><td class="paramname">protocol</td><td>protocol for this SA (ESP/AH) </td></tr>
    <tr><td class="paramname">cpi</td><td>CPI for IPComp, 0 if no IPComp is used </td></tr>
    <tr><td class="paramname">src</td><td>current source address </td></tr>
    <tr><td class="paramname">dst</td><td>current destination address </td></tr>
    <tr><td class="paramname">new_src</td><td>new source address </td></tr>
    <tr><td class="paramname">new_dst</td><td>new destination address </td></tr>
    <tr><td class="paramname">encap</td><td>current use of UDP encapsulation </td></tr>
    <tr><td class="paramname">new_encap</td><td>new use of UDP encapsulation </td></tr>
    <tr><td class="paramname">mark</td><td>optional mark for this SA </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SUCCESS if operation completed, NOT_SUPPORTED if the kernel interface can't update the SA </dd></dl>

<p>Definition at line <a class="el" href="../../db/d8e/kernel__interface_8h_source.html#l00220">220</a> of file <a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d99/child__sa_8c_source.html#l00979">METHOD()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="../../db/d8e/kernel__interface_8h_source.html">kernel_interface.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../db/df8/structkernel__interface__t.html">kernel_interface_t</a></li>
    <li class="footer">Generated on Wed Jan 20 2016 14:04:27 for strongSwan by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
